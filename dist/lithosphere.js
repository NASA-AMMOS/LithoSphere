!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("LithoSphere",[],e):"object"==typeof exports?exports.LithoSphere=e():t.LithoSphere=e()}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="C:\\Users\\tsoliman\\Documents\\Projects\\LithoSphere\\dist/",n(n.s=16)}([function(t,e,n){"use strict";n.r(e),n.d(e,"earthRadius",(function(){return r})),n.d(e,"factors",(function(){return i})),n.d(e,"unitsFactors",(function(){return o})),n.d(e,"areaFactors",(function(){return s})),n.d(e,"feature",(function(){return a})),n.d(e,"geometry",(function(){return l})),n.d(e,"point",(function(){return c})),n.d(e,"points",(function(){return u})),n.d(e,"polygon",(function(){return h})),n.d(e,"polygons",(function(){return f})),n.d(e,"lineString",(function(){return d})),n.d(e,"lineStrings",(function(){return p})),n.d(e,"featureCollection",(function(){return m})),n.d(e,"multiLineString",(function(){return g})),n.d(e,"multiPoint",(function(){return v})),n.d(e,"multiPolygon",(function(){return y})),n.d(e,"geometryCollection",(function(){return b})),n.d(e,"round",(function(){return _})),n.d(e,"radiansToLength",(function(){return x})),n.d(e,"lengthToRadians",(function(){return w})),n.d(e,"lengthToDegrees",(function(){return M})),n.d(e,"bearingToAzimuth",(function(){return S})),n.d(e,"radiansToDegrees",(function(){return E})),n.d(e,"degreesToRadians",(function(){return T})),n.d(e,"convertLength",(function(){return C})),n.d(e,"convertArea",(function(){return A})),n.d(e,"isNumber",(function(){return P})),n.d(e,"isObject",(function(){return L})),n.d(e,"validateBBox",(function(){return R})),n.d(e,"validateId",(function(){return O}));var r=6371008.8,i={centimeters:100*r,centimetres:100*r,degrees:r/111325,feet:3.28084*r,inches:39.37*r,kilometers:r/1e3,kilometres:r/1e3,meters:r,metres:r,miles:r/1609.344,millimeters:1e3*r,millimetres:1e3*r,nauticalmiles:r/1852,radians:1,yards:r/1.0936},o={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/r,yards:1/1.0936},s={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function a(t,e,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function l(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return c(e).geometry;case"LineString":return d(e).geometry;case"Polygon":return h(e).geometry;case"MultiPoint":return v(e).geometry;case"MultiLineString":return g(e).geometry;case"MultiPolygon":return y(e).geometry;default:throw new Error(t+" is invalid")}}function c(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!P(t[0])||!P(t[1]))throw new Error("coordinates must contain numbers");return a({type:"Point",coordinates:t},e,n)}function u(t,e,n){return void 0===n&&(n={}),m(t.map((function(t){return c(t,e)})),n)}function h(t,e,n){void 0===n&&(n={});for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return a({type:"Polygon",coordinates:t},e,n)}function f(t,e,n){return void 0===n&&(n={}),m(t.map((function(t){return h(t,e)})),n)}function d(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return a({type:"LineString",coordinates:t},e,n)}function p(t,e,n){return void 0===n&&(n={}),m(t.map((function(t){return d(t,e)})),n)}function m(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function g(t,e,n){return void 0===n&&(n={}),a({type:"MultiLineString",coordinates:t},e,n)}function v(t,e,n){return void 0===n&&(n={}),a({type:"MultiPoint",coordinates:t},e,n)}function y(t,e,n){return void 0===n&&(n={}),a({type:"MultiPolygon",coordinates:t},e,n)}function b(t,e,n){return void 0===n&&(n={}),a({type:"GeometryCollection",geometries:t},e,n)}function _(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n}function x(t,e){void 0===e&&(e="kilometers");var n=i[e];if(!n)throw new Error(e+" units is invalid");return t*n}function w(t,e){void 0===e&&(e="kilometers");var n=i[e];if(!n)throw new Error(e+" units is invalid");return t/n}function M(t,e){return E(w(t,e))}function S(t){var e=t%360;return e<0&&(e+=360),e}function E(t){return 180*(t%(2*Math.PI))/Math.PI}function T(t){return t%360*Math.PI/180}function C(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return x(w(t,e),n)}function A(t,e,n){if(void 0===e&&(e="meters"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var r=s[e];if(!r)throw new Error("invalid original units");var i=s[n];if(!i)throw new Error("invalid final units");return t/r*i}function P(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function L(t){return!!t&&t.constructor===Object}function R(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!P(t))throw new Error("bbox must only contain numbers")}))}function O(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},function(t,e,n){"use strict";n.r(e),n.d(e,"coordEach",(function(){return i})),n.d(e,"coordReduce",(function(){return o})),n.d(e,"propEach",(function(){return s})),n.d(e,"propReduce",(function(){return a})),n.d(e,"featureEach",(function(){return l})),n.d(e,"featureReduce",(function(){return c})),n.d(e,"coordAll",(function(){return u})),n.d(e,"geomEach",(function(){return h})),n.d(e,"geomReduce",(function(){return f})),n.d(e,"flattenEach",(function(){return d})),n.d(e,"flattenReduce",(function(){return p})),n.d(e,"segmentEach",(function(){return m})),n.d(e,"segmentReduce",(function(){return g})),n.d(e,"lineEach",(function(){return v})),n.d(e,"lineReduce",(function(){return y})),n.d(e,"findSegment",(function(){return b})),n.d(e,"findPoint",(function(){return _}));var r=n(0);function i(t,e,n){if(null!==t)for(var r,o,s,a,l,c,u,h,f=0,d=0,p=t.type,m="FeatureCollection"===p,g="Feature"===p,v=m?t.features.length:1,y=0;y<v;y++){l=(h=!!(u=m?t.features[y].geometry:g?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var b=0;b<l;b++){var _=0,x=0;if(null!==(a=h?u.geometries[b]:u)){c=a.coordinates;var w=a.type;switch(f=!n||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(c,d,y,_,x))return!1;d++,_++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(!1===e(c[r],d,y,_,x))return!1;d++,"MultiPoint"===w&&_++}"LineString"===w&&_++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(o=0;o<c[r].length-f;o++){if(!1===e(c[r][o],d,y,_,x))return!1;d++}"MultiLineString"===w&&_++,"Polygon"===w&&x++}"Polygon"===w&&_++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(x=0,o=0;o<c[r].length;o++){for(s=0;s<c[r][o].length-f;s++){if(!1===e(c[r][o][s],d,y,_,x))return!1;d++}x++}_++}break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(!1===i(a.geometries[r],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e,n,r){var o=n;return i(t,(function(t,r,i,s,a){o=0===r&&void 0===n?t:e(o,t,r,i,s,a)}),r),o}function s(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function a(t,e,n){var r=n;return s(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r}function l(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function c(t,e,n){var r=n;return l(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r}function u(t){var e=[];return i(t,(function(t){e.push(t)})),e}function h(t,e){var n,r,i,o,s,a,l,c,u,h,f=0,d="FeatureCollection"===t.type,p="Feature"===t.type,m=d?t.features.length:1;for(n=0;n<m;n++){for(a=d?t.features[n].geometry:p?t.geometry:t,c=d?t.features[n].properties:p?t.properties:{},u=d?t.features[n].bbox:p?t.bbox:void 0,h=d?t.features[n].id:p?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,i=0;i<s;i++)if(null!==(o=l?a.geometries[i]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,f,c,u,h))return!1;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===e(o.geometries[r],f,c,u,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,c,u,h))return!1;f++}}function f(t,e,n){var r=n;return h(t,(function(t,i,o,s,a){r=0===i&&void 0===n?t:e(r,t,i,o,s,a)})),r}function d(t,e){h(t,(function(t,n,i,o,s){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(Object(r.feature)(t,i,{bbox:o,id:s}),n,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var c=0;c<t.coordinates.length;c++){var u={type:a,coordinates:t.coordinates[c]};if(!1===e(Object(r.feature)(u,i),n,c))return!1}}))}function p(t,e,n){var r=n;return d(t,(function(t,i,o){r=0===i&&0===o&&void 0===n?t:e(r,t,i,o)})),r}function m(t,e){d(t,(function(t,n,o){var s=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var l,c=0,u=0,h=0;return!1!==i(t,(function(i,a,f,d,p){if(void 0===l||n>c||d>u||p>h)return l=i,c=n,u=d,h=p,void(s=0);var m=Object(r.lineString)([l,i],t.properties);if(!1===e(m,n,o,p,s))return!1;s++,l=i}))&&void 0}}}))}function g(t,e,n){var r=n,i=!1;return m(t,(function(t,o,s,a,l){r=!1===i&&void 0===n?t:e(r,t,o,s,a,l),i=!0})),r}function v(t,e){if(!t)throw new Error("geojson is required");d(t,(function(t,n,i){if(null!==t.geometry){var o=t.geometry.type,s=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,n,i,0,0))return!1;break;case"Polygon":for(var a=0;a<s.length;a++)if(!1===e(Object(r.lineString)(s[a],t.properties),n,i,a))return!1}}}))}function y(t,e,n){var r=n;return v(t,(function(t,i,o,s){r=0===i&&void 0===n?t:e(r,t,i,o,s)})),r}function b(t,e){if(e=e||{},!Object(r.isObject)(e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.segmentIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),l=l||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var c=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=c.length+a-1),Object(r.lineString)([c[a],c[a+1]],l,e);case"Polygon":return s<0&&(s=c.length+s),a<0&&(a=c[s].length+a-1),Object(r.lineString)([c[s][a],c[s][a+1]],l,e);case"MultiLineString":return o<0&&(o=c.length+o),a<0&&(a=c[o].length+a-1),Object(r.lineString)([c[o][a],c[o][a+1]],l,e);case"MultiPolygon":return o<0&&(o=c.length+o),s<0&&(s=c[o].length+s),a<0&&(a=c[o][s].length-a-1),Object(r.lineString)([c[o][s][a],c[o][s][a+1]],l,e)}throw new Error("geojson is invalid")}function _(t,e){if(e=e||{},!Object(r.isObject)(e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.coordIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),l=l||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var c=n.coordinates;switch(n.type){case"Point":return Object(r.point)(c,l,e);case"MultiPoint":return o<0&&(o=c.length+o),Object(r.point)(c[o],l,e);case"LineString":return a<0&&(a=c.length+a),Object(r.point)(c[a],l,e);case"Polygon":return s<0&&(s=c.length+s),a<0&&(a=c[s].length+a),Object(r.point)(c[s][a],l,e);case"MultiLineString":return o<0&&(o=c.length+o),a<0&&(a=c[o].length+a),Object(r.point)(c[o][a],l,e);case"MultiPolygon":return o<0&&(o=c.length+o),s<0&&(s=c[o].length+s),a<0&&(a=c[o][s].length-a),Object(r.point)(c[o][s][a],l,e)}throw new Error("geojson is invalid")}},function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var e="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var s=o>=0?arguments[o]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(e=s+"/"+e,i="/"===s.charAt(0))}return(i?"/":"")+(e=n(r(e.split("/"),(function(t){return!!t})),!i).join("/"))||"."},e.normalize=function(t){var o=e.isAbsolute(t),s="/"===i(t,-1);return(t=n(r(t.split("/"),(function(t){return!!t})),!o).join("/"))||o||(t="."),t&&s&&(t+="/"),(o?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(r(t,(function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var i=r(t.split("/")),o=r(n.split("/")),s=Math.min(i.length,o.length),a=s,l=0;l<s;l++)if(i[l]!==o[l]){a=l;break}var c=[];for(l=a;l<i.length;l++)c.push("..");return(c=c.concat(o.slice(a))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){if("string"!=typeof t&&(t+=""),0===t.length)return".";for(var e=t.charCodeAt(0),n=47===e,r=-1,i=!0,o=t.length-1;o>=1;--o)if(47===(e=t.charCodeAt(o))){if(!i){r=o;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":t.slice(0,r)},e.basename=function(t,e){var n=function(t){"string"!=typeof t&&(t+="");var e,n=0,r=-1,i=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!i){n=e+1;break}}else-1===r&&(i=!1,r=e+1);return-1===r?"":t.slice(n,r)}(t);return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){"string"!=typeof t&&(t+="");for(var e=-1,n=0,r=-1,i=!0,o=0,s=t.length-1;s>=0;--s){var a=t.charCodeAt(s);if(47!==a)-1===r&&(i=!1,r=s+1),46===a?-1===e?e=s:1!==o&&(o=1):-1!==e&&(o=-1);else if(!i){n=s+1;break}}return-1===e||-1===r||0===o||1===o&&e===r-1&&e===n+1?"":t.slice(e,r)};var i="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,n(12))},function(t,e,n){parcelRequire=function(e,r,i,o){var s,a="function"==typeof parcelRequire&&parcelRequire;function l(t,i){if(!r[t]){if(!e[t]){var o="function"==typeof parcelRequire&&parcelRequire;if(!i&&o)return o(t,!0);if(a)return a(t,!0);if("string"==typeof t)return n(6)(t);var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}u.resolve=function(n){return e[t][1][n]||n},u.cache={};var c=r[t]=new l.Module(t);e[t][0].call(c.exports,u,c,c.exports,this)}return r[t].exports;function u(t){return l(u.resolve(t))}}l.isParcelRequire=!0,l.Module=function(t){this.id=t,this.bundle=l,this.exports={}},l.modules=e,l.cache=r,l.parent=a,l.register=function(t,n){e[t]=[function(t,e){e.exports=n},{}]};for(var c=0;c<i.length;c++)try{l(i[c])}catch(e){s||(s=e)}if(i.length){var u=l(i[i.length-1]);t.exports=u}if(parcelRequire=l,s)throw s;return l}({QVnC:[function(t,e,n){var r=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,o=Object.create(i.prototype),s=new C(r||[]);return o._invoke=function(t,e,n){var r=u;return function(i,o){if(r===f)throw new Error("Generator is already running");if(r===d){if("throw"===i)throw o;return P()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=S(s,n);if(a){if(a===p)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===u)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var l=c(t,e,n);if("normal"===l.type){if(r=n.done?d:h,l.arg===p)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=d,n.method="throw",n.arg=l.arg)}}}(t,n,s),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var u="suspendedStart",h="suspendedYield",f="executing",d="completed",p={};function m(){}function g(){}function v(){}var y={};y[o]=function(){return this};var b=Object.getPrototypeOf,_=b&&b(b(A([])));_&&_!==n&&r.call(_,o)&&(y=_);var x=v.prototype=m.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function M(t,e){var n;this._invoke=function(i,o){function s(){return new e((function(n,s){!function n(i,o,s,a){var l=c(t[i],t,o);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"==typeof h&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){u.value=t,s(u)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}(i,o,n,s)}))}return n=n?n.then(s,s):s()}}function S(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method))return p;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=c(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var o=i.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,p):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function A(t){if(t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,s=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}return{next:P}}function P(){return{value:e,done:!0}}return g.prototype=x.constructor=v,v.constructor=g,v[a]=g.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,a in t||(t[a]="GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},w(M.prototype),M.prototype[s]=function(){return this},t.AsyncIterator=M,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var s=new M(l(e,n,r,i),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},w(x),x[a]="Generator",x[o]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=A,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return a.type="throw",a.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:A(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),p}},t}("object"==typeof e?e.exports:{});try{regeneratorRuntime=r}catch(t){Function("r","regeneratorRuntime = r")(r)}},{}],PMvg:[function(t,e,n){e.exports=t("regenerator-runtime")},{"regenerator-runtime":"QVnC"}],IxO8:[function(t,e,n){e.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},{}],OUZ9:[function(t,e,n){e.exports=function(t){if(Array.isArray(t))return t}},{}],vKPt:[function(t,e,n){e.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}},{}],NVR6:[function(t,e,n){e.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}},{}],UyFj:[function(t,e,n){var r=t("./arrayLikeToArray");e.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}},{"./arrayLikeToArray":"NVR6"}],Rom6:[function(t,e,n){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},{}],HETk:[function(t,e,n){var r=t("./arrayWithHoles"),i=t("./iterableToArrayLimit"),o=t("./unsupportedIterableToArray"),s=t("./nonIterableRest");e.exports=function(t,e){return r(t)||i(t,e)||o(t,e)||s()}},{"./arrayWithHoles":"OUZ9","./iterableToArrayLimit":"vKPt","./unsupportedIterableToArray":"UyFj","./nonIterableRest":"Rom6"}],agGE:[function(t,e,n){function r(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}e.exports=function(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var s=t.apply(e,n);function a(t){r(s,i,o,a,l,"next",t)}function l(t){r(s,i,o,a,l,"throw",t)}a(void 0)}))}}},{}],P8NW:[function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.exports=function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}},{}],AkAO:[function(t,e,n){function r(t,n){return e.exports=r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},r(t,n)}e.exports=r},{}],d4H2:[function(t,e,n){var r=t("./setPrototypeOf");e.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},{"./setPrototypeOf":"AkAO"}],b9XL:[function(t,e,n){function r(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=r=function(t){return typeof t}:e.exports=r=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}e.exports=r},{}],E7HD:[function(t,e,n){e.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},{}],pxk2:[function(t,e,n){var r=t("../helpers/typeof"),i=t("./assertThisInitialized");e.exports=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?i(t):e}},{"../helpers/typeof":"b9XL","./assertThisInitialized":"E7HD"}],UJE0:[function(t,e,n){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},r(t)}e.exports=r},{}],vNP7:[function(t,e,n){e.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")}},{}],QFb6:[function(t,e,n){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}},{}],dJhE:[function(t,e,n){var r=t("./setPrototypeOf"),i=t("./isNativeReflectConstruct");function o(t,n,s){return i()?e.exports=o=Reflect.construct:e.exports=o=function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o},o.apply(null,arguments)}e.exports=o},{"./setPrototypeOf":"AkAO","./isNativeReflectConstruct":"QFb6"}],ozpi:[function(t,e,n){var r=t("./getPrototypeOf"),i=t("./setPrototypeOf"),o=t("./isNativeFunction"),s=t("./construct");function a(t){var n="function"==typeof Map?new Map:void 0;return e.exports=a=function(t){if(null===t||!o(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return s(t,arguments,r(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),i(e,t)},a(t)}e.exports=a},{"./getPrototypeOf":"UJE0","./setPrototypeOf":"AkAO","./isNativeFunction":"vNP7","./construct":"dJhE"}],fcMS:[function(t,e,n){e.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},{}],GG94:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.roundToFloat16Bits=function(t){i[0]=t;const e=o[0],n=e>>23&511;return s[n]+((8388607&e)>>a[n])},n.convertToNumber=function(t){const e=t>>10;return o[0]=l[u[e]+(1023&t)]+c[e],i[0]};const r=new ArrayBuffer(4),i=new Float32Array(r),o=new Uint32Array(r),s=new Uint32Array(512),a=new Uint32Array(512);for(let t=0;t<256;++t){const e=t-127;e<-27?(s[0|t]=0,s[256|t]=32768,a[0|t]=24,a[256|t]=24):e<-14?(s[0|t]=1024>>-e-14,s[256|t]=1024>>-e-14|32768,a[0|t]=-e-1,a[256|t]=-e-1):e<=15?(s[0|t]=e+15<<10,s[256|t]=e+15<<10|32768,a[0|t]=13,a[256|t]=13):e<128?(s[0|t]=31744,s[256|t]=64512,a[0|t]=24,a[256|t]=24):(s[0|t]=31744,s[256|t]=64512,a[0|t]=13,a[256|t]=13)}const l=new Uint32Array(2048),c=new Uint32Array(64),u=new Uint32Array(64);l[0]=0;for(let t=1;t<1024;++t){let e=t<<13,n=0;for(;0==(8388608&e);)n-=8388608,e<<=1;e&=-8388609,n+=947912704,l[t]=e|n}for(let t=1024;t<2048;++t)l[t]=939524096+(t-1024<<13);c[0]=0;for(let t=1;t<31;++t)c[t]=t<<23;c[31]=1199570944,c[32]=2147483648;for(let t=33;t<63;++t)c[t]=2147483648+(t-32<<23);c[63]=3347054592,u[0]=0;for(let t=1;t<64;++t)u[t]=32===t?0:1024},{}],G4sf:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){if(t=Number(t),!Number.isFinite(t)||0===t)return t;const e=(0,r.roundToFloat16Bits)(t);return(0,r.convertToNumber)(e)};var r=t("./lib")},{"./lib":"GG94"}],xQUP:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ToInteger=function(t){return"number"!=typeof t&&(t=Number(t)),Number.isNaN(t)&&(t=0),Math.trunc(t)},n.defaultCompareFunction=function(t,e){const[n,r]=[Number.isNaN(t),Number.isNaN(e)];if(n&&r)return 0;if(n)return 1;if(r)return-1;if(t<e)return-1;if(t>e)return 1;if(0===t&&0===e){const[n,r]=[Object.is(t,0),Object.is(e,0)];if(!n&&r)return-1;if(n&&!r)return 1}return 0}},{}],iJ7y:[function(t,e,n){var r=arguments[3];Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i="object"==typeof r&&r&&r.Object===Object&&r,o=i;n.default=o},{}],ygki:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_freeGlobal.js")),i="object"==typeof self&&self&&self.Object===Object&&self,o=r.default||i||Function("return this")();n.default=o},{"./_freeGlobal.js":"iJ7y"}],Oi8n:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_root.js")).default.Symbol;n.default=r},{"./_root.js":"ygki"}],InRc:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_Symbol.js")),i=Object.prototype,o=i.hasOwnProperty,s=i.toString,a=r.default?r.default.toStringTag:void 0;n.default=function(t){var e=o.call(t,a),n=t[a];try{t[a]=void 0;var r=!0}catch(t){}var i=s.call(t);return r&&(e?t[a]=n:delete t[a]),i}},{"./_Symbol.js":"Oi8n"}],iwg4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=Object.prototype.toString;n.default=function(t){return r.call(t)}},{}],svpX:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=s(t("./_Symbol.js")),i=s(t("./_getRawTag.js")),o=s(t("./_objectToString.js"));function s(t){return t&&t.__esModule?t:{default:t}}var a=r.default?r.default.toStringTag:void 0;n.default=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":a&&a in Object(t)?(0,i.default)(t):(0,o.default)(t)}},{"./_Symbol.js":"Oi8n","./_getRawTag.js":"InRc","./_objectToString.js":"iwg4"}],UKR9:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(t){return null!=t&&"object"==typeof t}},{}],MYZg:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=o(t("./_baseGetTag.js")),i=o(t("./isObjectLike.js"));function o(t){return t&&t.__esModule?t:{default:t}}n.default=function(t){return(0,i.default)(t)&&"[object ArrayBuffer]"==(0,r.default)(t)}},{"./_baseGetTag.js":"svpX","./isObjectLike.js":"UKR9"}],pmj6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(t){return function(e){return t(e)}}},{}],oPFz:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_freeGlobal.js")),i="object"==typeof n&&n&&!n.nodeType&&n,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===i&&r.default.process,a=function(){try{return o&&o.require&&o.require("util").types||s&&s.binding&&s.binding("util")}catch(t){}}();n.default=a},{"./_freeGlobal.js":"iJ7y"}],rXXV:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=s(t("./_baseIsArrayBuffer.js")),i=s(t("./_baseUnary.js")),o=s(t("./_nodeUtil.js"));function s(t){return t&&t.__esModule?t:{default:t}}var a=o.default&&o.default.isArrayBuffer,l=a?(0,i.default)(a):r.default;n.default=l},{"./_baseIsArrayBuffer.js":"MYZg","./_baseUnary.js":"pmj6","./_nodeUtil.js":"oPFz"}],XYHx:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isDataView=function(t){return t instanceof DataView},n.isStringNumberKey=function(t){return"string"==typeof t&&t===(0,r.ToInteger)(t)+""},Object.defineProperty(n,"isArrayBuffer",{enumerable:!0,get:function(){return i.default}});var r=t("./spec"),i=function(t){return t&&t.__esModule?t:{default:t}}(t("lodash-es/isArrayBuffer"))},{"./spec":"xQUP","lodash-es/isArrayBuffer":"rXXV"}],EEXG:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createPrivateStorage=function(){const t=new WeakMap;return e=>{let n=t.get(e);return n||(n=Object.create(null),t.set(e,n),n)}}},{}],DTZk:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},{}],tWvT:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=o(t("./_baseGetTag.js")),i=o(t("./isObject.js"));function o(t){return t&&t.__esModule?t:{default:t}}n.default=function(t){if(!(0,i.default)(t))return!1;var e=(0,r.default)(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},{"./_baseGetTag.js":"svpX","./isObject.js":"DTZk"}],xFkS:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_root.js")).default["__core-js_shared__"];n.default=r},{"./_root.js":"ygki"}],pULC:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_coreJsData.js")),i=function(){var t=/[^.]+$/.exec(r.default&&r.default.keys&&r.default.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();n.default=function(t){return!!i&&i in t}},{"./_coreJsData.js":"xFkS"}],UKJK:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=Function.prototype.toString;n.default=function(t){if(null!=t){try{return r.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},{}],Zczf:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=a(t("./isFunction.js")),i=a(t("./_isMasked.js")),o=a(t("./isObject.js")),s=a(t("./_toSource.js"));function a(t){return t&&t.__esModule?t:{default:t}}var l=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,h=c.toString,f=u.hasOwnProperty,d=RegExp("^"+h.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");n.default=function(t){return!(!(0,o.default)(t)||(0,i.default)(t))&&((0,r.default)(t)?d:l).test((0,s.default)(t))}},{"./isFunction.js":"tWvT","./_isMasked.js":"pULC","./isObject.js":"DTZk","./_toSource.js":"UKJK"}],ZVQn:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(t,e){return null==t?void 0:t[e]}},{}],tx41:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=o(t("./_baseIsNative.js")),i=o(t("./_getValue.js"));function o(t){return t&&t.__esModule?t:{default:t}}n.default=function(t,e){var n=(0,i.default)(t,e);return(0,r.default)(n)?n:void 0}},{"./_baseIsNative.js":"Zczf","./_getValue.js":"ZVQn"}],YsDH:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=(0,function(t){return t&&t.__esModule?t:{default:t}}(t("./_getNative.js")).default)(Object,"create");n.default=r},{"./_getNative.js":"tx41"}],sJnX:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_nativeCreate.js"));n.default=function(){this.__data__=r.default?(0,r.default)(null):{},this.size=0}},{"./_nativeCreate.js":"YsDH"}],c9sB:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},{}],zYTU:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_nativeCreate.js")),i=Object.prototype.hasOwnProperty;n.default=function(t){var e=this.__data__;if(r.default){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(e,t)?e[t]:void 0}},{"./_nativeCreate.js":"YsDH"}],ZFwF:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_nativeCreate.js")),i=Object.prototype.hasOwnProperty;n.default=function(t){var e=this.__data__;return r.default?void 0!==e[t]:i.call(e,t)}},{"./_nativeCreate.js":"YsDH"}],i3LK:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_nativeCreate.js"));n.default=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r.default&&void 0===e?"__lodash_hash_undefined__":e,this}},{"./_nativeCreate.js":"YsDH"}],tE4I:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(t("./_hashClear.js")),i=l(t("./_hashDelete.js")),o=l(t("./_hashGet.js")),s=l(t("./_hashHas.js")),a=l(t("./_hashSet.js"));function l(t){return t&&t.__esModule?t:{default:t}}function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r.default,c.prototype.delete=i.default,c.prototype.get=o.default,c.prototype.has=s.default,c.prototype.set=a.default;var u=c;n.default=u},{"./_hashClear.js":"sJnX","./_hashDelete.js":"c9sB","./_hashGet.js":"zYTU","./_hashHas.js":"ZFwF","./_hashSet.js":"i3LK"}],cHCQ:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(){this.__data__=[],this.size=0}},{}],SRq7:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(t,e){return t===e||t!=t&&e!=e}},{}],Hp84:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./eq.js"));n.default=function(t,e){for(var n=t.length;n--;)if((0,r.default)(t[n][0],e))return n;return-1}},{"./eq.js":"SRq7"}],NMSb:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_assocIndexOf.js")),i=Array.prototype.splice;n.default=function(t){var e=this.__data__,n=(0,r.default)(e,t);return!(n<0||(n==e.length-1?e.pop():i.call(e,n,1),--this.size,0))}},{"./_assocIndexOf.js":"Hp84"}],P9vD:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_assocIndexOf.js"));n.default=function(t){var e=this.__data__,n=(0,r.default)(e,t);return n<0?void 0:e[n][1]}},{"./_assocIndexOf.js":"Hp84"}],mbsC:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_assocIndexOf.js"));n.default=function(t){return(0,r.default)(this.__data__,t)>-1}},{"./_assocIndexOf.js":"Hp84"}],GGNI:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_assocIndexOf.js"));n.default=function(t,e){var n=this.__data__,i=(0,r.default)(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}},{"./_assocIndexOf.js":"Hp84"}],UlXa:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(t("./_listCacheClear.js")),i=l(t("./_listCacheDelete.js")),o=l(t("./_listCacheGet.js")),s=l(t("./_listCacheHas.js")),a=l(t("./_listCacheSet.js"));function l(t){return t&&t.__esModule?t:{default:t}}function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r.default,c.prototype.delete=i.default,c.prototype.get=o.default,c.prototype.has=s.default,c.prototype.set=a.default;var u=c;n.default=u},{"./_listCacheClear.js":"cHCQ","./_listCacheDelete.js":"NMSb","./_listCacheGet.js":"P9vD","./_listCacheHas.js":"mbsC","./_listCacheSet.js":"GGNI"}],hhFe:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=o(t("./_getNative.js")),i=o(t("./_root.js"));function o(t){return t&&t.__esModule?t:{default:t}}var s=(0,r.default)(i.default,"Map");n.default=s},{"./_getNative.js":"tx41","./_root.js":"ygki"}],S4lD:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=s(t("./_Hash.js")),i=s(t("./_ListCache.js")),o=s(t("./_Map.js"));function s(t){return t&&t.__esModule?t:{default:t}}n.default=function(){this.size=0,this.__data__={hash:new r.default,map:new(o.default||i.default),string:new r.default}}},{"./_Hash.js":"tE4I","./_ListCache.js":"UlXa","./_Map.js":"hhFe"}],yCDP:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},{}],QOd1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_isKeyable.js"));n.default=function(t,e){var n=t.__data__;return(0,r.default)(e)?n["string"==typeof e?"string":"hash"]:n.map}},{"./_isKeyable.js":"yCDP"}],kigP:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_getMapData.js"));n.default=function(t){var e=(0,r.default)(this,t).delete(t);return this.size-=e?1:0,e}},{"./_getMapData.js":"QOd1"}],uJAD:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_getMapData.js"));n.default=function(t){return(0,r.default)(this,t).get(t)}},{"./_getMapData.js":"QOd1"}],h8gm:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_getMapData.js"));n.default=function(t){return(0,r.default)(this,t).has(t)}},{"./_getMapData.js":"QOd1"}],VMmx:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_getMapData.js"));n.default=function(t,e){var n=(0,r.default)(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}},{"./_getMapData.js":"QOd1"}],Ov7L:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(t("./_mapCacheClear.js")),i=l(t("./_mapCacheDelete.js")),o=l(t("./_mapCacheGet.js")),s=l(t("./_mapCacheHas.js")),a=l(t("./_mapCacheSet.js"));function l(t){return t&&t.__esModule?t:{default:t}}function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r.default,c.prototype.delete=i.default,c.prototype.get=o.default,c.prototype.has=s.default,c.prototype.set=a.default;var u=c;n.default=u},{"./_mapCacheClear.js":"S4lD","./_mapCacheDelete.js":"kigP","./_mapCacheGet.js":"uJAD","./_mapCacheHas.js":"h8gm","./_mapCacheSet.js":"VMmx"}],mNqw:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./_MapCache.js"));function i(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=t.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(i.Cache||r.default),n}i.Cache=r.default;var o=i;n.default=o},{"./_MapCache.js":"Ov7L"}],cSEU:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isTypedArrayIndexedPropertyWritable=void 0;const r=Object.getOwnPropertyDescriptor(new Uint8Array(1),0).writable;n.isTypedArrayIndexedPropertyWritable=r},{}],ZpG8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=t("./spec"),i=t("./is"),o=t("./private"),s=function(t){return t&&t.__esModule?t:{default:t}}(t("lodash-es/memoize")),a=t("./lib"),l=t("./bug");const c=(0,o.createPrivateStorage)();function u(t){return t instanceof m}function h(t){if(!u(t))throw new TypeError("This is not a Float16Array")}function f(t){const e=t.length,n=new Array(e);for(let r=0;r<e;++r)n[r]=(0,a.convertToNumber)(t[r]);return n}const d={apply:(t,e,n)=>u(e)&&function(t){return"function"==typeof t&&v.has(t)}(t)?Reflect.apply(t,c(e).target,n):Reflect.apply(t,e,n)},p={get(t,e){let n=null;if(l.isTypedArrayIndexedPropertyWritable||(t=c(n=t).target),(0,i.isStringNumberKey)(e))return Reflect.has(t,e)?(0,a.convertToNumber)(Reflect.get(t,e)):void 0;{const r=null!==n&&Reflect.has(n,e)?Reflect.get(n,e):Reflect.get(t,e);if("function"!=typeof r)return r;let i=c(r).proxy;return void 0===i&&(i=c(r).proxy=new Proxy(r,d)),i}},set(t,e,n){let r=null;return l.isTypedArrayIndexedPropertyWritable||(t=c(r=t).target),(0,i.isStringNumberKey)(e)?Reflect.set(t,e,(0,a.roundToFloat16Bits)(n)):null===r||Reflect.has(t,e)&&!Object.isFrozen(r)?Reflect.set(t,e,n):Reflect.set(r,e,n)}};l.isTypedArrayIndexedPropertyWritable||(p.getPrototypeOf=t=>Reflect.getPrototypeOf(c(t).target),p.setPrototypeOf=(t,e)=>Reflect.setPrototypeOf(c(t).target,e),p.defineProperty=(t,e,n)=>{const r=c(t).target;return!Reflect.has(r,e)||Object.isFrozen(t)?Reflect.defineProperty(t,e,n):Reflect.defineProperty(r,e,n)},p.deleteProperty=(t,e)=>{const n=c(t).target;return Reflect.has(t,e)?Reflect.deleteProperty(t,e):Reflect.deleteProperty(n,e)},p.has=(t,e)=>Reflect.has(t,e)||Reflect.has(c(t).target,e),p.isExtensible=t=>Reflect.isExtensible(t),p.preventExtensions=t=>Reflect.preventExtensions(t),p.getOwnPropertyDescriptor=(t,e)=>Reflect.getOwnPropertyDescriptor(t,e),p.ownKeys=t=>Reflect.ownKeys(t));class m extends Uint16Array{constructor(t,e,n){if(u(t))super(c(t).target);else if(null===t||"object"!=typeof t||(0,i.isArrayBuffer)(t))switch(arguments.length){case 0:super();break;case 1:super(t);break;case 2:super(t,e);break;case 3:super(t,e,n);break;default:super(...arguments)}else{const e=Reflect.has(t,"length")||void 0===t[Symbol.iterator]?t:[...t],n=e.length;super(n);for(let t=0;t<n;++t)this[t]=(0,a.roundToFloat16Bits)(e[t])}let r;if(l.isTypedArrayIndexedPropertyWritable)r=new Proxy(this,p);else{const t=Object.create(null);c(t).target=this,r=new Proxy(t,p)}return c(r).target=this,c(this).proxy=r,r}static from(t,...e){if(0===e.length)return new m(Uint16Array.from(t,a.roundToFloat16Bits).buffer);const n=e[0],r=e[1];return new m(Uint16Array.from(t,(function(t,...e){return(0,a.roundToFloat16Bits)(n.call(this,t,...e))}),r).buffer)}static of(...t){return new m(t)}*[Symbol.iterator](){for(const t of super[Symbol.iterator]())yield(0,a.convertToNumber)(t)}keys(){return super.keys()}*values(){for(const t of super.values())yield(0,a.convertToNumber)(t)}*entries(){for(const[t,e]of super.entries())yield[t,(0,a.convertToNumber)(e)]}map(t,...e){h(this);const n=e[0],r=[];for(let e=0,i=this.length;e<i;++e){const i=(0,a.convertToNumber)(this[e]);r.push(t.call(n,i,e,c(this).proxy))}return new m(r)}filter(t,...e){h(this);const n=e[0],r=[];for(let e=0,i=this.length;e<i;++e){const i=(0,a.convertToNumber)(this[e]);t.call(n,i,e,c(this).proxy)&&r.push(i)}return new m(r)}reduce(t,...e){let n,r;h(this),0===e.length?(n=(0,a.convertToNumber)(this[0]),r=1):(n=e[0],r=0);for(let e=r,i=this.length;e<i;++e)n=t(n,(0,a.convertToNumber)(this[e]),e,c(this).proxy);return n}reduceRight(t,...e){let n,r;h(this);const i=this.length;0===e.length?(n=(0,a.convertToNumber)(this[i-1]),r=i-1):(n=e[0],r=i);for(let e=r;e--;)n=t(n,(0,a.convertToNumber)(this[e]),e,c(this).proxy);return n}forEach(t,...e){h(this);const n=e[0];for(let e=0,r=this.length;e<r;++e)t.call(n,(0,a.convertToNumber)(this[e]),e,c(this).proxy)}find(t,...e){h(this);const n=e[0];for(let e=0,r=this.length;e<r;++e){const r=(0,a.convertToNumber)(this[e]);if(t.call(n,r,e,c(this).proxy))return r}}findIndex(t,...e){h(this);const n=e[0];for(let e=0,r=this.length;e<r;++e){const r=(0,a.convertToNumber)(this[e]);if(t.call(n,r,e,c(this).proxy))return e}return-1}every(t,...e){h(this);const n=e[0];for(let e=0,r=this.length;e<r;++e)if(!t.call(n,(0,a.convertToNumber)(this[e]),e,c(this).proxy))return!1;return!0}some(t,...e){h(this);const n=e[0];for(let e=0,r=this.length;e<r;++e)if(t.call(n,(0,a.convertToNumber)(this[e]),e,c(this).proxy))return!0;return!1}set(t,...e){h(this);const n=e[0];let r;if(u(t))r=c(t).target;else{const e=Reflect.has(t,"length")||void 0===t[Symbol.iterator]?t:[...t],n=e.length;r=new Uint16Array(n);for(let t=0,n=e.length;t<n;++t)r[t]=(0,a.roundToFloat16Bits)(e[t])}super.set(r,n)}reverse(){return h(this),super.reverse(),c(this).proxy}fill(t,...e){return h(this),super.fill((0,a.roundToFloat16Bits)(t),...e),c(this).proxy}copyWithin(t,e,...n){return h(this),super.copyWithin(t,e,...n),c(this).proxy}sort(...t){h(this);let e=t[0];void 0===e&&(e=r.defaultCompareFunction);const n=(0,s.default)(a.convertToNumber);return super.sort((t,r)=>e(n(t),n(r))),c(this).proxy}slice(...t){let e;h(this);try{e=super.slice(...t)}catch(n){if(!(n instanceof TypeError))throw n;e=new Uint16Array(this.buffer,this.byteOffset,this.length).slice(...t)}return new m(e.buffer)}subarray(...t){let e;h(this);try{e=super.subarray(...t)}catch(n){if(!(n instanceof TypeError))throw n;e=new Uint16Array(this.buffer,this.byteOffset,this.length).subarray(...t)}return new m(e.buffer,e.byteOffset,e.length)}indexOf(t,...e){h(this);const n=this.length;let i=(0,r.ToInteger)(e[0]);i<0&&(i+=n)<0&&(i=0);for(let e=i,r=n;e<r;++e)if((0,a.convertToNumber)(this[e])===t)return e;return-1}lastIndexOf(t,...e){h(this);const n=this.length;let i=(0,r.ToInteger)(e[0]);(i=0===i?n:i+1)>=0?i=i<n?i:n:i+=n;for(let e=i;e--;)if((0,a.convertToNumber)(this[e])===t)return e;return-1}includes(t,...e){h(this);const n=this.length;let i=(0,r.ToInteger)(e[0]);i<0&&(i+=n)<0&&(i=0);const o=Number.isNaN(t);for(let e=i,r=n;e<r;++e){const n=(0,a.convertToNumber)(this[e]);if(o&&Number.isNaN(n))return!0;if(n===t)return!0}return!1}join(...t){return h(this),f(this).join(...t)}toLocaleString(...t){return h(this),f(this).toLocaleString(...t)}get[Symbol.toStringTag](){if(u(this))return"Float16Array"}}n.default=m;const g=m.prototype,v=new WeakSet;for(const t of Reflect.ownKeys(g)){const e=g[t];"function"==typeof e&&v.add(e)}},{"./spec":"xQUP","./is":"XYHx","./private":"EEXG","lodash-es/memoize":"mNqw","./lib":"GG94","./bug":"cSEU"}],q489:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getFloat16=function(t,e,...n){if(!(0,r.isDataView)(t))throw new TypeError("First argument to getFloat16 function must be a DataView");return(0,i.convertToNumber)(t.getUint16(e,...n))},n.setFloat16=function(t,e,n,...o){if(!(0,r.isDataView)(t))throw new TypeError("First argument to setFloat16 function must be a DataView");t.setUint16(e,(0,i.roundToFloat16Bits)(n),...o)};var r=t("./is"),i=t("./lib")},{"./is":"XYHx","./lib":"GG94"}],Stm8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"hfround",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"Float16Array",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"getFloat16",{enumerable:!0,get:function(){return o.getFloat16}}),Object.defineProperty(n,"setFloat16",{enumerable:!0,get:function(){return o.setFloat16}});var r=s(t("./hfround")),i=s(t("./Float16Array")),o=t("./dataView.js");function s(t){return t&&t.__esModule?t:{default:t}}},{"./hfround":"G4sf","./Float16Array":"ZpG8","./dataView.js":"q489"}],rDCW:[function(t,e,n){},{}],FRpO:[function(t,e,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var s=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function c(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function u(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function h(t,e,n,r){var i,o,s;if(c(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),void 0===s)s=o[e]=n,++t._eventsCount;else if("function"==typeof s?s=o[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=u(t))>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,function(t){console&&console.warn&&console.warn(t)}(a)}return t}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=f.bind(r);return i.listener=n,r.wrapFn=i,i}function p(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):g(i,i.length)}function m(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");l=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=i[t];if(void 0===l)return!1;if("function"==typeof l)o(l,this,e);else{var c=l.length,u=g(l,c);for(n=0;n<c;++n)o(u[n],this,e)}return!0},a.prototype.addListener=function(t,e){return h(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return h(this,t,e,!0)},a.prototype.once=function(t,e){return c(e),this.on(t,d(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return c(e),this.prependListener(t,d(this,t,e)),this},a.prototype.removeListener=function(t,e){var n,r,i,o,s;if(c(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,s||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},a.prototype.listeners=function(t){return p(this,t,!0)},a.prototype.rawListeners=function(t){return p(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):m.call(t,e)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},{}],ExO1:[function(t,e,n){e.exports=t("events").EventEmitter},{events:"FRpO"}],yh9p:[function(t,e,n){"use strict";n.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},n.toByteArray=function(t){var e,n,r=c(t),s=r[0],a=r[1],l=new o(function(t,e,n){return 3*(e+n)/4-n}(0,s,a)),u=0,h=a>0?s-4:s;for(n=0;n<h;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],l[u++]=e>>16&255,l[u++]=e>>8&255,l[u++]=255&e;return 2===a&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,l[u++]=255&e),1===a&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,l[u++]=e>>8&255,l[u++]=255&e),l},n.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(h(t,s,s+16383>a?a:s+16383));return 1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=s.length;a<l;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function u(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function h(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),i.push(u(r));return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],JgNJ:[function(t,e,n){n.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,l=(1<<a)-1,c=l>>1,u=-7,h=n?i-1:0,f=n?-1:1,d=t[e+h];for(h+=f,o=d&(1<<-u)-1,d>>=-u,u+=a;u>0;o=256*o+t[e+h],h+=f,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=256*s+t[e+h],h+=f,u-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=c}return(d?-1:1)*s*Math.pow(2,o-r)},n.write=function(t,e,n,r,i,o){var s,a,l,c=8*o-i-1,u=(1<<c)-1,h=u>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+h>=1?f/l:f*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(e*l-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[n+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+d]=255&s,d+=p,s/=256,c-=8);t[n+d-p]|=128*m}},{}],REa7:[function(t,e,n){var r={}.toString;e.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},{}],dskh:[function(t,e,n){var r=arguments[3],i=t("base64-js"),o=t("ieee754"),s=t("isarray");function a(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}function l(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function c(t,e){if(l()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return p(this,t)}return h(this,t,e,n)}function h(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?v(t,e,n,r):"string"==typeof e?m(t,e,n):y(t,e)}function f(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function d(t,e,n,r){return f(e),e<=0?c(t,e):void 0!==n?"string"==typeof r?c(t,e).fill(n,r):c(t,e).fill(n):c(t,e)}function p(t,e){if(f(e),t=c(t,e<0?0:0|b(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function m(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|x(e,n),i=(t=c(t,r)).write(e,n);return i!==r&&(t=t.slice(0,i)),t}function g(t,e){var n=e.length<0?0:0|b(e.length);t=c(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function v(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=g(t,e),t}function y(t,e){if(u.isBuffer(e)){var n=0|b(e.length);return 0===(t=c(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||nt(e.length)?c(t,0):g(t,e);if("Buffer"===e.type&&s(e.data))return g(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function b(t){if(t>=l())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+l().toString(16)+" bytes");return 0|t}function _(t){return+t!=t&&(t=0),u.alloc(+t)}function x(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return K(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return tt(t).length;default:if(r)return K(t).length;e=(""+e).toLowerCase(),r=!0}}function w(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return F(this,e,n);case"utf8":case"utf-8":return k(this,e,n);case"ascii":return N(this,e,n);case"latin1":case"binary":return j(this,e,n);case"base64":return O(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function M(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function S(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:E(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):E(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function E(t,e,n,r,i){var o,s=1,a=t.length,l=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,l/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var u=-1;for(o=n;o<a;o++)if(c(t,o)===c(e,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*s}else-1!==u&&(o-=o-u),u=-1}else for(n+l>a&&(n=a-l),o=n;o>=0;o--){for(var h=!0,f=0;f<l;f++)if(c(t,o+f)!==c(e,f)){h=!1;break}if(h)return o}return-1}function T(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function C(t,e,n,r){return et(K(e,t.length-n),t,n,r)}function A(t,e,n,r){return et(Q(e),t,n,r)}function P(t,e,n,r){return A(t,e,n,r)}function L(t,e,n,r){return et(tt(e),t,n,r)}function R(t,e,n,r){return et($(e,t.length-n),t,n,r)}function O(t,e,n){return 0===e&&n===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,n))}function k(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,l,c=t[i],u=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(o=t[i+1]))&&(l=(31&c)<<6|63&o)>127&&(u=l);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(l=(15&c)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(l=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=h}return D(r)}n.Buffer=u,n.SlowBuffer=_,n.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==r.TYPED_ARRAY_SUPPORT?r.TYPED_ARRAY_SUPPORT:a(),n.kMaxLength=l(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return h(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return d(null,t,e,n)},u.allocUnsafe=function(t){return p(null,t)},u.allocUnsafeSlow=function(t){return p(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!s(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},u.byteLength=x,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)M(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)M(this,e,e+3),M(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)M(this,e,e+7),M(this,e+1,e+6),M(this,e+2,e+5),M(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?k(this,0,t):w.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(o,s),l=this.slice(r,i),c=t.slice(e,n),h=0;h<a;++h)if(l[h]!==c[h]){o=l[h],s=c[h];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return S(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return S(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return T(this,t,e,n);case"utf8":case"utf-8":return C(this,t,e,n);case"ascii":return A(this,t,e,n);case"latin1":case"binary":return P(this,t,e,n);case"base64":return L(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function D(t){var e=t.length;if(e<=I)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=I));return n}function N(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function j(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function F(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=J(t[o]);return i}function B(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function z(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function U(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function H(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function G(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function W(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function V(t,e,n,r,i){return i||W(t,0,n,4),o.write(t,e,n,r,23,4),n+4}function q(t,e,n,r,i){return i||W(t,0,n,8),o.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||z(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||z(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||z(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||z(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||z(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||z(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||z(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||z(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||z(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||z(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||z(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||z(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||z(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||z(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||z(t,4,this.length),o.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||z(t,4,this.length),o.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||z(t,8,this.length),o.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||z(t,8,this.length),o.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){t=+t,e|=0,n|=0,r||U(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){t=+t,e|=0,n|=0,r||U(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||U(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||U(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):H(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||U(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):H(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||U(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):G(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||U(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):G(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);U(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);U(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||U(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||U(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):H(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||U(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):H(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||U(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):G(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||U(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):G(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return V(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return V(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return q(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return q(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=u.isBuffer(t)?t:K(new u(t,r).toString()),a=s.length;for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var X=/[^+\/0-9A-Za-z-_]/g;function Y(t){if((t=Z(t).replace(X,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function Z(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function J(t){return t<16?"0"+t.toString(16):t.toString(16)}function K(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function Q(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function $(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,i=n%256,o.push(i),o.push(r);return o}function tt(t){return i.toByteArray(Y(t))}function et(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function nt(t){return t!=t}},{"base64-js":"yh9p",ieee754:"JgNJ",isarray:"REa7",buffer:"dskh"}],VCcH:[function(t,e,n){"use strict";function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=t("buffer").Buffer,a=t("util").inspect,l=a&&a.custom||"inspect";function c(t,e,n){s.prototype.copy.call(t,e,n)}e.exports=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.head=null,this.tail=null,this.length=0}return function(t,e,n){e&&o(t.prototype,e)}(t,[{key:"push",value:function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n}},{key:"concat",value:function(t){if(0===this.length)return s.alloc(0);for(var e=s.allocUnsafe(t>>>0),n=this.head,r=0;n;)c(n.data,e,r),r+=n.data.length,n=n.next;return e}},{key:"consume",value:function(t,e){var n;return t<this.head.data.length?(n=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):n=t===this.head.data.length?this.shift():e?this._getString(t):this._getBuffer(t),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var e=this.head,n=1,r=e.data;for(t-=r.length;e=e.next;){var i=e.data,o=t>i.length?i.length:t;if(o===i.length?r+=i:r+=i.slice(0,t),0==(t-=o)){o===i.length?(++n,e.next?this.head=e.next:this.head=this.tail=null):(this.head=e,e.data=i.slice(o));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(t){var e=s.allocUnsafe(t),n=this.head,r=1;for(n.data.copy(e),t-=n.data.length;n=n.next;){var i=n.data,o=t>i.length?i.length:t;if(i.copy(e,e.length-t,0,o),0==(t-=o)){o===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(o));break}++r}return this.length-=r,e}},{key:l,value:function(t,e){return a(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},e,{depth:0,customInspect:!1}))}}]),t}()},{buffer:"dskh",util:"rDCW"}],pBGv:[function(t,e,n){var r,i,o=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function l(t){if(r===setTimeout)return setTimeout(t,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(t){r=s}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}}();var c,u=[],h=!1,f=-1;function d(){h&&c&&(h=!1,c.length?u=c.concat(u):f=-1,u.length&&p())}function p(){if(!h){var t=l(d);h=!0;for(var e=u.length;e;){for(c=u,u=[];++f<e;)c&&c[f].run();f=-1,e=u.length}c=null,h=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function g(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new m(t,e)),1!==u.length||h||l(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],GRUB:[function(t,e,n){t("process");var r=t("process");function i(t,e){s(t,e),o(t)}function o(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function s(t,e){t.emit("error",e)}e.exports={destroy:function(t,e){var n=this,a=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return a||l?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,r.nextTick(s,this,t)):r.nextTick(s,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?n._writableState?n._writableState.errorEmitted?r.nextTick(o,n):(n._writableState.errorEmitted=!0,r.nextTick(i,n,t)):r.nextTick(i,n,t):e?(r.nextTick(o,n),e(t)):r.nextTick(o,n)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(t,e){var n=t._readableState,r=t._writableState;n&&n.autoDestroy||r&&r.autoDestroy?t.destroy(e):t.emit("error",e)}}},{process:"pBGv"}],Yj9o:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i={};function o(t,e,n){n||(n=Error);var r=function(t){function n(n,r,i){return t.call(this,function(t,n,r){return"string"==typeof e?e:e(t,n,r)}(n,r,i))||this}return function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}(n,t),n}(n);r.prototype.name=n.name,r.prototype.code=t,i[t]=r}function s(t,e){if(Array.isArray(t)){var n=t.length;return t=t.map((function(t){return String(t)})),n>2?"one of ".concat(e," ").concat(t.slice(0,n-1).join(", "),", or ")+t[n-1]:2===n?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}return"of ".concat(e," ").concat(String(t))}o("ERR_INVALID_OPT_VALUE",(function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'}),TypeError),o("ERR_INVALID_ARG_TYPE",(function(t,e,n){var i,o;if("string"==typeof e&&function(t,e,n){return t.substr(0,e.length)===e}(e,"not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be",function(t,e,n){return(void 0===n||n>t.length)&&(n=t.length),t.substring(n-e.length,n)===e}(t," argument"))o="The ".concat(t," ").concat(i," ").concat(s(e,"type"));else{var a=function(t,e,n){return"number"!=typeof n&&(n=0),!(n+".".length>t.length)&&-1!==t.indexOf(".",n)}(t)?"property":"argument";o='The "'.concat(t,'" ').concat(a," ").concat(i," ").concat(s(e,"type"))}return o+". Received type ".concat(r(n))}),TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",(function(t){return"The "+t+" method is not implemented"})),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",(function(t){return"Cannot call "+t+" after a stream was destroyed"})),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",(function(t){return"Unknown encoding: "+t}),TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=i},{}],TWVJ:[function(t,e,n){"use strict";var r=t("../../../errors").codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(t,e,n,i){var o=function(t,e,n){return null!=t.highWaterMark?t.highWaterMark:e?t[n]:null}(e,i,n);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new r(i?n:"highWaterMark",o);return Math.floor(o)}return t.objectMode?16:16384}}},{"../../../errors":"Yj9o"}],Bm0n:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},{}],yM1o:[function(t,e,n){var r=arguments[3];function i(t,e){if(o("noDeprecation"))return t;var n=!1;return function(){if(!n){if(o("throwDeprecation"))throw new Error(e);o("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}}function o(t){try{if(!r.localStorage)return!1}catch(t){return!1}var e=r.localStorage[t];return null!=e&&"true"===String(e).toLowerCase()}e.exports=i},{}],WSyY:[function(t,e,n){t("process");var r,i=arguments[3],o=t("process");function s(t){var e=this;this.next=null,this.entry=null,this.finish=function(){q(e,t)}}e.exports=P,P.WritableState=A;var a={deprecate:t("util-deprecate")},l=t("./internal/streams/stream"),c=t("buffer").Buffer,u=i.Uint8Array||function(){};function h(t){return c.from(t)}function f(t){return c.isBuffer(t)||t instanceof u}var d,p=t("./internal/streams/destroy"),m=t("./internal/streams/state"),g=m.getHighWaterMark,v=t("../errors").codes,y=v.ERR_INVALID_ARG_TYPE,b=v.ERR_METHOD_NOT_IMPLEMENTED,_=v.ERR_MULTIPLE_CALLBACK,x=v.ERR_STREAM_CANNOT_PIPE,w=v.ERR_STREAM_DESTROYED,M=v.ERR_STREAM_NULL_VALUES,S=v.ERR_STREAM_WRITE_AFTER_END,E=v.ERR_UNKNOWN_ENCODING,T=p.errorOrDestroy;function C(){}function A(e,n,i){r=r||t("./_stream_duplex"),e=e||{},"boolean"!=typeof i&&(i=n instanceof r),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=g(this,e,"writableHighWaterMark",i),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){j(n,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function P(e){var n=this instanceof(r=r||t("./_stream_duplex"));if(!n&&!d.call(P,this))return new P(e);this._writableState=new A(e,this,n),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),l.call(this)}function L(t,e){var n=new S;T(t,n),o.nextTick(e,n)}function R(t,e,n,r){var i;return null===n?i=new M:"string"==typeof n||e.objectMode||(i=new y("chunk",["string","Buffer"],n)),!i||(T(t,i),o.nextTick(r,i),!1)}function O(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=c.from(e,n)),e}function k(t,e,n,r,i,o){if(!n){var s=O(e,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var l=e.length<e.highWaterMark;if(l||(e.needDrain=!0),e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else I(t,e,!1,a,r,i,o);return l}function I(t,e,n,r,i,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new w("write")):n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function D(t,e,n,r,i){--e.pendingcb,n?(o.nextTick(i,r),o.nextTick(W,t,e),t._writableState.errorEmitted=!0,T(t,r)):(i(r),t._writableState.errorEmitted=!0,T(t,r),W(t,e))}function N(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function j(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if("function"!=typeof i)throw new _;if(N(n),e)D(t,n,r,e,i);else{var s=U(n)||t.destroyed;s||n.corked||n.bufferProcessing||!n.bufferedRequest||z(t,n),r?o.nextTick(F,t,n,s,i):F(t,n,s,i)}}function F(t,e,n,r){n||B(t,e),e.pendingcb--,r(),W(t,e)}function B(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function z(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),o=e.corkedRequestsFree;o.entry=n;for(var a=0,l=!0;n;)i[a]=n,n.isBuf||(l=!1),n=n.next,a+=1;i.allBuffers=l,I(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new s(e),e.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,u=n.encoding,h=n.callback;if(I(t,e,!1,e.objectMode?1:c.length,c,u,h),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function U(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function H(t,e){t._final((function(n){e.pendingcb--,n&&T(t,n),e.prefinished=!0,t.emit("prefinish"),W(t,e)}))}function G(t,e){e.prefinished||e.finalCalled||("function"!=typeof t._final||e.destroyed?(e.prefinished=!0,t.emit("prefinish")):(e.pendingcb++,e.finalCalled=!0,o.nextTick(H,t,e)))}function W(t,e){var n=U(e);if(n&&(G(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var r=t._readableState;(!r||r.autoDestroy&&r.endEmitted)&&t.destroy()}return n}function V(t,e,n){e.ending=!0,W(t,e),n&&(e.finished?o.nextTick(n):t.once("finish",n)),e.ended=!0,t.writable=!1}function q(t,e,n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree.next=t}t("inherits")(P,l),A.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(A.prototype,"buffer",{get:a.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(d=Function.prototype[Symbol.hasInstance],Object.defineProperty(P,Symbol.hasInstance,{value:function(t){return!!d.call(this,t)||this===P&&t&&t._writableState instanceof A}})):d=function(t){return t instanceof this},P.prototype.pipe=function(){T(this,new x)},P.prototype.write=function(t,e,n){var r=this._writableState,i=!1,o=!r.objectMode&&f(t);return o&&!c.isBuffer(t)&&(t=h(t)),"function"==typeof e&&(n=e,e=null),o?e="buffer":e||(e=r.defaultEncoding),"function"!=typeof n&&(n=C),r.ending?L(this,n):(o||R(this,r,t,n))&&(r.pendingcb++,i=k(this,r,o,t,e,n)),i},P.prototype.cork=function(){this._writableState.corked++},P.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.bufferProcessing||!t.bufferedRequest||z(this,t))},P.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new E(t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(P.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(P.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),P.prototype._write=function(t,e,n){n(new b("_write()"))},P.prototype._writev=null,P.prototype.end=function(t,e,n){var r=this._writableState;return"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||V(this,r,n),this},Object.defineProperty(P.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(P.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),P.prototype.destroy=p.destroy,P.prototype._undestroy=p.undestroy,P.prototype._destroy=function(t,e){e(t)}},{"util-deprecate":"yM1o","./internal/streams/stream":"ExO1",buffer:"dskh","./internal/streams/destroy":"GRUB","./internal/streams/state":"TWVJ","../errors":"Yj9o",inherits:"Bm0n","./_stream_duplex":"Hba0",process:"pBGv"}],Hba0:[function(t,e,n){t("process");var r=t("process"),i=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};e.exports=u;var o=t("./_stream_readable"),s=t("./_stream_writable");t("inherits")(u,o);for(var a=i(s.prototype),l=0;l<a.length;l++){var c=a[l];u.prototype[c]||(u.prototype[c]=s.prototype[c])}function u(t){if(!(this instanceof u))return new u(t);o.call(this,t),s.call(this,t),this.allowHalfOpen=!0,t&&(!1===t.readable&&(this.readable=!1),!1===t.writable&&(this.writable=!1),!1===t.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||r.nextTick(f,this)}function f(t){t.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}})},{"./_stream_readable":"DHrQ","./_stream_writable":"WSyY",inherits:"Bm0n",process:"pBGv"}],Wugr:[function(t,e,n){var r=t("buffer"),i=r.Buffer;function o(t,e){for(var n in t)e[n]=t[n]}function s(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,n),n.Buffer=s),s.prototype=Object.create(i.prototype),o(i,s),s.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},s.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},s.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},s.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},{buffer:"dskh"}],z0rv:[function(t,e,n){"use strict";var r=t("safe-buffer").Buffer,i=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=l,this.end=c,e=4;break;case"utf8":this.fillLast=a,e=4;break;case"base64":this.text=u,this.end=h,e=3;break;default:return this.write=f,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function a(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function l(t,e){if((t.length-e)%2==0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function c(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function u(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function h(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function f(t){return t.toString(this.encoding)}function d(t){return t&&t.length?this.write(t):""}n.StringDecoder=o,o.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},o.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var i=s(e[r]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--r<n||-2===i?0:(i=s(e[r]))>=0?(i>0&&(t.lastNeed=i-2),i):--r<n||-2===i?0:(i=s(e[r]))>=0?(i>0&&(2===i?i=0:t.lastNeed=i-3),i):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},{"safe-buffer":"Wugr"}],mrEY:[function(t,e,n){"use strict";var r=t("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function t(e,n,o){if("function"==typeof n)return t(e,null,n);n||(n={}),o=function(t){var e=!1;return function(){if(!e){e=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t.apply(this,r)}}}(o||i);var s=n.readable||!1!==n.readable&&e.readable,a=n.writable||!1!==n.writable&&e.writable,l=function(){e.writable||u()},c=e._writableState&&e._writableState.finished,u=function(){a=!1,c=!0,s||o.call(e)},h=e._readableState&&e._readableState.endEmitted,f=function(){s=!1,h=!0,a||o.call(e)},d=function(t){o.call(e,t)},p=function(){var t;return s&&!h?(e._readableState&&e._readableState.ended||(t=new r),o.call(e,t)):a&&!c?(e._writableState&&e._writableState.ended||(t=new r),o.call(e,t)):void 0},m=function(){e.req.on("finish",u)};return function(t){return t.setHeader&&"function"==typeof t.abort}(e)?(e.on("complete",u),e.on("abort",p),e.req?m():e.on("request",m)):a&&!e._writableState&&(e.on("end",l),e.on("close",l)),e.on("end",f),e.on("finish",u),!1!==n.error&&e.on("error",d),e.on("close",p),function(){e.removeListener("complete",u),e.removeListener("abort",p),e.removeListener("request",m),e.req&&e.req.removeListener("finish",u),e.removeListener("end",l),e.removeListener("close",l),e.removeListener("finish",u),e.removeListener("end",f),e.removeListener("error",d),e.removeListener("close",p)}}},{"../../../errors":"Yj9o"}],AOGM:[function(t,e,n){t("process");var r,i=t("process");function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=t("./end-of-stream"),a=Symbol("lastResolve"),l=Symbol("lastReject"),c=Symbol("error"),u=Symbol("ended"),h=Symbol("lastPromise"),f=Symbol("handlePromise"),d=Symbol("stream");function p(t,e){return{value:t,done:e}}function m(t){var e=t[a];if(null!==e){var n=t[d].read();null!==n&&(t[h]=null,t[a]=null,t[l]=null,e(p(n,!1)))}}function g(t){i.nextTick(m,t)}var v=Object.getPrototypeOf((function(){})),y=Object.setPrototypeOf((o(r={get stream(){return this[d]},next:function(){var t=this,e=this[c];if(null!==e)return Promise.reject(e);if(this[u])return Promise.resolve(p(void 0,!0));if(this[d].destroyed)return new Promise((function(e,n){i.nextTick((function(){t[c]?n(t[c]):e(p(void 0,!0))}))}));var n,r=this[h];if(r)n=new Promise(function(t,e){return function(n,r){t.then((function(){e[u]?n(p(void 0,!0)):e[f](n,r)}),r)}}(r,this));else{var o=this[d].read();if(null!==o)return Promise.resolve(p(o,!1));n=new Promise(this[f])}return this[h]=n,n}},Symbol.asyncIterator,(function(){return this})),o(r,"return",(function(){var t=this;return new Promise((function(e,n){t[d].destroy(null,(function(t){t?n(t):e(p(void 0,!0))}))}))})),r),v);e.exports=function(t){var e,n=Object.create(y,(o(e={},d,{value:t,writable:!0}),o(e,a,{value:null,writable:!0}),o(e,l,{value:null,writable:!0}),o(e,c,{value:null,writable:!0}),o(e,u,{value:t._readableState.endEmitted,writable:!0}),o(e,f,{value:function(t,e){var r=n[d].read();r?(n[h]=null,n[a]=null,n[l]=null,t(p(r,!1))):(n[a]=t,n[l]=e)},writable:!0}),e));return n[h]=null,s(t,(function(t){if(t&&"ERR_STREAM_PREMATURE_CLOSE"!==t.code){var e=n[l];return null!==e&&(n[h]=null,n[a]=null,n[l]=null,e(t)),void(n[c]=t)}var r=n[a];null!==r&&(n[h]=null,n[a]=null,n[l]=null,r(p(void 0,!0))),n[u]=!0})),t.on("readable",g.bind(null,n)),n}},{"./end-of-stream":"mrEY",process:"pBGv"}],Rr4m:[function(t,e,n){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],DHrQ:[function(t,e,n){t("process");var r,i=arguments[3],o=t("process");e.exports=L,L.ReadableState=P,t("events").EventEmitter;var s=function(t,e){return t.listeners(e).length},a=t("./internal/streams/stream"),l=t("buffer").Buffer,c=i.Uint8Array||function(){};function u(t){return l.from(t)}function h(t){return l.isBuffer(t)||t instanceof c}var f,d=t("util");f=d&&d.debuglog?d.debuglog("stream"):function(){};var p,m,g,v=t("./internal/streams/buffer_list"),y=t("./internal/streams/destroy"),b=t("./internal/streams/state"),_=b.getHighWaterMark,x=t("../errors").codes,w=x.ERR_INVALID_ARG_TYPE,M=x.ERR_STREAM_PUSH_AFTER_EOF,S=x.ERR_METHOD_NOT_IMPLEMENTED,E=x.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;t("inherits")(L,a);var T=y.errorOrDestroy,C=["error","close","destroy","pause","resume"];function A(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?Array.isArray(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}function P(e,n,i){r=r||t("./_stream_duplex"),e=e||{},"boolean"!=typeof i&&(i=n instanceof r),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=_(this,e,"readableHighWaterMark",i),this.buffer=new v,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(p||(p=t("string_decoder/").StringDecoder),this.decoder=new p(e.encoding),this.encoding=e.encoding)}function L(e){if(r=r||t("./_stream_duplex"),!(this instanceof L))return new L(e);var n=this instanceof r;this._readableState=new P(e,this,n),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),a.call(this)}function R(t,e,n,r,i){f("readableAddChunk",e);var o,s=t._readableState;if(null===e)s.reading=!1,j(t,s);else if(i||(o=k(s,e)),o)T(t,o);else if(s.objectMode||e&&e.length>0)if("string"==typeof e||s.objectMode||Object.getPrototypeOf(e)===l.prototype||(e=u(e)),r)s.endEmitted?T(t,new E):O(t,s,e,!0);else if(s.ended)T(t,new M);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!n?(e=s.decoder.write(e),s.objectMode||0!==e.length?O(t,s,e,!1):z(t,s)):O(t,s,e,!1)}else r||(s.reading=!1,z(t,s));return!s.ended&&(s.length<s.highWaterMark||0===s.length)}function O(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(e.awaitDrain=0,t.emit("data",n)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&F(t)),z(t,e)}function k(t,e){var n;return h(e)||"string"==typeof e||void 0===e||t.objectMode||(n=new w("chunk",["string","Buffer","Uint8Array"],e)),n}Object.defineProperty(L.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),L.prototype.destroy=y.destroy,L.prototype._undestroy=y.undestroy,L.prototype._destroy=function(t,e){e(t)},L.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=l.from(t,e),e=""),n=!0),R(this,t,e,!1,n)},L.prototype.unshift=function(t){return R(this,t,null,!0,!1)},L.prototype.isPaused=function(){return!1===this._readableState.flowing},L.prototype.setEncoding=function(e){p||(p=t("string_decoder/").StringDecoder);var n=new p(e);this._readableState.decoder=n,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=n.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var I=1073741824;function D(t){return t>=I?t=I:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function N(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=D(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function j(t,e){if(f("onEofChunk"),!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,e.sync?F(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,B(t)))}}function F(t){var e=t._readableState;f("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(f("emitReadable",e.flowing),e.emittedReadable=!0,o.nextTick(B,t))}function B(t){var e=t._readableState;f("emitReadable_",e.destroyed,e.length,e.ended),e.destroyed||!e.length&&!e.ended||(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,X(t)}function z(t,e){e.readingMore||(e.readingMore=!0,o.nextTick(U,t,e))}function U(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&0===e.length);){var n=e.length;if(f("maybeReadMore read 0"),t.read(0),n===e.length)break}e.readingMore=!1}function H(t){return function(){var e=t._readableState;f("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&s(t,"data")&&(e.flowing=!0,X(t))}}function G(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function W(t){f("readable nexttick read 0"),t.read(0)}function V(t,e){e.resumeScheduled||(e.resumeScheduled=!0,o.nextTick(q,t,e))}function q(t,e){f("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),X(t),e.flowing&&!e.reading&&t.read(0)}function X(t){var e=t._readableState;for(f("flow",e.flowing);e.flowing&&null!==t.read(););}function Y(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):n=e.buffer.consume(t,e.decoder),n);var n}function Z(t){var e=t._readableState;f("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,o.nextTick(J,e,t))}function J(t,e){if(f("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&0===t.length&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var n=e._writableState;(!n||n.autoDestroy&&n.finished)&&e.destroy()}}function K(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}L.prototype.read=function(t){f("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&((0!==e.highWaterMark?e.length>=e.highWaterMark:e.length>0)||e.ended))return f("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?Z(this):F(this),null;if(0===(t=N(t,e))&&e.ended)return 0===e.length&&Z(this),null;var r,i=e.needReadable;return f("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&f("length less than watermark",i=!0),e.ended||e.reading?f("reading or ended",i=!1):i&&(f("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=N(n,e))),null===(r=t>0?Y(t,e):null)?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&Z(this)),null!==r&&this.emit("data",r),r},L.prototype._read=function(t){T(this,new S("_read()"))},L.prototype.pipe=function(t,e){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=t;break;case 1:r.pipes=[r.pipes,t];break;default:r.pipes.push(t)}r.pipesCount+=1,f("pipe count=%d opts=%j",r.pipesCount,e);var i=e&&!1===e.end||t===o.stdout||t===o.stderr?m:a;function a(){f("onend"),t.end()}r.endEmitted?o.nextTick(i):n.once("end",i),t.on("unpipe",(function e(i,o){f("onunpipe"),i===n&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,f("cleanup"),t.removeListener("close",d),t.removeListener("finish",p),t.removeListener("drain",l),t.removeListener("error",h),t.removeListener("unpipe",e),n.removeListener("end",a),n.removeListener("end",m),n.removeListener("data",u),c=!0,!r.awaitDrain||t._writableState&&!t._writableState.needDrain||l())}));var l=H(n);t.on("drain",l);var c=!1;function u(e){f("ondata");var i=t.write(e);f("dest.write",i),!1===i&&((1===r.pipesCount&&r.pipes===t||r.pipesCount>1&&-1!==K(r.pipes,t))&&!c&&(f("false write response, pause",r.awaitDrain),r.awaitDrain++),n.pause())}function h(e){f("onerror",e),m(),t.removeListener("error",h),0===s(t,"error")&&T(t,e)}function d(){t.removeListener("finish",p),m()}function p(){f("onfinish"),t.removeListener("close",d),m()}function m(){f("unpipe"),n.unpipe(t)}return n.on("data",u),A(t,"error",h),t.once("close",d),t.once("finish",p),t.emit("pipe",n),r.flowing||(f("pipe resume"),n.resume()),t},L.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=K(e.pipes,t);return-1===s||(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},L.prototype.on=function(t,e){var n=a.prototype.on.call(this,t,e),r=this._readableState;return"data"===t?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===t&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,f("on readable",r.length,r.reading),r.length?F(this):r.reading||o.nextTick(W,this))),n},L.prototype.addListener=L.prototype.on,L.prototype.removeListener=function(t,e){var n=a.prototype.removeListener.call(this,t,e);return"readable"===t&&o.nextTick(G,this),n},L.prototype.removeAllListeners=function(t){var e=a.prototype.removeAllListeners.apply(this,arguments);return"readable"!==t&&void 0!==t||o.nextTick(G,this),e},L.prototype.resume=function(){var t=this._readableState;return t.flowing||(f("resume"),t.flowing=!t.readableListening,V(this,t)),t.paused=!1,this},L.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},L.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",(function(){if(f("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(i){f("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i||(n.objectMode||i&&i.length)&&(e.push(i)||(r=!0,t.pause()))})),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<C.length;o++)t.on(C[o],this.emit.bind(this,C[o]));return this._read=function(e){f("wrapped _read",e),r&&(r=!1,t.resume())},this},"function"==typeof Symbol&&(L.prototype[Symbol.asyncIterator]=function(){return void 0===m&&(m=t("./internal/streams/async_iterator")),m(this)}),Object.defineProperty(L.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(L.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(L.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}}),L._fromList=Y,Object.defineProperty(L.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(L.from=function(e,n){return void 0===g&&(g=t("./internal/streams/from")),g(L,e,n)})},{events:"FRpO","./internal/streams/stream":"ExO1",buffer:"dskh",util:"rDCW","./internal/streams/buffer_list":"VCcH","./internal/streams/destroy":"GRUB","./internal/streams/state":"TWVJ","../errors":"Yj9o",inherits:"Bm0n","./_stream_duplex":"Hba0","string_decoder/":"z0rv","./internal/streams/async_iterator":"AOGM","./internal/streams/from":"Rr4m",process:"pBGv"}],tlBz:[function(t,e,n){"use strict";e.exports=u;var r=t("../errors").codes,i=r.ERR_METHOD_NOT_IMPLEMENTED,o=r.ERR_MULTIPLE_CALLBACK,s=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=r.ERR_TRANSFORM_WITH_LENGTH_0,l=t("./_stream_duplex");function c(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new o);n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function u(t){if(!(this instanceof u))return new u(t);l.call(this,t),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",h)}function h(){var t=this;"function"!=typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(e,n){f(t,e,n)}))}function f(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new a;if(t._transformState.transforming)throw new s;return t.push(null)}t("inherits")(u,l),u.prototype.push=function(t,e){return this._transformState.needTransform=!1,l.prototype.push.call(this,t,e)},u.prototype._transform=function(t,e,n){n(new i("_transform()"))},u.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},u.prototype._read=function(t){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},u.prototype._destroy=function(t,e){l.prototype._destroy.call(this,t,(function(t){e(t)}))}},{"../errors":"Yj9o","./_stream_duplex":"Hba0",inherits:"Bm0n"}],nwyA:[function(t,e,n){"use strict";e.exports=i;var r=t("./_stream_transform");function i(t){if(!(this instanceof i))return new i(t);r.call(this,t)}t("inherits")(i,r),i.prototype._transform=function(t,e,n){n(null,t)}},{"./_stream_transform":"tlBz",inherits:"Bm0n"}],AJFC:[function(t,e,n){"use strict";var r,i=t("../../../errors").codes,o=i.ERR_MISSING_ARGS,s=i.ERR_STREAM_DESTROYED;function a(t){if(t)throw t}function l(e,n,i,o){o=function(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}(o);var a=!1;e.on("close",(function(){a=!0})),void 0===r&&(r=t("./end-of-stream")),r(e,{readable:n,writable:i},(function(t){if(t)return o(t);a=!0,o()}));var l=!1;return function(t){if(!a&&!l)return l=!0,function(t){return t.setHeader&&"function"==typeof t.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void o(t||new s("pipe"))}}function c(t){t()}function u(t,e){return t.pipe(e)}function h(t){return t.length?"function"!=typeof t[t.length-1]?a:t.pop():a}e.exports=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,i=h(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new o("streams");var s=e.map((function(t,n){var o=n<e.length-1;return l(t,o,n>0,(function(t){r||(r=t),t&&s.forEach(c),o||(s.forEach(c),i(r))}))}));return e.reduce(u)}},{"../../../errors":"Yj9o","./end-of-stream":"mrEY"}],tzeh:[function(t,e,n){(n=e.exports=t("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=t("./lib/_stream_writable.js"),n.Duplex=t("./lib/_stream_duplex.js"),n.Transform=t("./lib/_stream_transform.js"),n.PassThrough=t("./lib/_stream_passthrough.js"),n.finished=t("./lib/internal/streams/end-of-stream.js"),n.pipeline=t("./lib/internal/streams/pipeline.js")},{"./lib/_stream_readable.js":"DHrQ","./lib/_stream_writable.js":"WSyY","./lib/_stream_duplex.js":"Hba0","./lib/_stream_transform.js":"tlBz","./lib/_stream_passthrough.js":"nwyA","./lib/internal/streams/end-of-stream.js":"mrEY","./lib/internal/streams/pipeline.js":"AJFC"}],vexR:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],tcrG:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],gfUn:[function(t,e,n){t("process");var r=t("process"),i=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},o=/%[sdj%]/g;n.format=function(t){if(!b(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(l(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,s=String(t).replace(o,(function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}})),a=r[n];n<i;a=r[++n])v(a)||!w(a)?s+=" "+a:s+=" "+l(a);return s},n.deprecate=function(t,e){if(void 0!==r&&!0===r.noDeprecation)return t;if(void 0===r)return function(){return n.deprecate(t,e).apply(this,arguments)};var i=!1;return function(){if(!i){if(r.throwDeprecation)throw new Error(e);r.traceDeprecation?console.trace(e):console.error(e),i=!0}return t.apply(this,arguments)}};var s,a={};function l(t,e){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(e)?r.showHidden=e:e&&n._extend(r,e),_(r.showHidden)&&(r.showHidden=!1),_(r.depth)&&(r.depth=2),_(r.colors)&&(r.colors=!1),_(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),h(r,t,r.depth)}function c(t,e){var n=l.styles[e];return n?"["+l.colors[n][0]+"m"+t+"["+l.colors[n][1]+"m":t}function u(t,e){return t}function h(t,e,r){if(t.customInspect&&e&&E(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(r,t);return b(i)||(i=h(t,i,r)),i}var o=f(t,e);if(o)return o;var s=Object.keys(e),a=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),S(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return d(e);if(0===s.length){if(E(e)){var l=e.name?": "+e.name:"";return t.stylize("[Function"+l+"]","special")}if(x(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(M(e))return t.stylize(Date.prototype.toString.call(e),"date");if(S(e))return d(e)}var c,u="",g=!1,v=["{","}"];return m(e)&&(g=!0,v=["[","]"]),E(e)&&(u=" [Function"+(e.name?": "+e.name:"")+"]"),x(e)&&(u=" "+RegExp.prototype.toString.call(e)),M(e)&&(u=" "+Date.prototype.toUTCString.call(e)),S(e)&&(u=" "+d(e)),0!==s.length||g&&0!=e.length?r<0?x(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),c=g?function(t,e,n,r,i){for(var o=[],s=0,a=e.length;s<a;++s)L(e,String(s))?o.push(p(t,e,n,r,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(p(t,e,n,r,i,!0))})),o}(t,e,r,a,s):s.map((function(n){return p(t,e,r,a,n,g)})),t.seen.pop(),function(t,e,n){return t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(c,u,v)):v[0]+u+v[1]}function f(t,e){if(_(e))return t.stylize("undefined","undefined");if(b(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return y(e)?t.stylize(""+e,"number"):g(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}function d(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,n,r,i,o){var s,a,l;if((l=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?a=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(a=t.stylize("[Setter]","special")),L(r,i)||(s="["+i+"]"),a||(t.seen.indexOf(l.value)<0?(a=v(n)?h(t,l.value,null):h(t,l.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+a.split("\n").map((function(t){return"   "+t})).join("\n")):a=t.stylize("[Circular]","special")),_(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function m(t){return Array.isArray(t)}function g(t){return"boolean"==typeof t}function v(t){return null===t}function y(t){return"number"==typeof t}function b(t){return"string"==typeof t}function _(t){return void 0===t}function x(t){return w(t)&&"[object RegExp]"===T(t)}function w(t){return"object"==typeof t&&null!==t}function M(t){return w(t)&&"[object Date]"===T(t)}function S(t){return w(t)&&("[object Error]"===T(t)||t instanceof Error)}function E(t){return"function"==typeof t}function T(t){return Object.prototype.toString.call(t)}function C(t){return t<10?"0"+t.toString(10):t.toString(10)}n.debuglog=function(t){if(_(s)&&(s=""),t=t.toUpperCase(),!a[t])if(new RegExp("\\b"+t+"\\b","i").test(s)){var e=r.pid;a[t]=function(){var r=n.format.apply(n,arguments);console.error("%s %d: %s",t,e,r)}}else a[t]=function(){};return a[t]},n.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=m,n.isBoolean=g,n.isNull=v,n.isNullOrUndefined=function(t){return null==t},n.isNumber=y,n.isString=b,n.isSymbol=function(t){return"symbol"==typeof t},n.isUndefined=_,n.isRegExp=x,n.isObject=w,n.isDate=M,n.isError=S,n.isFunction=E,n.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},n.isBuffer=t("./support/isBuffer");var A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function P(){var t=new Date,e=[C(t.getHours()),C(t.getMinutes()),C(t.getSeconds())].join(":");return[t.getDate(),A[t.getMonth()],e].join(" ")}function L(t,e){return Object.prototype.hasOwnProperty.call(t,e)}n.log=function(){console.log("%s - %s",P(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!w(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t};var R="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function O(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}n.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(R&&t[R]){var e;if("function"!=typeof(e=t[R]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,R,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise((function(t,r){e=t,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(t,r){t?n(t):e(r)}));try{t.apply(this,i)}catch(t){n(t)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),R&&Object.defineProperty(e,R,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,i(t))},n.promisify.custom=R,n.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function e(){for(var e=[],n=0;n<arguments.length;n++)e.push(arguments[n]);var i=e.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,s=function(){return i.apply(o,arguments)};t.apply(this,e).then((function(t){r.nextTick(s,null,t)}),(function(t){r.nextTick(O,t,s)}))}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),Object.defineProperties(e,i(t)),e}},{"./support/isBuffer":"vexR",inherits:"tcrG",process:"pBGv"}],m2P9:[function(t,e,n){t("process");var r=t("process"),i=t("readable-stream").Transform,o=t("util").inherits;function s(t){i.call(this,t),this._destroyed=!1}function a(t,e,n){n(null,t)}function l(t){return function(e,n,r){return"function"==typeof e&&(r=n,n=e,e={}),"function"!=typeof n&&(n=a),"function"!=typeof r&&(r=null),t(e,n,r)}}o(s,i),s.prototype.destroy=function(t){if(!this._destroyed){this._destroyed=!0;var e=this;r.nextTick((function(){t&&e.emit("error",t),e.emit("close")}))}},e.exports=l((function(t,e,n){var r=new s(t);return r._transform=e,n&&(r._flush=n),r})),e.exports.ctor=l((function(t,e,n){function r(e){if(!(this instanceof r))return new r(e);this.options=Object.assign({},t,e),s.call(this,this.options)}return o(r,s),r.prototype._transform=e,n&&(r.prototype._flush=n),r})),e.exports.obj=l((function(t,e,n){var r=new s(Object.assign({objectMode:!0,highWaterMark:16},t));return r._transform=e,n&&(r._flush=n),r}))},{"readable-stream":"tzeh",util:"gfUn",process:"pBGv"}],JO74:[function(t,e,n){function r(t,e){"use strict";var n=(e=e||{}).pos||0,i="<".charCodeAt(0),o=">".charCodeAt(0),s="-".charCodeAt(0),a="/".charCodeAt(0),l="!".charCodeAt(0),c="'".charCodeAt(0),u='"'.charCodeAt(0);function h(){for(var e=[];t[n];)if(t.charCodeAt(n)==i){if(t.charCodeAt(n+1)===a)return(n=t.indexOf(">",n))+1&&(n+=1),e;if(t.charCodeAt(n+1)===l){if(t.charCodeAt(n+2)==s){for(;-1!==n&&(t.charCodeAt(n)!==o||t.charCodeAt(n-1)!=s||t.charCodeAt(n-2)!=s||-1==n);)n=t.indexOf(">",n+1);-1===n&&(n=t.length)}else for(n+=2;t.charCodeAt(n)!==o&&t[n];)n++;n++;continue}var r=m();e.push(r)}else{var c=f();c.trim().length>0&&e.push(c),n++}return e}function f(){var e=n;return-2==(n=t.indexOf("<",n)-1)&&(n=t.length),t.slice(e,n+1)}function d(){for(var e=n;-1==="\n\t>/= ".indexOf(t[n])&&t[n];)n++;return t.slice(e,n)}var p=e.noChildNodes||["img","br","input","meta","link"];function m(){n++;const e=d(),r={};let i=[];for(;t.charCodeAt(n)!==o&&t[n];){var s=t.charCodeAt(n);if(s>64&&s<91||s>96&&s<123){for(var l=d(),f=t.charCodeAt(n);f&&f!==c&&f!==u&&!(f>64&&f<91||f>96&&f<123)&&f!==o;)n++,f=t.charCodeAt(n);if(f===c||f===u){var m=g();if(-1===n)return{tagName:e,attributes:r,children:i}}else m=null,n--;r[l]=m}n++}if(t.charCodeAt(n-1)!==a)if("script"==e){var v=n+1;n=t.indexOf("<\/script>",n),i=[t.slice(v,n-1)],n+=9}else"style"==e?(v=n+1,n=t.indexOf("</style>",n),i=[t.slice(v,n-1)],n+=8):-1==p.indexOf(e)&&(n++,i=h());else n++;return{tagName:e,attributes:r,children:i}}function g(){var e=t[n],r=++n;return n=t.indexOf(e,r),t.slice(r,n)}var v,y=null;if(void 0!==e.attrValue)for(e.attrName=e.attrName||"id",y=[];-1!==(v=new RegExp("\\s"+e.attrName+"\\s*=['\"]"+e.attrValue+"['\"]").exec(t),n=v?v.index:-1);)-1!==(n=t.lastIndexOf("<",n))&&y.push(m()),t=t.substr(n),n=0;else y=e.parseNode?m():h();return e.filter&&(y=r.filter(y,e.filter)),e.setPos&&(y.pos=n),y}r.simplify=function(t){var e={};if(!t.length)return"";if(1===t.length&&"string"==typeof t[0])return t[0];for(var n in t.forEach((function(t){if("object"==typeof t){e[t.tagName]||(e[t.tagName]=[]);var n=r.simplify(t.children||[]);e[t.tagName].push(n),t.attributes&&(n._attributes=t.attributes)}})),e)1==e[n].length&&(e[n]=e[n][0]);return e},r.filter=function(t,e){var n=[];return t.forEach((function(t){if("object"==typeof t&&e(t)&&n.push(t),t.children){var i=r.filter(t.children,e);n=n.concat(i)}})),n},r.stringify=function(t){var e="";function n(t){if(t)for(var n=0;n<t.length;n++)"string"==typeof t[n]?e+=t[n].trim():r(t[n])}function r(t){for(var r in e+="<"+t.tagName,t.attributes)null===t.attributes[r]?e+=" "+r:-1===t.attributes[r].indexOf('"')?e+=" "+r+'="'+t.attributes[r].trim()+'"':e+=" "+r+"='"+t.attributes[r].trim()+"'";e+=">",n(t.children),e+="</"+t.tagName+">"}return n(t),e},r.toContentString=function(t){if(Array.isArray(t)){var e="";return t.forEach((function(t){e=(e+=" "+r.toContentString(t)).trim()})),e}return"object"==typeof t?r.toContentString(t.children):" "+t},r.getElementById=function(t,e,n){var i=r(t,{attrValue:e});return n?r.simplify(i):i[0]},r.getElementsByClassName=function(t,e,n){const i=r(t,{attrName:"class",attrValue:"[a-zA-Z0-9-s ]*"+e+"[a-zA-Z0-9-s ]*"});return n?r.simplify(i):i},r.parseStream=function(e,n){if("string"==typeof n&&(n=n.length+2),"string"==typeof e){var i=t("fs");e=i.createReadStream(e,{start:n}),n=0}var o=n,s="";return e.on("data",(function(t){s+=t;for(var n=0;;){if(!(o=s.indexOf("<",o)+1))return void(o=n);if("/"!==s[o+1]){var i=r(s,{pos:o-1,parseNode:!0,setPos:!0});if((o=i.pos)>s.length-1||o<n)return s=s.slice(n),o=0,void(n=0);e.emit("xml",i),n=o}else o+=1,n=pos}})),e.on("end",(function(){console.log("end")})),e},r.transformStream=function(e){const n=t("through2");"string"==typeof e&&(e=e.length+2);var i=e||0,o="";return n({readableObjectMode:!0},(function(t,e,n){o+=t;for(var s=0;;){if(!(i=o.indexOf("<",i)+1))return i=s,n();if("/"!==o[i+1]){var a=r(o,{pos:i-1,parseNode:!0,setPos:!0});if((i=a.pos)>o.length-1||i<s)return o=o.slice(s),i=0,s=0,n();this.push(a),s=i}else i+=1,s=pos}n()}))},"object"==typeof e&&(e.exports=r,r.xml=r)},{fs:"rDCW",through2:"m2P9"}],j27V:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.geoKeys=n.geoKeyNames=n.ExtraSamplesValues=n.photometricInterpretations=n.fieldTypes=n.fieldTypeNames=n.arrayFields=n.fieldTagTypes=n.fieldTags=n.fieldTagNames=void 0;var r={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams"};n.fieldTagNames=r;var i={};for(var o in n.fieldTags=i,r)r.hasOwnProperty(o)&&(i[r[o]]=parseInt(o,10));n.fieldTagTypes={256:"SHORT",257:"SHORT",258:"SHORT",259:"SHORT",262:"SHORT",273:"LONG",274:"SHORT",277:"SHORT",278:"LONG",279:"LONG",282:"RATIONAL",283:"RATIONAL",284:"SHORT",286:"SHORT",287:"RATIONAL",296:"SHORT",305:"ASCII",306:"ASCII",338:"SHORT",339:"SHORT",513:"LONG",514:"LONG",1024:"SHORT",1025:"SHORT",2048:"SHORT",2049:"ASCII",33550:"DOUBLE",33922:"DOUBLE",34665:"LONG",34735:"SHORT",34737:"ASCII",42113:"ASCII"};var s=[i.BitsPerSample,i.ExtraSamples,i.SampleFormat,i.StripByteCounts,i.StripOffsets,i.StripRowCounts,i.TileByteCounts,i.TileOffsets,i.SubIFDs];n.arrayFields=s;var a={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"};n.fieldTypeNames=a;var l={};for(var c in n.fieldTypes=l,a)a.hasOwnProperty(c)&&(l[a[c]]=parseInt(c,10));n.photometricInterpretations={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},n.ExtraSamplesValues={Unspecified:0,Assocalpha:1,Unassalpha:2};var u={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"};n.geoKeyNames=u;var h={};for(var f in n.geoKeys=h,u)u.hasOwnProperty(f)&&(h[u[f]]=parseInt(f,10))},{}],fpBl:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fromWhiteIsZero=function(t,e){for(var n,r=t.width,i=t.height,o=new Uint8Array(r*i*3),s=0,a=0;s<t.length;++s,a+=3)n=256-t[s]/e*256,o[a]=n,o[a+1]=n,o[a+2]=n;return o},n.fromBlackIsZero=function(t,e){for(var n,r=t.width,i=t.height,o=new Uint8Array(r*i*3),s=0,a=0;s<t.length;++s,a+=3)n=t[s]/e*256,o[a]=n,o[a+1]=n,o[a+2]=n;return o},n.fromPalette=function(t,e){for(var n=t.width,r=t.height,i=new Uint8Array(n*r*3),o=e.length/3,s=e.length/3*2,a=0,l=0;a<t.length;++a,l+=3){var c=t[a];i[l]=e[c]/65536*256,i[l+1]=e[c+o]/65536*256,i[l+2]=e[c+s]/65536*256}return i},n.fromCMYK=function(t){for(var e=t.width,n=t.height,r=new Uint8Array(e*n*3),i=0,o=0;i<t.length;i+=4,o+=3){var s=t[i],a=t[i+1],l=t[i+2],c=t[i+3];r[o]=(255-s)/256*255*((255-c)/256),r[o+1]=(255-a)/256*255*((255-c)/256),r[o+2]=(255-l)/256*255*((255-c)/256)}return r},n.fromYCbCr=function(t){for(var e=t.width,n=t.height,r=new Uint8ClampedArray(e*n*3),i=0,o=0;i<t.length;i+=3,o+=3){var s=t[i],a=t[i+1],l=t[i+2];r[o]=s+1.402*(l-128),r[o+1]=s-.34414*(a-128)-.71414*(l-128),r[o+2]=s+1.772*(a-128)}return r},n.fromCIELab=function(t){for(var e=t.width,n=t.height,r=new Uint8Array(e*n*3),i=0,o=0;i<t.length;i+=3,o+=3){var s=(t[i+0]+16)/116,a=(t[i+1]<<24>>24)/500+s,l=s-(t[i+2]<<24>>24)/200,c=void 0,u=void 0,h=void 0;u=-.9689*(a=.95047*(a*a*a>.008856?a*a*a:(a-16/116)/7.787))+1.8758*(s=1*(s*s*s>.008856?s*s*s:(s-16/116)/7.787))+.0415*(l=1.08883*(l*l*l>.008856?l*l*l:(l-16/116)/7.787)),h=.0557*a+-.204*s+1.057*l,c=(c=3.2406*a+-1.5372*s+-.4986*l)>.0031308?1.055*Math.pow(c,1/2.4)-.055:12.92*c,u=u>.0031308?1.055*Math.pow(u,1/2.4)-.055:12.92*u,h=h>.0031308?1.055*Math.pow(h,1/2.4)-.055:12.92*h,r[o]=255*Math.max(0,Math.min(1,c)),r[o+1]=255*Math.max(0,Math.min(1,u)),r[o+2]=255*Math.max(0,Math.min(1,h))}return r}},{}],IKSA:[function(t,e,n){"use strict";function r(t,e){var n=t.length-e,r=0;do{for(var i=e;i>0;i--)t[r+e]+=t[r],r++;n-=e}while(n>0)}function i(t,e,n){for(var r=0,i=t.length,o=i/n;i>e;){for(var s=e;s>0;--s)t[r+e]+=t[r],++r;i-=e}for(var a=t.slice(),l=0;l<o;++l)for(var c=0;c<n;++c)t[n*l+c]=a[(n-c-1)*o+l]}Object.defineProperty(n,"__esModule",{value:!0}),n.applyPredictor=function(t,e,n,o,s,a){if(!e||1===e)return t;for(var l=0;l<s.length;++l){if(s[l]%8!=0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(s[l]!==s[0])throw new Error("When decoding with predictor, all samples must have the same size.")}for(var c=s[0]/8,u=2===a?1:s.length,h=0;h<o&&!(h*u*n*c>=t.byteLength);++h){var f=void 0;if(2===e){switch(s[0]){case 8:f=new Uint8Array(t,h*u*n*c,u*n*c);break;case 16:f=new Uint16Array(t,h*u*n*c,u*n*c/2);break;case 32:f=new Uint32Array(t,h*u*n*c,u*n*c/4);break;default:throw new Error("Predictor 2 not allowed with ".concat(s[0]," bits per sample."))}r(f,u)}else 3===e&&i(f=new Uint8Array(t,h*u*n*c,u*n*c),u,c)}return t}},{}],FJDe:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(t("@babel/runtime/regenerator")),i=l(t("@babel/runtime/helpers/asyncToGenerator")),o=l(t("@babel/runtime/helpers/classCallCheck")),s=l(t("@babel/runtime/helpers/createClass")),a=t("../predictor");function l(t){return t&&t.__esModule?t:{default:t}}var c=function(){function t(){(0,o.default)(this,t)}return(0,s.default)(t,[{key:"decode",value:function(){var t=(0,i.default)(r.default.mark((function t(e,n){var i,o,s,l,c;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.decodeBlock(n);case 2:if(i=t.sent,1===(o=e.Predictor||1)){t.next=9;break}return s=!e.StripOffsets,l=s?e.TileWidth:e.ImageWidth,c=s?e.TileLength:e.RowsPerStrip||e.ImageLength,t.abrupt("return",(0,a.applyPredictor)(i,o,l,c,e.BitsPerSample,e.PlanarConfiguration));case 9:return t.abrupt("return",i);case 10:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()}]),t}();n.default=c},{"@babel/runtime/regenerator":"PMvg","@babel/runtime/helpers/asyncToGenerator":"agGE","@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW","../predictor":"IKSA"}],V9bQ:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(t("@babel/runtime/helpers/classCallCheck")),i=l(t("@babel/runtime/helpers/createClass")),o=l(t("@babel/runtime/helpers/inherits")),s=l(t("@babel/runtime/helpers/possibleConstructorReturn")),a=l(t("@babel/runtime/helpers/getPrototypeOf"));function l(t){return t&&t.__esModule?t:{default:t}}var c=function(t){(0,o.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,a.default)(t);if(e){var i=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(n);function n(){return(0,r.default)(this,n),e.apply(this,arguments)}return(0,i.default)(n,[{key:"decodeBlock",value:function(t){return t}}]),n}(l(t("./basedecoder")).default);n.default=c},{"@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW","@babel/runtime/helpers/inherits":"d4H2","@babel/runtime/helpers/possibleConstructorReturn":"pxk2","@babel/runtime/helpers/getPrototypeOf":"UJE0","./basedecoder":"FJDe"}],tcId:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(t("@babel/runtime/helpers/classCallCheck")),i=l(t("@babel/runtime/helpers/createClass")),o=l(t("@babel/runtime/helpers/inherits")),s=l(t("@babel/runtime/helpers/possibleConstructorReturn")),a=l(t("@babel/runtime/helpers/getPrototypeOf"));function l(t){return t&&t.__esModule?t:{default:t}}function c(t,e){for(var n=e.length-1;n>=0;n--)t.push(e[n]);return t}var u=function(t){(0,o.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,a.default)(t);if(e){var i=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(n);function n(){return(0,r.default)(this,n),e.apply(this,arguments)}return(0,i.default)(n,[{key:"decodeBlock",value:function(t){return function(t){for(var e=new Uint16Array(4093),n=new Uint8Array(4093),r=0;r<=257;r++)e[r]=4096,n[r]=r;var i=258,o=9,s=0;function a(){i=258,o=9}function l(t){var e=function(t,e,n){var r=e%8,i=Math.floor(e/8),o=8-r,s=e+n-8*(i+1),a=8*(i+2)-(e+n),l=8*(i+2)-e;if(a=Math.max(0,a),i>=t.length)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),257;var c=t[i]&Math.pow(2,8-r)-1,u=c<<=n-o;if(i+1<t.length){var h=t[i+1]>>>a;u+=h<<=Math.max(0,n-l)}if(s>8&&i+2<t.length){var f=8*(i+3)-(e+n);u+=t[i+2]>>>f}return u}(t,s,o);return s+=o,e}function u(t,r){return n[i]=r,e[i]=t,++i-1}function h(t){for(var r=[],i=t;4096!==i;i=e[i])r.push(n[i]);return r}var f=[];a();for(var d,p=new Uint8Array(t),m=l(p);257!==m;){if(256===m){for(a(),m=l(p);256===m;)m=l(p);if(257===m)break;if(m>256)throw new Error("corrupted code at scanline ".concat(m));c(f,h(m)),d=m}else if(m<i){var g=h(m);c(f,g),u(d,g[g.length-1]),d=m}else{var v=h(d);if(!v)throw new Error("Bogus entry. Not in dictionary, ".concat(d," / ").concat(i,", position: ").concat(s));c(f,v),f.push(v[v.length-1]),u(d,v[v.length-1]),d=m}i+1>=Math.pow(2,o)&&(12===o?d=void 0:o++),m=l(p)}return new Uint8Array(f)}(t).buffer}}]),n}(l(t("./basedecoder")).default);n.default=u},{"@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW","@babel/runtime/helpers/inherits":"d4H2","@babel/runtime/helpers/possibleConstructorReturn":"pxk2","@babel/runtime/helpers/getPrototypeOf":"UJE0","./basedecoder":"FJDe"}],J7kk:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=u(t("@babel/runtime/helpers/inherits")),i=u(t("@babel/runtime/helpers/possibleConstructorReturn")),o=u(t("@babel/runtime/helpers/getPrototypeOf")),s=u(t("@babel/runtime/helpers/classCallCheck")),a=u(t("@babel/runtime/helpers/createClass")),l=u(t("@babel/runtime/helpers/typeof")),c=u(t("./basedecoder"));function u(t){return t&&t.__esModule?t:{default:t}}var h=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),f=4017,d=799,p=3406,m=2276,g=1567,v=3784,y=5793,b=2896;function _(t,e){for(var n=0,r=[],i=16;i>0&&!t[i-1];)--i;r.push({children:[],index:0});for(var o,s=r[0],a=0;a<i;a++){for(var l=0;l<t[a];l++){for((s=r.pop()).children[s.index]=e[n];s.index>0;)s=r.pop();for(s.index++,r.push(s);r.length<=a;)r.push(o={children:[],index:0}),s.children[s.index]=o.children,s=o;n++}a+1<i&&(r.push(o={children:[],index:0}),s.children[s.index]=o.children,s=o)}return r[0].children}function x(t,e,n,r,i,o,s,a,c){var u=n.mcusPerLine,f=n.progressive,d=e,p=e,m=0,g=0;function v(){if(g>0)return m>>--g&1;if(255===(m=t[p++])){var e=t[p++];if(e)throw new Error("unexpected marker: ".concat((m<<8|e).toString(16)))}return g=7,m>>>7}function y(t){for(var e,n=t;null!==(e=v());){if("number"==typeof(n=n[e]))return n;if("object"!==(0,l.default)(n))throw new Error("invalid huffman sequence")}return null}function b(t){for(var e=t,n=0;e>0;){var r=v();if(null===r)return;n=n<<1|r,--e}return n}function _(t){var e=b(t);return e>=1<<t-1?e:e+(-1<<t)+1}var x,w=0,M=0;function S(t,e,n,r,i){var o=n%u,s=(n/u|0)*t.v+r,a=o*t.h+i;e(t,t.blocks[s][a])}function E(t,e,n){var r=n/t.blocksPerLine|0,i=n%t.blocksPerLine;e(t,t.blocks[r][i])}var T,C,A,P,L,R,O=r.length;R=f?0===o?0===a?function(t,e){var n=y(t.huffmanTableDC),r=0===n?0:_(n)<<c;t.pred+=r,e[0]=t.pred}:function(t,e){e[0]|=v()<<c}:0===a?function(t,e){if(w>0)w--;else for(var n=o,r=s;n<=r;){var i=y(t.huffmanTableAC),a=15&i,l=i>>4;if(0===a){if(l<15){w=b(l)+(1<<l)-1;break}n+=16}else e[h[n+=l]]=_(a)*(1<<c),n++}}:function(t,e){for(var n=o,r=s,i=0;n<=r;){var a=h[n],l=e[a]<0?-1:1;switch(M){case 0:var u=y(t.huffmanTableAC),f=15&u;if(i=u>>4,0===f)i<15?(w=b(i)+(1<<i),M=4):(i=16,M=1);else{if(1!==f)throw new Error("invalid ACn encoding");x=_(f),M=i?2:3}continue;case 1:case 2:e[a]?e[a]+=(v()<<c)*l:0==--i&&(M=2===M?3:0);break;case 3:e[a]?e[a]+=(v()<<c)*l:(e[a]=x<<c,M=0);break;case 4:e[a]&&(e[a]+=(v()<<c)*l)}n++}4===M&&0==--w&&(M=0)}:function(t,e){var n=y(t.huffmanTableDC),r=0===n?0:_(n);t.pred+=r,e[0]=t.pred;for(var i=1;i<64;){var o=y(t.huffmanTableAC),s=15&o,a=o>>4;if(0===s){if(a<15)break;i+=16}else e[h[i+=a]]=_(s),i++}};var k,I,D=0;I=1===O?r[0].blocksPerLine*r[0].blocksPerColumn:u*n.mcusPerColumn;for(var N=i||I;D<I;){for(C=0;C<O;C++)r[C].pred=0;if(w=0,1===O)for(T=r[0],L=0;L<N;L++)E(T,R,D),D++;else for(L=0;L<N;L++){for(C=0;C<O;C++){var j=T=r[C],F=j.h,B=j.v;for(A=0;A<B;A++)for(P=0;P<F;P++)S(T,R,D,A,P)}if(++D===I)break}if(g=0,(k=t[p]<<8|t[p+1])<65280)throw new Error("marker was not found");if(!(k>=65488&&k<=65495))break;p+=2}return p-d}function w(t,e){var n=[],r=e.blocksPerLine,i=e.blocksPerColumn,o=r<<3,s=new Int32Array(64),a=new Uint8Array(64);function l(t,n,r){var i,o,s,a,l,c,u,h,_,x,w=e.quantizationTable,M=r;for(x=0;x<64;x++)M[x]=t[x]*w[x];for(x=0;x<8;++x){var S=8*x;0!==M[1+S]||0!==M[2+S]||0!==M[3+S]||0!==M[4+S]||0!==M[5+S]||0!==M[6+S]||0!==M[7+S]?(i=y*M[0+S]+128>>8,o=y*M[4+S]+128>>8,s=M[2+S],a=M[6+S],l=b*(M[1+S]-M[7+S])+128>>8,h=b*(M[1+S]+M[7+S])+128>>8,c=M[3+S]<<4,u=M[5+S]<<4,_=i-o+1>>1,i=i+o+1>>1,o=_,_=s*v+a*g+128>>8,s=s*g-a*v+128>>8,a=_,_=l-u+1>>1,l=l+u+1>>1,u=_,_=h+c+1>>1,c=h-c+1>>1,h=_,_=i-a+1>>1,i=i+a+1>>1,a=_,_=o-s+1>>1,o=o+s+1>>1,s=_,_=l*m+h*p+2048>>12,l=l*p-h*m+2048>>12,h=_,_=c*d+u*f+2048>>12,c=c*f-u*d+2048>>12,u=_,M[0+S]=i+h,M[7+S]=i-h,M[1+S]=o+u,M[6+S]=o-u,M[2+S]=s+c,M[5+S]=s-c,M[3+S]=a+l,M[4+S]=a-l):(_=y*M[0+S]+512>>10,M[0+S]=_,M[1+S]=_,M[2+S]=_,M[3+S]=_,M[4+S]=_,M[5+S]=_,M[6+S]=_,M[7+S]=_)}for(x=0;x<8;++x){var E=x;0!==M[8+E]||0!==M[16+E]||0!==M[24+E]||0!==M[32+E]||0!==M[40+E]||0!==M[48+E]||0!==M[56+E]?(i=y*M[0+E]+2048>>12,o=y*M[32+E]+2048>>12,s=M[16+E],a=M[48+E],l=b*(M[8+E]-M[56+E])+2048>>12,h=b*(M[8+E]+M[56+E])+2048>>12,c=M[24+E],u=M[40+E],_=i-o+1>>1,i=i+o+1>>1,o=_,_=s*v+a*g+2048>>12,s=s*g-a*v+2048>>12,a=_,_=l-u+1>>1,l=l+u+1>>1,u=_,_=h+c+1>>1,c=h-c+1>>1,h=_,_=i-a+1>>1,i=i+a+1>>1,a=_,_=o-s+1>>1,o=o+s+1>>1,s=_,_=l*m+h*p+2048>>12,l=l*p-h*m+2048>>12,h=_,_=c*d+u*f+2048>>12,c=c*f-u*d+2048>>12,u=_,M[0+E]=i+h,M[56+E]=i-h,M[8+E]=o+u,M[48+E]=o-u,M[16+E]=s+c,M[40+E]=s-c,M[24+E]=a+l,M[32+E]=a-l):(_=y*r[x+0]+8192>>14,M[0+E]=_,M[8+E]=_,M[16+E]=_,M[24+E]=_,M[32+E]=_,M[40+E]=_,M[48+E]=_,M[56+E]=_)}for(x=0;x<64;++x){var T=128+(M[x]+8>>4);n[x]=T<0?0:T>255?255:T}}for(var c=0;c<i;c++){for(var u=c<<3,h=0;h<8;h++)n.push(new Uint8Array(o));for(var _=0;_<r;_++){l(e.blocks[c][_],a,s);for(var x=0,w=_<<3,M=0;M<8;M++)for(var S=n[u+M],E=0;E<8;E++)S[w+E]=a[x++]}}return n}var M=function(){function t(){(0,s.default)(this,t),this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()}return(0,a.default)(t,[{key:"resetFrames",value:function(){this.frames=[]}},{key:"parse",value:function(t){var e=0;function n(){var n=t[e]<<8|t[e+1];return e+=2,n}function r(t){var e,n,r=0,i=0;for(n in t.components)t.components.hasOwnProperty(n)&&(r<(e=t.components[n]).h&&(r=e.h),i<e.v&&(i=e.v));var o=Math.ceil(t.samplesPerLine/8/r),s=Math.ceil(t.scanLines/8/i);for(n in t.components)if(t.components.hasOwnProperty(n)){e=t.components[n];for(var a=Math.ceil(Math.ceil(t.samplesPerLine/8)*e.h/r),l=Math.ceil(Math.ceil(t.scanLines/8)*e.v/i),c=o*e.h,u=s*e.v,h=[],f=0;f<u;f++){for(var d=[],p=0;p<c;p++)d.push(new Int32Array(64));h.push(d)}e.blocksPerLine=a,e.blocksPerColumn=l,e.blocks=h}t.maxH=r,t.maxV=i,t.mcusPerLine=o,t.mcusPerColumn=s}var i,o,s=n();if(65496!==s)throw new Error("SOI not found");for(s=n();65497!==s;){switch(s){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var a=(i=n(),o=t.subarray(e,e+i-2),e+=o.length,o);65504===s&&74===a[0]&&70===a[1]&&73===a[2]&&70===a[3]&&0===a[4]&&(this.jfif={version:{major:a[5],minor:a[6]},densityUnits:a[7],xDensity:a[8]<<8|a[9],yDensity:a[10]<<8|a[11],thumbWidth:a[12],thumbHeight:a[13],thumbData:a.subarray(14,14+3*a[12]*a[13])}),65518===s&&65===a[0]&&100===a[1]&&111===a[2]&&98===a[3]&&101===a[4]&&0===a[5]&&(this.adobe={version:a[6],flags0:a[7]<<8|a[8],flags1:a[9]<<8|a[10],transformCode:a[11]});break;case 65499:for(var l=n()+e-2;e<l;){var c=t[e++],u=new Int32Array(64);if(c>>4==0)for(var f=0;f<64;f++)u[h[f]]=t[e++];else{if(c>>4!=1)throw new Error("DQT: invalid table spec");for(var d=0;d<64;d++)u[h[d]]=n()}this.quantizationTables[15&c]=u}break;case 65472:case 65473:case 65474:n();for(var p={extended:65473===s,progressive:65474===s,precision:t[e++],scanLines:n(),samplesPerLine:n(),components:{},componentsOrder:[]},m=t[e++],g=void 0,v=0;v<m;v++){g=t[e];var y=t[e+1]>>4,b=15&t[e+1],w=t[e+2];p.componentsOrder.push(g),p.components[g]={h:y,v:b,quantizationIdx:w},e+=3}r(p),this.frames.push(p);break;case 65476:for(var M=n(),S=2;S<M;){for(var E=t[e++],T=new Uint8Array(16),C=0,A=0;A<16;A++,e++)T[A]=t[e],C+=T[A];for(var P=new Uint8Array(C),L=0;L<C;L++,e++)P[L]=t[e];S+=17+C,E>>4==0?this.huffmanTablesDC[15&E]=_(T,P):this.huffmanTablesAC[15&E]=_(T,P)}break;case 65501:n(),this.resetInterval=n();break;case 65498:n();for(var R=t[e++],O=[],k=this.frames[0],I=0;I<R;I++){var D=k.components[t[e++]],N=t[e++];D.huffmanTableDC=this.huffmanTablesDC[N>>4],D.huffmanTableAC=this.huffmanTablesAC[15&N],O.push(D)}var j=t[e++],F=t[e++],B=t[e++],z=x(t,e,k,O,this.resetInterval,j,F,B>>4,15&B);e+=z;break;case 65535:255!==t[e]&&e--;break;default:if(255===t[e-3]&&t[e-2]>=192&&t[e-2]<=254){e-=3;break}throw new Error("unknown JPEG marker ".concat(s.toString(16)))}s=n()}}},{key:"getResult",value:function(){var t=this.frames;if(0===this.frames.length)throw new Error("no frames were decoded");this.frames.length>1&&console.warn("more than one frame is not supported");for(var e=0;e<this.frames.length;e++)for(var n=this.frames[e].components,r=0,i=Object.keys(n);r<i.length;r++){var o=i[r];n[o].quantizationTable=this.quantizationTables[n[o].quantizationIdx],delete n[o].quantizationIdx}for(var s=t[0],a=s.components,l=s.componentsOrder,c=[],u=s.samplesPerLine,h=s.scanLines,f=0;f<l.length;f++){var d=a[l[f]];c.push({lines:w(0,d),scaleX:d.h/s.maxH,scaleY:d.v/s.maxV})}for(var p=new Uint8Array(u*h*c.length),m=0,g=0;g<h;++g)for(var v=0;v<u;++v)for(var y=0;y<c.length;++y){var b=c[y];p[m]=b.lines[0|g*b.scaleY][0|v*b.scaleX],++m}return p}}]),t}(),S=function(t){(0,r.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.default)(t);if(e){var s=(0,o.default)(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return(0,i.default)(this,n)}}(n);function n(t){var r;return(0,s.default)(this,n),(r=e.call(this)).reader=new M,t.JPEGTables&&r.reader.parse(t.JPEGTables),r}return(0,a.default)(n,[{key:"decodeBlock",value:function(t){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(t)),this.reader.getResult().buffer}}]),n}(c.default);n.default=S},{"@babel/runtime/helpers/inherits":"d4H2","@babel/runtime/helpers/possibleConstructorReturn":"pxk2","@babel/runtime/helpers/getPrototypeOf":"UJE0","@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW","@babel/runtime/helpers/typeof":"b9XL","./basedecoder":"FJDe"}],tbG5:[function(t,e,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}n.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)i(n,r)&&(t[r]=n[r])}}return t},n.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var o={arraySet:function(t,e,n,r,i){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+r),i);else for(var o=0;o<r;o++)t[i+o]=e[n+o]},flattenChunks:function(t){var e,n,r,i,o,s;for(r=0,e=0,n=t.length;e<n;e++)r+=t[e].length;for(s=new Uint8Array(r),i=0,e=0,n=t.length;e<n;e++)o=t[e],s.set(o,i),i+=o.length;return s}},s={arraySet:function(t,e,n,r,i){for(var o=0;o<r;o++)t[i+o]=e[n+o]},flattenChunks:function(t){return[].concat.apply([],t)}};n.setTyped=function(t){t?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,o)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,s))},n.setTyped(r)},{}],uxo6:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){for(var i=65535&t|0,o=t>>>16&65535|0,s=0;0!==n;){n-=s=n>2e3?2e3:n;do{o=o+(i=i+e[r++]|0)|0}while(--s);i%=65521,o%=65521}return i|o<<16|0}},{}],X4kj:[function(t,e,n){"use strict";var r=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();e.exports=function(t,e,n,i){var o=r,s=i+n;t^=-1;for(var a=i;a<s;a++)t=t>>>8^o[255&(t^e[a])];return-1^t}},{}],LP5M:[function(t,e,n){"use strict";e.exports=function(t,e){var n,r,i,o,s,a,l,c,u,h,f,d,p,m,g,v,y,b,_,x,w,M,S,E,T;n=t.state,r=t.next_in,E=t.input,i=r+(t.avail_in-5),o=t.next_out,T=t.output,s=o-(e-t.avail_out),a=o+(t.avail_out-257),l=n.dmax,c=n.wsize,u=n.whave,h=n.wnext,f=n.window,d=n.hold,p=n.bits,m=n.lencode,g=n.distcode,v=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;t:do{p<15&&(d+=E[r++]<<p,p+=8,d+=E[r++]<<p,p+=8),b=m[d&v];e:for(;;){if(d>>>=_=b>>>24,p-=_,0==(_=b>>>16&255))T[o++]=65535&b;else{if(!(16&_)){if(0==(64&_)){b=m[(65535&b)+(d&(1<<_)-1)];continue e}if(32&_){n.mode=12;break t}t.msg="invalid literal/length code",n.mode=30;break t}x=65535&b,(_&=15)&&(p<_&&(d+=E[r++]<<p,p+=8),x+=d&(1<<_)-1,d>>>=_,p-=_),p<15&&(d+=E[r++]<<p,p+=8,d+=E[r++]<<p,p+=8),b=g[d&y];n:for(;;){if(d>>>=_=b>>>24,p-=_,!(16&(_=b>>>16&255))){if(0==(64&_)){b=g[(65535&b)+(d&(1<<_)-1)];continue n}t.msg="invalid distance code",n.mode=30;break t}if(w=65535&b,p<(_&=15)&&(d+=E[r++]<<p,(p+=8)<_&&(d+=E[r++]<<p,p+=8)),(w+=d&(1<<_)-1)>l){t.msg="invalid distance too far back",n.mode=30;break t}if(d>>>=_,p-=_,w>(_=o-s)){if((_=w-_)>u&&n.sane){t.msg="invalid distance too far back",n.mode=30;break t}if(M=0,S=f,0===h){if(M+=c-_,_<x){x-=_;do{T[o++]=f[M++]}while(--_);M=o-w,S=T}}else if(h<_){if(M+=c+h-_,(_-=h)<x){x-=_;do{T[o++]=f[M++]}while(--_);if(M=0,h<x){x-=_=h;do{T[o++]=f[M++]}while(--_);M=o-w,S=T}}}else if(M+=h-_,_<x){x-=_;do{T[o++]=f[M++]}while(--_);M=o-w,S=T}for(;x>2;)T[o++]=S[M++],T[o++]=S[M++],T[o++]=S[M++],x-=3;x&&(T[o++]=S[M++],x>1&&(T[o++]=S[M++]))}else{M=o-w;do{T[o++]=T[M++],T[o++]=T[M++],T[o++]=T[M++],x-=3}while(x>2);x&&(T[o++]=T[M++],x>1&&(T[o++]=T[M++]))}break}}break}}while(r<i&&o<a);r-=x=p>>3,d&=(1<<(p-=x<<3))-1,t.next_in=r,t.next_out=o,t.avail_in=r<i?i-r+5:5-(r-i),t.avail_out=o<a?a-o+257:257-(o-a),n.hold=d,n.bits=p}},{}],uNlq:[function(t,e,n){"use strict";var r=t("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,n,l,c,u,h,f){var d,p,m,g,v,y,b,_,x,w=f.bits,M=0,S=0,E=0,T=0,C=0,A=0,P=0,L=0,R=0,O=0,k=null,I=0,D=new r.Buf16(16),N=new r.Buf16(16),j=null,F=0;for(M=0;M<=15;M++)D[M]=0;for(S=0;S<l;S++)D[e[n+S]]++;for(C=w,T=15;T>=1&&0===D[T];T--);if(C>T&&(C=T),0===T)return c[u++]=20971520,c[u++]=20971520,f.bits=1,0;for(E=1;E<T&&0===D[E];E++);for(C<E&&(C=E),L=1,M=1;M<=15;M++)if(L<<=1,(L-=D[M])<0)return-1;if(L>0&&(0===t||1!==T))return-1;for(N[1]=0,M=1;M<15;M++)N[M+1]=N[M]+D[M];for(S=0;S<l;S++)0!==e[n+S]&&(h[N[e[n+S]]++]=S);if(0===t?(k=j=h,y=19):1===t?(k=i,I-=257,j=o,F-=257,y=256):(k=s,j=a,y=-1),O=0,S=0,M=E,v=u,A=C,P=0,m=-1,g=(R=1<<C)-1,1===t&&R>852||2===t&&R>592)return 1;for(;;){b=M-P,h[S]<y?(_=0,x=h[S]):h[S]>y?(_=j[F+h[S]],x=k[I+h[S]]):(_=96,x=0),d=1<<M-P,E=p=1<<A;do{c[v+(O>>P)+(p-=d)]=b<<24|_<<16|x|0}while(0!==p);for(d=1<<M-1;O&d;)d>>=1;if(0!==d?(O&=d-1,O+=d):O=0,S++,0==--D[M]){if(M===T)break;M=e[n+h[S]]}if(M>C&&(O&g)!==m){for(0===P&&(P=C),v+=E,L=1<<(A=M-P);A+P<T&&!((L-=D[A+P])<=0);)A++,L<<=1;if(R+=1<<A,1===t&&R>852||2===t&&R>592)return 1;c[m=O&g]=C<<24|A<<16|v-u|0}}return 0!==O&&(c[v+O]=M-P<<24|64<<16|0),f.bits=C,0}},{"../utils/common":"tbG5"}],GIDK:[function(t,e,n){"use strict";var r=t("../utils/common"),i=t("./adler32"),o=t("./crc32"),s=t("./inffast"),a=t("./inftrees"),l=-2,c=12,u=30;function h(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function f(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new r.Buf32(852),e.distcode=e.distdyn=new r.Buf32(592),e.sane=1,e.back=-1,0):l}function p(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,d(t)):l}function m(t,e){var n,r;return t&&t.state?(r=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?l:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,p(t))):l}function g(t,e){var n,r;return t?(r=new f,t.state=r,r.window=null,0!==(n=m(t,e))&&(t.state=null),n):l}var v,y,b=!0;function _(t){if(b){var e;for(v=new r.Buf32(512),y=new r.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(a(1,t.lens,0,288,v,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;a(2,t.lens,0,32,y,0,t.work,{bits:5}),b=!1}t.lencode=v,t.lenbits=9,t.distcode=y,t.distbits=5}function x(t,e,n,i){var o,s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new r.Buf8(s.wsize)),i>=s.wsize?(r.arraySet(s.window,e,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((o=s.wsize-s.wnext)>i&&(o=i),r.arraySet(s.window,e,n-i,o,s.wnext),(i-=o)?(r.arraySet(s.window,e,n-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=o,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=o))),0}n.inflateReset=p,n.inflateReset2=m,n.inflateResetKeep=d,n.inflateInit=function(t){return g(t,15)},n.inflateInit2=g,n.inflate=function(t,e){var n,f,d,p,m,g,v,y,b,w,M,S,E,T,C,A,P,L,R,O,k,I,D,N,j=0,F=new r.Buf8(4),B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return l;(n=t.state).mode===c&&(n.mode=13),m=t.next_out,d=t.output,v=t.avail_out,p=t.next_in,f=t.input,g=t.avail_in,y=n.hold,b=n.bits,w=g,M=v,I=0;t:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;b<16;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}if(2&n.wrap&&35615===y){n.check=0,F[0]=255&y,F[1]=y>>>8&255,n.check=o(n.check,F,2,0),y=0,b=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&y)<<8)+(y>>8))%31){t.msg="incorrect header check",n.mode=u;break}if(8!=(15&y)){t.msg="unknown compression method",n.mode=u;break}if(b-=4,k=8+(15&(y>>>=4)),0===n.wbits)n.wbits=k;else if(k>n.wbits){t.msg="invalid window size",n.mode=u;break}n.dmax=1<<k,t.adler=n.check=1,n.mode=512&y?10:c,y=0,b=0;break;case 2:for(;b<16;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}if(n.flags=y,8!=(255&n.flags)){t.msg="unknown compression method",n.mode=u;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=u;break}n.head&&(n.head.text=y>>8&1),512&n.flags&&(F[0]=255&y,F[1]=y>>>8&255,n.check=o(n.check,F,2,0)),y=0,b=0,n.mode=3;case 3:for(;b<32;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}n.head&&(n.head.time=y),512&n.flags&&(F[0]=255&y,F[1]=y>>>8&255,F[2]=y>>>16&255,F[3]=y>>>24&255,n.check=o(n.check,F,4,0)),y=0,b=0,n.mode=4;case 4:for(;b<16;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}n.head&&(n.head.xflags=255&y,n.head.os=y>>8),512&n.flags&&(F[0]=255&y,F[1]=y>>>8&255,n.check=o(n.check,F,2,0)),y=0,b=0,n.mode=5;case 5:if(1024&n.flags){for(;b<16;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}n.length=y,n.head&&(n.head.extra_len=y),512&n.flags&&(F[0]=255&y,F[1]=y>>>8&255,n.check=o(n.check,F,2,0)),y=0,b=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((S=n.length)>g&&(S=g),S&&(n.head&&(k=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,f,p,S,k)),512&n.flags&&(n.check=o(n.check,f,S,p)),g-=S,p+=S,n.length-=S),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===g)break t;S=0;do{k=f[p+S++],n.head&&k&&n.length<65536&&(n.head.name+=String.fromCharCode(k))}while(k&&S<g);if(512&n.flags&&(n.check=o(n.check,f,S,p)),g-=S,p+=S,k)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===g)break t;S=0;do{k=f[p+S++],n.head&&k&&n.length<65536&&(n.head.comment+=String.fromCharCode(k))}while(k&&S<g);if(512&n.flags&&(n.check=o(n.check,f,S,p)),g-=S,p+=S,k)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;b<16;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}if(y!==(65535&n.check)){t.msg="header crc mismatch",n.mode=u;break}y=0,b=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=c;break;case 10:for(;b<32;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}t.adler=n.check=h(y),y=0,b=0,n.mode=11;case 11:if(0===n.havedict)return t.next_out=m,t.avail_out=v,t.next_in=p,t.avail_in=g,n.hold=y,n.bits=b,2;t.adler=n.check=1,n.mode=c;case c:if(5===e||6===e)break t;case 13:if(n.last){y>>>=7&b,b-=7&b,n.mode=27;break}for(;b<3;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}switch(n.last=1&y,b-=1,3&(y>>>=1)){case 0:n.mode=14;break;case 1:if(_(n),n.mode=20,6===e){y>>>=2,b-=2;break t}break;case 2:n.mode=17;break;case 3:t.msg="invalid block type",n.mode=u}y>>>=2,b-=2;break;case 14:for(y>>>=7&b,b-=7&b;b<32;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}if((65535&y)!=(y>>>16^65535)){t.msg="invalid stored block lengths",n.mode=u;break}if(n.length=65535&y,y=0,b=0,n.mode=15,6===e)break t;case 15:n.mode=16;case 16:if(S=n.length){if(S>g&&(S=g),S>v&&(S=v),0===S)break t;r.arraySet(d,f,p,S,m),g-=S,p+=S,v-=S,m+=S,n.length-=S;break}n.mode=c;break;case 17:for(;b<14;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}if(n.nlen=257+(31&y),y>>>=5,b-=5,n.ndist=1+(31&y),y>>>=5,b-=5,n.ncode=4+(15&y),y>>>=4,b-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=u;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;b<3;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}n.lens[B[n.have++]]=7&y,y>>>=3,b-=3}for(;n.have<19;)n.lens[B[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,D={bits:n.lenbits},I=a(0,n.lens,0,19,n.lencode,0,n.work,D),n.lenbits=D.bits,I){t.msg="invalid code lengths set",n.mode=u;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;A=(j=n.lencode[y&(1<<n.lenbits)-1])>>>16&255,P=65535&j,!((C=j>>>24)<=b);){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}if(P<16)y>>>=C,b-=C,n.lens[n.have++]=P;else{if(16===P){for(N=C+2;b<N;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}if(y>>>=C,b-=C,0===n.have){t.msg="invalid bit length repeat",n.mode=u;break}k=n.lens[n.have-1],S=3+(3&y),y>>>=2,b-=2}else if(17===P){for(N=C+3;b<N;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}b-=C,k=0,S=3+(7&(y>>>=C)),y>>>=3,b-=3}else{for(N=C+7;b<N;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}b-=C,k=0,S=11+(127&(y>>>=C)),y>>>=7,b-=7}if(n.have+S>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=u;break}for(;S--;)n.lens[n.have++]=k}}if(n.mode===u)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=u;break}if(n.lenbits=9,D={bits:n.lenbits},I=a(1,n.lens,0,n.nlen,n.lencode,0,n.work,D),n.lenbits=D.bits,I){t.msg="invalid literal/lengths set",n.mode=u;break}if(n.distbits=6,n.distcode=n.distdyn,D={bits:n.distbits},I=a(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,D),n.distbits=D.bits,I){t.msg="invalid distances set",n.mode=u;break}if(n.mode=20,6===e)break t;case 20:n.mode=21;case 21:if(g>=6&&v>=258){t.next_out=m,t.avail_out=v,t.next_in=p,t.avail_in=g,n.hold=y,n.bits=b,s(t,M),m=t.next_out,d=t.output,v=t.avail_out,p=t.next_in,f=t.input,g=t.avail_in,y=n.hold,b=n.bits,n.mode===c&&(n.back=-1);break}for(n.back=0;A=(j=n.lencode[y&(1<<n.lenbits)-1])>>>16&255,P=65535&j,!((C=j>>>24)<=b);){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}if(A&&0==(240&A)){for(L=C,R=A,O=P;A=(j=n.lencode[O+((y&(1<<L+R)-1)>>L)])>>>16&255,P=65535&j,!(L+(C=j>>>24)<=b);){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}y>>>=L,b-=L,n.back+=L}if(y>>>=C,b-=C,n.back+=C,n.length=P,0===A){n.mode=26;break}if(32&A){n.back=-1,n.mode=c;break}if(64&A){t.msg="invalid literal/length code",n.mode=u;break}n.extra=15&A,n.mode=22;case 22:if(n.extra){for(N=n.extra;b<N;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}n.length+=y&(1<<n.extra)-1,y>>>=n.extra,b-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;A=(j=n.distcode[y&(1<<n.distbits)-1])>>>16&255,P=65535&j,!((C=j>>>24)<=b);){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}if(0==(240&A)){for(L=C,R=A,O=P;A=(j=n.distcode[O+((y&(1<<L+R)-1)>>L)])>>>16&255,P=65535&j,!(L+(C=j>>>24)<=b);){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}y>>>=L,b-=L,n.back+=L}if(y>>>=C,b-=C,n.back+=C,64&A){t.msg="invalid distance code",n.mode=u;break}n.offset=P,n.extra=15&A,n.mode=24;case 24:if(n.extra){for(N=n.extra;b<N;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}n.offset+=y&(1<<n.extra)-1,y>>>=n.extra,b-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=u;break}n.mode=25;case 25:if(0===v)break t;if(S=M-v,n.offset>S){if((S=n.offset-S)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=u;break}S>n.wnext?(S-=n.wnext,E=n.wsize-S):E=n.wnext-S,S>n.length&&(S=n.length),T=n.window}else T=d,E=m-n.offset,S=n.length;S>v&&(S=v),v-=S,n.length-=S;do{d[m++]=T[E++]}while(--S);0===n.length&&(n.mode=21);break;case 26:if(0===v)break t;d[m++]=n.length,v--,n.mode=21;break;case 27:if(n.wrap){for(;b<32;){if(0===g)break t;g--,y|=f[p++]<<b,b+=8}if(M-=v,t.total_out+=M,n.total+=M,M&&(t.adler=n.check=n.flags?o(n.check,d,M,m-M):i(n.check,d,M,m-M)),M=v,(n.flags?y:h(y))!==n.check){t.msg="incorrect data check",n.mode=u;break}y=0,b=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;b<32;){if(0===g)break t;g--,y+=f[p++]<<b,b+=8}if(y!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=u;break}y=0,b=0}n.mode=29;case 29:I=1;break t;case u:I=-3;break t;case 31:return-4;case 32:default:return l}return t.next_out=m,t.avail_out=v,t.next_in=p,t.avail_in=g,n.hold=y,n.bits=b,(n.wsize||M!==t.avail_out&&n.mode<u&&(n.mode<27||4!==e))&&x(t,t.output,t.next_out,M-t.avail_out)?(n.mode=31,-4):(w-=t.avail_in,M-=t.avail_out,t.total_in+=w,t.total_out+=M,n.total+=M,n.wrap&&M&&(t.adler=n.check=n.flags?o(n.check,d,M,t.next_out-M):i(n.check,d,M,t.next_out-M)),t.data_type=n.bits+(n.last?64:0)+(n.mode===c?128:0)+(20===n.mode||15===n.mode?256:0),(0===w&&0===M||4===e)&&0===I&&(I=-5),I)},n.inflateEnd=function(t){if(!t||!t.state)return l;var e=t.state;return e.window&&(e.window=null),t.state=null,0},n.inflateGetHeader=function(t,e){var n;return t&&t.state?0==(2&(n=t.state).wrap)?l:(n.head=e,e.done=!1,0):l},n.inflateSetDictionary=function(t,e){var n,r=e.length;return t&&t.state?0!==(n=t.state).wrap&&11!==n.mode?l:11===n.mode&&i(1,e,r,0)!==n.check?-3:x(t,e,r,r)?(n.mode=31,-4):(n.havedict=1,0):l},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":"tbG5","./adler32":"uxo6","./crc32":"X4kj","./inffast":"LP5M","./inftrees":"uNlq"}],Q3ZD:[function(t,e,n){"use strict";var r=t("./common"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(t){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){o=!1}for(var s=new r.Buf8(256),a=0;a<256;a++)s[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;function l(t,e){if(e<65534&&(t.subarray&&o||!t.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(t,e));for(var n="",s=0;s<e;s++)n+=String.fromCharCode(t[s]);return n}s[254]=s[254]=1,n.string2buf=function(t){var e,n,i,o,s,a=t.length,l=0;for(o=0;o<a;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<a&&56320==(64512&(i=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=new r.Buf8(l),s=0,o=0;s<l;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<a&&56320==(64512&(i=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|63&n):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|63&n):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|63&n);return e},n.buf2binstring=function(t){return l(t,t.length)},n.binstring2buf=function(t){for(var e=new r.Buf8(t.length),n=0,i=e.length;n<i;n++)e[n]=t.charCodeAt(n);return e},n.buf2string=function(t,e){var n,r,i,o,a=e||t.length,c=new Array(2*a);for(r=0,n=0;n<a;)if((i=t[n++])<128)c[r++]=i;else if((o=s[i])>4)c[r++]=65533,n+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&n<a;)i=i<<6|63&t[n++],o--;o>1?c[r++]=65533:i<65536?c[r++]=i:(i-=65536,c[r++]=55296|i>>10&1023,c[r++]=56320|1023&i)}return l(c,r)},n.utf8border=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;n>=0&&128==(192&t[n]);)n--;return n<0||0===n?e:n+s[t[n]]>e?n:e}},{"./common":"tbG5"}],xUUw:[function(t,e,n){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],gMAY:[function(t,e,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],bdtv:[function(t,e,n){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],WIli:[function(t,e,n){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],faQk:[function(t,e,n){"use strict";var r=t("./zlib/inflate"),i=t("./utils/common"),o=t("./utils/strings"),s=t("./zlib/constants"),a=t("./zlib/messages"),l=t("./zlib/zstream"),c=t("./zlib/gzheader"),u=Object.prototype.toString;function h(t){if(!(this instanceof h))return new h(t);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,e.windowBits);if(n!==s.Z_OK)throw new Error(a[n]);if(this.header=new c,r.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=o.string2buf(e.dictionary):"[object ArrayBuffer]"===u.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=r.inflateSetDictionary(this.strm,e.dictionary))!==s.Z_OK))throw new Error(a[n])}function f(t,e){var n=new h(e);if(n.push(t,!0),n.err)throw n.msg||a[n.err];return n.result}h.prototype.push=function(t,e){var n,a,l,c,h,f=this.strm,d=this.options.chunkSize,p=this.options.dictionary,m=!1;if(this.ended)return!1;a=e===~~e?e:!0===e?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof t?f.input=o.binstring2buf(t):"[object ArrayBuffer]"===u.call(t)?f.input=new Uint8Array(t):f.input=t,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new i.Buf8(d),f.next_out=0,f.avail_out=d),(n=r.inflate(f,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&p&&(n=r.inflateSetDictionary(this.strm,p)),n===s.Z_BUF_ERROR&&!0===m&&(n=s.Z_OK,m=!1),n!==s.Z_STREAM_END&&n!==s.Z_OK)return this.onEnd(n),this.ended=!0,!1;f.next_out&&(0!==f.avail_out&&n!==s.Z_STREAM_END&&(0!==f.avail_in||a!==s.Z_FINISH&&a!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(f.output,f.next_out),c=f.next_out-l,h=o.buf2string(f.output,l),f.next_out=c,f.avail_out=d-c,c&&i.arraySet(f.output,f.output,l,c,0),this.onData(h)):this.onData(i.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(m=!0)}while((f.avail_in>0||0===f.avail_out)&&n!==s.Z_STREAM_END);return n===s.Z_STREAM_END&&(a=s.Z_FINISH),a===s.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===s.Z_OK):a!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),f.avail_out=0,!0)},h.prototype.onData=function(t){this.chunks.push(t)},h.prototype.onEnd=function(t){t===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Inflate=h,n.inflate=f,n.inflateRaw=function(t,e){return(e=e||{}).raw=!0,f(t,e)},n.ungzip=f},{"./zlib/inflate":"GIDK","./utils/common":"tbG5","./utils/strings":"Q3ZD","./zlib/constants":"xUUw","./zlib/messages":"gMAY","./zlib/zstream":"bdtv","./zlib/gzheader":"WIli"}],JAiC:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=c(t("@babel/runtime/helpers/classCallCheck")),i=c(t("@babel/runtime/helpers/createClass")),o=c(t("@babel/runtime/helpers/inherits")),s=c(t("@babel/runtime/helpers/possibleConstructorReturn")),a=c(t("@babel/runtime/helpers/getPrototypeOf")),l=t("pako/lib/inflate");function c(t){return t&&t.__esModule?t:{default:t}}var u=function(t){(0,o.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,a.default)(t);if(e){var i=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(n);function n(){return(0,r.default)(this,n),e.apply(this,arguments)}return(0,i.default)(n,[{key:"decodeBlock",value:function(t){return(0,l.inflate)(new Uint8Array(t)).buffer}}]),n}(c(t("./basedecoder")).default);n.default=u},{"@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW","@babel/runtime/helpers/inherits":"d4H2","@babel/runtime/helpers/possibleConstructorReturn":"pxk2","@babel/runtime/helpers/getPrototypeOf":"UJE0","pako/lib/inflate":"faQk","./basedecoder":"FJDe"}],OcPz:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(t("@babel/runtime/helpers/classCallCheck")),i=l(t("@babel/runtime/helpers/createClass")),o=l(t("@babel/runtime/helpers/inherits")),s=l(t("@babel/runtime/helpers/possibleConstructorReturn")),a=l(t("@babel/runtime/helpers/getPrototypeOf"));function l(t){return t&&t.__esModule?t:{default:t}}var c=function(t){(0,o.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,a.default)(t);if(e){var i=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(n);function n(){return(0,r.default)(this,n),e.apply(this,arguments)}return(0,i.default)(n,[{key:"decodeBlock",value:function(t){for(var e=new DataView(t),n=[],r=0;r<t.byteLength;++r){var i=e.getInt8(r);if(i<0){var o=e.getUint8(r+1);i=-i;for(var s=0;s<=i;++s)n.push(o);r+=1}else{for(var a=0;a<=i;++a)n.push(e.getUint8(r+a+1));r+=i+1}}return new Uint8Array(n).buffer}}]),n}(l(t("./basedecoder")).default);n.default=c},{"@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW","@babel/runtime/helpers/inherits":"d4H2","@babel/runtime/helpers/possibleConstructorReturn":"pxk2","@babel/runtime/helpers/getPrototypeOf":"UJE0","./basedecoder":"FJDe"}],FGCZ:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getDecoder=function(t){switch(t.Compression){case void 0:case 1:return new r.default;case 5:return new i.default;case 6:throw new Error("old style JPEG compression is not supported.");case 7:return new o.default(t);case 8:case 32946:return new s.default;case 32773:return new a.default;default:throw new Error("Unknown compression method identifier: ".concat(t.Compression))}};var r=l(t("./raw")),i=l(t("./lzw")),o=l(t("./jpeg")),s=l(t("./deflate")),a=l(t("./packbits"));function l(t){return t&&t.__esModule?t:{default:t}}},{"./raw":"V9bQ","./lzw":"tcId","./jpeg":"J7kk","./deflate":"JAiC","./packbits":"OcPz"}],OQju:[function(t,e,n){"use strict";function r(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return new(Object.getPrototypeOf(t).constructor)(e*n*r)}function i(t,e,n,i,o){var s=e/i,a=n/o;return t.map((function(t){for(var l=r(t,i,o),c=0;c<o;++c)for(var u=Math.min(Math.round(a*c),n-1),h=0;h<i;++h){var f=Math.min(Math.round(s*h),e-1),d=t[u*e+f];l[c*i+h]=d}return l}))}function o(t,e,n){return(1-n)*t+n*e}function s(t,e,n,i,s){var a=e/i,l=n/s;return t.map((function(t){for(var c=r(t,i,s),u=0;u<s;++u)for(var h=l*u,f=Math.floor(h),d=Math.min(Math.ceil(h),n-1),p=0;p<i;++p){var m=a*p,g=m%1,v=Math.floor(m),y=Math.min(Math.ceil(m),e-1),b=t[f*e+v],_=t[f*e+y],x=t[d*e+v],w=t[d*e+y],M=o(o(b,_,g),o(x,w,g),h%1);c[u*i+p]=M}return c}))}function a(t,e,n,i,o,s){for(var a=e/i,l=n/o,c=r(t,i,o,s),u=0;u<o;++u)for(var h=Math.min(Math.round(l*u),n-1),f=0;f<i;++f)for(var d=Math.min(Math.round(a*f),e-1),p=0;p<s;++p){var m=t[h*e*s+d*s+p];c[u*i*s+f*s+p]=m}return c}function l(t,e,n,i,s,a){for(var l=e/i,c=n/s,u=r(t,i,s,a),h=0;h<s;++h)for(var f=c*h,d=Math.floor(f),p=Math.min(Math.ceil(f),n-1),m=0;m<i;++m)for(var g=l*m,v=g%1,y=Math.floor(g),b=Math.min(Math.ceil(g),e-1),_=0;_<a;++_){var x=t[d*e*a+y*a+_],w=t[d*e*a+b*a+_],M=t[p*e*a+y*a+_],S=t[p*e*a+b*a+_],E=o(o(x,w,v),o(M,S,v),f%1);u[h*i*a+m*a+_]=E}return u}Object.defineProperty(n,"__esModule",{value:!0}),n.resampleNearest=i,n.resampleBilinear=s,n.resample=function(t,e,n,r,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"nearest";switch(a.toLowerCase()){case"nearest":return i(t,e,n,r,o);case"bilinear":case"linear":return s(t,e,n,r,o);default:throw new Error("Unsupported resampling method: '".concat(a,"'"))}},n.resampleNearestInterleaved=a,n.resampleBilinearInterleaved=l,n.resampleInterleaved=function(t,e,n,r,i,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"nearest";switch(s.toLowerCase()){case"nearest":return a(t,e,n,r,i,o);case"bilinear":case"linear":return l(t,e,n,r,i,o);default:throw new Error("Unsupported resampling method: '".concat(s,"'"))}}},{}],eOWo:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=p(t("@babel/runtime/helpers/slicedToArray")),i=p(t("@babel/runtime/regenerator")),o=p(t("@babel/runtime/helpers/asyncToGenerator")),s=p(t("@babel/runtime/helpers/classCallCheck")),a=p(t("@babel/runtime/helpers/createClass")),l=t("@petamoriken/float16"),c=p(t("txml")),u=t("./globals"),h=t("./rgb"),f=t("./compression"),d=t("./resample");function p(t){return t&&t.__esModule?t:{default:t}}function m(t,e,n){for(var r=0,i=e;i<n;++i)r+=t[i];return r}function g(t,e,n){switch(t){case 1:if(e<=8)return new Uint8Array(n);if(e<=16)return new Uint16Array(n);if(e<=32)return new Uint32Array(n);break;case 2:if(8===e)return new Int8Array(n);if(16===e)return new Int16Array(n);if(32===e)return new Int32Array(n);break;case 3:switch(e){case 16:case 32:return new Float32Array(n);case 64:return new Float64Array(n)}}throw Error("Unsupported data format/bitsPerSample")}function v(t,e){return(1!==t&&2!==t||!(e<=32)||e%8!=0)&&(3!==t||16!==e&&32!==e&&64!==e)}function y(t,e,n,r,i,o,s){var a=new DataView(t),l=2===n?1:r,c=g(e,i,2===n?s*o:s*o*r),u=parseInt("1".repeat(i),2);if(1===e){var h=o*(1===n?r*i:i);0!=(7&h)&&(h=h+7&-8);for(var f=0;f<s;++f)for(var d=f*h,p=0;p<o;++p)for(var m=d+p*l*i,v=0;v<l;++v){var y=m+v*i,b=(f*o+p)*l+v,_=Math.floor(y/8),x=y%8;if(x+i<=8)c[b]=a.getUint8(_)>>8-i-x&u;else if(x+i<=16)c[b]=a.getUint16(_)>>16-i-x&u;else if(x+i<=24){var w=a.getUint16(_)<<8|a.getUint8(_+2);c[b]=w>>24-i-x&u}else c[b]=a.getUint32(_)>>32-i-x&u}}return c.buffer}var b=function(){function t(e,n,r,i,o,a){(0,s.default)(this,t),this.fileDirectory=e,this.geoKeys=n,this.dataView=r,this.littleEndian=i,this.tiles=o?{}:null,this.isTiled=!e.StripOffsets;var l=e.PlanarConfiguration;if(this.planarConfiguration=void 0===l?1:l,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");this.source=a}return(0,a.default)(t,[{key:"getFileDirectory",value:function(){return this.fileDirectory}},{key:"getGeoKeys",value:function(){return this.geoKeys}},{key:"getWidth",value:function(){return this.fileDirectory.ImageWidth}},{key:"getHeight",value:function(){return this.fileDirectory.ImageLength}},{key:"getSamplesPerPixel",value:function(){return void 0!==this.fileDirectory.SamplesPerPixel?this.fileDirectory.SamplesPerPixel:1}},{key:"getTileWidth",value:function(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}},{key:"getTileHeight",value:function(){return this.isTiled?this.fileDirectory.TileLength:void 0!==this.fileDirectory.RowsPerStrip?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}},{key:"getBlockWidth",value:function(){return this.getTileWidth()}},{key:"getBlockHeight",value:function(t){return this.isTiled||(t+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-t*this.getTileHeight()}},{key:"getBytesPerPixel",value:function(){for(var t=0,e=0;e<this.fileDirectory.BitsPerSample.length;++e)t+=this.getSampleByteSize(e);return t}},{key:"getSampleByteSize",value:function(t){if(t>=this.fileDirectory.BitsPerSample.length)throw new RangeError("Sample index ".concat(t," is out of range."));return Math.ceil(this.fileDirectory.BitsPerSample[t]/8)}},{key:"getReaderForSample",value:function(t){var e=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1,n=this.fileDirectory.BitsPerSample[t];switch(e){case 1:if(n<=8)return DataView.prototype.getUint8;if(n<=16)return DataView.prototype.getUint16;if(n<=32)return DataView.prototype.getUint32;break;case 2:if(n<=8)return DataView.prototype.getInt8;if(n<=16)return DataView.prototype.getInt16;if(n<=32)return DataView.prototype.getInt32;break;case 3:switch(n){case 16:return function(t,e){return(0,l.getFloat16)(this,t,e)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}throw Error("Unsupported data format/bitsPerSample")}},{key:"getSampleFormat",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1}},{key:"getBitsPerSample",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.fileDirectory.BitsPerSample[t]}},{key:"getArrayForSample",value:function(t,e){return g(this.getSampleFormat(t),this.getBitsPerSample(t),e)}},{key:"getTileOrStrip",value:function(){var t=(0,o.default)(i.default.mark((function t(e,n,r,s,a){var l,c,u,h,f,d,p,m,g=this;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=Math.ceil(this.getWidth()/this.getTileWidth()),c=Math.ceil(this.getHeight()/this.getTileHeight()),h=this.tiles,1===this.planarConfiguration?u=n*l+e:2===this.planarConfiguration&&(u=r*l*c+n*l+e),this.isTiled?(f=this.fileDirectory.TileOffsets[u],d=this.fileDirectory.TileByteCounts[u]):(f=this.fileDirectory.StripOffsets[u],d=this.fileDirectory.StripByteCounts[u]),t.next=7,this.source.fetch([{offset:f,length:d}],a);case 7:return p=t.sent[0],null!==h&&h[u]?m=h[u]:(m=(0,o.default)(i.default.mark((function t(){var e,r,o;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.decode(g.fileDirectory,p);case 2:return e=t.sent,r=g.getSampleFormat(),o=g.getBitsPerSample(),v(r,o)&&(e=y(e,r,g.planarConfiguration,g.getSamplesPerPixel(),o,g.getTileWidth(),g.getBlockHeight(n))),t.abrupt("return",e);case 7:case"end":return t.stop()}}),t)})))(),null!==h&&(h[u]=m)),t.t0=e,t.t1=n,t.t2=r,t.next=14,m;case 14:return t.t3=t.sent,t.abrupt("return",{x:t.t0,y:t.t1,sample:t.t2,data:t.t3});case 16:case"end":return t.stop()}}),t,this)})));return function(e,n,r,i,o){return t.apply(this,arguments)}}()},{key:"_readRaster",value:function(){var t=(0,o.default)(i.default.mark((function t(e,n,r,o,s,a,l,c,u){var h,f,p,g,v,y,b,_,x,w,M,S,E,T,C,A,P,L,R=this;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(h=this.getTileWidth(),f=this.getTileHeight(),p=Math.max(Math.floor(e[0]/h),0),g=Math.min(Math.ceil(e[2]/h),Math.ceil(this.getWidth()/this.getTileWidth())),v=Math.max(Math.floor(e[1]/f),0),y=Math.min(Math.ceil(e[3]/f),Math.ceil(this.getHeight()/this.getTileHeight())),b=e[2]-e[0],_=this.getBytesPerPixel(),x=[],w=[],M=0;M<n.length;++M)1===this.planarConfiguration?x.push(m(this.fileDirectory.BitsPerSample,0,n[M])/8):x.push(0),w.push(this.getReaderForSample(n[M]));for(S=[],E=this.littleEndian,T=v;T<y;++T)for(C=p;C<g;++C)for(A=function(t){var i=t,a=n[t];2===R.planarConfiguration&&(_=R.getSampleByteSize(t));var l=R.getTileOrStrip(C,T,a,s,u);S.push(l),l.then((function(t){for(var s=t.data,a=new DataView(s),l=R.getBlockHeight(t.y),c=t.y*f,u=t.x*h,d=c+l,p=(t.x+1)*h,m=w[i],g=Math.min(l,l-(d-e[3])),v=Math.min(h,h-(p-e[2])),y=Math.max(0,e[1]-c);y<g;++y)for(var M=Math.max(0,e[0]-u);M<v;++M){var S=(y*h+M)*_,T=m.call(a,S+x[i],E),C=void 0;o?(C=(y+c-e[1])*b*n.length+(M+u-e[0])*n.length+i,r[C]=T):(C=(y+c-e[1])*b+M+u-e[0],r[i][C]=T)}}))},P=0;P<n.length;++P)A(P);return t.next=16,Promise.all(S);case 16:if(!(a&&e[2]-e[0]!==a||l&&e[3]-e[1]!==l)){t.next=21;break}return(L=o?(0,d.resampleInterleaved)(r,e[2]-e[0],e[3]-e[1],a,l,n.length,c):(0,d.resample)(r,e[2]-e[0],e[3]-e[1],a,l,c)).width=a,L.height=l,t.abrupt("return",L);case 21:return r.width=a||e[2]-e[0],r.height=l||e[3]-e[1],t.abrupt("return",r);case 24:case"end":return t.stop()}}),t,this)})));return function(e,n,r,i,o,s,a,l,c){return t.apply(this,arguments)}}()},{key:"readRasters",value:function(){var t=(0,o.default)(i.default.mark((function t(){var e,n,r,o,s,a,l,c,u,h,d,p,m,v,y,b,_,x,w,M,S,E,T,C,A,P,L=arguments;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=L.length>0&&void 0!==L[0]?L[0]:{},n=e.window,r=e.samples,o=void 0===r?[]:r,s=e.interleave,a=e.pool,l=void 0===a?null:a,c=e.width,u=e.height,h=e.resampleMethod,d=e.fillValue,p=e.signal,!((m=n||[0,0,this.getWidth(),this.getHeight()])[0]>m[2]||m[1]>m[3])){t.next=4;break}throw new Error("Invalid subsets");case 4:if(v=m[2]-m[0],y=m[3]-m[1],b=v*y,_=this.getSamplesPerPixel(),o&&o.length){t.next=12;break}for(x=0;x<_;++x)o.push(x);t.next=19;break;case 12:w=0;case 13:if(!(w<o.length)){t.next=19;break}if(!(o[w]>=_)){t.next=16;break}return t.abrupt("return",Promise.reject(new RangeError("Invalid sample index '".concat(o[w],"'."))));case 16:++w,t.next=13;break;case 19:if(s)S=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,E=Math.max.apply(null,this.fileDirectory.BitsPerSample),M=g(S,E,b*o.length),d&&M.fill(d);else for(M=[],T=0;T<o.length;++T)C=this.getArrayForSample(o[T],b),Array.isArray(d)&&T<d.length?C.fill(d[T]):d&&!Array.isArray(d)&&C.fill(d),M.push(C);return A=l||(0,f.getDecoder)(this.fileDirectory),t.next=23,this._readRaster(m,o,M,s,A,c,u,h,p);case 23:return P=t.sent,t.abrupt("return",P);case 25:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"readRGB",value:function(){var t=(0,o.default)(i.default.mark((function t(){var e,n,r,o,s,a,l,c,f,d,p,m,g,v,y,b,_,x,w,M,S=arguments;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=S.length>0&&void 0!==S[0]?S[0]:{},n=e.window,r=e.pool,o=void 0===r?null:r,s=e.width,a=e.height,l=e.resampleMethod,c=e.enableAlpha,f=void 0!==c&&c,d=e.signal,!((p=n||[0,0,this.getWidth(),this.getHeight()])[0]>p[2]||p[1]>p[3])){t.next=4;break}throw new Error("Invalid subsets");case 4:if((m=this.fileDirectory.PhotometricInterpretation)!==u.photometricInterpretations.RGB){t.next=9;break}if(g=[0,1,2],this.fileDirectory.ExtraSamples!==u.ExtraSamplesValues.Unspecified&&f)for(g=[],v=0;v<this.fileDirectory.BitsPerSample.length;v+=1)g.push(v);return t.abrupt("return",this.readRasters({window:n,interleave:!0,samples:g,pool:o,width:s,height:a,resampleMethod:l,signal:d}));case 9:t.t0=m,t.next=t.t0===u.photometricInterpretations.WhiteIsZero||t.t0===u.photometricInterpretations.BlackIsZero||t.t0===u.photometricInterpretations.Palette?12:t.t0===u.photometricInterpretations.CMYK?14:t.t0===u.photometricInterpretations.YCbCr||t.t0===u.photometricInterpretations.CIELab?16:18;break;case 12:return y=[0],t.abrupt("break",19);case 14:return y=[0,1,2,3],t.abrupt("break",19);case 16:return y=[0,1,2],t.abrupt("break",19);case 18:throw new Error("Invalid or unsupported photometric interpretation.");case 19:return b={window:p,interleave:!0,samples:y,pool:o,width:s,height:a,resampleMethod:l,signal:d},_=this.fileDirectory,t.next=23,this.readRasters(b);case 23:x=t.sent,w=Math.pow(2,this.fileDirectory.BitsPerSample[0]),t.t1=m,t.next=t.t1===u.photometricInterpretations.WhiteIsZero?28:t.t1===u.photometricInterpretations.BlackIsZero?30:t.t1===u.photometricInterpretations.Palette?32:t.t1===u.photometricInterpretations.CMYK?34:t.t1===u.photometricInterpretations.YCbCr?36:t.t1===u.photometricInterpretations.CIELab?38:40;break;case 28:return M=(0,h.fromWhiteIsZero)(x,w),t.abrupt("break",41);case 30:return M=(0,h.fromBlackIsZero)(x,w),t.abrupt("break",41);case 32:return M=(0,h.fromPalette)(x,_.ColorMap),t.abrupt("break",41);case 34:return M=(0,h.fromCMYK)(x),t.abrupt("break",41);case 36:return M=(0,h.fromYCbCr)(x),t.abrupt("break",41);case 38:return M=(0,h.fromCIELab)(x),t.abrupt("break",41);case 40:throw new Error("Unsupported photometric interpretation.");case 41:return M.width=x.width,M.height=x.height,t.abrupt("return",M);case 44:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getTiePoints",value:function(){if(!this.fileDirectory.ModelTiepoint)return[];for(var t=[],e=0;e<this.fileDirectory.ModelTiepoint.length;e+=6)t.push({i:this.fileDirectory.ModelTiepoint[e],j:this.fileDirectory.ModelTiepoint[e+1],k:this.fileDirectory.ModelTiepoint[e+2],x:this.fileDirectory.ModelTiepoint[e+3],y:this.fileDirectory.ModelTiepoint[e+4],z:this.fileDirectory.ModelTiepoint[e+5]});return t}},{key:"getGDALMetadata",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={};if(!this.fileDirectory.GDAL_METADATA)return null;var n=this.fileDirectory.GDAL_METADATA,r=(0,c.default)(n.substring(0,n.length-1));if(!r[0].tagName)throw new Error("Failed to parse GDAL metadata XML.");var i=r[0];if("GDALMetadata"!==i.tagName)throw new Error("Unexpected GDAL metadata XML tag.");var o=i.children.filter((function(t){return"Item"===t.tagName}));null!==t&&(o=o.filter((function(e){return Number(e.attributes.sample)===t})));for(var s=0;s<o.length;++s){var a=o[s];e[a.attributes.name]=a.children[0]}return e}},{key:"getGDALNoData",value:function(){if(!this.fileDirectory.GDAL_NODATA)return null;var t=this.fileDirectory.GDAL_NODATA;return Number(t.substring(0,t.length-1))}},{key:"getOrigin",value:function(){var t=this.fileDirectory.ModelTiepoint,e=this.fileDirectory.ModelTransformation;if(t&&6===t.length)return[t[3],t[4],t[5]];if(e)return[e[3],e[7],e[11]];throw new Error("The image does not have an affine transformation.")}},{key:"getResolution",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.fileDirectory.ModelPixelScale,n=this.fileDirectory.ModelTransformation;if(e)return[e[0],-e[1],e[2]];if(n)return[n[0],n[5],n[10]];if(t){var i=t.getResolution(),o=(0,r.default)(i,3),s=o[0],a=o[1],l=o[2];return[s*t.getWidth()/this.getWidth(),a*t.getHeight()/this.getHeight(),l*t.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}},{key:"pixelIsArea",value:function(){return 1===this.geoKeys.GTRasterTypeGeoKey}},{key:"getBoundingBox",value:function(){var t=this.getOrigin(),e=this.getResolution(),n=t[0],r=t[1],i=n+e[0]*this.getWidth(),o=r+e[1]*this.getHeight();return[Math.min(n,i),Math.min(r,o),Math.max(n,i),Math.max(r,o)]}}]),t}();n.default=b},{"@babel/runtime/helpers/slicedToArray":"HETk","@babel/runtime/regenerator":"PMvg","@babel/runtime/helpers/asyncToGenerator":"agGE","@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW","@petamoriken/float16":"Stm8",txml:"JO74","./globals":"j27V","./rgb":"fpBl","./compression":"FGCZ","./resample":"OQju"}],dqpX:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=s(t("@babel/runtime/helpers/classCallCheck")),i=s(t("@babel/runtime/helpers/createClass")),o=t("@petamoriken/float16");function s(t){return t&&t.__esModule?t:{default:t}}var a=function(){function t(e){(0,r.default)(this,t),this._dataView=new DataView(e)}return(0,i.default)(t,[{key:"getUint64",value:function(t,e){var n,r=this.getUint32(t,e),i=this.getUint32(t+4,e);if(e){if(n=r+Math.pow(2,32)*i,!Number.isSafeInteger(n))throw new Error("".concat(n," exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues"));return n}if(n=Math.pow(2,32)*r+i,!Number.isSafeInteger(n))throw new Error("".concat(n," exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues"));return n}},{key:"getInt64",value:function(t,e){for(var n=0,r=(128&this._dataView.getUint8(t+(e?7:0)))>0,i=!0,o=0;o<8;o++){var s=this._dataView.getUint8(t+(e?o:7-o));r&&(i?0!==s&&(s=255&~(s-1),i=!1):s=255&~s),n+=s*Math.pow(256,o)}return r&&(n=-n),n}},{key:"getUint8",value:function(t,e){return this._dataView.getUint8(t,e)}},{key:"getInt8",value:function(t,e){return this._dataView.getInt8(t,e)}},{key:"getUint16",value:function(t,e){return this._dataView.getUint16(t,e)}},{key:"getInt16",value:function(t,e){return this._dataView.getInt16(t,e)}},{key:"getUint32",value:function(t,e){return this._dataView.getUint32(t,e)}},{key:"getInt32",value:function(t,e){return this._dataView.getInt32(t,e)}},{key:"getFloat16",value:function(t,e){return(0,o.getFloat16)(this._dataView,e)}},{key:"getFloat32",value:function(t,e){return this._dataView.getFloat32(t,e)}},{key:"getFloat64",value:function(t,e){return this._dataView.getFloat64(t,e)}},{key:"buffer",get:function(){return this._dataView.buffer}}]),t}();n.default=a},{"@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW","@petamoriken/float16":"Stm8"}],dGLV:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=o(t("@babel/runtime/helpers/classCallCheck")),i=o(t("@babel/runtime/helpers/createClass"));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(){function t(e,n,i,o){(0,r.default)(this,t),this._dataView=new DataView(e),this._sliceOffset=n,this._littleEndian=i,this._bigTiff=o}return(0,i.default)(t,[{key:"covers",value:function(t,e){return this.sliceOffset<=t&&this.sliceTop>=t+e}},{key:"readUint8",value:function(t){return this._dataView.getUint8(t-this._sliceOffset,this._littleEndian)}},{key:"readInt8",value:function(t){return this._dataView.getInt8(t-this._sliceOffset,this._littleEndian)}},{key:"readUint16",value:function(t){return this._dataView.getUint16(t-this._sliceOffset,this._littleEndian)}},{key:"readInt16",value:function(t){return this._dataView.getInt16(t-this._sliceOffset,this._littleEndian)}},{key:"readUint32",value:function(t){return this._dataView.getUint32(t-this._sliceOffset,this._littleEndian)}},{key:"readInt32",value:function(t){return this._dataView.getInt32(t-this._sliceOffset,this._littleEndian)}},{key:"readFloat32",value:function(t){return this._dataView.getFloat32(t-this._sliceOffset,this._littleEndian)}},{key:"readFloat64",value:function(t){return this._dataView.getFloat64(t-this._sliceOffset,this._littleEndian)}},{key:"readUint64",value:function(t){var e,n=this.readUint32(t),r=this.readUint32(t+4);if(this._littleEndian){if(e=n+Math.pow(2,32)*r,!Number.isSafeInteger(e))throw new Error("".concat(e," exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues"));return e}if(e=Math.pow(2,32)*n+r,!Number.isSafeInteger(e))throw new Error("".concat(e," exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues"));return e}},{key:"readInt64",value:function(t){for(var e=0,n=(128&this._dataView.getUint8(t+(this._littleEndian?7:0)))>0,r=!0,i=0;i<8;i++){var o=this._dataView.getUint8(t+(this._littleEndian?i:7-i));n&&(r?0!==o&&(o=255&~(o-1),r=!1):o=255&~o),e+=o*Math.pow(256,i)}return n&&(e=-e),e}},{key:"readOffset",value:function(t){return this._bigTiff?this.readUint64(t):this.readUint32(t)}},{key:"sliceOffset",get:function(){return this._sliceOffset}},{key:"sliceTop",get:function(){return this._sliceOffset+this.buffer.byteLength}},{key:"littleEndian",get:function(){return this._littleEndian}},{key:"bigTiff",get:function(){return this._bigTiff}},{key:"buffer",get:function(){return this._dataView.buffer}}]),t}();n.default=s},{"@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW"}],z2GM:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.extendSerializer=function(t,e){const n=t.deserialize.bind(t),r=t.serialize.bind(t);return{deserialize:t=>e.deserialize(t,n),serialize:t=>e.serialize(t,r)}},n.DefaultSerializer=void 0;const r={deserialize:t=>(t=>t&&"object"==typeof t&&"__error_marker"in t&&"$$error"===t.__error_marker)(t)?(t=>Object.assign(Error(t.message),{name:t.name,stack:t.stack}))(t):t,serialize:t=>t instanceof Error?(t=>({__error_marker:"$$error",message:t.message,name:t.name,stack:t.stack}))(t):t};n.DefaultSerializer=r},{}],kdjL:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.registerSerializer=function(t){i=(0,r.extendSerializer)(i,t)},n.deserialize=function(t){return i.deserialize(t)},n.serialize=function(t){return i.serialize(t)};var r=t("./serializers");let i=r.DefaultSerializer},{"./serializers":"z2GM"}],LQHy:[function(t,e,n){"use strict";let r;function i(t){return(""+t).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}Object.defineProperty(n,"__esModule",{value:!0}),n.getBaseURL=i,n.getBundleURL=function(){return r||(r=function(){try{throw new Error}catch(t){const e=(""+t.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(e)return i(e[0])}return"/"}()),r}},{}],XK2w:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.selectWorkerImplementation=function(){return"undefined"==typeof Worker?class{constructor(){throw Error("No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.")}}:class extends Worker{constructor(t,e){"string"==typeof t&&e&&e._baseURL?t=new URL(t,e._baseURL):"string"==typeof t&&!o(t)&&(0,r.getBundleURL)().match(/^file:\/\//i)&&(t=new URL(t,(0,r.getBundleURL)().replace(/\/[^\/]+$/,"/")),t=s(`importScripts(${JSON.stringify(t)});`)),"string"==typeof t&&o(t)&&(t=s(`importScripts(${JSON.stringify(t)});`)),super(t,e)}}},n.defaultPoolSize=void 0;var r=t("./get-bundle-url.browser");const i="undefined"!=typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:4;n.defaultPoolSize=i;const o=t=>/^(file|https?:)?\/\//i.test(t);function s(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}},{"./get-bundle-url.browser":"LQHy"}],IAgR:[function(t,e,n){var r=1e3,i=6e4,o=60*i,s=24*o;function a(t,e,n,r){var i=e>=1.5*n;return Math.round(t/n)+" "+r+(i?"s":"")}e.exports=function(t,e){e=e||{};var n=typeof t;if("string"===n&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"weeks":case"week":case"w":return 6048e5*n;case"days":case"day":case"d":return n*s;case"hours":case"hour":case"hrs":case"hr":case"h":return n*o;case"minutes":case"minute":case"mins":case"min":case"m":return n*i;case"seconds":case"second":case"secs":case"sec":case"s":return n*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(t);if("number"===n&&isFinite(t))return e.long?function(t){var e=Math.abs(t);return e>=s?a(t,e,s,"day"):e>=o?a(t,e,o,"hour"):e>=i?a(t,e,i,"minute"):e>=r?a(t,e,r,"second"):t+" ms"}(t):function(t){var e=Math.abs(t);return e>=s?Math.round(t/s)+"d":e>=o?Math.round(t/o)+"h":e>=i?Math.round(t/i)+"m":e>=r?Math.round(t/r)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},{}],Kest:[function(t,e,n){e.exports=function(e){function n(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return r.colors[Math.abs(e)%r.colors.length]}function r(t){let e;function s(...t){if(!s.enabled)return;const n=s,i=Number(new Date),o=i-(e||i);n.diff=o,n.prev=e,n.curr=i,e=i,t[0]=r.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let a=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(e,i)=>{if("%%"===e)return e;a++;const o=r.formatters[i];if("function"==typeof o){const r=t[a];e=o.call(n,r),t.splice(a,1),a--}return e}),r.formatArgs.call(n,t),(n.log||r.log).apply(n,t)}return s.namespace=t,s.enabled=r.enabled(t),s.useColors=r.useColors(),s.color=n(t),s.destroy=i,s.extend=o,"function"==typeof r.init&&r.init(s),r.instances.push(s),s}function i(){const t=r.instances.indexOf(this);return-1!==t&&(r.instances.splice(t,1),!0)}function o(t,e){const n=r(this.namespace+(void 0===e?":":e)+t);return n.log=this.log,n}function s(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(t){return t instanceof Error?t.stack||t.message:t},r.disable=function(){const t=[...r.names.map(s),...r.skips.map(s).map(t=>"-"+t)].join(",");return r.enable(""),t},r.enable=function(t){let e;r.save(t),r.names=[],r.skips=[];const n=("string"==typeof t?t:"").split(/[\s,]+/),i=n.length;for(e=0;e<i;e++)n[e]&&("-"===(t=n[e].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+t.substr(1)+"$")):r.names.push(new RegExp("^"+t+"$")));for(e=0;e<r.instances.length;e++){const t=r.instances[e];t.enabled=r.enabled(t.namespace)}},r.enabled=function(t){if("*"===t[t.length-1])return!0;let e,n;for(e=0,n=r.skips.length;e<n;e++)if(r.skips[e].test(t))return!1;for(e=0,n=r.names.length;e<n;e++)if(r.names[e].test(t))return!0;return!1},r.humanize=t("ms"),Object.keys(e).forEach(t=>{r[t]=e[t]}),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=n,r.enable(r.load()),r}},{ms:"IAgR"}],jcLW:[function(t,e,n){t("process");var r=t("process");n.log=function(...t){return"object"==typeof console&&console.log&&console.log(...t)},n.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(r++,"%c"===t&&(i=r))}),t.splice(i,0,n)},n.save=function(t){try{t?n.storage.setItem("debug",t):n.storage.removeItem("debug")}catch(t){}},n.load=function(){let t;try{t=n.storage.getItem("debug")}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=void 0),t},n.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},n.storage=function(){try{return localStorage}catch(t){}}(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=t("./common")(n);const{formatters:i}=e.exports;i.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},{"./common":"Kest",process:"pBGv"}],sfrJ:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AsyncSerialScheduler=void 0,n.AsyncSerialScheduler=class{constructor(t){this._baseObserver=t,this._pendingPromises=new Set}complete(){Promise.all(this._pendingPromises).then(()=>this._baseObserver.complete()).catch(t=>this._baseObserver.error(t))}error(t){this._baseObserver.error(t)}schedule(t){const e=Promise.all(this._pendingPromises),n=[],r=t=>n.push(t),i=Promise.resolve().then(()=>function(t,e,n,r){return new(n||(n=Promise))((function(e,i){function o(t){try{a(r.next(t))}catch(t){i(t)}}function s(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){t.done?e(t.value):new n((function(e){e(t.value)})).then(o,s)}a((r=r.apply(t,[])).next())}))}(this,0,void 0,(function*(){yield e,yield t(r),this._pendingPromises.delete(i);for(const t of n)this._baseObserver.next(t)}))).catch(t=>{this._pendingPromises.delete(i),this._baseObserver.error(t)});this._pendingPromises.add(i)}}},{}],lj3f:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.registerObservableSymbol=function(){r()&&!i("observable")&&(Symbol.observable=Symbol("observable"))},n.getSymbol=n.hasSymbol=n.hasSymbols=void 0;const r=()=>"function"==typeof Symbol;n.hasSymbols=r;const i=t=>r()&&Boolean(Symbol[t]);n.hasSymbol=i,n.getSymbol=t=>i(t)?Symbol[t]:"@@"+t,i("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"))},{}],B9l3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Observable=n.SubscriptionObserver=n.Subscription=void 0;var r=t("./_symbols");const i=(0,r.getSymbol)("iterator"),o=(0,r.getSymbol)("observable"),s=(0,r.getSymbol)("species");function a(t,e){const n=t[e];if(null!=n){if("function"!=typeof n)throw new TypeError(n+" is not a function");return n}}function l(t){let e=t.constructor;return void 0!==e&&null===(e=e[s])&&(e=void 0),void 0!==e?e:v}function c(t){c.log?c.log(t):setTimeout(()=>{throw t},0)}function u(t){Promise.resolve().then(()=>{try{t()}catch(t){c(t)}})}function h(t){const e=t._cleanup;if(void 0!==e&&(t._cleanup=void 0,e))try{if("function"==typeof e)e();else{const t=a(e,"unsubscribe");t&&t.call(e)}}catch(t){c(t)}}function f(t){t._observer=void 0,t._queue=void 0,t._state="closed"}function d(t,e,n){t._state="running";const r=t._observer;try{const i=r?a(r,e):void 0;switch(e){case"next":i&&i.call(r,n);break;case"error":if(f(t),!i)throw n;i.call(r,n);break;case"complete":f(t),i&&i.call(r)}}catch(t){c(t)}"closed"===t._state?h(t):"running"===t._state&&(t._state="ready")}function p(t,e,n){if("closed"!==t._state)return"buffering"===t._state?(t._queue=t._queue||[],void t._queue.push({type:e,value:n})):"ready"!==t._state?(t._state="buffering",t._queue=[{type:e,value:n}],void u(()=>function(t){const e=t._queue;if(e){t._queue=void 0,t._state="ready";for(const n of e)if(d(t,n.type,n.value),"closed"===t._state)break}}(t))):void d(t,e,n)}class m{constructor(t,e){this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";const n=new g(this);try{this._cleanup=e.call(void 0,n)}catch(t){n.error(t)}"initializing"===this._state&&(this._state="ready")}get closed(){return"closed"===this._state}unsubscribe(){"closed"!==this._state&&(f(this),h(this))}}n.Subscription=m;class g{constructor(t){this._subscription=t}get closed(){return"closed"===this._subscription._state}next(t){p(this._subscription,"next",t)}error(t){p(this._subscription,"error",t)}complete(){p(this._subscription,"complete")}}n.SubscriptionObserver=g;class v{constructor(t){if(!(this instanceof v))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof t)throw new TypeError("Observable initializer must be a function");this._subscriber=t}subscribe(t,e,n){return"object"==typeof t&&null!==t||(t={next:t,error:e,complete:n}),new m(t,this._subscriber)}pipe(t,...e){let n=this;for(const r of[t,...e])n=r(n);return n}tap(t,e,n){const r="object"!=typeof t||null===t?{next:t,error:e,complete:n}:t;return new v(t=>this.subscribe({next(e){r.next&&r.next(e),t.next(e)},error(e){r.error&&r.error(e),t.error(e)},complete(){r.complete&&r.complete(),t.complete()},start(t){r.start&&r.start(t)}}))}forEach(t){return new Promise((e,n)=>{if("function"!=typeof t)return void n(new TypeError(t+" is not a function"));function r(){i.unsubscribe(),e()}const i=this.subscribe({next(e){try{t(e,r)}catch(t){n(t),i.unsubscribe()}},error:n,complete:e})})}map(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return new(l(this))(e=>this.subscribe({next(n){let r=n;try{r=t(n)}catch(t){return e.error(t)}e.next(r)},error(t){e.error(t)},complete(){e.complete()}}))}filter(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return new(l(this))(e=>this.subscribe({next(n){try{if(!t(n))return}catch(t){return e.error(t)}e.next(n)},error(t){e.error(t)},complete(){e.complete()}}))}reduce(t,e){if("function"!=typeof t)throw new TypeError(t+" is not a function");const n=l(this),r=arguments.length>1;let i=!1,o=e;return new n(e=>this.subscribe({next(n){const s=!i;if(i=!0,!s||r)try{o=t(o,n)}catch(t){return e.error(t)}else o=n},error(t){e.error(t)},complete(){if(!i&&!r)return e.error(new TypeError("Cannot reduce an empty sequence"));e.next(o),e.complete()}}))}concat(...t){const e=l(this);return new e(n=>{let r,i=0;return function o(s){r=s.subscribe({next(t){n.next(t)},error(t){n.error(t)},complete(){i===t.length?(r=void 0,n.complete()):o(e.from(t[i++]))}})}(this),()=>{r&&(r.unsubscribe(),r=void 0)}})}flatMap(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");const e=l(this);return new e(n=>{const r=[],i=this.subscribe({next(i){let s;if(t)try{s=t(i)}catch(t){return n.error(t)}else s=i;const a=e.from(s).subscribe({next(t){n.next(t)},error(t){n.error(t)},complete(){const t=r.indexOf(a);t>=0&&r.splice(t,1),o()}});r.push(a)},error(t){n.error(t)},complete(){o()}});function o(){i.closed&&0===r.length&&n.complete()}return()=>{r.forEach(t=>t.unsubscribe()),i.unsubscribe()}})}[o](){return this}static from(t){const e="function"==typeof this?this:v;if(null==t)throw new TypeError(t+" is not an object");const n=a(t,o);if(n){const r=n.call(t);if(Object(r)!==r)throw new TypeError(r+" is not an object");return function(t){return t instanceof v}(r)&&r.constructor===e?r:new e(t=>r.subscribe(t))}if((0,r.hasSymbol)("iterator")){const n=a(t,i);if(n)return new e(e=>{u(()=>{if(!e.closed){for(const r of n.call(t))if(e.next(r),e.closed)return;e.complete()}})})}if(Array.isArray(t))return new e(e=>{u(()=>{if(!e.closed){for(const n of t)if(e.next(n),e.closed)return;e.complete()}})});throw new TypeError(t+" is not observable")}static of(...t){return new("function"==typeof this?this:v)(e=>{u(()=>{if(!e.closed){for(const n of t)if(e.next(n),e.closed)return;e.complete()}})})}static get[s](){return this}}n.Observable=v,(0,r.hasSymbols)()&&Object.defineProperty(v,Symbol("extensions"),{value:{symbol:o,hostReportError:c},configurable:!0});var y=v;n.default=y},{"./_symbols":"lj3f"}],QC75:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(t){"function"==typeof t?t():t&&"function"==typeof t.unsubscribe&&t.unsubscribe()}},{}],apmd:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=t("./_scheduler"),i=s(t("./observable")),o=s(t("./unsubscribe"));function s(t){return t&&t.__esModule?t:{default:t}}n.default=function(t){return e=>new i.default(n=>{const i=new r.AsyncSerialScheduler(n),s=e.subscribe({complete(){i.complete()},error(t){i.error(t)},next(e){i.schedule(n=>function(t,e,n,r){return new(n||(n=Promise))((function(e,i){function o(t){try{a(r.next(t))}catch(t){i(t)}}function s(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){t.done?e(t.value):new n((function(e){e(t.value)})).then(o,s)}a((r=r.apply(t,[])).next())}))}(this,0,void 0,(function*(){(yield t(e))&&n(e)})))}});return()=>(0,o.default)(s)})}},{"./_scheduler":"sfrJ","./observable":"B9l3","./unsubscribe":"QC75"}],FgiE:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isAsyncIterator=function(t){return t&&(0,r.hasSymbol)("asyncIterator")&&t[Symbol.asyncIterator]},n.isIterator=function(t){return t&&(0,r.hasSymbol)("iterator")&&t[Symbol.iterator]};var r=t("./_symbols")},{"./_symbols":"lj3f"}],ltny:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=t("./_scheduler"),i=t("./_util"),o=a(t("./observable")),s=a(t("./unsubscribe"));function a(t){return t&&t.__esModule?t:{default:t}}n.default=function(t){return e=>new o.default(n=>{const o=new r.AsyncSerialScheduler(n),a=e.subscribe({complete(){o.complete()},error(t){o.error(t)},next(e){o.schedule(n=>function(t,e,n,r){return new(n||(n=Promise))((function(e,i){function o(t){try{a(r.next(t))}catch(t){i(t)}}function s(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){t.done?e(t.value):new n((function(e){e(t.value)})).then(o,s)}a((r=r.apply(t,[])).next())}))}(this,0,void 0,(function*(){var r,o;const s=yield t(e);if((0,i.isIterator)(s)||(0,i.isAsyncIterator)(s))try{for(var a,l=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}}(s);!(a=yield l.next()).done;){const t=a.value;n(t)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(o=l.return)&&(yield o.call(l))}finally{if(r)throw r.error}}else s.map(t=>n(t))})))}});return()=>(0,s.default)(a)})}},{"./_scheduler":"sfrJ","./_util":"FgiE","./observable":"B9l3","./unsubscribe":"QC75"}],jAhG:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){return new r.Observable(e=>{let n=0;const r=setInterval(()=>{e.next(n++)},t);return()=>clearInterval(r)})};var r=t("./observable")},{"./observable":"B9l3"}],aP59:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=t("./_scheduler"),i=s(t("./observable")),o=s(t("./unsubscribe"));function s(t){return t&&t.__esModule?t:{default:t}}n.default=function(t){return e=>new i.default(n=>{const i=new r.AsyncSerialScheduler(n),s=e.subscribe({complete(){i.complete()},error(t){i.error(t)},next(e){i.schedule(n=>function(t,e,n,r){return new(n||(n=Promise))((function(e,i){function o(t){try{a(r.next(t))}catch(t){i(t)}}function s(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){t.done?e(t.value):new n((function(e){e(t.value)})).then(o,s)}a((r=r.apply(t,[])).next())}))}(this,0,void 0,(function*(){const r=yield t(e);n(r)})))}});return()=>(0,o.default)(s)})}},{"./_scheduler":"sfrJ","./observable":"B9l3","./unsubscribe":"QC75"}],Rg1v:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=t("./observable"),i=function(t){return t&&t.__esModule?t:{default:t}}(t("./unsubscribe"));n.default=function(...t){return 0===t.length?r.Observable.from([]):new r.Observable(e=>{let n=0;const r=t.map(r=>r.subscribe({error(t){e.error(t),o()},next(t){e.next(t)},complete(){++n===t.length&&(e.complete(),o())}})),o=()=>{r.forEach(t=>(0,i.default)(t))};return o})}},{"./observable":"B9l3","./unsubscribe":"QC75"}],wtHd:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./observable"));class i extends r.default{constructor(){super(t=>(this._observers.add(t),()=>this._observers.delete(t))),this._observers=new Set}next(t){for(const e of this._observers)e.next(t)}error(t){for(const e of this._observers)e.error(t)}complete(){for(const t of this._observers)t.complete()}}var o=i;n.default=o},{"./observable":"B9l3"}],NgdC:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=s(t("./observable")),i=s(t("./subject")),o=s(t("./unsubscribe"));function s(t){return t&&t.__esModule?t:{default:t}}n.default=function(t){const e=new i.default;let n,s=0;return new r.default(r=>{n||(n=t.subscribe(e));const i=e.subscribe(r);return s++,()=>{s--,i.unsubscribe(),0===s&&((0,o.default)(n),n=void 0)}})}},{"./observable":"B9l3","./subject":"wtHd","./unsubscribe":"QC75"}],b7o0:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=t("./_scheduler"),i=s(t("./observable")),o=s(t("./unsubscribe"));function s(t){return t&&t.__esModule?t:{default:t}}n.default=function(t,e){return n=>new i.default(i=>{let s,a=0;const l=new r.AsyncSerialScheduler(i),c=n.subscribe({complete(){l.complete()},error(t){l.error(t)},next(n){l.schedule(r=>function(t,e,n,r){return new(n||(n=Promise))((function(e,i){function o(t){try{a(r.next(t))}catch(t){i(t)}}function s(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){t.done?e(t.value):new n((function(e){e(t.value)})).then(o,s)}a((r=r.apply(t,[])).next())}))}(this,0,void 0,(function*(){const i=0===a?void 0===e?n:e:s;s=yield t(i,n,a++),r(s)})))}});return()=>(0,o.default)(c)})}},{"./_scheduler":"sfrJ","./observable":"B9l3","./unsubscribe":"QC75"}],cyO3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"filter",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"flatMap",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"interval",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(n,"map",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"merge",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"multicast",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(n,"Observable",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(n,"scan",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(n,"Subject",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(n,"unsubscribe",{enumerable:!0,get:function(){return f.default}});var r=d(t("./filter")),i=d(t("./flatMap")),o=d(t("./interval")),s=d(t("./map")),a=d(t("./merge")),l=d(t("./multicast")),c=d(t("./observable")),u=d(t("./scan")),h=d(t("./subject")),f=d(t("./unsubscribe"));function d(t){return t&&t.__esModule?t:{default:t}}},{"./filter":"apmd","./flatMap":"ltny","./interval":"jAhG","./map":"aP59","./merge":"Rg1v","./multicast":"NgdC","./observable":"B9l3","./scan":"b7o0","./subject":"wtHd","./unsubscribe":"QC75"}],vpgy:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.allSettled=function(t){return Promise.all(t.map(t=>{const e=t=>({status:"fulfilled",value:t}),n=t=>({status:"rejected",reason:t}),r=Promise.resolve(t);try{return r.then(e,n)}catch(t){return Promise.reject(t)}}))}},{}],UYCO:[function(t,e,n){"use strict";var r;Object.defineProperty(n,"__esModule",{value:!0}),n.PoolEventType=void 0,n.PoolEventType=r,function(t){t.initialized="initialized",t.taskCanceled="taskCanceled",t.taskCompleted="taskCompleted",t.taskFailed="taskFailed",t.taskQueued="taskQueued",t.taskQueueDrained="taskQueueDrained",t.taskStart="taskStart",t.terminated="terminated"}(r||(n.PoolEventType=r={}))},{}],fmdM:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.$worker=n.$transferable=n.$terminate=n.$events=n.$errors=void 0;const r=Symbol("thread.errors");n.$errors=r;const i=Symbol("thread.events");n.$events=i;const o=Symbol("thread.terminate");n.$terminate=o;const s=Symbol("thread.transferable");n.$transferable=s;const a=Symbol("thread.worker");n.$worker=a},{}],LBuu:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Thread=void 0;var r=t("../symbols");function i(t){throw Error(t)}const o={errors:t=>t[r.$errors]||i("Error observable not found. Make sure to pass a thread instance as returned by the spawn() promise."),events:t=>t[r.$events]||i("Events observable not found. Make sure to pass a thread instance as returned by the spawn() promise."),terminate:t=>t[r.$terminate]()};n.Thread=o},{"../symbols":"fmdM"}],EB3M:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"PoolEventType",{enumerable:!0,get:function(){return a.PoolEventType}}),Object.defineProperty(n,"Thread",{enumerable:!0,get:function(){return l.Thread}}),n.Pool=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("debug")),i=t("observable-fns"),o=t("../ponyfills"),s=t("./implementation"),a=t("./pool-types"),l=t("./thread"),c=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};let u=1;class h{constructor(t,e){this.eventSubject=new i.Subject,this.initErrors=[],this.isClosing=!1,this.nextTaskID=1,this.taskQueue=[];const n="number"==typeof e?{size:e}:e||{},{size:o=s.defaultPoolSize}=n;this.debug=(0,r.default)("threads:pool:"+function(t){return t.replace(/\W/g," ").trim().replace(/\s+/g,"-")}(n.name||String(u++))),this.options=n,this.workers=function(t,e){return function(t){const e=[];for(let n=0;n<t;n++)e.push(n);return e}(e).map(()=>({init:t(),runningTasks:[]}))}(t,o),this.eventObservable=(0,i.multicast)(i.Observable.from(this.eventSubject)),Promise.all(this.workers.map(t=>t.init)).then(()=>this.eventSubject.next({type:a.PoolEventType.initialized,size:this.workers.length}),t=>{this.debug("Error while initializing pool worker:",t),this.eventSubject.error(t),this.initErrors.push(t)})}findIdlingWorker(){const{concurrency:t=1}=this.options;return this.workers.find(e=>e.runningTasks.length<t)}runPoolTask(t,e){return c(this,void 0,void 0,(function*(){const n=this.workers.indexOf(t)+1;this.debug(`Running task #${e.id} on worker #${n}...`),this.eventSubject.next({type:a.PoolEventType.taskStart,taskID:e.id,workerID:n});try{const r=yield e.run(yield t.init);this.debug(`Task #${e.id} completed successfully`),this.eventSubject.next({type:a.PoolEventType.taskCompleted,returnValue:r,taskID:e.id,workerID:n})}catch(t){this.debug(`Task #${e.id} failed`),this.eventSubject.next({type:a.PoolEventType.taskFailed,taskID:e.id,error:t,workerID:n})}}))}run(t,e){return c(this,void 0,void 0,(function*(){const n=(()=>c(this,void 0,void 0,(function*(){yield new Promise(t=>setTimeout(t,0));try{yield this.runPoolTask(t,e)}finally{t.runningTasks=t.runningTasks.filter(t=>t!==n),this.isClosing||this.scheduleWork()}})))();t.runningTasks.push(n)}))}scheduleWork(){this.debug("Attempt de-queueing a task in order to run it...");const t=this.findIdlingWorker();if(!t)return;const e=this.taskQueue.shift();if(!e)return this.debug("Task queue is empty"),void this.eventSubject.next({type:a.PoolEventType.taskQueueDrained});this.run(t,e)}taskCompletion(t){return new Promise((e,n)=>{const r=this.events().subscribe(i=>{i.type===a.PoolEventType.taskCompleted&&i.taskID===t?(r.unsubscribe(),e(i.returnValue)):i.type===a.PoolEventType.taskFailed&&i.taskID===t?(r.unsubscribe(),n(i.error)):i.type===a.PoolEventType.terminated&&(r.unsubscribe(),n(Error("Pool has been terminated before task was run.")))})})}settled(t=!1){return c(this,void 0,void 0,(function*(){const e=()=>function(t,e){return t.reduce((t,n)=>[...t,...e(n)],[])}(this.workers,t=>t.runningTasks),n=[],r=this.eventObservable.subscribe(t=>{t.type===a.PoolEventType.taskFailed&&n.push(t.error)});return this.initErrors.length>0?Promise.reject(this.initErrors[0]):t&&0===this.taskQueue.length?(yield(0,o.allSettled)(e()),n):(yield new Promise((t,e)=>{const n=this.eventObservable.subscribe({next(e){e.type===a.PoolEventType.taskQueueDrained&&(n.unsubscribe(),t())},error:e})}),yield(0,o.allSettled)(e()),r.unsubscribe(),n)}))}completed(t=!1){return c(this,void 0,void 0,(function*(){const e=this.settled(t),n=new Promise((t,n)=>{const r=this.eventObservable.subscribe({next(i){i.type===a.PoolEventType.taskQueueDrained?(r.unsubscribe(),t(e)):i.type===a.PoolEventType.taskFailed&&(r.unsubscribe(),n(i.error))},error:n})}),r=yield Promise.race([e,n]);if(r.length>0)throw r[0]}))}events(){return this.eventObservable}queue(t){const{maxQueuedJobs:e=1/0}=this.options;if(this.isClosing)throw Error("Cannot schedule pool tasks after terminate() has been called.");if(this.initErrors.length>0)throw this.initErrors[0];const n=()=>this.taskCompletion(i.id);let r;const i={id:this.nextTaskID++,run:t,cancel:()=>{-1!==this.taskQueue.indexOf(i)&&(this.taskQueue=this.taskQueue.filter(t=>t!==i),this.eventSubject.next({type:a.PoolEventType.taskCanceled,taskID:i.id}))},get then(){if(!r){const t=n();r=t.then.bind(t)}return r}};if(this.taskQueue.length>=e)throw Error("Maximum number of pool tasks queued. Refusing to queue another one.\nThis usually happens for one of two reasons: We are either at peak workload right now or some tasks just won't finish, thus blocking the pool.");return this.debug(`Queueing task #${i.id}...`),this.taskQueue.push(i),this.eventSubject.next({type:a.PoolEventType.taskQueued,taskID:i.id}),this.scheduleWork(),i}terminate(t){return c(this,void 0,void 0,(function*(){this.isClosing=!0,t||(yield this.completed(!0)),this.eventSubject.next({type:a.PoolEventType.terminated,remainingQueue:[...this.taskQueue]}),this.eventSubject.complete(),yield Promise.all(this.workers.map(t=>c(this,void 0,void 0,(function*(){return l.Thread.terminate(yield t.init)}))))}))}}function f(t,e){return new h(t,e)}h.EventType=a.PoolEventType,f.EventType=a.PoolEventType;const d=f;n.Pool=d},{debug:"jcLW","observable-fns":"cyO3","../ponyfills":"vpgy","./implementation":"XK2w","./pool-types":"UYCO","./thread":"LBuu"}],PRGP:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createPromiseWithResolver=function(){let t,e=!1,n=r;return[new Promise(r=>{e?r(t):n=r}),r=>{e=!0,t=r,n()}]};const r=()=>{}},{}],ZLGT:[function(t,e,n){"use strict";var r;Object.defineProperty(n,"__esModule",{value:!0}),n.WorkerEventType=void 0,t("../symbols"),n.WorkerEventType=r,function(t){t.internalError="internalError",t.message="message",t.termination="termination"}(r||(n.WorkerEventType=r={}))},{"../symbols":"fmdM"}],zXl4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ObservablePromise=void 0;var r=t("observable-fns");const i=()=>{},o=t=>t,s=t=>Promise.resolve().then(t);function a(t){throw t}class l extends r.Observable{constructor(t){super(e=>{const n=this,r=Object.assign(Object.assign({},e),{complete(){e.complete(),n.onCompletion()},error(t){e.error(t),n.onError(t)},next(t){e.next(t),n.onNext(t)}});try{return this.initHasRun=!0,t(r)}catch(t){r.error(t)}}),this.initHasRun=!1,this.fulfillmentCallbacks=[],this.rejectionCallbacks=[],this.firstValueSet=!1,this.state="pending"}onNext(t){this.firstValueSet||(this.firstValue=t,this.firstValueSet=!0)}onError(t){this.state="rejected",this.rejection=t;for(const e of this.rejectionCallbacks)s(()=>e(t))}onCompletion(){this.state="fulfilled";for(const t of this.fulfillmentCallbacks)s(()=>t(this.firstValue))}then(t,e){const n=t||o,r=e||a;let i=!1;return new Promise((t,e)=>{const o=n=>{if(!i){i=!0;try{t(r(n))}catch(t){e(t)}}};return this.initHasRun||this.subscribe({error:o}),"fulfilled"===this.state?t(n(this.firstValue)):"rejected"===this.state?(i=!0,t(r(this.rejection))):(this.fulfillmentCallbacks.push(e=>{try{t(n(e))}catch(t){o(t)}}),void this.rejectionCallbacks.push(o))})}catch(t){return this.then(void 0,t)}finally(t){const e=t||i;return this.then(t=>(e(),t),()=>e())}static from(t){return function(t){return t&&"function"==typeof t.then}(t)?new l(e=>{t.then(t=>{e.next(t),e.complete()},t=>{e.error(t)})}):super.from(t)}}n.ObservablePromise=l},{"observable-fns":"cyO3"}],qW1u:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isTransferDescriptor=function(t){return t&&"object"==typeof t&&t[r.$transferable]},n.Transfer=function(t,e){if(!e){if(!function(t){return!(!t||"object"!=typeof t)}(t))throw Error();e=[t]}return{[r.$transferable]:!0,send:t,transferables:e}};var r=t("./symbols")},{"./symbols":"fmdM"}],fUdt:[function(t,e,n){"use strict";var r,i;Object.defineProperty(n,"__esModule",{value:!0}),n.WorkerMessageType=n.MasterMessageType=void 0,n.MasterMessageType=r,function(t){t.run="run"}(r||(n.MasterMessageType=r={})),n.WorkerMessageType=i,function(t){t.error="error",t.init="init",t.result="result",t.running="running",t.uncaughtError="uncaughtError"}(i||(n.WorkerMessageType=i={}))},{}],iMbm:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createProxyFunction=p,n.createProxyModule=function(t,e){const n={};for(const r of e)n[r]=p(t,r);return n};var r=function(t){return t&&t.__esModule?t:{default:t}}(t("debug")),i=t("observable-fns"),o=t("../common"),s=t("../observable-promise"),a=t("../transferable"),l=t("../types/messages");const c=(0,r.default)("threads:master:messages");let u=1;const h=t=>Array.from(new Set(t));function f(t,e){return new i.Observable(n=>{let r;const i=s=>{if(c("Message from worker:",s.data),s.data&&s.data.uid===e)if((t=>t&&t.type===l.WorkerMessageType.running)(s.data))r=s.data.resultType;else if((t=>t&&t.type===l.WorkerMessageType.result)(s.data))"promise"===r?(void 0!==s.data.payload&&n.next((0,o.deserialize)(s.data.payload)),n.complete(),t.removeEventListener("message",i)):(s.data.payload&&n.next((0,o.deserialize)(s.data.payload)),s.data.complete&&(n.complete(),t.removeEventListener("message",i)));else if((t=>t&&t.type===l.WorkerMessageType.error)(s.data)){const e=(0,o.deserialize)(s.data.error);n.error(e),t.removeEventListener("message",i)}};return t.addEventListener("message",i),()=>t.removeEventListener("message",i)})}function d(t){if(0===t.length)return{args:[],transferables:[]};const e=[],n=[];for(const r of t)(0,a.isTransferDescriptor)(r)?(e.push((0,o.serialize)(r.send)),n.push(...r.transferables)):e.push((0,o.serialize)(r));return{args:e,transferables:0===n.length?n:h(n)}}function p(t,e){return(...n)=>{const r=u++,{args:o,transferables:a}=d(n),h={type:l.MasterMessageType.run,uid:r,method:e,args:o};c("Sending command to run function to worker:",h);try{t.postMessage(h,a)}catch(t){return s.ObservablePromise.from(Promise.reject(t))}return s.ObservablePromise.from((0,i.multicast)(f(t,r)))}}},{debug:"jcLW","observable-fns":"cyO3","../common":"kdjL","../observable-promise":"zXl4","../transferable":"qW1u","../types/messages":"fUdt"}],a83E:[function(t,e,n){t("process"),t("process"),Object.defineProperty(n,"__esModule",{value:!0}),n.spawn=function(t,e){return u(this,void 0,void 0,(function*(){f("Initializing new thread");const n=(yield function(t,e,n){return u(this,void 0,void 0,(function*(){let n;const r=new Promise((t,r)=>{n=setTimeout(()=>r(Error("Timeout: Did not receive an init message from worker after 10000ms. Make sure the worker calls expose().")),e)}),i=yield Promise.race([t,r]);return clearTimeout(n),i}))}(p(t),e&&e.timeout?e.timeout:1e4)).exposed,{termination:r,terminate:i}=function(t){const[e,n]=(0,s.createPromiseWithResolver)();return{terminate:()=>u(this,void 0,void 0,(function*(){d("Terminating worker"),yield t.terminate(),n()})),termination:e}}(t),o=m(t,r);if("function"===n.type)return g((0,c.createProxyFunction)(t),t,o,i);if("module"===n.type)return g((0,c.createProxyModule)(t,n.methods),t,o,i);{const t=n.type;throw Error("Worker init message states unexpected type of expose(): "+t)}}))};var r=function(t){return t&&t.__esModule?t:{default:t}}(t("debug")),i=t("observable-fns"),o=t("../common"),s=t("../promise"),a=t("../symbols"),l=t("../types/master"),c=t("./invocation-proxy"),u=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};const h=(0,r.default)("threads:master:messages"),f=(0,r.default)("threads:master:spawn"),d=(0,r.default)("threads:master:thread-utils");function p(t){return new Promise((e,n)=>{const r=i=>{h("Message from worker before finishing initialization:",i.data),(t=>t&&"init"===t.type)(i.data)?(t.removeEventListener("message",r),e(i.data)):(t=>t&&"uncaughtError"===t.type)(i.data)&&(t.removeEventListener("message",r),n((0,o.deserialize)(i.data.error)))};t.addEventListener("message",r)})}function m(t,e){return new i.Observable(n=>{const r=t=>{const e={type:l.WorkerEventType.message,data:t.data};n.next(e)},i=t=>{d("Unhandled promise rejection event in thread:",t);const e={type:l.WorkerEventType.internalError,error:Error(t.reason)};n.next(e)};t.addEventListener("message",r),t.addEventListener("unhandledrejection",i),e.then(()=>{const e={type:l.WorkerEventType.termination};t.removeEventListener("message",r),t.removeEventListener("unhandledrejection",i),n.next(e),n.complete()})})}function g(t,e,n,r){const i=n.filter(t=>t.type===l.WorkerEventType.internalError).map(t=>t.error);return Object.assign(t,{[a.$errors]:i,[a.$events]:n,[a.$terminate]:r,[a.$worker]:e})}},{debug:"jcLW","observable-fns":"cyO3","../common":"kdjL","../promise":"PRGP","../symbols":"fmdM","../types/master":"ZLGT","./invocation-proxy":"iMbm",process:"pBGv"}],HfK0:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Pool",{enumerable:!0,get:function(){return i.Pool}}),Object.defineProperty(n,"spawn",{enumerable:!0,get:function(){return o.spawn}}),Object.defineProperty(n,"Thread",{enumerable:!0,get:function(){return s.Thread}}),n.Worker=void 0;var r=t("./implementation"),i=t("./pool"),o=t("./spawn"),s=t("./thread");const a=(0,r.selectWorkerImplementation)();n.Worker=a},{"./implementation":"XK2w","./pool":"EB3M","./spawn":"a83E","./thread":"LBuu"}],JZ8d:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){var e,n=t.Symbol;return"function"==typeof n?n.observable?e=n.observable:(e=n("observable"),n.observable=e):e="@@observable",e}},{}],LkZ7:[function(t,e,n){var r=arguments[3];Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,o=s(t("./ponyfill.js"));function s(t){return t&&t.__esModule?t:{default:t}}i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r?r:void 0!==e?e:Function("return this")();var a=(0,o.default)(i),l=a;n.default=l},{"./ponyfill.js":"JZ8d"}],UALh:[function(t,e,n){"use strict";const r=t("symbol-observable").default;e.exports=t=>Boolean(t&&t[r]&&t===t[r]())},{"symbol-observable":"LkZ7"}],AZa4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r={isWorkerRuntime:function(){return!("undefined"==typeof self||!self.postMessage)},postMessageToMaster:function(t,e){self.postMessage(t,e)},subscribeToMasterMessages:function(t){const e=e=>{t(e.data)};return self.addEventListener("message",e),()=>{self.removeEventListener("message",e)}}};n.default=r},{}],l5pR:[function(t,e,n){t("process");var r=t("process");Object.defineProperty(n,"__esModule",{value:!0}),n.expose=function(t){if(!l.default.isWorkerRuntime())throw Error("expose() called in the master thread.");if(u)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(u=!0,"function"==typeof t)l.default.subscribeToMasterMessages(e=>{h(e)&&!e.method&&v(e.uid,t,e.args.map(o.deserialize))}),function(){const t={type:a.WorkerMessageType.init,exposed:{type:"function"}};l.default.postMessageToMaster(t)}();else{if("object"!=typeof t||!t)throw Error("Invalid argument passed to expose(). Expected a function or an object, got: "+t);l.default.subscribeToMasterMessages(e=>{h(e)&&e.method&&v(e.uid,t[e.method],e.args.map(o.deserialize))}),function(t){const e={type:a.WorkerMessageType.init,exposed:{type:"module",methods:t}};l.default.postMessageToMaster(e)}(Object.keys(t).filter(e=>"function"==typeof t[e]))}},Object.defineProperty(n,"registerSerializer",{enumerable:!0,get:function(){return o.registerSerializer}}),Object.defineProperty(n,"Transfer",{enumerable:!0,get:function(){return s.Transfer}});var i=c(t("is-observable")),o=t("../common"),s=t("../transferable"),a=t("../types/messages"),l=c(t("./implementation"));function c(t){return t&&t.__esModule?t:{default:t}}let u=!1;const h=t=>t&&t.type===a.MasterMessageType.run,f=t=>(0,i.default)(t)||function(t){return t&&"object"==typeof t&&"function"==typeof t.subscribe}(t);function d(t){return(0,s.isTransferDescriptor)(t)?{payload:t.send,transferables:t.transferables}:{payload:t,transferables:void 0}}function p(t,e){const{payload:n,transferables:r}=d(e),i={type:a.WorkerMessageType.error,uid:t,error:(0,o.serialize)(n)};l.default.postMessageToMaster(i,r)}function m(t,e,n){const{payload:r,transferables:i}=d(n),o={type:a.WorkerMessageType.result,uid:t,complete:!!e||void 0,payload:r};l.default.postMessageToMaster(o,i)}function g(t){try{const e={type:a.WorkerMessageType.uncaughtError,error:(0,o.serialize)(t)};l.default.postMessageToMaster(e)}catch(e){console.error("Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.\nLatest error:",e,"\nOriginal error:",t)}}function v(t,e,n){return function(t,e,n,r){return new(n||(n=Promise))((function(e,i){function o(t){try{a(r.next(t))}catch(t){i(t)}}function s(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(t){t(r)}))).then(o,s)}a((r=r.apply(t,[])).next())}))}(this,0,void 0,(function*(){let r;try{r=e(...n)}catch(e){return p(t,e)}const i=f(r)?"observable":"promise";if(function(t,e){const n={type:a.WorkerMessageType.running,uid:t,resultType:e};l.default.postMessageToMaster(n)}(t,i),f(r))r.subscribe(e=>m(t,!1,(0,o.serialize)(e)),e=>p(t,(0,o.serialize)(e)),()=>m(t,!0));else try{const e=yield r;m(t,!0,(0,o.serialize)(e))}catch(e){p(t,(0,o.serialize)(e))}}))}"undefined"!=typeof self&&"function"==typeof self.addEventListener&&l.default.isWorkerRuntime()&&(self.addEventListener("error",t=>{setTimeout(()=>g(t.error||t),250)}),self.addEventListener("unhandledrejection",t=>{const e=t.reason;e&&"string"==typeof e.message&&setTimeout(()=>g(e),250)})),void 0!==r&&"function"==typeof r.on&&l.default.isWorkerRuntime()&&(r.on("uncaughtException",t=>{setTimeout(()=>g(t),250)}),r.on("unhandledRejection",t=>{t&&"string"==typeof t.message&&setTimeout(()=>g(t),250)}))},{"is-observable":"UALh","../common":"kdjL","../transferable":"qW1u","../types/messages":"fUdt","./implementation":"AZa4",process:"pBGv"}],CqwR:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r={registerSerializer:!0,expose:!0,DefaultSerializer:!0,Transfer:!0};Object.defineProperty(n,"registerSerializer",{enumerable:!0,get:function(){return i.registerSerializer}}),Object.defineProperty(n,"expose",{enumerable:!0,get:function(){return s.expose}}),Object.defineProperty(n,"DefaultSerializer",{enumerable:!0,get:function(){return a.DefaultSerializer}}),Object.defineProperty(n,"Transfer",{enumerable:!0,get:function(){return l.Transfer}});var i=t("./common"),o=t("./master/index");Object.keys(o).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(r,t)||Object.defineProperty(n,t,{enumerable:!0,get:function(){return o[t]}}))}));var s=t("./worker/index"),a=t("./serializers"),l=t("./transferable")},{"./common":"kdjL","./master/index":"HfK0","./worker/index":"l5pR","./serializers":"z2GM","./transferable":"qW1u"}],dHPO:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=l(t("@babel/runtime/regenerator")),i=l(t("@babel/runtime/helpers/asyncToGenerator")),o=l(t("@babel/runtime/helpers/classCallCheck")),s=l(t("@babel/runtime/helpers/createClass")),a=t("threads");function l(t){return t&&t.__esModule?t:{default:t}}var c="undefined"!=typeof navigator?navigator.hardwareConcurrency:null,u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new a.Worker("decoder.worker.1936c0d9.js");(0,o.default)(this,t),this.pool=(0,a.Pool)((function(){return(0,a.spawn)(n)}),e)}return(0,s.default)(t,[{key:"decode",value:function(){var t=(0,i.default)(r.default.mark((function t(e,n){var o=this;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,s){o.pool.queue(function(){var o=(0,i.default)(r.default.mark((function i(o){var l;return r.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,o(e,(0,a.Transfer)(n));case 3:l=r.sent,t(l),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),s(r.t0);case 10:case"end":return r.stop()}}),i,null,[[0,7]])})));return function(t){return o.apply(this,arguments)}}())})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"destroy",value:function(){this.pool.terminate(!0)}}]),t}();n.default=u},{"@babel/runtime/regenerator":"PMvg","@babel/runtime/helpers/asyncToGenerator":"agGE","@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW",threads:"CqwR","./decoder.worker.js":[["decoder.worker.1936c0d9.js","LHx9"],"decoder.worker.1936c0d9.js.map","LHx9"]}],t2zx:[function(t,e,n){e.exports=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}},{}],U8F3:[function(t,e,n){var r=t("./objectWithoutPropertiesLoose");e.exports=function(t,e){if(null==t)return{};var n,i,o=r(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}},{"./objectWithoutPropertiesLoose":"t2zx"}],OMTj:[function(t,e,n){e.exports=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}},{}],kQhN:[function(t,e,n){var r=t("./arrayWithHoles"),i=t("./iterableToArray"),o=t("./unsupportedIterableToArray"),s=t("./nonIterableRest");e.exports=function(t){return r(t)||i(t)||o(t)||s()}},{"./arrayWithHoles":"OUZ9","./iterableToArray":"OMTj","./unsupportedIterableToArray":"UyFj","./nonIterableRest":"Rom6"}],ZJpj:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.parseContentType=function(t){var e=t.split(";").map((function(t){return t.trim()})),n=(0,r.default)(e);return{type:n[0],params:u(n.slice(1).map((function(t){return t.split("=")})))}},n.parseContentRange=f,n.parseByteRanges=function(t,e){for(var n=null,r=new TextDecoder("ascii"),i=[],o="--".concat(e),s="".concat(o,"--"),a=0;a<10;++a)r.decode(new Uint8Array(t,a,o.length))===o&&(n=a);if(null===n)throw new Error("Could not find initial boundary");for(;n<t.byteLength;){var l=r.decode(new Uint8Array(t,n,Math.min(o.length+1024,t.byteLength-n)));if(0===l.length||l.startsWith(s))break;if(!l.startsWith(o))throw new Error("Part does not start with boundary");var u=l.substr(o.length+2);if(0===u.length)break;var d=u.indexOf(c),p=h(u.substr(0,d)),m=f(p["content-range"]),g=m.start,v=m.end,y=m.total,b=n+o.length+d+c.length,_=parseInt(v,10)+1-parseInt(g,10);i.push({headers:p,data:t.slice(b,b+_),offset:g,length:_,fileSize:y}),n=b+_+4}return i};var r=o(t("@babel/runtime/helpers/toArray")),i=o(t("@babel/runtime/helpers/slicedToArray"));function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=a(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw o}}}}function a(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var c="\r\n\r\n";function u(t){if(void 0!==Object.fromEntries)return Object.fromEntries(t);var e,n={},r=s(t);try{for(r.s();!(e=r.n()).done;){var o=(0,i.default)(e.value,2),a=o[0],l=o[1];n[a.toLowerCase()]=l}}catch(t){r.e(t)}finally{r.f()}return n}function h(t){return u(t.split("\r\n").map((function(t){var e=t.split(":").map((function(t){return t.trim()}));return e[0]=e[0].toLowerCase(),e})))}function f(t){var e,n,r;if(t){var o=t.match(/bytes (\d+)-(\d+)\/(\d+)/),s=(0,i.default)(o,4);e=s[1],n=s[2],r=s[3],e=parseInt(e,10),n=parseInt(n,10),r=parseInt(r,10)}return{start:e,end:n,total:r}}},{"@babel/runtime/helpers/toArray":"kQhN","@babel/runtime/helpers/slicedToArray":"HETk"}],LzCD:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BaseSource=void 0;var r=a(t("@babel/runtime/regenerator")),i=a(t("@babel/runtime/helpers/asyncToGenerator")),o=a(t("@babel/runtime/helpers/classCallCheck")),s=a(t("@babel/runtime/helpers/createClass"));function a(t){return t&&t.__esModule?t:{default:t}}var l=function(){function t(){(0,o.default)(this,t)}return(0,s.default)(t,[{key:"fetch",value:function(){var t=(0,i.default)(r.default.mark((function t(e){var n,i=this,o=arguments;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:void 0,t.next=3,Promise.all(e.map((function(t){return i.fetchSlice(t,n)})));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"fetchSlice",value:function(){var t=(0,i.default)(r.default.mark((function t(e){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("fetching of slice ".concat(e," not possible, not implemented"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"close",value:function(){var t=(0,i.default)(r.default.mark((function t(){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"fileSize",get:function(){return null}}]),t}();n.BaseSource=l},{"@babel/runtime/regenerator":"PMvg","@babel/runtime/helpers/asyncToGenerator":"agGE","@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW"}],eMzk:[function(t,e,n){"use strict";e.exports=function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}},{}],sfWH:[function(t,e,n){"use strict";function r(t){var e=this;if(e instanceof r||(e=new r),e.tail=null,e.head=null,e.length=0,t&&"function"==typeof t.forEach)t.forEach((function(t){e.push(t)}));else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)e.push(arguments[n]);return e}function i(t,e,n){var r=e===t.head?new a(n,null,e,t):new a(n,e,e.next,t);return null===r.next&&(t.tail=r),null===r.prev&&(t.head=r),t.length++,r}function o(t,e){t.tail=new a(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function s(t,e){t.head=new a(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function a(t,e,n,r){if(!(this instanceof a))return new a(t,e,n,r);this.list=r,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}e.exports=r,r.Node=a,r.create=r,r.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;return e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null,e},r.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},r.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},r.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)o(this,arguments[t]);return this.length},r.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)s(this,arguments[t]);return this.length},r.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},r.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},r.prototype.forEach=function(t,e){e=e||this;for(var n=this.head,r=0;null!==n;r++)t.call(e,n.value,r,this),n=n.next},r.prototype.forEachReverse=function(t,e){e=e||this;for(var n=this.tail,r=this.length-1;null!==n;r--)t.call(e,n.value,r,this),n=n.prev},r.prototype.get=function(t){for(var e=0,n=this.head;null!==n&&e<t;e++)n=n.next;if(e===t&&null!==n)return n.value},r.prototype.getReverse=function(t){for(var e=0,n=this.tail;null!==n&&e<t;e++)n=n.prev;if(e===t&&null!==n)return n.value},r.prototype.map=function(t,e){e=e||this;for(var n=new r,i=this.head;null!==i;)n.push(t.call(e,i.value,this)),i=i.next;return n},r.prototype.mapReverse=function(t,e){e=e||this;for(var n=new r,i=this.tail;null!==i;)n.push(t.call(e,i.value,this)),i=i.prev;return n},r.prototype.reduce=function(t,e){var n,r=this.head;if(arguments.length>1)n=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=t(n,r.value,i),r=r.next;return n},r.prototype.reduceReverse=function(t,e){var n,r=this.tail;if(arguments.length>1)n=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=t(n,r.value,i),r=r.prev;return n},r.prototype.toArray=function(){for(var t=new Array(this.length),e=0,n=this.head;null!==n;e++)t[e]=n.value,n=n.next;return t},r.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,n=this.tail;null!==n;e++)t[e]=n.value,n=n.prev;return t},r.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new r;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=0,o=this.head;null!==o&&i<t;i++)o=o.next;for(;null!==o&&i<e;i++,o=o.next)n.push(o.value);return n},r.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new r;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=this.length,o=this.tail;null!==o&&i>e;i--)o=o.prev;for(;null!==o&&i>t;i--,o=o.prev)n.push(o.value);return n},r.prototype.splice=function(t,e,...n){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var r=0,o=this.head;null!==o&&r<t;r++)o=o.next;var s=[];for(r=0;o&&r<e;r++)s.push(o.value),o=this.removeNode(o);for(null===o&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev),r=0;r<n.length;r++)o=i(this,o,n[r]);return s},r.prototype.reverse=function(){for(var t=this.head,e=this.tail,n=t;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=e,this.tail=t,this};try{t("./iterator.js")(r)}catch(t){}},{"./iterator.js":"eMzk"}],tpff:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=t("yallist"),s=Symbol("max"),a=Symbol("length"),l=Symbol("lengthCalculator"),c=Symbol("allowStale"),u=Symbol("maxAge"),h=Symbol("dispose"),f=Symbol("noDisposeOnSet"),d=Symbol("lruList"),p=Symbol("cache"),m=Symbol("updateAgeOnGet"),g=function(){return 1},v=function(){function t(e){if(r(this,t),"number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[s]=e.max||1/0;var n=e.length||g;if(this[l]="function"!=typeof n?g:n,this[c]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[u]=e.maxAge||0,this[h]=e.dispose,this[f]=e.noDisposeOnSet||!1,this[m]=e.updateAgeOnGet||!1,this.reset()}return function(t,e,n){e&&i(t.prototype,e),n&&i(t,n)}(t,[{key:"rforEach",value:function(t,e){e=e||this;for(var n=this[d].tail;null!==n;){var r=n.prev;M(this,t,n,e),n=r}}},{key:"forEach",value:function(t,e){e=e||this;for(var n=this[d].head;null!==n;){var r=n.next;M(this,t,n,e),n=r}}},{key:"keys",value:function(){return this[d].toArray().map((function(t){return t.key}))}},{key:"values",value:function(){return this[d].toArray().map((function(t){return t.value}))}},{key:"reset",value:function(){var t=this;this[h]&&this[d]&&this[d].length&&this[d].forEach((function(e){return t[h](e.key,e.value)})),this[p]=new Map,this[d]=new o,this[a]=0}},{key:"dump",value:function(){var t=this;return this[d].map((function(e){return!b(t,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}})).toArray().filter((function(t){return t}))}},{key:"dumpLru",value:function(){return this[d]}},{key:"set",value:function(t,e,n){if((n=n||this[u])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");var r=n?Date.now():0,i=this[l](e,t);if(this[p].has(t)){if(i>this[s])return x(this,this[p].get(t)),!1;var o=this[p].get(t).value;return this[h]&&(this[f]||this[h](t,o.value)),o.now=r,o.maxAge=n,o.value=e,this[a]+=i-o.length,o.length=i,this.get(t),_(this),!0}var c=new w(t,e,i,r,n);return c.length>this[s]?(this[h]&&this[h](t,e),!1):(this[a]+=c.length,this[d].unshift(c),this[p].set(t,this[d].head),_(this),!0)}},{key:"has",value:function(t){if(!this[p].has(t))return!1;var e=this[p].get(t).value;return!b(this,e)}},{key:"get",value:function(t){return y(this,t,!0)}},{key:"peek",value:function(t){return y(this,t,!1)}},{key:"pop",value:function(){var t=this[d].tail;return t?(x(this,t),t.value):null}},{key:"del",value:function(t){x(this,this[p].get(t))}},{key:"load",value:function(t){this.reset();for(var e=Date.now(),n=t.length-1;n>=0;n--){var r=t[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{var o=i-e;o>0&&this.set(r.k,r.v,o)}}}},{key:"prune",value:function(){var t=this;this[p].forEach((function(e,n){return y(t,n,!1)}))}},{key:"max",set:function(t){if("number"!=typeof t||t<0)throw new TypeError("max must be a non-negative number");this[s]=t||1/0,_(this)},get:function(){return this[s]}},{key:"allowStale",set:function(t){this[c]=!!t},get:function(){return this[c]}},{key:"maxAge",set:function(t){if("number"!=typeof t)throw new TypeError("maxAge must be a non-negative number");this[u]=t,_(this)},get:function(){return this[u]}},{key:"lengthCalculator",set:function(t){var e=this;"function"!=typeof t&&(t=g),t!==this[l]&&(this[l]=t,this[a]=0,this[d].forEach((function(t){t.length=e[l](t.value,t.key),e[a]+=t.length}))),_(this)},get:function(){return this[l]}},{key:"length",get:function(){return this[a]}},{key:"itemCount",get:function(){return this[d].length}}]),t}(),y=function(t,e,n){var r=t[p].get(e);if(r){var i=r.value;if(b(t,i)){if(x(t,r),!t[c])return}else n&&(t[m]&&(r.value.now=Date.now()),t[d].unshiftNode(r));return i.value}},b=function(t,e){if(!e||!e.maxAge&&!t[u])return!1;var n=Date.now()-e.now;return e.maxAge?n>e.maxAge:t[u]&&n>t[u]},_=function(t){if(t[a]>t[s])for(var e=t[d].tail;t[a]>t[s]&&null!==e;){var n=e.prev;x(t,e),e=n}},x=function(t,e){if(e){var n=e.value;t[h]&&t[h](n.key,n.value),t[a]-=n.length,t[p].delete(n.key),t[d].removeNode(e)}},w=function t(e,n,i,o,s){r(this,t),this.key=e,this.value=n,this.length=i,this.now=o,this.maxAge=s||0},M=function(t,e,n,r){var i=n.value;b(t,i)&&(x(t,n),t[c]||(i=void 0)),i&&e.call(r,i.value,i.key,t)};e.exports=v},{yallist:"sfWH"}],FOZT:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.assign=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},n.chunk=function(t,e){for(var n=[],r=t.length,i=0;i<r;i+=e){for(var o=[],s=i;s<i+e;s++)o.push(t[s]);n.push(o)}return n},n.endsWith=function(t,e){return!(t.length<e.length)&&t.substr(t.length-e.length)===e},n.forEach=function(t,e){for(var n=t.length,r=0;r<n;r++)e(t[r],r)},n.invert=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e},n.range=function(t){for(var e=[],n=0;n<t;n++)e.push(n);return e},n.times=function(t,e){for(var n=[],r=0;r<t;r++)n.push(e(r));return n},n.toArray=d,n.toArrayRecursively=function t(e){return e.length?d(e).map(t):e},n.parseContentRange=function(t){if(!t)return null;if("string"!=typeof t)throw new Error("invalid argument");var e=function(t){return Number.parseInt(t,10)},n=t.match(/^(\w*) /),r=n&&n[1];return(n=t.match(/(\d+)-(\d+)\/(\d+|\*)/))?{unit:r,first:e(n[1]),last:e(n[2]),length:"*"===n[3]?null:e(n[3])}:(n=t.match(/(\d+|\*)/))?{unit:r,first:null,last:null,length:"*"===n[1]?null:e(n[1])}:null},n.wait=function(t){return p.apply(this,arguments)},n.zip=function(t,e){var n=Array.isArray(t)?t:Array.from(t),r=Array.isArray(e)?e:Array.from(e);return n.map((function(t,e){return[t,r[e]]}))},n.AggregateError=n.CustomAggregateError=n.AbortError=void 0;var r=h(t("@babel/runtime/regenerator")),i=h(t("@babel/runtime/helpers/classCallCheck")),o=h(t("@babel/runtime/helpers/assertThisInitialized")),s=h(t("@babel/runtime/helpers/inherits")),a=h(t("@babel/runtime/helpers/possibleConstructorReturn")),l=h(t("@babel/runtime/helpers/getPrototypeOf")),c=h(t("@babel/runtime/helpers/wrapNativeSuper")),u=h(t("@babel/runtime/helpers/asyncToGenerator"));function h(t){return t&&t.__esModule?t:{default:t}}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,l.default)(t);if(e){var i=(0,l.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.default)(this,n)}}function d(t){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}function p(){return(p=(0,u.default)(r.default.mark((function t(e){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){return setTimeout(t,e)})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var m=function(t){(0,s.default)(n,t);var e=f(n);function n(t){var r;return(0,i.default)(this,n),r=e.call(this,t),Error.captureStackTrace&&Error.captureStackTrace((0,o.default)(r),n),r.name="AbortError",r}return n}((0,c.default)(Error));n.AbortError=m;var g=function(t){(0,s.default)(n,t);var e=f(n);function n(t,r){var o;return(0,i.default)(this,n),(o=e.call(this,r)).errors=t,o.message=r,o.name="AggregateError",o}return n}((0,c.default)(Error));n.CustomAggregateError=g;var v=g;n.AggregateError=v},{"@babel/runtime/regenerator":"PMvg","@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/assertThisInitialized":"E7HD","@babel/runtime/helpers/inherits":"d4H2","@babel/runtime/helpers/possibleConstructorReturn":"pxk2","@babel/runtime/helpers/getPrototypeOf":"UJE0","@babel/runtime/helpers/wrapNativeSuper":"ozpi","@babel/runtime/helpers/asyncToGenerator":"agGE"}],xD7g:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BlockedSource=void 0;var r=p(t("@babel/runtime/regenerator")),i=p(t("@babel/runtime/helpers/slicedToArray")),o=p(t("@babel/runtime/helpers/asyncToGenerator")),s=p(t("@babel/runtime/helpers/inherits")),a=p(t("@babel/runtime/helpers/possibleConstructorReturn")),l=p(t("@babel/runtime/helpers/getPrototypeOf")),c=p(t("@babel/runtime/helpers/classCallCheck")),u=p(t("@babel/runtime/helpers/createClass")),h=p(t("lru-cache")),f=t("./basesource"),d=t("../utils");function p(t){return t&&t.__esModule?t:{default:t}}function m(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return g(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var v=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,c.default)(this,t),this.offset=e,this.length=n,this.data=r}return(0,u.default)(t,[{key:"top",get:function(){return this.offset+this.length}}]),t}(),y=function t(e,n,r){(0,c.default)(this,t),this.offset=e,this.length=n,this.blockIds=r},b=function(t){(0,s.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,l.default)(t);if(e){var i=(0,l.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.default)(this,n)}}(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.blockSize,s=void 0===o?65536:o,a=i.cacheSize,l=void 0===a?100:a;return(0,c.default)(this,n),(r=e.call(this)).source=t,r.blockSize=s,r.blockCache=new h.default({max:l}),r.blockRequests=new Map,r.blockIdsToFetch=new Set,r}return(0,u.default)(n,[{key:"fetch",value:function(){var t=(0,o.default)(r.default.mark((function t(e,n){var o,s,a,l,c,u,h,f,p,g,v,y,b,_,x,w,M,S,E,T,C,A,P,L,R,O,k,I,D,N,j,F,B,z,U,H,G,W;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=new Map,s=new Map,a=new Set,l=m(e);try{for(l.s();!(c=l.n()).done;)for(u=c.value,h=u.offset,f=u.length,p=h+f,null!==(g=this.fileSize)&&(p=Math.min(p,g)),v=Math.floor(h/this.blockSize)*this.blockSize,y=v;y<p;y+=this.blockSize)b=Math.floor(y/this.blockSize),this.blockCache.has(b)?o.set(b,this.blockCache.get(b)):this.blockRequests.has(b)?s.set(b,this.blockRequests.get(b)):(this.blockIdsToFetch.has(b)||this.blockIdsToFetch.add(b),a.add(b))}catch(t){l.e(t)}finally{l.f()}return t.next=7,(0,d.wait)();case 7:this.fetchBlocks(n),_=m(a),t.prev=9,_.s();case 11:if((x=_.n()).done){t.next=26;break}if(w=x.value,M=this.blockRequests.get(w),S=this.blockCache.get(w),!M){t.next=19;break}s.set(w,M),t.next=24;break;case 19:if(!S){t.next=23;break}o.set(w,S),t.next=24;break;case 23:throw new Error("Block ".concat(w," is not in the block requests"));case 24:t.next=11;break;case 26:t.next=31;break;case 28:t.prev=28,t.t0=t.catch(9),_.e(t.t0);case 31:return t.prev=31,_.f(),t.finish(31);case 34:return t.next=36,Promise.allSettled(s.values());case 36:if(!(E=t.sent).some((function(t){return"rejected"===t.status}))){t.next=65;break}T=new Set,C=m((0,d.zip)(s.keys(),E));try{for(C.s();!(A=C.n()).done;)P=(0,i.default)(A.value,2),L=P[0],R=P[1],O=R.rejected,k=R.reason,O&&"AbortError"===k.name&&k.signal!==n&&(this.blockIdsToFetch.add(L),T.add(L))}catch(t){C.e(t)}finally{C.f()}if(!(this.blockIdsToFetch.length>0)){t.next=65;break}this.fetchBlocks(n),I=m(T),t.prev=44,I.s();case 46:if((D=I.n()).done){t.next=54;break}if(N=D.value,j=this.blockRequests.get(N)){t.next=51;break}throw new Error("Block ".concat(N," is not in the block requests"));case 51:s.set(N,j);case 52:t.next=46;break;case 54:t.next=59;break;case 56:t.prev=56,t.t1=t.catch(44),I.e(t.t1);case 59:return t.prev=59,I.f(),t.finish(59);case 62:return t.next=64,Promise.allSettled(Array.from(s.values()));case 64:E=t.sent;case 65:if(!E.some((function(t){return"rejected"===t.status}))){t.next=69;break}if(!n||!n.aborted){t.next=68;break}throw new d.AbortError("Request was aborted");case 68:throw new d.AggregateError(E.filter((function(t){return"rejected"===t.status})).map((function(t){return t.reason})),"Request failed");case 69:F=E.map((function(t){return t.value})),B=new Map((0,d.zip)(Array.from(s.keys()),F)),z=m(o);try{for(z.s();!(U=z.n()).done;)H=(0,i.default)(U.value,2),G=H[0],W=H[1],B.set(G,W)}catch(t){z.e(t)}finally{z.f()}return t.abrupt("return",this.readSliceData(e,B));case 74:case"end":return t.stop()}}),t,this,[[9,28,31,34],[44,56,59,62]])})));return function(e,n){return t.apply(this,arguments)}}()},{key:"fetchBlocks",value:function(t){var e=this;this.blockIdsToFetch.size>0&&function(){for(var n=e.groupBlocks(e.blockIdsToFetch),i=e.source.fetch(n,t),s=function(s){var a,l=m(n[s].blockIds);try{var c=function(){var n=a.value,l=(0,o.default)(r.default.mark((function o(){var a,l,c,u,h,f;return r.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,i;case 3:return r.t0=s,a=r.sent[r.t0],l=n*e.blockSize,c=l-a.offset,u=Math.min(c+e.blockSize,a.data.byteLength),h=a.data.slice(c,u),f=new v(l,h.byteLength,h),e.blockCache.set(n,f),r.abrupt("return",f);case 14:throw r.prev=14,r.t1=r.catch(0),"AbortError"===r.t1.name&&(r.t1.signal=t),r.t1;case 18:return r.prev=18,e.blockRequests.delete(n),r.finish(18);case 21:case"end":return r.stop()}}),o,null,[[0,14,18,21]])})))();e.blockRequests.set(n,l)};for(l.s();!(a=l.n()).done;)c()}catch(t){l.e(t)}finally{l.f()}},a=0;a<n.length;++a)s(a);e.blockIdsToFetch.clear()}()}},{key:"groupBlocks",value:function(t){var e=Array.from(t).sort((function(t,e){return t-e}));if(0===e.length)return[];var n,r=[],i=null,o=[],s=m(e);try{for(s.s();!(n=s.n()).done;){var a=n.value;null===i||i+1===a?(r.push(a),i=a):(o.push(new y(r[0]*this.blockSize,r.length*this.blockSize,r)),r=[a],i=a)}}catch(t){s.e(t)}finally{s.f()}return o.push(new y(r[0]*this.blockSize,r.length*this.blockSize,r)),o}},{key:"readSliceData",value:function(t,e){var n=this;return t.map((function(t){for(var r=t.offset+t.length,i=Math.floor(t.offset/n.blockSize),o=Math.floor((t.offset+t.length)/n.blockSize),s=new ArrayBuffer(t.length),a=new Uint8Array(s),l=i;l<=o;++l){var c,u=e.get(l),h=u.offset-t.offset,f=0,d=0;h<0?f=-h:h>0&&(d=h),c=u.top-r<0?u.length-f:r-u.offset-f;var p=new Uint8Array(u.data,f,c);a.set(p,d)}return s}))}},{key:"fileSize",get:function(){return this.source.fileSize}}]),n}(f.BaseSource);n.BlockedSource=b},{"@babel/runtime/regenerator":"PMvg","@babel/runtime/helpers/slicedToArray":"HETk","@babel/runtime/helpers/asyncToGenerator":"agGE","@babel/runtime/helpers/inherits":"d4H2","@babel/runtime/helpers/possibleConstructorReturn":"pxk2","@babel/runtime/helpers/getPrototypeOf":"UJE0","@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW","lru-cache":"tpff","./basesource":"LzCD","../utils":"FOZT"}],uL1U:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BaseClient=n.BaseResponse=void 0;var r=a(t("@babel/runtime/regenerator")),i=a(t("@babel/runtime/helpers/asyncToGenerator")),o=a(t("@babel/runtime/helpers/classCallCheck")),s=a(t("@babel/runtime/helpers/createClass"));function a(t){return t&&t.__esModule?t:{default:t}}var l=function(){function t(){(0,o.default)(this,t)}return(0,s.default)(t,[{key:"getHeader",value:function(t){throw new Error("not implemented")}},{key:"getData",value:function(){var t=(0,i.default)(r.default.mark((function t(){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("not implemented");case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"ok",get:function(){return this.status>=200&&this.status<=299}},{key:"status",get:function(){throw new Error("not implemented")}}]),t}();n.BaseResponse=l;var c=function(){function t(e){(0,o.default)(this,t),this.url=e}return(0,s.default)(t,[{key:"request",value:function(){var t=(0,i.default)(r.default.mark((function t(){var e,n=arguments;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw(e=n.length>0&&void 0!==n[0]?n[0]:{}).headers,e.credentials,e.signal,new Error("request is not implemented");case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),t}();n.BaseClient=c},{"@babel/runtime/regenerator":"PMvg","@babel/runtime/helpers/asyncToGenerator":"agGE","@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW"}],Un5s:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.FetchClient=void 0;var r=h(t("@babel/runtime/regenerator")),i=h(t("@babel/runtime/helpers/asyncToGenerator")),o=h(t("@babel/runtime/helpers/classCallCheck")),s=h(t("@babel/runtime/helpers/createClass")),a=h(t("@babel/runtime/helpers/inherits")),l=h(t("@babel/runtime/helpers/possibleConstructorReturn")),c=h(t("@babel/runtime/helpers/getPrototypeOf")),u=t("./base");function h(t){return t&&t.__esModule?t:{default:t}}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,c.default)(t);if(e){var i=(0,c.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,l.default)(this,n)}}var d=function(t){(0,a.default)(n,t);var e=f(n);function n(t){var r;return(0,o.default)(this,n),(r=e.call(this)).response=t,r}return(0,s.default)(n,[{key:"getHeader",value:function(t){return this.response.headers.get(t)}},{key:"getData",value:function(){var t=(0,i.default)(r.default.mark((function t(){var e;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.response.arrayBuffer){t.next=6;break}return t.next=3,this.response.arrayBuffer();case 3:t.t0=t.sent,t.next=9;break;case 6:return t.next=8,this.response.buffer();case 8:t.t0=t.sent.buffer;case 9:return e=t.t0,t.abrupt("return",e);case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"status",get:function(){return this.response.status}}]),n}(u.BaseResponse),p=function(t){(0,a.default)(n,t);var e=f(n);function n(t,r){var i;return(0,o.default)(this,n),(i=e.call(this,t)).credentials=r,i}return(0,s.default)(n,[{key:"request",value:function(){var t=(0,i.default)(r.default.mark((function t(){var e,n,i,o,s,a=arguments;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:{},n=e.headers,i=e.credentials,o=e.signal,t.next=3,fetch(this.url,{headers:n,credentials:i,signal:o});case 3:return s=t.sent,t.abrupt("return",new d(s));case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),n}(u.BaseClient);n.FetchClient=p},{"@babel/runtime/regenerator":"PMvg","@babel/runtime/helpers/asyncToGenerator":"agGE","@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW","@babel/runtime/helpers/inherits":"d4H2","@babel/runtime/helpers/possibleConstructorReturn":"pxk2","@babel/runtime/helpers/getPrototypeOf":"UJE0","./base":"uL1U"}],hvgd:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.XHRClient=void 0;var r=d(t("@babel/runtime/helpers/slicedToArray")),i=d(t("@babel/runtime/regenerator")),o=d(t("@babel/runtime/helpers/asyncToGenerator")),s=d(t("@babel/runtime/helpers/classCallCheck")),a=d(t("@babel/runtime/helpers/createClass")),l=d(t("@babel/runtime/helpers/inherits")),c=d(t("@babel/runtime/helpers/possibleConstructorReturn")),u=d(t("@babel/runtime/helpers/getPrototypeOf")),h=t("./base"),f=t("../../utils");function d(t){return t&&t.__esModule?t:{default:t}}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,u.default)(t);if(e){var i=(0,u.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.default)(this,n)}}var m=function(t){(0,l.default)(n,t);var e=p(n);function n(t,r){var i;return(0,s.default)(this,n),(i=e.call(this)).xhr=t,i.data=r,i}return(0,a.default)(n,[{key:"getHeader",value:function(t){return this.xhr.getResponseHeader(t)}},{key:"getData",value:function(){var t=(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.data);case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"status",get:function(){return this.xhr.status}}]),n}(h.BaseResponse),g=function(t){(0,l.default)(n,t);var e=p(n);function n(){return(0,s.default)(this,n),e.apply(this,arguments)}return(0,a.default)(n,[{key:"constructRequest",value:function(t,e){var n=this;return new Promise((function(i,o){var s=new XMLHttpRequest;s.open("GET",n.url),s.responseType="arraybuffer";for(var a=0,l=Object.entries(t);a<l.length;a++){var c=(0,r.default)(l[a],2),u=c[0],h=c[1];s.setRequestHeader(u,h)}s.onload=function(){var t=s.response;i(new m(s,t))},s.onerror=o,s.onabort=function(){return o(new f.AbortError("Request aborted"))},s.send(),e&&(e.aborted&&s.abort(),e.addEventListener("abort",(function(){return s.abort()})))}))}},{key:"request",value:function(){var t=(0,o.default)(i.default.mark((function t(){var e,n,r,o,s=arguments;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=s.length>0&&void 0!==s[0]?s[0]:{},n=e.headers,r=e.signal,t.next=3,this.constructRequest(n,r);case 3:return o=t.sent,t.abrupt("return",o);case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),n}(h.BaseClient);n.XHRClient=g},{"@babel/runtime/helpers/slicedToArray":"HETk","@babel/runtime/regenerator":"PMvg","@babel/runtime/helpers/asyncToGenerator":"agGE","@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW","@babel/runtime/helpers/inherits":"d4H2","@babel/runtime/helpers/possibleConstructorReturn":"pxk2","@babel/runtime/helpers/getPrototypeOf":"UJE0","./base":"uL1U","../../utils":"FOZT"}],p5a1:[function(t,e,n){var r,i=arguments[3];n.fetch=c(i.fetch)&&c(i.ReadableStream),n.writableStream=c(i.WritableStream),n.abortController=c(i.AbortController),n.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),n.blobConstructor=!0}catch(t){}function o(){if(void 0!==r)return r;if(i.XMLHttpRequest){r=new i.XMLHttpRequest;try{r.open("GET",i.XDomainRequest?"/":"https://example.com")}catch(t){r=null}}else r=null;return r}function s(t){var e=o();if(!e)return!1;try{return e.responseType=t,e.responseType===t}catch(t){}return!1}var a=void 0!==i.ArrayBuffer,l=a&&c(i.ArrayBuffer.prototype.slice);function c(t){return"function"==typeof t}n.arraybuffer=n.fetch||a&&s("arraybuffer"),n.msstream=!n.fetch&&l&&s("ms-stream"),n.mozchunkedarraybuffer=!n.fetch&&a&&s("moz-chunked-arraybuffer"),n.overrideMimeType=n.fetch||!!o()&&c(o().overrideMimeType),n.vbArray=c(i.VBArray),r=null},{}],Yj0v:[function(t,e,n){t("process");var r=t("process");void 0===r||!r.version||0===r.version.indexOf("v0.")||0===r.version.indexOf("v1.")&&0!==r.version.indexOf("v1.8.")?e.exports={nextTick:function(t,e,n,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,s,a=arguments.length;switch(a){case 0:case 1:return r.nextTick(t);case 2:return r.nextTick((function(){t.call(null,e)}));case 3:return r.nextTick((function(){t.call(null,e,n)}));case 4:return r.nextTick((function(){t.call(null,e,n,i)}));default:for(o=new Array(a-1),s=0;s<o.length;)o[s++]=arguments[s];return r.nextTick((function(){t.apply(null,o)}))}}}:e.exports=r},{process:"pBGv"}],Nqn4:[function(t,e,n){var r=t("buffer"),i=r.Buffer;function o(t,e){for(var n in t)e[n]=t[n]}function s(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,n),n.Buffer=s),o(i,s),s.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},s.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},s.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},s.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},{buffer:"dskh"}],Q14w:[function(t,e,n){t("buffer").Buffer;var r=t("buffer").Buffer;function i(t){return Object.prototype.toString.call(t)}n.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===i(t)},n.isBoolean=function(t){return"boolean"==typeof t},n.isNull=function(t){return null===t},n.isNullOrUndefined=function(t){return null==t},n.isNumber=function(t){return"number"==typeof t},n.isString=function(t){return"string"==typeof t},n.isSymbol=function(t){return"symbol"==typeof t},n.isUndefined=function(t){return void 0===t},n.isRegExp=function(t){return"[object RegExp]"===i(t)},n.isObject=function(t){return"object"==typeof t&&null!==t},n.isDate=function(t){return"[object Date]"===i(t)},n.isError=function(t){return"[object Error]"===i(t)||t instanceof Error},n.isFunction=function(t){return"function"==typeof t},n.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},n.isBuffer=r.isBuffer},{buffer:"dskh"}],CQMM:[function(t,e,n){"use strict";var r=t("safe-buffer").Buffer,i=t("util");function o(t,e,n){t.copy(e,n)}e.exports=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},t.prototype.concat=function(t){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var e=r.allocUnsafe(t>>>0),n=this.head,i=0;n;)o(n.data,e,i),i+=n.data.length,n=n.next;return e},t}(),i&&i.inspect&&i.inspect.custom&&(e.exports.prototype[i.inspect.custom]=function(){var t=i.inspect({length:this.length});return this.constructor.name+" "+t})},{"safe-buffer":"Nqn4",util:"rDCW"}],lCUh:[function(t,e,n){"use strict";var r=t("process-nextick-args");function i(t,e){t.emit("error",e)}e.exports={destroy:function(t,e){var n=this,o=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return o||s?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?(r.nextTick(i,n,t),n._writableState&&(n._writableState.errorEmitted=!0)):e&&e(t)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":"Yj0v"}],jPmE:[function(t,e,n){t("process"),t("process");var r=arguments[3],i=t("process-nextick-args");function o(t){var e=this;this.next=null,this.entry=null,this.finish=function(){N(e,t)}}e.exports=b;var s,a=i.nextTick;b.WritableState=y;var l=Object.create(t("core-util-is"));l.inherits=t("inherits");var c={deprecate:t("util-deprecate")},u=t("./internal/streams/stream"),h=t("safe-buffer").Buffer,f=r.Uint8Array||function(){};function d(t){return h.from(t)}function p(t){return h.isBuffer(t)||t instanceof f}var m,g=t("./internal/streams/destroy");function v(){}function y(e,n){s=s||t("./_stream_duplex"),e=e||{};var r=n instanceof s;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,a=e.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(a||0===a)?a:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var c=!1===e.decodeStrings;this.decodeStrings=!c,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){C(n,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function b(e){if(s=s||t("./_stream_duplex"),!(m.call(b,this)||this instanceof s))return new b(e);this._writableState=new y(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),u.call(this)}function _(t,e){var n=new Error("write after end");t.emit("error",n),i.nextTick(e,n)}function x(t,e,n,r){var o=!0,s=!1;return null===n?s=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||e.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(t.emit("error",s),i.nextTick(r,s),o=!1),o}function w(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=h.from(e,n)),e}function M(t,e,n,r,i,o){if(!n){var s=w(e,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var l=e.length<e.highWaterMark;if(l||(e.needDrain=!0),e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else S(t,e,!1,a,r,i,o);return l}function S(t,e,n,r,i,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function E(t,e,n,r,o){--e.pendingcb,n?(i.nextTick(o,r),i.nextTick(I,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(o(r),t._writableState.errorEmitted=!0,t.emit("error",r),I(t,e))}function T(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function C(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if(T(n),e)E(t,n,r,e,i);else{var o=R(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||L(t,n),r?a(A,t,n,o,i):A(t,n,o,i)}}function A(t,e,n,r){n||P(t,e),e.pendingcb--,r(),I(t,e)}function P(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function L(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),s=e.corkedRequestsFree;s.entry=n;for(var a=0,l=!0;n;)i[a]=n,n.isBuf||(l=!1),n=n.next,a+=1;i.allBuffers=l,S(t,e,!0,e.length,i,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new o(e),e.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,u=n.encoding,h=n.callback;if(S(t,e,!1,e.objectMode?1:c.length,c,u,h),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function R(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function O(t,e){t._final((function(n){e.pendingcb--,n&&t.emit("error",n),e.prefinished=!0,t.emit("prefinish"),I(t,e)}))}function k(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,i.nextTick(O,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function I(t,e){var n=R(e);return n&&(k(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),n}function D(t,e,n){e.ending=!0,I(t,e),n&&(e.finished?i.nextTick(n):t.once("finish",n)),e.ended=!0,t.writable=!1}function N(t,e,n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}l.inherits(b,u),y.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(y.prototype,"buffer",{get:c.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(m=Function.prototype[Symbol.hasInstance],Object.defineProperty(b,Symbol.hasInstance,{value:function(t){return!!m.call(this,t)||this===b&&t&&t._writableState instanceof y}})):m=function(t){return t instanceof this},b.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},b.prototype.write=function(t,e,n){var r=this._writableState,i=!1,o=!r.objectMode&&p(t);return o&&!h.isBuffer(t)&&(t=d(t)),"function"==typeof e&&(n=e,e=null),o?e="buffer":e||(e=r.defaultEncoding),"function"!=typeof n&&(n=v),r.ended?_(this,n):(o||x(this,r,t,n))&&(r.pendingcb++,i=M(this,r,o,t,e,n)),i},b.prototype.cork=function(){this._writableState.corked++},b.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||L(this,t))},b.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(b.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),b.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},b.prototype._writev=null,b.prototype.end=function(t,e,n){var r=this._writableState;"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||D(this,r,n)},Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),b.prototype.destroy=g.destroy,b.prototype._undestroy=g.undestroy,b.prototype._destroy=function(t,e){this.end(),e(t)}},{"process-nextick-args":"Yj0v","core-util-is":"Q14w",inherits:"Bm0n","util-deprecate":"yM1o","./internal/streams/stream":"ExO1","safe-buffer":"Nqn4","./internal/streams/destroy":"lCUh","./_stream_duplex":"Jcj8",process:"pBGv"}],Jcj8:[function(t,e,n){"use strict";var r=t("process-nextick-args"),i=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};e.exports=h;var o=Object.create(t("core-util-is"));o.inherits=t("inherits");var s=t("./_stream_readable"),a=t("./_stream_writable");o.inherits(h,s);for(var l=i(a.prototype),c=0;c<l.length;c++){var u=l[c];h.prototype[u]||(h.prototype[u]=a.prototype[u])}function h(t){if(!(this instanceof h))return new h(t);s.call(this,t),a.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||r.nextTick(d,this)}function d(t){t.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),h.prototype._destroy=function(t,e){this.push(null),this.end(),r.nextTick(e,t)}},{"process-nextick-args":"Yj0v","core-util-is":"Q14w",inherits:"Bm0n","./_stream_readable":"YrHu","./_stream_writable":"jPmE"}],OUJr:[function(t,e,n){"use strict";var r=t("safe-buffer").Buffer,i=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=l,this.end=c,e=4;break;case"utf8":this.fillLast=a,e=4;break;case"base64":this.text=u,this.end=h,e=3;break;default:return this.write=f,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function a(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function l(t,e){if((t.length-e)%2==0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function c(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function u(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function h(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function f(t){return t.toString(this.encoding)}function d(t){return t&&t.length?this.write(t):""}n.StringDecoder=o,o.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},o.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var i=s(e[r]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--r<n||-2===i?0:(i=s(e[r]))>=0?(i>0&&(t.lastNeed=i-2),i):--r<n||-2===i?0:(i=s(e[r]))>=0?(i>0&&(2===i?i=0:t.lastNeed=i-3),i):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},{"safe-buffer":"Nqn4"}],YrHu:[function(t,e,n){t("process");var r=arguments[3],i=t("process"),o=t("process-nextick-args");e.exports=M;var s,a=t("isarray");M.ReadableState=w,t("events").EventEmitter;var l=function(t,e){return t.listeners(e).length},c=t("./internal/streams/stream"),u=t("safe-buffer").Buffer,h=r.Uint8Array||function(){};function f(t){return u.from(t)}function d(t){return u.isBuffer(t)||t instanceof h}var p=Object.create(t("core-util-is"));p.inherits=t("inherits");var m=t("util"),g=void 0;g=m&&m.debuglog?m.debuglog("stream"):function(){};var v,y=t("./internal/streams/BufferList"),b=t("./internal/streams/destroy");p.inherits(M,c);var _=["error","close","destroy","pause","resume"];function x(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?a(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}function w(e,n){e=e||{};var r=n instanceof(s=s||t("./_stream_duplex"));this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,o=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(o||0===o)?o:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(v||(v=t("string_decoder/").StringDecoder),this.decoder=new v(e.encoding),this.encoding=e.encoding)}function M(e){if(s=s||t("./_stream_duplex"),!(this instanceof M))return new M(e);this._readableState=new w(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),c.call(this)}function S(t,e,n,r,i){var o,s=t._readableState;return null===e?(s.reading=!1,R(t,s)):(i||(o=T(s,e)),o?t.emit("error",o):s.objectMode||e&&e.length>0?("string"==typeof e||s.objectMode||Object.getPrototypeOf(e)===u.prototype||(e=f(e)),r?s.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):E(t,s,e,!0):s.ended?t.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!n?(e=s.decoder.write(e),s.objectMode||0!==e.length?E(t,s,e,!1):I(t,s)):E(t,s,e,!1))):r||(s.reading=!1)),C(s)}function E(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&O(t)),I(t,e)}function T(t,e){var n;return d(e)||"string"==typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function C(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}Object.defineProperty(M.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),M.prototype.destroy=b.destroy,M.prototype._undestroy=b.undestroy,M.prototype._destroy=function(t,e){this.push(null),e(t)},M.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=u.from(t,e),e=""),n=!0),S(this,t,e,!1,n)},M.prototype.unshift=function(t){return S(this,t,null,!0,!1)},M.prototype.isPaused=function(){return!1===this._readableState.flowing},M.prototype.setEncoding=function(e){return v||(v=t("string_decoder/").StringDecoder),this._readableState.decoder=new v(e),this._readableState.encoding=e,this};var A=8388608;function P(t){return t>=A?t=A:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function L(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=P(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function R(t,e){if(!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,O(t)}}function O(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(g("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?o.nextTick(k,t):k(t))}function k(t){g("emit readable"),t.emit("readable"),z(t)}function I(t,e){e.readingMore||(e.readingMore=!0,o.nextTick(D,t,e))}function D(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(g("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function N(t){return function(){var e=t._readableState;g("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&l(t,"data")&&(e.flowing=!0,z(t))}}function j(t){g("readable nexttick read 0"),t.read(0)}function F(t,e){e.resumeScheduled||(e.resumeScheduled=!0,o.nextTick(B,t,e))}function B(t,e){e.reading||(g("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),z(t),e.flowing&&!e.reading&&t.read(0)}function z(t){var e=t._readableState;for(g("flow",e.flowing);e.flowing&&null!==t.read(););}function U(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=H(t,e.buffer,e.decoder),n);var n}function H(t,e,n){var r;return t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():n?G(t,e):W(t,e),r}function G(t,e){var n=e.head,r=1,i=n.data;for(t-=i.length;n=n.next;){var o=n.data,s=t>o.length?o.length:t;if(s===o.length?i+=o:i+=o.slice(0,t),0==(t-=s)){s===o.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=o.slice(s));break}++r}return e.length-=r,i}function W(t,e){var n=u.allocUnsafe(t),r=e.head,i=1;for(r.data.copy(n),t-=r.data.length;r=r.next;){var o=r.data,s=t>o.length?o.length:t;if(o.copy(n,n.length-t,0,s),0==(t-=s)){s===o.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(s));break}++i}return e.length-=i,n}function V(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,o.nextTick(q,e,t))}function q(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function X(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}M.prototype.read=function(t){g("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return g("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?V(this):O(this),null;if(0===(t=L(t,e))&&e.ended)return 0===e.length&&V(this),null;var r,i=e.needReadable;return g("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&g("length less than watermark",i=!0),e.ended||e.reading?g("reading or ended",i=!1):i&&(g("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=L(n,e))),null===(r=t>0?U(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&V(this)),null!==r&&this.emit("data",r),r},M.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},M.prototype.pipe=function(t,e){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=t;break;case 1:r.pipes=[r.pipes,t];break;default:r.pipes.push(t)}r.pipesCount+=1,g("pipe count=%d opts=%j",r.pipesCount,e);var s=e&&!1===e.end||t===i.stdout||t===i.stderr?v:a;function a(){g("onend"),t.end()}r.endEmitted?o.nextTick(s):n.once("end",s),t.on("unpipe",(function e(i,o){g("onunpipe"),i===n&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,g("cleanup"),t.removeListener("close",p),t.removeListener("finish",m),t.removeListener("drain",c),t.removeListener("error",d),t.removeListener("unpipe",e),n.removeListener("end",a),n.removeListener("end",v),n.removeListener("data",f),u=!0,!r.awaitDrain||t._writableState&&!t._writableState.needDrain||c())}));var c=N(n);t.on("drain",c);var u=!1,h=!1;function f(e){g("ondata"),h=!1,!1!==t.write(e)||h||((1===r.pipesCount&&r.pipes===t||r.pipesCount>1&&-1!==X(r.pipes,t))&&!u&&(g("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,h=!0),n.pause())}function d(e){g("onerror",e),v(),t.removeListener("error",d),0===l(t,"error")&&t.emit("error",e)}function p(){t.removeListener("finish",m),v()}function m(){g("onfinish"),t.removeListener("close",p),v()}function v(){g("unpipe"),n.unpipe(t)}return n.on("data",f),x(t,"error",d),t.once("close",p),t.once("finish",m),t.emit("pipe",n),r.flowing||(g("pipe resume"),n.resume()),t},M.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var s=X(e.pipes,t);return-1===s||(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},M.prototype.on=function(t,e){var n=c.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&O(this):o.nextTick(j,this))}return n},M.prototype.addListener=M.prototype.on,M.prototype.resume=function(){var t=this._readableState;return t.flowing||(g("resume"),t.flowing=!0,F(this,t)),this},M.prototype.pause=function(){return g("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(g("pause"),this._readableState.flowing=!1,this.emit("pause")),this},M.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",(function(){if(g("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(i){g("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i||(n.objectMode||i&&i.length)&&(e.push(i)||(r=!0,t.pause()))})),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<_.length;o++)t.on(_[o],this.emit.bind(this,_[o]));return this._read=function(e){g("wrapped _read",e),r&&(r=!1,t.resume())},this},Object.defineProperty(M.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),M._fromList=U},{"process-nextick-args":"Yj0v",isarray:"REa7",events:"FRpO","./internal/streams/stream":"ExO1","safe-buffer":"Nqn4","core-util-is":"Q14w",inherits:"Bm0n",util:"rDCW","./internal/streams/BufferList":"CQMM","./internal/streams/destroy":"lCUh","./_stream_duplex":"Jcj8","string_decoder/":"OUJr",process:"pBGv"}],wBib:[function(t,e,n){"use strict";e.exports=s;var r=t("./_stream_duplex"),i=Object.create(t("core-util-is"));function o(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function s(t){if(!(this instanceof s))return new s(t);r.call(this,t),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",a)}function a(){var t=this;"function"==typeof this._flush?this._flush((function(e,n){l(t,e,n)})):l(this,null,null)}function l(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}i.inherits=t("inherits"),i.inherits(s,r),s.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},s.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},s.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},s.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},s.prototype._destroy=function(t,e){var n=this;r.prototype._destroy.call(this,t,(function(t){e(t),n.emit("close")}))}},{"./_stream_duplex":"Jcj8","core-util-is":"Q14w",inherits:"Bm0n"}],IxGW:[function(t,e,n){"use strict";e.exports=o;var r=t("./_stream_transform"),i=Object.create(t("core-util-is"));function o(t){if(!(this instanceof o))return new o(t);r.call(this,t)}i.inherits=t("inherits"),i.inherits(o,r),o.prototype._transform=function(t,e,n){n(null,t)}},{"./_stream_transform":"wBib","core-util-is":"Q14w",inherits:"Bm0n"}],JaqQ:[function(t,e,n){(n=e.exports=t("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=t("./lib/_stream_writable.js"),n.Duplex=t("./lib/_stream_duplex.js"),n.Transform=t("./lib/_stream_transform.js"),n.PassThrough=t("./lib/_stream_passthrough.js")},{"./lib/_stream_readable.js":"YrHu","./lib/_stream_writable.js":"jPmE","./lib/_stream_duplex.js":"Jcj8","./lib/_stream_transform.js":"wBib","./lib/_stream_passthrough.js":"IxGW"}],UxIR:[function(t,e,n){t("process"),t("buffer").Buffer;var r=t("process"),i=t("buffer").Buffer,o=arguments[3],s=t("./capability"),a=t("inherits"),l=t("readable-stream"),c=n.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},u=n.IncomingMessage=function(t,e,n,a){var c=this;if(l.Readable.call(c),c._mode=n,c.headers={},c.rawHeaders=[],c.trailers={},c.rawTrailers=[],c.on("end",(function(){r.nextTick((function(){c.emit("close")}))})),"fetch"===n){if(c._fetchResponse=e,c.url=e.url,c.statusCode=e.status,c.statusMessage=e.statusText,e.headers.forEach((function(t,e){c.headers[e.toLowerCase()]=t,c.rawHeaders.push(e,t)})),s.writableStream){var u=new WritableStream({write:function(t){return new Promise((function(e,n){c._destroyed?n():c.push(new i(t))?e():c._resumeFetch=e}))},close:function(){o.clearTimeout(a),c._destroyed||c.push(null)},abort:function(t){c._destroyed||c.emit("error",t)}});try{return void e.body.pipeTo(u).catch((function(t){o.clearTimeout(a),c._destroyed||c.emit("error",t)}))}catch(t){}}var h=e.body.getReader();!function t(){h.read().then((function(e){if(!c._destroyed){if(e.done)return o.clearTimeout(a),void c.push(null);c.push(new i(e.value)),t()}})).catch((function(t){o.clearTimeout(a),c._destroyed||c.emit("error",t)}))}()}else if(c._xhr=t,c._pos=0,c.url=t.responseURL,c.statusCode=t.status,c.statusMessage=t.statusText,t.getAllResponseHeaders().split(/\r?\n/).forEach((function(t){var e=t.match(/^([^:]+):\s*(.*)/);if(e){var n=e[1].toLowerCase();"set-cookie"===n?(void 0===c.headers[n]&&(c.headers[n]=[]),c.headers[n].push(e[2])):void 0!==c.headers[n]?c.headers[n]+=", "+e[2]:c.headers[n]=e[2],c.rawHeaders.push(e[1],e[2])}})),c._charset="x-user-defined",!s.overrideMimeType){var f=c.rawHeaders["mime-type"];if(f){var d=f.match(/;\s*charset=([^;])(;|$)/);d&&(c._charset=d[1].toLowerCase())}c._charset||(c._charset="utf-8")}};a(u,l.Readable),u.prototype._read=function(){var t=this._resumeFetch;t&&(this._resumeFetch=null,t())},u.prototype._onXHRProgress=function(){var t=this,e=t._xhr,n=null;switch(t._mode){case"text:vbarray":if(e.readyState!==c.DONE)break;try{n=new o.VBArray(e.responseBody).toArray()}catch(t){}if(null!==n){t.push(new i(n));break}case"text":try{n=e.responseText}catch(e){t._mode="text:vbarray";break}if(n.length>t._pos){var r=n.substr(t._pos);if("x-user-defined"===t._charset){for(var s=new i(r.length),a=0;a<r.length;a++)s[a]=255&r.charCodeAt(a);t.push(s)}else t.push(r,t._charset);t._pos=n.length}break;case"arraybuffer":if(e.readyState!==c.DONE||!e.response)break;n=e.response,t.push(new i(new Uint8Array(n)));break;case"moz-chunked-arraybuffer":if(n=e.response,e.readyState!==c.LOADING||!n)break;t.push(new i(new Uint8Array(n)));break;case"ms-stream":if(n=e.response,e.readyState!==c.LOADING)break;var l=new o.MSStreamReader;l.onprogress=function(){l.result.byteLength>t._pos&&(t.push(new i(new Uint8Array(l.result.slice(t._pos)))),t._pos=l.result.byteLength)},l.onload=function(){t.push(null)},l.readAsArrayBuffer(n)}t._xhr.readyState===c.DONE&&"ms-stream"!==t._mode&&t.push(null)}},{"./capability":"p5a1",inherits:"Bm0n","readable-stream":"JaqQ",process:"pBGv",buffer:"dskh"}],AH4k:[function(t,e,n){var r=t("buffer").Buffer;e.exports=function(t){if(t instanceof Uint8Array){if(0===t.byteOffset&&t.byteLength===t.buffer.byteLength)return t.buffer;if("function"==typeof t.buffer.slice)return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}if(r.isBuffer(t)){for(var e=new Uint8Array(t.length),n=t.length,i=0;i<n;i++)e[i]=t[i];return e.buffer}throw new Error("Argument must be a Buffer")}},{buffer:"dskh"}],yL7F:[function(t,e,n){t("buffer").Buffer,t("process");var r=t("buffer").Buffer,i=arguments[3],o=t("process"),s=t("./capability"),a=t("inherits"),l=t("./response"),c=t("readable-stream"),u=t("to-arraybuffer"),h=l.IncomingMessage,f=l.readyStates;function d(t,e){return s.fetch&&e?"fetch":s.mozchunkedarraybuffer?"moz-chunked-arraybuffer":s.msstream?"ms-stream":s.arraybuffer&&t?"arraybuffer":s.vbArray&&t?"text:vbarray":"text"}var p=e.exports=function(t){var e,n=this;c.Writable.call(n),n._opts=t,n._body=[],n._headers={},t.auth&&n.setHeader("Authorization","Basic "+new r(t.auth).toString("base64")),Object.keys(t.headers).forEach((function(e){n.setHeader(e,t.headers[e])}));var i=!0;if("disable-fetch"===t.mode||"requestTimeout"in t&&!s.abortController)i=!1,e=!0;else if("prefer-streaming"===t.mode)e=!1;else if("allow-wrong-content-type"===t.mode)e=!s.overrideMimeType;else{if(t.mode&&"default"!==t.mode&&"prefer-fast"!==t.mode)throw new Error("Invalid value for opts.mode");e=!0}n._mode=d(e,i),n._fetchTimer=null,n.on("finish",(function(){n._onFinish()}))};function m(t){try{var e=t.status;return null!==e&&0!==e}catch(t){return!1}}a(p,c.Writable),p.prototype.setHeader=function(t,e){var n=t.toLowerCase();-1===g.indexOf(n)&&(this._headers[n]={name:t,value:e})},p.prototype.getHeader=function(t){var e=this._headers[t.toLowerCase()];return e?e.value:null},p.prototype.removeHeader=function(t){delete this._headers[t.toLowerCase()]},p.prototype._onFinish=function(){var t=this;if(!t._destroyed){var e=t._opts,n=t._headers,a=null;"GET"!==e.method&&"HEAD"!==e.method&&(a=s.arraybuffer?u(r.concat(t._body)):s.blobConstructor?new i.Blob(t._body.map((function(t){return u(t)})),{type:(n["content-type"]||{}).value||""}):r.concat(t._body).toString());var l=[];if(Object.keys(n).forEach((function(t){var e=n[t].name,r=n[t].value;Array.isArray(r)?r.forEach((function(t){l.push([e,t])})):l.push([e,r])})),"fetch"===t._mode){var c=null;if(s.abortController){var h=new AbortController;c=h.signal,t._fetchAbortController=h,"requestTimeout"in e&&0!==e.requestTimeout&&(t._fetchTimer=i.setTimeout((function(){t.emit("requestTimeout"),t._fetchAbortController&&t._fetchAbortController.abort()}),e.requestTimeout))}i.fetch(t._opts.url,{method:t._opts.method,headers:l,body:a||void 0,mode:"cors",credentials:e.withCredentials?"include":"same-origin",signal:c}).then((function(e){t._fetchResponse=e,t._connect()}),(function(e){i.clearTimeout(t._fetchTimer),t._destroyed||t.emit("error",e)}))}else{var d=t._xhr=new i.XMLHttpRequest;try{d.open(t._opts.method,t._opts.url,!0)}catch(e){return void o.nextTick((function(){t.emit("error",e)}))}"responseType"in d&&(d.responseType=t._mode.split(":")[0]),"withCredentials"in d&&(d.withCredentials=!!e.withCredentials),"text"===t._mode&&"overrideMimeType"in d&&d.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in e&&(d.timeout=e.requestTimeout,d.ontimeout=function(){t.emit("requestTimeout")}),l.forEach((function(t){d.setRequestHeader(t[0],t[1])})),t._response=null,d.onreadystatechange=function(){switch(d.readyState){case f.LOADING:case f.DONE:t._onXHRProgress()}},"moz-chunked-arraybuffer"===t._mode&&(d.onprogress=function(){t._onXHRProgress()}),d.onerror=function(){t._destroyed||t.emit("error",new Error("XHR error"))};try{d.send(a)}catch(e){return void o.nextTick((function(){t.emit("error",e)}))}}}},p.prototype._onXHRProgress=function(){m(this._xhr)&&!this._destroyed&&(this._response||this._connect(),this._response._onXHRProgress())},p.prototype._connect=function(){var t=this;t._destroyed||(t._response=new h(t._xhr,t._fetchResponse,t._mode,t._fetchTimer),t._response.on("error",(function(e){t.emit("error",e)})),t.emit("response",t._response))},p.prototype._write=function(t,e,n){this._body.push(t),n()},p.prototype.abort=p.prototype.destroy=function(){this._destroyed=!0,i.clearTimeout(this._fetchTimer),this._response&&(this._response._destroyed=!0),this._xhr?this._xhr.abort():this._fetchAbortController&&this._fetchAbortController.abort()},p.prototype.end=function(t,e,n){"function"==typeof t&&(n=t,t=void 0),c.Writable.prototype.end.call(this,t,e,n)},p.prototype.flushHeaders=function(){},p.prototype.setTimeout=function(){},p.prototype.setNoDelay=function(){},p.prototype.setSocketKeepAlive=function(){};var g=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]},{"./capability":"p5a1",inherits:"Bm0n","./response":"UxIR","readable-stream":"JaqQ","to-arraybuffer":"AH4k",buffer:"dskh",process:"pBGv"}],K5Tb:[function(t,e,n){e.exports=function(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var i in n)r.call(n,i)&&(t[i]=n[i])}return t};var r=Object.prototype.hasOwnProperty},{}],OpTI:[function(t,e,n){e.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],oWqx:[function(t,e,n){var r,i=arguments[3];!function(t){var o="object"==typeof n&&n&&!n.nodeType&&n,s="object"==typeof e&&e&&!e.nodeType&&e,a="object"==typeof i&&i;a.global!==a&&a.window!==a&&a.self!==a||(t=a);var l,c,u=2147483647,h=36,f=/^xn--/,d=/[^\x20-\x7E]/,p=/[\x2E\u3002\uFF0E\uFF61]/g,m={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},g=Math.floor,v=String.fromCharCode;function y(t){throw new RangeError(m[t])}function b(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function _(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),r+b((t=t.replace(p,".")).split("."),e).join(".")}function x(t){for(var e,n,r=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function w(t){return b(t,(function(t){var e="";return t>65535&&(e+=v((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+v(t)})).join("")}function M(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function S(t,e,n){var r=0;for(t=n?g(t/700):t>>1,t+=g(t/e);t>455;r+=h)t=g(t/35);return g(r+36*t/(t+38))}function E(t){var e,n,r,i,o,s,a,l,c,f,d,p=[],m=t.length,v=0,b=128,_=72;for((n=t.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&y("not-basic"),p.push(t.charCodeAt(r));for(i=n>0?n+1:0;i<m;){for(o=v,s=1,a=h;i>=m&&y("invalid-input"),((l=(d=t.charCodeAt(i++))-48<10?d-22:d-65<26?d-65:d-97<26?d-97:h)>=h||l>g((u-v)/s))&&y("overflow"),v+=l*s,!(l<(c=a<=_?1:a>=_+26?26:a-_));a+=h)s>g(u/(f=h-c))&&y("overflow"),s*=f;_=S(v-o,e=p.length+1,0==o),g(v/e)>u-b&&y("overflow"),b+=g(v/e),v%=e,p.splice(v++,0,b)}return w(p)}function T(t){var e,n,r,i,o,s,a,l,c,f,d,p,m,b,_,w=[];for(p=(t=x(t)).length,e=128,n=0,o=72,s=0;s<p;++s)(d=t[s])<128&&w.push(v(d));for(r=i=w.length,i&&w.push("-");r<p;){for(a=u,s=0;s<p;++s)(d=t[s])>=e&&d<a&&(a=d);for(a-e>g((u-n)/(m=r+1))&&y("overflow"),n+=(a-e)*m,e=a,s=0;s<p;++s)if((d=t[s])<e&&++n>u&&y("overflow"),d==e){for(l=n,c=h;!(l<(f=c<=o?1:c>=o+26?26:c-o));c+=h)_=l-f,b=h-f,w.push(v(M(f+_%b,0))),l=g(_/b);w.push(v(M(l,0))),o=S(n,m,r==i),n=0,++r}++n,++e}return w.join("")}if(l={version:"1.4.1",ucs2:{decode:x,encode:w},decode:E,encode:T,toASCII:function(t){return _(t,(function(t){return d.test(t)?"xn--"+T(t):t}))},toUnicode:function(t){return _(t,(function(t){return f.test(t)?E(t.slice(4).toLowerCase()):t}))}},"function"==typeof r&&"object"==typeof r.amd&&r.amd)r("punycode",(function(){return l}));else if(o&&s)if(e.exports==o)s.exports=l;else for(c in l)l.hasOwnProperty(c)&&(o[c]=l[c]);else t.punycode=l}(this)},{}],YsIc:[function(t,e,n){"use strict";e.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},{}],J6GP:[function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,n,o){e=e||"&",n=n||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var l=1e3;o&&"number"==typeof o.maxKeys&&(l=o.maxKeys);var c=t.length;l>0&&c>l&&(c=l);for(var u=0;u<c;++u){var h,f,d,p,m=t[u].replace(a,"%20"),g=m.indexOf(n);g>=0?(h=m.substr(0,g),f=m.substr(g+1)):(h=m,f=""),d=decodeURIComponent(h),p=decodeURIComponent(f),r(s,d)?i(s[d])?s[d].push(p):s[d]=[s[d],p]:s[d]=p}return s};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],bvhO:[function(t,e,n){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,n,a){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?o(s(t),(function(s){var a=encodeURIComponent(r(s))+n;return i(t[s])?o(t[s],(function(t){return a+encodeURIComponent(r(t))})).join(e):a+encodeURIComponent(r(t[s]))})).join(e):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var s=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},{}],fk5h:[function(t,e,n){"use strict";n.decode=n.parse=t("./decode"),n.encode=n.stringify=t("./encode")},{"./decode":"J6GP","./encode":"bvhO"}],Mej7:[function(t,e,n){"use strict";var r=t("punycode"),i=t("./util");function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}n.parse=b,n.resolve=function(t,e){return b(t,!1,!0).resolve(e)},n.resolveObject=function(t,e){return t?b(t,!1,!0).resolveObject(e):e},n.format=function(t){return i.isString(t)&&(t=b(t)),t instanceof o?t.format():o.prototype.format.call(t)},n.Url=o;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(c),h=["%","/","?",";","#"].concat(u),f=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=t("querystring");function b(t,e,n){if(t&&i.isObject(t)&&t instanceof o)return t;var r=new o;return r.parse(t,e,n),r}o.prototype.parse=function(t,e,n){if(!i.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var o=t.indexOf("?"),a=-1!==o&&o<t.indexOf("#")?"?":"#",c=t.split(a);c[0]=c[0].replace(/\\/g,"/");var b=t=c.join(a);if(b=b.trim(),!n&&1===t.split("#").length){var _=l.exec(b);if(_)return this.path=b,this.href=b,this.pathname=_[1],_[2]?(this.search=_[2],this.query=e?y.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var x=s.exec(b);if(x){var w=(x=x[0]).toLowerCase();this.protocol=w,b=b.substr(x.length)}if(n||x||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var M="//"===b.substr(0,2);!M||x&&g[x]||(b=b.substr(2),this.slashes=!0)}if(!g[x]&&(M||x&&!v[x])){for(var S,E,T=-1,C=0;C<f.length;C++)-1!==(A=b.indexOf(f[C]))&&(-1===T||A<T)&&(T=A);for(-1!==(E=-1===T?b.lastIndexOf("@"):b.lastIndexOf("@",T))&&(S=b.slice(0,E),b=b.slice(E+1),this.auth=decodeURIComponent(S)),T=-1,C=0;C<h.length;C++){var A;-1!==(A=b.indexOf(h[C]))&&(-1===T||A<T)&&(T=A)}-1===T&&(T=b.length),this.host=b.slice(0,T),b=b.slice(T),this.parseHost(),this.hostname=this.hostname||"";var P="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!P)for(var L=this.hostname.split(/\./),R=(C=0,L.length);C<R;C++){var O=L[C];if(O&&!O.match(d)){for(var k="",I=0,D=O.length;I<D;I++)O.charCodeAt(I)>127?k+="x":k+=O[I];if(!k.match(d)){var N=L.slice(0,C),j=L.slice(C+1),F=O.match(p);F&&(N.push(F[1]),j.unshift(F[2])),j.length&&(b="/"+j.join(".")+b),this.hostname=N.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),P||(this.hostname=r.toASCII(this.hostname));var B=this.port?":"+this.port:"",z=this.hostname||"";this.host=z+B,this.href+=this.host,P&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!m[w])for(C=0,R=u.length;C<R;C++){var U=u[C];if(-1!==b.indexOf(U)){var H=encodeURIComponent(U);H===U&&(H=escape(U)),b=b.split(U).join(H)}}var G=b.indexOf("#");-1!==G&&(this.hash=b.substr(G),b=b.slice(0,G));var W=b.indexOf("?");if(-1!==W?(this.search=b.substr(W),this.query=b.substr(W+1),e&&(this.query=y.parse(this.query)),b=b.slice(0,W)):e&&(this.search="",this.query={}),b&&(this.pathname=b),v[w]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){B=this.pathname||"";var V=this.search||"";this.path=B+V}return this.href=this.format(),this},o.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,s="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(s=y.stringify(this.query));var a=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||v[e])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),e+o+(n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+r},o.prototype.resolve=function(t){return this.resolveObject(b(t,!1,!0)).format()},o.prototype.resolveObject=function(t){if(i.isString(t)){var e=new o;e.parse(t,!1,!0),t=e}for(var n=new o,r=Object.keys(this),s=0;s<r.length;s++){var a=r[s];n[a]=this[a]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var l=Object.keys(t),c=0;c<l.length;c++){var u=l[c];"protocol"!==u&&(n[u]=t[u])}return v[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!v[t.protocol]){for(var h=Object.keys(t),f=0;f<h.length;f++){var d=h[f];n[d]=t[d]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||g[t.protocol])n.pathname=t.pathname;else{for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var m=n.pathname||"",y=n.search||"";n.path=m+y}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),_=t.host||t.pathname&&"/"===t.pathname.charAt(0),x=_||b||n.host&&t.pathname,w=x,M=n.pathname&&n.pathname.split("/")||[],S=(p=t.pathname&&t.pathname.split("/")||[],n.protocol&&!v[n.protocol]);if(S&&(n.hostname="",n.port=null,n.host&&(""===M[0]?M[0]=n.host:M.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),x=x&&(""===p[0]||""===M[0])),_)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,M=p;else if(p.length)M||(M=[]),M.pop(),M=M.concat(p),n.search=t.search,n.query=t.query;else if(!i.isNullOrUndefined(t.search))return S&&(n.hostname=n.host=M.shift(),(P=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=P.shift(),n.host=n.hostname=P.shift())),n.search=t.search,n.query=t.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!M.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var E=M.slice(-1)[0],T=(n.host||t.host||M.length>1)&&("."===E||".."===E)||""===E,C=0,A=M.length;A>=0;A--)"."===(E=M[A])?M.splice(A,1):".."===E?(M.splice(A,1),C++):C&&(M.splice(A,1),C--);if(!x&&!w)for(;C--;C)M.unshift("..");!x||""===M[0]||M[0]&&"/"===M[0].charAt(0)||M.unshift(""),T&&"/"!==M.join("/").substr(-1)&&M.push("");var P,L=""===M[0]||M[0]&&"/"===M[0].charAt(0);return S&&(n.hostname=n.host=L?"":M.length?M.shift():"",(P=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=P.shift(),n.host=n.hostname=P.shift())),(x=x||n.host&&M.length)&&!L&&M.unshift(""),M.length?n.pathname=M.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var t=this.host,e=a.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{punycode:"oWqx","./util":"YsIc",querystring:"fk5h"}],KKrj:[function(t,e,n){var r=arguments[3],i=t("./lib/request"),o=t("./lib/response"),s=t("xtend"),a=t("builtin-status-codes"),l=t("url"),c=n;c.request=function(t,e){t="string"==typeof t?l.parse(t):s(t);var n=-1===r.location.protocol.search(/^https?:$/)?"http:":"",o=t.protocol||n,a=t.hostname||t.host,c=t.port,u=t.path||"/";a&&-1!==a.indexOf(":")&&(a="["+a+"]"),t.url=(a?o+"//"+a:"")+(c?":"+c:"")+u,t.method=(t.method||"GET").toUpperCase(),t.headers=t.headers||{};var h=new i(t);return e&&h.on("response",e),h},c.get=function(t,e){var n=c.request(t,e);return n.end(),n},c.ClientRequest=i,c.IncomingMessage=o.IncomingMessage,c.Agent=function(){},c.Agent.defaultMaxSockets=4,c.globalAgent=new c.Agent,c.STATUS_CODES=a,c.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]},{"./lib/request":"yL7F","./lib/response":"UxIR",xtend:"K5Tb","builtin-status-codes":"OpTI",url:"Mej7"}],wVMl:[function(t,e,n){var r=t("http"),i=t("url"),o=e.exports;for(var s in r)r.hasOwnProperty(s)&&(o[s]=r[s]);function a(t){if("string"==typeof t&&(t=i.parse(t)),t.protocol||(t.protocol="https:"),"https:"!==t.protocol)throw new Error('Protocol "'+t.protocol+'" not supported. Expected "https:"');return t}o.request=function(t,e){return t=a(t),r.request.call(this,t,e)},o.get=function(t,e){return t=a(t),r.get.call(this,t,e)}},{http:"KKrj",url:"Mej7"}],SHlS:[function(t,e,n){t("buffer").Buffer;var r=t("buffer").Buffer;Object.defineProperty(n,"__esModule",{value:!0}),n.HttpClient=void 0;var i=v(t("@babel/runtime/helpers/defineProperty")),o=v(t("@babel/runtime/regenerator")),s=v(t("@babel/runtime/helpers/asyncToGenerator")),a=v(t("@babel/runtime/helpers/classCallCheck")),l=v(t("@babel/runtime/helpers/createClass")),c=v(t("@babel/runtime/helpers/inherits")),u=v(t("@babel/runtime/helpers/possibleConstructorReturn")),h=v(t("@babel/runtime/helpers/getPrototypeOf")),f=v(t("http")),d=v(t("https")),p=v(t("url")),m=t("./base"),g=t("../../utils");function v(t){return t&&t.__esModule?t:{default:t}}function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function _(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,h.default)(t);if(e){var i=(0,h.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}var x=function(t){(0,c.default)(n,t);var e=_(n);function n(t,r){var i;return(0,a.default)(this,n),(i=e.call(this)).response=t,i.dataPromise=r,i}return(0,l.default)(n,[{key:"getHeader",value:function(t){return this.response.headers[t]}},{key:"getData",value:function(){var t=(0,s.default)(o.default.mark((function t(){var e;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dataPromise;case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"status",get:function(){return this.response.statusCode}}]),n}(m.BaseResponse),w=function(t){(0,c.default)(n,t);var e=_(n);function n(t){var r;return(0,a.default)(this,n),(r=e.call(this,t)).parsedUrl=p.default.parse(r.url),r.httpApi="http:"===r.parsedUrl.protocol?f.default:d.default,r}return(0,l.default)(n,[{key:"constructRequest",value:function(t,e){var n=this;return new Promise((function(i,o){var s=n.httpApi.get(b(b({},n.parsedUrl),{},{headers:t}),(function(t){var e=new Promise((function(e){var n=[];t.on("data",(function(t){n.push(t)})),t.on("end",(function(){var t=r.concat(n).buffer;e(t)})),t.on("error",o)}));i(new x(t,e))}));s.on("error",o),e&&(e.aborted&&s.destroy(new g.AbortError("Request aborted")),e.addEventListener("abort",(function(){return s.destroy(new g.AbortError("Request aborted"))})))}))}},{key:"request",value:function(){var t=(0,s.default)(o.default.mark((function t(){var e,n,r,i,s=arguments;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=s.length>0&&void 0!==s[0]?s[0]:{},n=e.headers,r=e.signal,t.next=3,this.constructRequest(n,r);case 3:return i=t.sent,t.abrupt("return",i);case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),n}(m.BaseClient);n.HttpClient=w},{"@babel/runtime/helpers/defineProperty":"IxO8","@babel/runtime/regenerator":"PMvg","@babel/runtime/helpers/asyncToGenerator":"agGE","@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW","@babel/runtime/helpers/inherits":"d4H2","@babel/runtime/helpers/possibleConstructorReturn":"pxk2","@babel/runtime/helpers/getPrototypeOf":"UJE0",http:"KKrj",https:"wVMl",url:"Mej7","./base":"uL1U","../../utils":"FOZT",buffer:"dskh"}],itmA:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.makeFetchSource=M,n.makeXHRSource=S,n.makeHttpSource=E,n.makeRemoteSource=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.forceXHR,i=void 0!==n&&n,o=(0,r.default)(e,["forceXHR"]);return"function"!=typeof fetch||i?"undefined"!=typeof XMLHttpRequest?S(t,o):E(t,o):M(t,o)};var r=y(t("@babel/runtime/helpers/objectWithoutProperties")),i=y(t("@babel/runtime/helpers/defineProperty")),o=y(t("@babel/runtime/regenerator")),s=y(t("@babel/runtime/helpers/asyncToGenerator")),a=y(t("@babel/runtime/helpers/classCallCheck")),l=y(t("@babel/runtime/helpers/createClass")),c=y(t("@babel/runtime/helpers/inherits")),u=y(t("@babel/runtime/helpers/possibleConstructorReturn")),h=y(t("@babel/runtime/helpers/getPrototypeOf")),f=t("./httputils"),d=t("./basesource"),p=t("./blockedsource"),m=t("./client/fetch"),g=t("./client/xhr"),v=t("./client/http");function y(t){return t&&t.__esModule?t:{default:t}}function b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?b(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var x=function(t){(0,c.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,h.default)(t);if(e){var i=(0,h.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}(n);function n(t,r,i,o){var s;return(0,a.default)(this,n),(s=e.call(this)).client=t,s.headers=r,s.maxRanges=i,s.allowFullFile=o,s._fileSize=null,s}return(0,l.default)(n,[{key:"fetch",value:function(){var t=(0,s.default)(o.default.mark((function t(e,n){var r=this;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.maxRanges>=e.length)){t.next=4;break}return t.abrupt("return",this.fetchSlices(e,n));case 4:this.maxRanges>0&&e.length;case 5:return t.next=7,Promise.all(e.map((function(t){return r.fetchSlice(t,n)})));case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"fetchSlices",value:function(){var t=(0,s.default)(o.default.mark((function t(e,n){var r,i,s,a,l,c,u,h,d,p,m,g,v,y=this;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.client.request({headers:_(_({},this.headers),{},{Range:"bytes=".concat(e.map((function(t){var e=t.offset,n=t.length;return"".concat(e,"-").concat(e+n)})).join(","))}),signal:n});case 2:if((r=t.sent).ok){t.next=7;break}throw new Error("Error fetching data.");case 7:if(206!==r.status){t.next=32;break}if(i=(0,f.parseContentType)(r.getHeader("content-type")),s=i.type,a=i.params,"multipart/byteranges"!==s){t.next=18;break}return t.t0=f.parseByteRanges,t.next=13,r.getData();case 13:return t.t1=t.sent,t.t2=a.boundary,l=(0,t.t0)(t.t1,t.t2),this._fileSize=l[0].fileSize||null,t.abrupt("return",l);case 18:return t.next=20,r.getData();case 20:if(c=t.sent,u=(0,f.parseContentRange)(r.getHeader("content-range")),h=u.start,d=u.end,p=u.total,this._fileSize=p||null,m=[{data:c,offset:h,length:d-h}],!(e.length>1)){t.next=29;break}return t.next=27,Promise.all(e.slice(1).map((function(t){return y.fetchSlice(t,n)})));case 27:return g=t.sent,t.abrupt("return",m.concat(g));case 29:return t.abrupt("return",m);case 32:if(this.allowFullFile){t.next=34;break}throw new Error("Server responded with full file");case 34:return t.next=36,r.getData();case 36:return v=t.sent,this._fileSize=v.byteLength,t.abrupt("return",[{data:v,offset:0,length:v.byteLength}]);case 39:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"fetchSlice",value:function(){var t=(0,s.default)(o.default.mark((function t(e,n){var r,i,s,a,l,c,u;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.offset,i=e.length,t.next=3,this.client.request({headers:_(_({},this.headers),{},{Range:"bytes=".concat(r,"-").concat(r+i)}),signal:n});case 3:if((s=t.sent).ok){t.next=8;break}throw new Error("Error fetching data.");case 8:if(206!==s.status){t.next=17;break}return t.next=11,s.getData();case 11:return a=t.sent,l=(0,f.parseContentRange)(s.getHeader("content-range")),c=l.total,this._fileSize=c||null,t.abrupt("return",{data:a,offset:r,length:i});case 17:if(this.allowFullFile){t.next=19;break}throw new Error("Server responded with full file");case 19:return t.next=21,s.getData();case 21:return u=t.sent,this._fileSize=u.byteLength,t.abrupt("return",{data:u,offset:0,length:u.byteLength});case 24:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"fileSize",get:function(){return this._fileSize}}]),n}(d.BaseSource);function w(t,e){var n=e.blockSize,r=e.cacheSize;return null===n?t:new p.BlockedSource(t,n,r)}function M(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.headers,i=void 0===n?{}:n,o=e.credentials,s=e.maxRanges,a=void 0===s?0:s,l=e.allowFullFile,c=void 0!==l&&l,u=(0,r.default)(e,["headers","credentials","maxRanges","allowFullFile"]),h=new m.FetchClient(t,o);return w(new x(h,i,a,c),u)}function S(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.headers,i=void 0===n?{}:n,o=e.maxRanges,s=void 0===o?0:o,a=e.allowFullFile,l=void 0!==a&&a,c=(0,r.default)(e,["headers","maxRanges","allowFullFile"]),u=new g.XHRClient(t);return w(new x(u,i,s,l),c)}function E(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.headers,i=void 0===n?{}:n,o=e.maxRanges,s=void 0===o?0:o,a=e.allowFullFile,l=void 0!==a&&a,c=(0,r.default)(e,["headers","maxRanges","allowFullFile"]),u=new v.HttpClient(t);return w(new x(u,i,s,l),c)}},{"@babel/runtime/helpers/objectWithoutProperties":"U8F3","@babel/runtime/helpers/defineProperty":"IxO8","@babel/runtime/regenerator":"PMvg","@babel/runtime/helpers/asyncToGenerator":"agGE","@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW","@babel/runtime/helpers/inherits":"d4H2","@babel/runtime/helpers/possibleConstructorReturn":"pxk2","@babel/runtime/helpers/getPrototypeOf":"UJE0","./httputils":"ZJpj","./basesource":"LzCD","./blockedsource":"xD7g","./client/fetch":"Un5s","./client/xhr":"hvgd","./client/http":"SHlS"}],wM9h:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.makeBufferSource=function(t){return new h(t)};var r=u(t("@babel/runtime/helpers/classCallCheck")),i=u(t("@babel/runtime/helpers/createClass")),o=u(t("@babel/runtime/helpers/inherits")),s=u(t("@babel/runtime/helpers/possibleConstructorReturn")),a=u(t("@babel/runtime/helpers/getPrototypeOf")),l=t("./basesource"),c=t("../utils");function u(t){return t&&t.__esModule?t:{default:t}}var h=function(t){(0,o.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,a.default)(t);if(e){var i=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}(n);function n(t){var i;return(0,r.default)(this,n),(i=e.call(this)).arrayBuffer=t,i}return(0,i.default)(n,[{key:"fetchSlice",value:function(t,e){if(e&&e.aborted)throw new c.AbortError("Request aborted");return this.arrayBuffer.slice(t.offset,t.offset+t.length)}}]),n}(l.BaseSource)},{"@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW","@babel/runtime/helpers/inherits":"d4H2","@babel/runtime/helpers/possibleConstructorReturn":"pxk2","@babel/runtime/helpers/getPrototypeOf":"UJE0","./basesource":"LzCD","../utils":"FOZT"}],GiEG:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.makeFileReaderSource=function(t){return new h(t)};var r=u(t("@babel/runtime/regenerator")),i=u(t("@babel/runtime/helpers/asyncToGenerator")),o=u(t("@babel/runtime/helpers/classCallCheck")),s=u(t("@babel/runtime/helpers/createClass")),a=u(t("@babel/runtime/helpers/inherits")),l=u(t("@babel/runtime/helpers/possibleConstructorReturn")),c=u(t("@babel/runtime/helpers/getPrototypeOf"));function u(t){return t&&t.__esModule?t:{default:t}}var h=function(t){(0,a.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,c.default)(t);if(e){var i=(0,c.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,l.default)(this,n)}}(n);function n(t){var r;return(0,o.default)(this,n),(r=e.call(this)).file=t,r}return(0,s.default)(n,[{key:"fetchSlice",value:function(){var t=(0,i.default)(r.default.mark((function t(e,n){var i=this;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){var o=i.file.slice(e.offset,e.offset+e.length),s=new FileReader;s.onload=function(e){return t(e.target.result)},s.onerror=r,s.onabort=r,s.readAsArrayBuffer(o),n&&n.addEventListener("abort",(function(){return s.abort()}))})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),n}(t("./basesource").BaseSource)},{"@babel/runtime/regenerator":"PMvg","@babel/runtime/helpers/asyncToGenerator":"agGE","@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW","@babel/runtime/helpers/inherits":"d4H2","@babel/runtime/helpers/possibleConstructorReturn":"pxk2","@babel/runtime/helpers/getPrototypeOf":"UJE0","./basesource":"LzCD"}],G7Cz:[function(t,e,n){t("buffer").Buffer;var r=t("buffer").Buffer;Object.defineProperty(n,"__esModule",{value:!0}),n.makeFileSource=function(t){return new m(t)};var i=f(t("@babel/runtime/regenerator")),o=f(t("@babel/runtime/helpers/asyncToGenerator")),s=f(t("@babel/runtime/helpers/classCallCheck")),a=f(t("@babel/runtime/helpers/createClass")),l=f(t("@babel/runtime/helpers/inherits")),c=f(t("@babel/runtime/helpers/possibleConstructorReturn")),u=f(t("@babel/runtime/helpers/getPrototypeOf")),h=t("fs");function f(t){return t&&t.__esModule?t:{default:t}}function d(t){return new Promise((function(e,n){(0,h.close)(t,(function(t){t?n(t):e()}))}))}function p(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new Promise((function(t,n){h.read.apply(void 0,e.concat([function(e,r,i){e?n(e):t({bytesRead:r,buffer:i})}]))}))}var m=function(t){(0,l.default)(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,u.default)(t);if(e){var i=(0,u.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.default)(this,n)}}(n);function n(t){var r;return(0,s.default)(this,n),(r=e.call(this)).path=t,r.openRequest=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return new Promise((function(r,i){(0,h.open)(t,e,n,(function(t,e){t?i(t):r(e)}))}))}(t,"r"),r}return(0,a.default)(n,[{key:"fetchSlice",value:function(){var t=(0,o.default)(i.default.mark((function t(e){var n,o,s;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openRequest;case 2:return n=t.sent,t.next=5,p(n,r.alloc(e.length),0,e.length,e.offset);case 5:return o=t.sent,s=o.buffer,t.abrupt("return",s.buffer);case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"close",value:function(){var t=(0,o.default)(i.default.mark((function t(){var e;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openRequest;case 2:return e=t.sent,t.next=5,d(e);case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),n}(t("./basesource").BaseSource)},{"@babel/runtime/regenerator":"PMvg","@babel/runtime/helpers/asyncToGenerator":"agGE","@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW","@babel/runtime/helpers/inherits":"d4H2","@babel/runtime/helpers/possibleConstructorReturn":"pxk2","@babel/runtime/helpers/getPrototypeOf":"UJE0",fs:"rDCW","./basesource":"LzCD",buffer:"dskh"}],BGyE:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.writeGeotiff=function(t,e){var n,o,s,a;"number"==typeof t[0]?(n=e.height||e.ImageLength,s=e.width||e.ImageWidth,o=t.length/(n*s),a=t):(o=t.length,n=t[0].length,s=t[0][0].length,a=[],(0,i.times)(n,(function(e){(0,i.times)(s,(function(n){(0,i.times)(o,(function(r){a.push(t[r][e][n])}))}))}))),e.ImageLength=n,delete e.height,e.ImageWidth=s,delete e.width,e.BitsPerSample||(e.BitsPerSample=(0,i.times)(o,(function(){return 8}))),g.forEach((function(t){var n=t[0];if(!e[n]){var r=t[1];e[n]=r}})),e.PhotometricInterpretation||(e.PhotometricInterpretation=3===e.BitsPerSample.length?2:1),e.SamplesPerPixel||(e.SamplesPerPixel=[o]),e.StripByteCounts||(e.StripByteCounts=[o*n*s]),e.ModelPixelScale||(e.ModelPixelScale=[360/s,180/n,0]),e.SampleFormat||(e.SampleFormat=(0,i.times)(o,(function(){return 1})));var l=Object.keys(e).filter((function(t){return(0,i.endsWith)(t,"GeoKey")})).sort((function(t,e){return u[t]-u[e]}));if(!e.GeoKeyDirectory){var c=[1,1,0,l.length];l.forEach((function(t){var n,i,o,s=Number(u[t]);c.push(s),"SHORT"===r.fieldTagTypes[s]?(n=1,i=0,o=e[t]):"GeogCitationGeoKey"===t?(n=e.GeoAsciiParams.length,i=Number(u.GeoAsciiParams),o=0):console.log("[geotiff.js] couldn't get TIFFTagLocation for ".concat(t)),c.push(i),c.push(n),c.push(o)})),e.GeoKeyDirectory=c}for(var h in l)l.hasOwnProperty(h)&&delete e[h];["Compression","ExtraSamples","GeographicTypeGeoKey","GTModelTypeGeoKey","GTRasterTypeGeoKey","ImageLength","ImageWidth","PhotometricInterpretation","PlanarConfiguration","ResolutionUnit","SamplesPerPixel","XPosition","YPosition"].forEach((function(t){e[t]&&(e[t]=function(t){return Array.isArray(t)?t:[t]}(e[t]))}));var f=function(t){var e={};for(var n in t)"StripOffsets"!==n&&(u[n]||console.error(n,"not in name2code:",Object.keys(u)),e[u[n]]=t[n]);return e}(e);return m(a,s,n,f)};var r=t("./globals"),i=t("./utils");function o(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=s(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function s(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var l=(0,i.invert)(r.fieldTagNames),c=(0,i.invert)(r.geoKeyNames),u={};(0,i.assign)(u,l),(0,i.assign)(u,c);var h=(0,i.invert)(r.fieldTypeNames),f=1e3,d={nextZero:function(t,e){for(var n=e;0!==t[n];)n++;return n},readUshort:function(t,e){return t[e]<<8|t[e+1]},readShort:function(t,e){var n=d.ui8;return n[0]=t[e+1],n[1]=t[e+0],d.i16[0]},readInt:function(t,e){var n=d.ui8;return n[0]=t[e+3],n[1]=t[e+2],n[2]=t[e+1],n[3]=t[e+0],d.i32[0]},readUint:function(t,e){var n=d.ui8;return n[0]=t[e+3],n[1]=t[e+2],n[2]=t[e+1],n[3]=t[e+0],d.ui32[0]},readASCII:function(t,e,n){return n.map((function(n){return String.fromCharCode(t[e+n])})).join("")},readFloat:function(t,e){var n=d.ui8;return(0,i.times)(4,(function(r){n[r]=t[e+3-r]})),d.fl32[0]},readDouble:function(t,e){var n=d.ui8;return(0,i.times)(8,(function(r){n[r]=t[e+7-r]})),d.fl64[0]},writeUshort:function(t,e,n){t[e]=n>>8&255,t[e+1]=255&n},writeUint:function(t,e,n){t[e]=n>>24&255,t[e+1]=n>>16&255,t[e+2]=n>>8&255,t[e+3]=n>>0&255},writeASCII:function(t,e,n){(0,i.times)(n.length,(function(r){t[e+r]=n.charCodeAt(r)}))},ui8:new Uint8Array(8)};d.fl64=new Float64Array(d.ui8.buffer),d.writeDouble=function(t,e,n){d.fl64[0]=n,(0,i.times)(8,(function(n){t[e+n]=d.ui8[7-n]}))};var p=function(t,e,n,s){var a=n,l=Object.keys(s).filter((function(t){return null!=t&&"undefined"!==t}));t.writeUshort(e,a,l.length);var c,u=(a+=2)+12*l.length+4,f=o(l);try{var d=function(){var n=c.value,o=null;"number"==typeof n?o=n:"string"==typeof n&&(o=parseInt(n,10));var l=r.fieldTagTypes[o],f=h[l];if(null==l||void 0===l||void 0===l)throw new Error("unknown type of tag: ".concat(o));var d=s[n];if(void 0===d)throw new Error("failed to get value for key ".concat(n));"ASCII"===l&&"string"==typeof d&&!1===(0,i.endsWith)(d,"\0")&&(d+="\0");var p=d.length;t.writeUshort(e,a,o),a+=2,t.writeUshort(e,a,f),a+=2,t.writeUint(e,a,p);var m=[-1,1,1,2,4,8,0,0,0,0,0,0,8][f]*p,g=a+=4;m>4&&(t.writeUint(e,a,u),g=u),"ASCII"===l?t.writeASCII(e,g,d):"SHORT"===l?(0,i.times)(p,(function(n){t.writeUshort(e,g+2*n,d[n])})):"LONG"===l?(0,i.times)(p,(function(n){t.writeUint(e,g+4*n,d[n])})):"RATIONAL"===l?(0,i.times)(p,(function(n){t.writeUint(e,g+8*n,Math.round(1e4*d[n])),t.writeUint(e,g+8*n+4,1e4)})):"DOUBLE"===l&&(0,i.times)(p,(function(n){t.writeDouble(e,g+8*n,d[n])})),m>4&&(u+=m+=1&m),a+=4};for(f.s();!(c=f.n()).done;)d()}catch(t){f.e(t)}finally{f.f()}return[a,u]},m=function(t,e,n,r){if(null==n)throw new Error("you passed into encodeImage a width of type ".concat(n));if(null==e)throw new Error("you passed into encodeImage a width of type ".concat(e));var o={256:[e],257:[n],273:[f],278:[n],305:"geotiff.js"};if(r)for(var s in r)r.hasOwnProperty(s)&&(o[s]=r[s]);var a=new Uint8Array(function(t){var e=new Uint8Array(f),n=4,r=d;e[0]=77,e[1]=77,e[3]=42;var i=8;if(r.writeUint(e,n,i),n+=4,t.forEach((function(n,o){var s=p(r,e,i,n);i=s[1],o<t.length-1&&r.writeUint(e,s[0],i)})),e.slice)return e.slice(0,i).buffer;for(var o=new Uint8Array(i),s=0;s<i;s++)o[s]=e[s];return o.buffer}([o])),l=new Uint8Array(t),c=o[277],u=new Uint8Array(f+e*n*c);return(0,i.times)(a.length,(function(t){u[t]=a[t]})),(0,i.forEach)(l,(function(t,e){u[f+e]=t})),u.buffer},g=[["Compression",1],["PlanarConfiguration",1],["XPosition",0],["YPosition",0],["ResolutionUnit",1],["ExtraSamples",0],["GeoAsciiParams","WGS 84\0"],["ModelTiepoint",[0,0,0,-180,90,0]],["GTModelTypeGeoKey",2],["GTRasterTypeGeoKey",1],["GeographicTypeGeoKey",4326],["GeogCitationGeoKey","WGS 84"]]},{"./globals":"j27V","./utils":"FOZT"}],dy4f:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.setLogger=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;a=t},n.debug=function(){var t;return(t=a).debug.apply(t,arguments)},n.log=function(){var t;return(t=a).log.apply(t,arguments)},n.info=function(){var t;return(t=a).info.apply(t,arguments)},n.warn=function(){var t;return(t=a).warn.apply(t,arguments)},n.error=function(){var t;return(t=a).error.apply(t,arguments)},n.time=function(){var t;return(t=a).time.apply(t,arguments)},n.timeEnd=function(){var t;return(t=a).timeEnd.apply(t,arguments)};var r=o(t("@babel/runtime/helpers/classCallCheck")),i=o(t("@babel/runtime/helpers/createClass"));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(){function t(){(0,r.default)(this,t)}return(0,i.default)(t,[{key:"log",value:function(){}},{key:"debug",value:function(){}},{key:"info",value:function(){}},{key:"warn",value:function(){}},{key:"error",value:function(){}},{key:"time",value:function(){}},{key:"timeEnd",value:function(){}}]),t}(),a=new s},{"@babel/runtime/helpers/classCallCheck":"fcMS","@babel/runtime/helpers/createClass":"P8NW"}],bsJs:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fromUrl=function(t){return U.apply(this,arguments)},n.fromArrayBuffer=function(t,e){return H.apply(this,arguments)},n.fromFile=function(t,e){return G.apply(this,arguments)},n.fromBlob=function(t,e){return W.apply(this,arguments)},n.fromUrls=function(t){return V.apply(this,arguments)},n.writeArrayBuffer=function(t,e){return q.apply(this,arguments)},Object.defineProperty(n,"Pool",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(n,"getDecoder",{enumerable:!0,get:function(){return S.getDecoder}}),Object.defineProperty(n,"setLogger",{enumerable:!0,get:function(){return E.setLogger}}),n.rgb=n.globals=n.MultiGeoTIFF=n.default=n.GeoTIFF=void 0;var r=A(t("@babel/runtime/regenerator")),i=A(t("@babel/runtime/helpers/defineProperty")),o=A(t("@babel/runtime/helpers/slicedToArray")),s=A(t("@babel/runtime/helpers/asyncToGenerator")),a=A(t("@babel/runtime/helpers/createClass")),l=A(t("@babel/runtime/helpers/inherits")),c=A(t("@babel/runtime/helpers/possibleConstructorReturn")),u=A(t("@babel/runtime/helpers/getPrototypeOf")),h=A(t("@babel/runtime/helpers/wrapNativeSuper")),f=A(t("@babel/runtime/helpers/classCallCheck")),d=A(t("./geotiffimage")),p=A(t("./dataview64")),m=A(t("./dataslice")),g=A(t("./pool")),v=t("./source/remote"),y=t("./source/arraybuffer"),b=t("./source/filereader"),_=t("./source/file"),x=C(t("./globals"));n.globals=x;var w=t("./geotiffwriter"),M=C(t("./rgb"));n.rgb=M;var S=t("./compression"),E=t("./logging");function T(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return T=function(){return t},t}function C(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=T();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}function A(t){return t&&t.__esModule?t:{default:t}}function P(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?P(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function R(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,u.default)(t);if(e){var i=(0,u.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.default)(this,n)}}function O(t){switch(t){case x.fieldTypes.BYTE:case x.fieldTypes.ASCII:case x.fieldTypes.SBYTE:case x.fieldTypes.UNDEFINED:return 1;case x.fieldTypes.SHORT:case x.fieldTypes.SSHORT:return 2;case x.fieldTypes.LONG:case x.fieldTypes.SLONG:case x.fieldTypes.FLOAT:case x.fieldTypes.IFD:return 4;case x.fieldTypes.RATIONAL:case x.fieldTypes.SRATIONAL:case x.fieldTypes.DOUBLE:case x.fieldTypes.LONG8:case x.fieldTypes.SLONG8:case x.fieldTypes.IFD8:return 8;default:throw new RangeError("Invalid field type: ".concat(t))}}function k(t){var e=t.GeoKeyDirectory;if(!e)return null;for(var n={},r=4;r<=4*e[3];r+=4){var i=x.geoKeyNames[e[r]],o=e[r+1]?x.fieldTagNames[e[r+1]]:null,s=e[r+2],a=e[r+3],l=null;if(o){if(null==(l=t[o]))throw new Error("Could not get value of geoKey '".concat(i,"'."));"string"==typeof l?l=l.substring(a,a+s-1):l.subarray&&(l=l.subarray(a,a+s),1===s&&(l=l[0]))}else l=a;n[i]=l}return n}function I(t,e,n,r){var i=null,o=null,s=O(e);switch(e){case x.fieldTypes.BYTE:case x.fieldTypes.ASCII:case x.fieldTypes.UNDEFINED:i=new Uint8Array(n),o=t.readUint8;break;case x.fieldTypes.SBYTE:i=new Int8Array(n),o=t.readInt8;break;case x.fieldTypes.SHORT:i=new Uint16Array(n),o=t.readUint16;break;case x.fieldTypes.SSHORT:i=new Int16Array(n),o=t.readInt16;break;case x.fieldTypes.LONG:case x.fieldTypes.IFD:i=new Uint32Array(n),o=t.readUint32;break;case x.fieldTypes.SLONG:i=new Int32Array(n),o=t.readInt32;break;case x.fieldTypes.LONG8:case x.fieldTypes.IFD8:i=new Array(n),o=t.readUint64;break;case x.fieldTypes.SLONG8:i=new Array(n),o=t.readInt64;break;case x.fieldTypes.RATIONAL:i=new Uint32Array(2*n),o=t.readUint32;break;case x.fieldTypes.SRATIONAL:i=new Int32Array(2*n),o=t.readInt32;break;case x.fieldTypes.FLOAT:i=new Float32Array(n),o=t.readFloat32;break;case x.fieldTypes.DOUBLE:i=new Float64Array(n),o=t.readFloat64;break;default:throw new RangeError("Invalid field type: ".concat(e))}if(e!==x.fieldTypes.RATIONAL&&e!==x.fieldTypes.SRATIONAL)for(var a=0;a<n;++a)i[a]=o.call(t,r+a*s);else for(var l=0;l<n;l+=2)i[l]=o.call(t,r+l*s),i[l+1]=o.call(t,r+(l*s+4));return e===x.fieldTypes.ASCII?new TextDecoder("utf-8").decode(i):i}var D=function t(e,n,r){(0,f.default)(this,t),this.fileDirectory=e,this.geoKeyDirectory=n,this.nextIFDByteOffset=r},N=function(t){(0,l.default)(n,t);var e=R(n);function n(t){var r;return(0,f.default)(this,n),(r=e.call(this,"No image at index ".concat(t))).index=t,r}return n}((0,h.default)(Error)),j=function(){function t(){(0,f.default)(this,t)}return(0,a.default)(t,[{key:"readRasters",value:function(){var t=(0,s.default)(r.default.mark((function t(){var e,n,i,s,a,l,c,u,h,f,d,p,m,g,v,y,b,_,x,w,M,S,E,T,C,A,P,R,O,k,I,D,N,j,F,B,z,U,H,G=arguments;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=G.length>0&&void 0!==G[0]?G[0]:{},n=e.window,i=e.width,s=e.height,a=e.resX,l=e.resY,c=e.bbox,t.next=5,this.getImage();case 5:return u=t.sent,h=u,t.next=9,this.getImageCount();case 9:if(f=t.sent,d=u.getBoundingBox(),!n||!c){t.next=13;break}throw new Error('Both "bbox" and "window" passed.');case 13:if(!i&&!s){t.next=24;break}if(n&&(p=u.getOrigin(),m=(0,o.default)(p,2),g=m[0],v=m[1],y=u.getResolution(),b=(0,o.default)(y,2),_=b[0],x=b[1],c=[g+n[0]*_,v+n[1]*x,g+n[2]*_,v+n[3]*x]),w=c||d,!i){t.next=20;break}if(!a){t.next=19;break}throw new Error("Both width and resX passed");case 19:a=(w[2]-w[0])/i;case 20:if(!s){t.next=24;break}if(!l){t.next=23;break}throw new Error("Both width and resY passed");case 23:l=(w[3]-w[1])/s;case 24:if(!a&&!l){t.next=48;break}M=[],S=0;case 27:if(!(S<f)){t.next=36;break}return t.next=30,this.getImage(S);case 30:E=t.sent,T=E.fileDirectory,C=T.SubfileType,A=T.NewSubfileType,(0===S||2===C||1&A)&&M.push(E);case 33:++S,t.next=27;break;case 36:M.sort((function(t,e){return t.getWidth()-e.getWidth()})),P=0;case 38:if(!(P<M.length)){t.next=48;break}if(R=M[P],O=(d[2]-d[0])/R.getWidth(),k=(d[3]-d[1])/R.getHeight(),h=R,!(a&&a>O||l&&l>k)){t.next=45;break}return t.abrupt("break",48);case 45:++P,t.next=38;break;case 48:return I=n,c&&(D=u.getOrigin(),N=(0,o.default)(D,2),j=N[0],F=N[1],B=h.getResolution(u),z=(0,o.default)(B,2),U=z[0],H=z[1],I=[Math.round((c[0]-j)/U),Math.round((c[1]-F)/H),Math.round((c[2]-j)/U),Math.round((c[3]-F)/H)],I=[Math.min(I[0],I[2]),Math.min(I[1],I[3]),Math.max(I[0],I[2]),Math.max(I[1],I[3])]),t.abrupt("return",h.readRasters(L(L({},e),{},{window:I})));case 51:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}(),F=function(t){(0,l.default)(n,t);var e=R(n);function n(t,r,i,o){var s,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(0,f.default)(this,n),(s=e.call(this)).source=t,s.littleEndian=r,s.bigTiff=i,s.firstIFDOffset=o,s.cache=a.cache||!1,s.ifdRequests=[],s.ghostValues=null,s}return(0,a.default)(n,[{key:"getSlice",value:function(){var t=(0,s.default)(r.default.mark((function t(e,n){var i;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.bigTiff?4048:1024,t.t0=m.default,t.next=4,this.source.fetch([{offset:e,length:void 0!==n?n:i}]);case 4:return t.t1=t.sent[0],t.t2=e,t.t3=this.littleEndian,t.t4=this.bigTiff,t.abrupt("return",new t.t0(t.t1,t.t2,t.t3,t.t4));case 9:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"parseFileDirectoryAt",value:function(){var t=(0,s.default)(r.default.mark((function t(e){var n,i,o,s,a,l,c,u,h,f,d,p,m,g,v,y,b,_,w,M;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.bigTiff?20:12,i=this.bigTiff?8:2,t.next=4,this.getSlice(e);case 4:if(o=t.sent,s=this.bigTiff?o.readUint64(e):o.readUint16(e),a=s*n+(this.bigTiff?16:6),o.covers(e,a)){t.next=11;break}return t.next=10,this.getSlice(e,a);case 10:o=t.sent;case 11:l={},c=e+(this.bigTiff?8:2),u=0;case 14:if(!(u<s)){t.next=41;break}if(h=o.readUint16(c),f=o.readUint16(c+2),d=this.bigTiff?o.readUint64(c+4):o.readUint32(c+4),p=void 0,m=void 0,g=O(f),v=c+(this.bigTiff?12:8),!(g*d<=(this.bigTiff?8:4))){t.next=26;break}p=I(o,f,d,v),t.next=36;break;case 26:if(y=o.readOffset(v),b=O(f)*d,!o.covers(y,b)){t.next=32;break}p=I(o,f,d,y),t.next=36;break;case 32:return t.next=34,this.getSlice(y,b);case 34:_=t.sent,p=I(_,f,d,y);case 36:m=1===d&&-1===x.arrayFields.indexOf(h)&&f!==x.fieldTypes.RATIONAL&&f!==x.fieldTypes.SRATIONAL?p[0]:p,l[x.fieldTagNames[h]]=m;case 38:c+=n,++u,t.next=14;break;case 41:return w=k(l),M=o.readOffset(e+i+n*s),t.abrupt("return",new D(l,w,M));case 44:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"requestIFD",value:function(){var t=(0,s.default)(r.default.mark((function t(e){var n=this;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.ifdRequests[e]){t.next=4;break}return t.abrupt("return",this.ifdRequests[e]);case 4:if(0!==e){t.next=9;break}return this.ifdRequests[e]=this.parseFileDirectoryAt(this.firstIFDOffset),t.abrupt("return",this.ifdRequests[e]);case 9:if(this.ifdRequests[e-1]){t.next=19;break}t.prev=10,this.ifdRequests[e-1]=this.requestIFD(e-1),t.next=19;break;case 14:if(t.prev=14,t.t0=t.catch(10),!(t.t0 instanceof N)){t.next=18;break}throw new N(e);case 18:throw t.t0;case 19:return this.ifdRequests[e]=(0,s.default)(r.default.mark((function t(){var i;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.ifdRequests[e-1];case 2:if(0!==(i=t.sent).nextIFDByteOffset){t.next=5;break}throw new N(e);case 5:return t.abrupt("return",n.parseFileDirectoryAt(i.nextIFDByteOffset));case 6:case"end":return t.stop()}}),t)})))(),t.abrupt("return",this.ifdRequests[e]);case 21:case"end":return t.stop()}}),t,this,[[10,14]])})));return function(e){return t.apply(this,arguments)}}()},{key:"getImage",value:function(){var t=(0,s.default)(r.default.mark((function t(){var e,n,i=arguments;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:0,t.next=3,this.requestIFD(e);case 3:return n=t.sent,t.abrupt("return",new d.default(n.fileDirectory,n.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source));case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getImageCount",value:function(){var t=(0,s.default)(r.default.mark((function t(){var e,n;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=0,n=!0;case 2:if(!n){t.next=18;break}return t.prev=3,t.next=6,this.requestIFD(e);case 6:++e,t.next=16;break;case 9:if(t.prev=9,t.t0=t.catch(3),!(t.t0 instanceof N)){t.next=15;break}n=!1,t.next=16;break;case 15:throw t.t0;case 16:t.next=2;break;case 18:return t.abrupt("return",e);case 19:case"end":return t.stop()}}),t,this,[[3,9]])})));return function(){return t.apply(this,arguments)}}()},{key:"getGhostValues",value:function(){var t=(0,s.default)(r.default.mark((function t(){var e,n,i,s,a,l,c,u,h=this;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.bigTiff?16:8,!this.ghostValues){t.next=3;break}return t.abrupt("return",this.ghostValues);case 3:return i=(n="GDAL_STRUCTURAL_METADATA_SIZE=").length+100,t.next=7,this.getSlice(e,i);case 7:if(s=t.sent,n!==I(s,x.fieldTypes.ASCII,n.length,e)){t.next=19;break}if(a=I(s,x.fieldTypes.ASCII,i,e),l=a.split("\n")[0],!((c=Number(l.split("=")[1].split(" ")[0])+l.length)>i)){t.next=16;break}return t.next=15,this.getSlice(e,c);case 15:s=t.sent;case 16:u=I(s,x.fieldTypes.ASCII,c,e),this.ghostValues={},u.split("\n").filter((function(t){return t.length>0})).map((function(t){return t.split("=")})).forEach((function(t){var e=(0,o.default)(t,2),n=e[0],r=e[1];h.ghostValues[n]=r}));case 19:return t.abrupt("return",this.ghostValues);case 20:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"close",value:function(){return"function"==typeof this.source.close&&this.source.close()}}],[{key:"fromSource",value:function(){var t=(0,s.default)(r.default.mark((function t(e,i,o){var s,a,l,c,u,h,f;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.fetch([{offset:0,length:1024}],o);case 2:if(s=t.sent[0],a=new p.default(s),18761!==(l=a.getUint16(0,0))){t.next=9;break}c=!0,t.next=14;break;case 9:if(19789!==l){t.next=13;break}c=!1,t.next=14;break;case 13:throw new TypeError("Invalid byte order value.");case 14:if(42!==(u=a.getUint16(2,c))){t.next=19;break}h=!1,t.next=27;break;case 19:if(43!==u){t.next=26;break}if(h=!0,8===a.getUint16(4,c)){t.next=24;break}throw new Error("Unsupported offset byte-size.");case 24:t.next=27;break;case 26:throw new TypeError("Invalid magic number.");case 27:return f=h?a.getUint64(8,c):a.getUint32(4,c),t.abrupt("return",new n(e,c,h,f,i));case 29:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()}]),n}(j);n.GeoTIFF=F;var B=F;n.default=B;var z=function(t){(0,l.default)(n,t);var e=R(n);function n(t,r){var i;return(0,f.default)(this,n),(i=e.call(this)).mainFile=t,i.overviewFiles=r,i.imageFiles=[t].concat(r),i.fileDirectoriesPerFile=null,i.fileDirectoriesPerFileParsing=null,i.imageCount=null,i}return(0,a.default)(n,[{key:"parseFileDirectoriesPerFile",value:function(){var t=(0,s.default)(r.default.mark((function t(){var e;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map((function(t){return t.parseFileDirectoryAt(t.firstIFDOffset)}))),t.next=3,Promise.all(e);case 3:return this.fileDirectoriesPerFile=t.sent,t.abrupt("return",this.fileDirectoriesPerFile);case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getImage",value:function(){var t=(0,s.default)(r.default.mark((function t(){var e,n,i,o,s,a,l,c=arguments;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=c.length>0&&void 0!==c[0]?c[0]:0,t.next=3,this.getImageCount();case 3:return t.next=5,this.parseFileDirectoriesPerFile();case 5:n=0,i=0,o=0;case 8:if(!(o<this.imageFiles.length)){t.next=26;break}s=this.imageFiles[o],a=0;case 11:if(!(a<this.imageCounts[o])){t.next=22;break}if(e!==n){t.next=17;break}return t.next=15,s.requestIFD(i);case 15:return l=t.sent,t.abrupt("return",new d.default(l.fileDirectory,l.geoKeyDirectory,s.dataView,s.littleEndian,s.cache,s.source));case 17:n++,i++;case 19:a++,t.next=11;break;case 22:i=0;case 23:o++,t.next=8;break;case 26:throw new RangeError("Invalid image index");case 27:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getImageCount",value:function(){var t=(0,s.default)(r.default.mark((function t(){var e;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===this.imageCount){t.next=2;break}return t.abrupt("return",this.imageCount);case 2:return e=[this.mainFile.getImageCount()].concat(this.overviewFiles.map((function(t){return t.getImageCount()}))),t.next=5,Promise.all(e);case 5:return this.imageCounts=t.sent,this.imageCount=this.imageCounts.reduce((function(t,e){return t+e}),0),t.abrupt("return",this.imageCount);case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),n}(j);function U(){return(U=(0,s.default)(r.default.mark((function t(e){var n,i,o=arguments;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},i=o.length>2?o[2]:void 0,t.abrupt("return",F.fromSource((0,v.makeRemoteSource)(e,n),i));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function H(){return(H=(0,s.default)(r.default.mark((function t(e,n){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",F.fromSource((0,y.makeBufferSource)(e),n));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function G(){return(G=(0,s.default)(r.default.mark((function t(e,n){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",F.fromSource((0,_.makeFileSource)(e),n));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function W(){return(W=(0,s.default)(r.default.mark((function t(e,n){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",F.fromSource((0,b.makeFileReaderSource)(e),n));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function V(){return(V=(0,s.default)(r.default.mark((function t(e){var n,i,o,s,a,l=arguments;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:[],i=l.length>2&&void 0!==l[2]?l[2]:{},o=l.length>3?l[3]:void 0,t.next=5,F.fromSource((0,v.makeRemoteSource)(e,i),o);case 5:return s=t.sent,t.next=8,Promise.all(n.map((function(t){return F.fromSource((0,v.makeRemoteSource)(t,i))})));case 8:return a=t.sent,t.abrupt("return",new z(s,a));case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function q(){return(q=(0,s.default)(r.default.mark((function t(e,n){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,w.writeGeotiff)(e,n));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}n.MultiGeoTIFF=z},{"@babel/runtime/regenerator":"PMvg","@babel/runtime/helpers/defineProperty":"IxO8","@babel/runtime/helpers/slicedToArray":"HETk","@babel/runtime/helpers/asyncToGenerator":"agGE","@babel/runtime/helpers/createClass":"P8NW","@babel/runtime/helpers/inherits":"d4H2","@babel/runtime/helpers/possibleConstructorReturn":"pxk2","@babel/runtime/helpers/getPrototypeOf":"UJE0","@babel/runtime/helpers/wrapNativeSuper":"ozpi","@babel/runtime/helpers/classCallCheck":"fcMS","./geotiffimage":"eOWo","./dataview64":"dqpX","./dataslice":"dGLV","./pool":"dHPO","./source/remote":"itmA","./source/arraybuffer":"wM9h","./source/filereader":"GiEG","./source/file":"G7Cz","./globals":"j27V","./geotiffwriter":"BGyE","./rgb":"fpBl","./compression":"FGCZ","./logging":"dy4f"}]},{},["bsJs"])},function(t,e,n){var r=n(9),i=n(0),o=n(1),s=n(11).default,a=o.featureEach,l=(o.coordEach,i.polygon,i.featureCollection);function c(t){var e=r(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),r.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})):a(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})),r.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),r.prototype.remove.call(this,t,e)},e.clear=function(){return r.prototype.clear.call(this)},e.search=function(t){var e=r.prototype.search.call(this,this.toBBox(t));return l(e)},e.collides=function(t){return r.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=r.prototype.all.call(this);return l(t)},e.toJSON=function(){return r.prototype.toJSON.call(this)},e.fromJSON=function(t){return r.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=s(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=s(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=c,t.exports.default=c},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=t(e);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,r){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(i[s]=!0)}for(var a=0;a<t.length;a++){var l=[].concat(t[a]);r&&i[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),e.push(l))}},e}},function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=6},function(t,e){window.DecodeStream=function(){function t(){this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=null}return t.prototype={ensureBuffer:function(t){var e=this.buffer,n=e?e.byteLength:0;if(t<n)return e;for(var r=512;r<t;)r<<=1;for(var i=new Uint8Array(r),o=0;o<n;++o)i[o]=e[o];return this.buffer=i},getByte:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(t){var e=this.pos;if(t){this.ensureBuffer(e+t);for(var n=e+t;!this.eof&&this.bufferLength<n;)this.readBlock();var r=this.bufferLength;n>r&&(n=r)}else{for(;!this.eof;)this.readBlock();n=this.bufferLength}return this.pos=n,this.buffer.subarray(e,n)},lookChar:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(t,e,n){for(var r=t+e;this.bufferLength<=r&&!this.eof;)this.readBlock();return new Stream(this.buffer,t,e,n)},skip:function(t){t||(t=1),this.pos+=t},reset:function(){this.pos=0}},t}(),window.FlateStream=function(){var t=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),e=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),n=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),r=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],i=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];function o(t){throw new Error(t)}function s(t){var e=0,n=t[e++],r=t[e++];-1!=n&&-1!=r||o("Invalid header in flate stream"),8!=(15&n)&&o("Unknown compression method in flate stream"),((n<<8)+r)%31!=0&&o("Bad FCHECK in flate stream"),32&r&&o("FDICT bit set in flate stream"),this.bytes=t,this.bytesPos=2,this.codeSize=0,this.codeBuf=0,DecodeStream.call(this)}return s.prototype=Object.create(DecodeStream.prototype),s.prototype.getBits=function(t){for(var e,n=this.codeSize,r=this.codeBuf,i=this.bytes,s=this.bytesPos;n<t;)void 0===(e=i[s++])&&o("Bad encoding in flate stream"),r|=e<<n,n+=8;return e=r&(1<<t)-1,this.codeBuf=r>>t,this.codeSize=n-=t,this.bytesPos=s,e},s.prototype.getCode=function(t){for(var e=t[0],n=t[1],r=this.codeSize,i=this.codeBuf,s=this.bytes,a=this.bytesPos;r<n;){var l;void 0===(l=s[a++])&&o("Bad encoding in flate stream"),i|=l<<r,r+=8}var c=e[i&(1<<n)-1],u=c>>16,h=65535&c;return(0==r||r<u||0==u)&&o("Bad encoding in flate stream"),this.codeBuf=i>>u,this.codeSize=r-u,this.bytesPos=a,h},s.prototype.generateHuffmanTable=function(t){for(var e=t.length,n=0,r=0;r<e;++r)t[r]>n&&(n=t[r]);for(var i=1<<n,o=new Uint32Array(i),s=1,a=0,l=2;s<=n;++s,a<<=1,l<<=1)for(var c=0;c<e;++c)if(t[c]==s){var u=0,h=a;for(r=0;r<s;++r)u=u<<1|1&h,h>>=1;for(r=u;r<i;r+=l)o[r]=s<<16|c;++a}return[o,n]},s.prototype.readBlock=function(){function s(t,e,n,r,i){for(var o=t.getBits(n)+r;o-- >0;)e[p++]=i}var a=this.getBits(3);if(1&a&&(this.eof=!0),0!=(a>>=1)){var l,c;if(1==a)l=r,c=i;else if(2==a){for(var u=this.getBits(5)+257,h=this.getBits(5)+1,f=this.getBits(4)+4,d=Array(t.length),p=0;p<f;)d[t[p++]]=this.getBits(3);for(var m=this.generateHuffmanTable(d),g=0,v=(p=0,u+h),y=new Array(v);p<v;){var b=this.getCode(m);16==b?s(this,y,2,3,g):17==b?s(this,y,3,3,g=0):18==b?s(this,y,7,11,g=0):y[p++]=g=b}l=this.generateHuffmanTable(y.slice(0,u)),c=this.generateHuffmanTable(y.slice(u,v))}else o("Unknown block type in flate stream");for(var _=(O=this.buffer)?O.length:0,x=this.bufferLength;;){var w=this.getCode(l);if(w<256)x+1>=_&&(_=(O=this.ensureBuffer(x+1)).length),O[x++]=w;else{if(256==w)return void(this.bufferLength=x);var M=(w=e[w-=257])>>16;M>0&&(M=this.getBits(M));g=(65535&w)+M;w=this.getCode(c),(M=(w=n[w])>>16)>0&&(M=this.getBits(M));var S=(65535&w)+M;x+g>=_&&(_=(O=this.ensureBuffer(x+g)).length);for(var E=0;E<g;++E,++x)O[x]=O[x-S]}}}else{var T,C=this.bytes,A=this.bytesPos;void 0===(T=C[A++])&&o("Bad block header in flate stream");var P=T;void 0===(T=C[A++])&&o("Bad block header in flate stream"),P|=T<<8,void 0===(T=C[A++])&&o("Bad block header in flate stream");var L=T;void 0===(T=C[A++])&&o("Bad block header in flate stream"),(L|=T<<8)!=(65535&~P)&&o("Bad uncompressed block length in flate stream"),this.codeBuf=0,this.codeSize=0;var R=this.bufferLength,O=this.ensureBuffer(R+P),k=R+P;this.bufferLength=k;for(var I=R;I<k;++I){if(void 0===(T=C[A++])){this.eof=!0;break}O[I]=T}this.bytesPos=A}},s}()},function(t,e){var n,r,i;window.PNG=(n=document.createElement("canvas"),r=n.getContext("2d"),i=function(t){r.width=t.width,r.height=t.height,r.clearRect(0,0,t.width,t.height),r.putImageData(t,0,0);var e=new Image;return e.src=n.toDataURL(),e},function(){function t(t){var e;this.data=t,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={};for(var n=null;;){var r,i=this.readUInt32(),o="";for(e=0;e<4;e++)o+=String.fromCharCode(this.data[this.pos++]);switch(o){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(i);break;case"fcTL":n&&this.animation.frames.push(n),this.pos+=4,n={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()};var s=this.readUInt16(),a=this.readUInt16()||100;n.delay=1e3*s/a,n.disposeOp=this.data[this.pos++],n.blendOp=this.data[this.pos++],n.data=[];break;case"IDAT":case"fdAT":for("fdAT"===o&&(this.pos+=4,i-=4),r=n&&n.data||this.imgData,e=0;e<i;e++)r.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:this.transparency.indexed=this.read(i);var l=255-this.transparency.indexed.length;if(l>0)for(e=0;e<l;e++)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(i)[0];break;case 2:this.transparency.rgb=this.read(i)}break;case"tEXt":var c=this.read(i),u=c.indexOf(0),h=String.fromCharCode.apply(String,c.slice(0,u));this.text[h]=String.fromCharCode.apply(String,c.slice(u+1));break;case"IEND":switch(n&&this.animation.frames.push(n),this.colorType){case 0:case 3:case 4:this.colors=1;break;case 2:case 6:this.colors=3}this.hasAlphaChannel=[4,6].includes(this.colorType);var f=this.colors+(this.hasAlphaChannel?1:0);switch(this.pixelBitlength=this.bits*f,this.colors){case 1:this.colorSpace="DeviceGray";break;case 3:this.colorSpace="DeviceRGB"}return void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=i}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}return t.load=function(e,n,r,i){var o=new XMLHttpRequest;return o.open("GET",e,!0),o.responseType="arraybuffer",o.withCredentials=n.withCredentials,o.onload=function(){var e=new Uint8Array(o.response||o.mozResponseArrayBuffer);if(404!==o.status){var n=new t(e);return"function"==typeof r?r(n):void 0}"function"==typeof i&&i(o.status)},o.send()},t.prototype.read=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=this.data[this.pos++];return e},t.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},t.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},t.prototype.decodePixels=function(t){if(null==t&&(t=this.imgData),0===t.length)return new Uint8Array(0);t=(t=new FlateStream(t)).getBytes();var e=this.width,n=this.height,r=this.pixelBitlength/8,i=new Uint8Array(e*n*r),o=t.length,s=0;function a(a,l,c,u,h){void 0===h&&(h=!1);for(var f=Math.ceil((e-a)/c),d=Math.ceil((n-l)/u),p=r*f,m=h?i:new Uint8Array(p*d),g=0,v=0;g<d&&s<o;){var y,b,_,x,w;switch(t[s++]){case 0:for(_=0;_<p;_++)m[v++]=t[s++];break;case 1:for(_=0;_<p;_++)y=t[s++],x=_<r?0:m[v-r],m[v++]=(y+x)%256;break;case 2:for(_=0;_<p;_++)y=t[s++],b=(_-_%r)/r,w=g&&m[(g-1)*p+b*r+_%r],m[v++]=(w+y)%256;break;case 3:for(_=0;_<p;_++)y=t[s++],b=(_-_%r)/r,x=_<r?0:m[v-r],w=g&&m[(g-1)*p+b*r+_%r],m[v++]=(y+Math.floor((x+w)/2))%256;break;case 4:for(_=0;_<p;_++){var M,S;y=t[s++],b=(_-_%r)/r,x=_<r?0:m[v-r],0===g?w=S=0:(w=m[(g-1)*p+b*r+_%r],S=b&&m[(g-1)*p+(b-1)*r+_%r]);var E=x+w-S,T=Math.abs(E-x),C=Math.abs(E-w),A=Math.abs(E-S);M=T<=C&&T<=A?x:C<=A?w:S,m[v++]=(y+M)%256}break;default:throw new Error("Invalid filter algorithm: "+t[s-1])}if(!h){var P=((l+g*u)*e+a)*r,L=g*p;for(_=0;_<f;_++){for(var R=0;R<r;R++)i[P++]=m[L++];P+=(c-1)*r}}g++}}return 1===this.interlaceMethod?(a(0,0,8,8),a(4,0,8,8),a(0,4,4,8),a(2,0,4,4),a(0,2,2,4),a(1,0,2,2),a(0,1,1,2)):a(0,0,1,1,!0),i},t.prototype.decodePalette=function(){for(var t=this.palette,e=t.length,n=this.transparency.indexed||[],r=new Uint8Array((n.length||0)+e),i=0,o=0,s=0;s<e;s+=3){var a;r[i++]=t[s],r[i++]=t[s+1],r[i++]=t[s+2],r[i++]=null!=(a=n[o++])?a:255}return r},t.prototype.copyToImageData=function(t,e){var n,r,i=this.colors,o=null,s=this.hasAlphaChannel;this.palette.length&&(o=this._decodedPalette||(this._decodedPalette=this.decodePalette()),i=4,s=!0);var a=t.data||t,l=a.length,c=o||e,u=n=0;if(1===i)for(;u<l;){r=o?4*e[u/4]:n;var h=c[r++];a[u++]=h,a[u++]=h,a[u++]=h,a[u++]=s?c[r++]:255,n=r}else for(;u<l;)r=o?4*e[u/4]:n,a[u++]=c[r++],a[u++]=c[r++],a[u++]=c[r++],a[u++]=s?c[r++]:255,n=r},t.prototype.decode=function(){var t=new Uint8Array(this.width*this.height*4);return this.copyToImageData(t,this.decodePixels()),t},t.prototype.decodeFrames=function(t){if(this.animation)for(var e=0;e<this.animation.frames.length;e++){var n=this.animation.frames[e],r=t.createImageData(n.width,n.height),o=this.decodePixels(new Uint8Array(n.data));this.copyToImageData(r,o),n.imageData=r,n.image=i(r)}},t.prototype.renderFrame=function(t,e){var n=this.animation.frames,r=n[e],i=n[e-1];return 0===e&&t.clearRect(0,0,this.width,this.height),1===(i&&i.disposeOp)?t.clearRect(i.xOffset,i.yOffset,i.width,i.height):2===(i&&i.disposeOp)&&t.putImageData(i.imageData,i.xOffset,i.yOffset),0===r.blendOp&&t.clearRect(r.xOffset,r.yOffset,r.width,r.height),t.drawImage(r.image,r.xOffset,r.yOffset)},t.prototype.animate=function(t){var e=this,n=0,r=this.animation,i=r.numFrames,o=r.frames,s=r.numPlays,a=function(){var r=n++%i,l=o[r];e.renderFrame(t,r),i>1&&n/i<s&&(e.animation._timeout=setTimeout(a,l.delay))};a()},t.prototype.stopAnimation=function(){return clearTimeout(this.animation&&this.animation._timeout)},t.prototype.render=function(t){t._png&&t._png.stopAnimation(),t._png=this,t.width=this.width,t.height=this.height;var e=t.getContext("2d");if(this.animation)return this.decodeFrames(e),this.animate(e);var n=e.createImageData(this.width,this.height);return this.copyToImageData(n,this.decodePixels()),e.putImageData(n,0,0)},t}())},function(t,e,n){"use strict";t.exports=i,t.exports.default=i;var r=n(10);function i(t,e){if(!(this instanceof i))return new i(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,r,i){i||(i=m(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o,s=e;s<n;s++)o=t.children[s],l(i,t.leaf?r(o):o);return i}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function c(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function m(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(t,e,n,i,o){for(var s,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=i||(s=e+Math.ceil((n-e)/i/2)*i,r(t,s,e,n,o),a.push(e,s,s,n))}i.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],r=this.toBBox;if(!p(t,e))return n;for(var i,o,s,a,l=[];e;){for(i=0,o=e.children.length;i<o;i++)s=e.children[i],p(t,a=e.leaf?r(s):s)&&(e.leaf?n.push(s):d(t,a)?this._all(s,n):l.push(s));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!p(t,e))return!1;for(var r,i,o,s,a=[];e;){for(r=0,i=e.children.length;r<i;r++)if(o=e.children[r],p(t,s=e.leaf?n(o):o)){if(e.leaf||d(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(t,e){if(!t)return this;for(var n,r,i,s,a=this.data,l=this.toBBox(t),c=[],u=[];a||c.length;){if(a||(a=c.pop(),r=c[c.length-1],n=u.pop(),s=!0),a.leaf&&-1!==(i=o(t,a.children,e)))return a.children.splice(i,1),c.push(a),this._condense(c),this;s||a.leaf||!d(a,l)?r?(n++,a=r.children[n],s=!1):a=null:(c.push(a),u.push(n),n=0,r=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:c,compareMinY:u,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,r){var i,o=n-e+1,a=this._maxEntries;if(o<=a)return s(i=m(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,r-1))),(i=m([])).leaf=!1,i.height=r;var l,c,u,h,f=Math.ceil(o/a),d=f*Math.ceil(Math.sqrt(a));for(g(t,e,n,d,this.compareMinX),l=e;l<=n;l+=d)for(g(t,l,u=Math.min(l+d-1,n),f,this.compareMinY),c=l;c<=u;c+=f)h=Math.min(c+f-1,u),i.children.push(this._build(t,c,h,r-1));return s(i,this.toBBox),i},_chooseSubtree:function(t,e,n,r){for(var i,o,s,a,l,c,u,f,d,p;r.push(e),!e.leaf&&r.length-1!==n;){for(u=f=1/0,i=0,o=e.children.length;i<o;i++)l=h(s=e.children[i]),d=t,p=s,(c=(Math.max(p.maxX,d.maxX)-Math.min(p.minX,d.minX))*(Math.max(p.maxY,d.maxY)-Math.min(p.minY,d.minY))-l)<f?(f=c,u=l<u?l:u,a=s):c===f&&l<u&&(u=l,a=s);e=a||e.children[0]}return e},_insert:function(t,e,n){var r=this.toBBox,i=n?t:r(t),o=[],s=this._chooseSubtree(i,this.data,e,o);for(s.children.push(t),l(s,i);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(i,o,e)},_split:function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var o=this._chooseSplitIndex(n,i,r),a=m(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,s(n,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=m([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var r,i,o,s,l,c,u,f,d,p,m,g,v,y;for(c=u=1/0,r=e;r<=n-e;r++)i=a(t,0,r,this.toBBox),o=a(t,r,n,this.toBBox),d=i,p=o,m=void 0,g=void 0,v=void 0,y=void 0,m=Math.max(d.minX,p.minX),g=Math.max(d.minY,p.minY),v=Math.min(d.maxX,p.maxX),y=Math.min(d.maxY,p.maxY),s=Math.max(0,v-m)*Math.max(0,y-g),l=h(i)+h(o),s<c?(c=s,f=r,u=l<u?l:u):s===c&&l<u&&(u=l,f=r);return f},_chooseSplitAxis:function(t,e,n){var r=t.leaf?this.compareMinX:c,i=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},_allDistMargin:function(t,e,n,r){t.children.sort(r);var i,o,s=this.toBBox,c=a(t,0,e,s),u=a(t,n-e,n,s),h=f(c)+f(u);for(i=e;i<n-e;i++)o=t.children[i],l(c,t.leaf?s(o):o),h+=f(c);for(i=n-e-1;i>=e;i--)o=t.children[i],l(u,t.leaf?s(o):o),h+=f(u);return h},_adjustParentBBoxes:function(t,e,n){for(var r=n;r>=0;r--)l(e[r],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():s(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},function(t,e,n){t.exports=function(){"use strict";function t(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function e(t,e){return t<e?-1:t>e?1:0}return function(n,r,i,o,s){!function e(n,r,i,o,s){for(;o>i;){if(o-i>600){var a=o-i+1,l=r-i+1,c=Math.log(a),u=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*u*(a-u)/a)*(l-a/2<0?-1:1),f=Math.max(i,Math.floor(r-l*u/a+h)),d=Math.min(o,Math.floor(r+(a-l)*u/a+h));e(n,r,f,d,s)}var p=n[r],m=i,g=o;for(t(n,i,r),s(n[o],p)>0&&t(n,i,o);m<g;){for(t(n,m,g),m++,g--;s(n[m],p)<0;)m++;for(;s(n[g],p)>0;)g--}0===s(n[i],p)?t(n,i,g):(g++,t(n,g,o)),g<=r&&(i=g+1),r<=g&&(o=g-1)}}(n,r,i||0,o||n.length-1,s||e)}}()},function(t,e,n){"use strict";n.r(e);var r=n(1);function i(t){var e=[1/0,1/0,-1/0,-1/0];return Object(r.coordEach)(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}i.default=i,e.default=i},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var l,c=[],u=!1,h=-1;function f(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&d())}function d(){if(!u){var t=a(f);u=!0;for(var e=c.length;e;){for(l=c,c=[];++h<e;)l&&l[h].run();h=-1,e=c.length}l=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||u||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){var r=n(14),i=n(15);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};r(i,o);t.exports=i.locals||{}},function(t,e,n){"use strict";var r,i=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},o=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),s=[];function a(t){for(var e=-1,n=0;n<s.length;n++)if(s[n].identifier===t){e=n;break}return e}function l(t,e){for(var n={},r=[],i=0;i<t.length;i++){var o=t[i],l=e.base?o[0]+e.base:o[0],c=n[l]||0,u="".concat(l," ").concat(c);n[l]=c+1;var h=a(u),f={css:o[1],media:o[2],sourceMap:o[3]};-1!==h?(s[h].references++,s[h].updater(f)):s.push({identifier:u,updater:g(f,e),references:1}),r.push(u)}return r}function c(t){var e=document.createElement("style"),r=t.attributes||{};if(void 0===r.nonce){var i=n.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(t){e.setAttribute(t,r[t])})),"function"==typeof t.insert)t.insert(e);else{var s=o(t.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}return e}var u,h=(u=[],function(t,e){return u[t]=e,u.filter(Boolean).join("\n")});function f(t,e,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(t.styleSheet)t.styleSheet.cssText=h(e,i);else{var o=document.createTextNode(i),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function d(t,e,n){var r=n.css,i=n.media,o=n.sourceMap;if(i?t.setAttribute("media",i):t.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var p=null,m=0;function g(t,e){var n,r,i;if(e.singleton){var o=m++;n=p||(p=c(e)),r=f.bind(null,n,o,!1),i=f.bind(null,n,o,!0)}else n=c(e),r=d.bind(null,n,e),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else i()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=i());var n=l(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var r=0;r<n.length;r++){var i=a(n[r]);s[i].references--}for(var o=l(t,e),c=0;c<n.length;c++){var u=a(n[c]);0===s[u].references&&(s[u].updater(),s.splice(u,1))}n=o}}}},function(t,e,n){"use strict";n.r(e);var r=n(5),i=n.n(r)()((function(t){return t[1]}));i.push([t.i,"._lithosphere_loadingscreen_loading{position:absolute;width:100%;height:100%;perspective:160px;top:0;left:0}._lithosphere_loadingscreen_loading>div{width:60px;height:60px;background:rgba(255,255,255,0);position:absolute;left:50%;margin-left:-30px;top:50%;margin-top:-5px;border-radius:2px;border:2px solid rgba(255,255,255,0.7)}@-webkit-keyframes translateIn{30%{transform:rotateX(60deg) rotateY(0deg) rotateZ(45deg) translateZ(20px) scale(1);opacity:0.7;background:rgba(255,255,255,0.3)}100%{transform:rotateX(65deg) rotateY(0deg) rotateZ(45deg) translateZ(0px) scale(0.85);opacity:0;background:rgba(255,255,255,0)}}@keyframes translateIn{30%{transform:rotateX(60deg) rotateY(0deg) rotateZ(45deg) translateZ(20px) scale(1);opacity:0.7;background:rgba(255,255,255,0.3)}100%{transform:rotateX(65deg) rotateY(0deg) rotateZ(45deg) translateZ(0px) scale(0.85);opacity:0;background:rgba(255,255,255,0)}}._lithosphere_loadingscreen_loading>div{opacity:0}._lithosphere_loadingscreen_loading>div:nth-of-type(1){transform:rotateX(70deg) rotateY(0deg) rotateZ(45deg) translateZ(30px);-webkit-animation:translateIn 1.9s ease-in infinite 500ms;animation:translateIn 1.9s ease-in infinite 500ms}._lithosphere_loadingscreen_loading>div:nth-of-type(2){transform:rotateX(70deg) rotateY(0deg) rotateZ(45deg) translateZ(60px);-webkit-animation:translateIn 1.9s ease-in infinite 700ms;animation:translateIn 1.9s ease-in infinite 700ms}._lithosphere_loadingscreen_loading>div:nth-of-type(3){transform:rotateX(70deg) rotateY(0deg) rotateZ(45deg) translateZ(85px);-webkit-animation:translateIn 1.9s ease-in infinite 800ms;animation:translateIn 1.9s ease-in infinite 800ms}._lithosphere_loadingscreen_loading>div:nth-of-type(4){transform:rotateX(70deg) rotateY(0deg) rotateZ(45deg) translateZ(105px);-webkit-animation:translateIn 1.9s ease-in infinite 1000ms;animation:translateIn 1.9s ease-in infinite 1000ms}._lithosphere_loadingscreen_loading>div:nth-of-type(5){transform:rotateX(70deg) rotateY(0deg) rotateZ(45deg) translateZ(120px);-webkit-animation:translateIn 1.9s ease-in infinite 1200ms;animation:translateIn 1.9s ease-in infinite 1200ms}._lithosphere_loadingscreen_loading>div:nth-of-type(6){transform:rotateX(70deg) rotateY(0deg) rotateZ(45deg) translateZ(130px);-webkit-animation:translateIn 1.9s ease-in infinite 1400ms;animation:translateIn 1.9s ease-in infinite 1400ms}\n",""]),e.default=i},function(t,e,n){"use strict";n.r(e);const r=0,i=1,o=2;function s(){}Object.assign(s.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0===this._listeners)return;const n=this._listeners[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}},dispatchEvent:function(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const n=e.slice(0);for(let e=0,r=n.length;e<r;e++)n[e].call(this,t)}}});const a=[];for(let t=0;t<256;t++)a[t]=(t<16?"0":"")+t.toString(16);let l=1234567;const c={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(a[255&t]+a[t>>8&255]+a[t>>16&255]+a[t>>24&255]+"-"+a[255&e]+a[e>>8&255]+"-"+a[e>>16&15|64]+a[e>>24&255]+"-"+a[63&n|128]+a[n>>8&255]+"-"+a[n>>16&255]+a[n>>24&255]+a[255&r]+a[r>>8&255]+a[r>>16&255]+a[r>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},damp:function(t,e,n,r){return c.lerp(t,e,1-Math.exp(-n*r))},pingpong:function(t,e=1){return e-Math.abs(c.euclideanModulo(t,2*e)-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return void 0!==t&&(l=t%2147483647),l=16807*l%2147483647,(l-1)/2147483646},degToRad:function(t){return t*c.DEG2RAD},radToDeg:function(t){return t*c.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){const o=Math.cos,s=Math.sin,a=o(n/2),l=s(n/2),c=o((e+r)/2),u=s((e+r)/2),h=o((e-r)/2),f=s((e-r)/2),d=o((r-e)/2),p=s((r-e)/2);switch(i){case"XYX":t.set(a*u,l*h,l*f,a*c);break;case"YZY":t.set(l*f,a*u,l*h,a*c);break;case"ZXZ":t.set(l*h,l*f,a*u,a*c);break;case"XZX":t.set(a*u,l*p,l*d,a*c);break;case"YXY":t.set(l*d,a*u,l*p,a*c);break;case"ZYZ":t.set(l*p,l*d,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}};class u{constructor(t=0,e=0){Object.defineProperty(this,"isVector2",{value:!0}),this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}class h{constructor(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,i,o,s,a,l){const c=this.elements;return c[0]=t,c[1]=r,c[2]=s,c[3]=e,c[4]=i,c[5]=a,c[6]=n,c[7]=o,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}clone(){return(new this.constructor).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,o=n[0],s=n[3],a=n[6],l=n[1],c=n[4],u=n[7],h=n[2],f=n[5],d=n[8],p=r[0],m=r[3],g=r[6],v=r[1],y=r[4],b=r[7],_=r[2],x=r[5],w=r[8];return i[0]=o*p+s*v+a*_,i[3]=o*m+s*y+a*x,i[6]=o*g+s*b+a*w,i[1]=l*p+c*v+u*_,i[4]=l*m+c*y+u*x,i[7]=l*g+c*b+u*w,i[2]=h*p+f*v+d*_,i[5]=h*m+f*y+d*x,i[8]=h*g+f*b+d*w,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],l=t[7],c=t[8];return e*o*c-e*s*l-n*i*c+n*s*a+r*i*l-r*o*a}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=c*o-s*l,h=s*a-c*i,f=l*i-o*a,d=e*u+n*h+r*f;if(0===d)return this.set(0,0,0,0,0,0,0,0,0);const p=1/d;return t[0]=u*p,t[1]=(r*l-c*n)*p,t[2]=(s*n-r*o)*p,t[3]=h*p,t[4]=(c*e-r*a)*p,t[5]=(r*i-s*e)*p,t[6]=f*p,t[7]=(n*a-l*e)*p,t[8]=(o*e-n*i)*p,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).copy(this).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,i,o,s){const a=Math.cos(i),l=Math.sin(i);return this.set(n*a,n*l,-n*(a*o+l*s)+o+t,-r*l,r*a,-r*(-l*o+a*s)+s+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],o=r[3],s=r[6],a=r[1],l=r[4],c=r[7];return r[0]=e*i+n*a,r[3]=e*o+n*l,r[6]=e*s+n*c,r[1]=-n*i+e*a,r[4]=-n*o+e*l,r[7]=-n*s+e*c,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let t=0;t<9;t++)if(e[t]!==n[t])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}}let f;const d={getDataURL:function(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===f&&(f=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),f.width=t.width,f.height=t.height;const n=f.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=f}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}};let p=0;function m(t=m.DEFAULT_IMAGE,e=m.DEFAULT_MAPPING,n=1001,r=1001,i=1006,o=1008,s=1023,a=1009,l=1,f=3e3){Object.defineProperty(this,"id",{value:p++}),this.uuid=c.generateUUID(),this.name="",this.image=t,this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=o,this.anisotropy=l,this.format=s,this.internalFormat=null,this.type=a,this.offset=new u(0,0),this.repeat=new u(1,1),this.center=new u(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new h,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=f,this.version=0,this.onUpdate=null}function g(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?d.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}m.DEFAULT_IMAGE=void 0,m.DEFAULT_MAPPING=300,m.prototype=Object.assign(Object.create(s.prototype),{constructor:m,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const r=this.image;if(void 0===r.uuid&&(r.uuid=c.generateUUID()),!e&&void 0===t.images[r.uuid]){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)r[t].isDataTexture?e.push(g(r[t].image)):e.push(g(r[t]))}else e=g(r);t.images[r.uuid]={uuid:r.uuid,url:e}}n.image=r.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case 1001:t.x=t.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case 1001:t.y=t.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(m.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}});class v{constructor(t=0,e=0,n=0,r=1){Object.defineProperty(this,"isVector4",{value:!0}),this.x=t,this.y=e,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*i,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,r,i;const o=t.elements,s=o[0],a=o[4],l=o[8],c=o[1],u=o[5],h=o[9],f=o[2],d=o[6],p=o[10];if(Math.abs(a-c)<.01&&Math.abs(l-f)<.01&&Math.abs(h-d)<.01){if(Math.abs(a+c)<.1&&Math.abs(l+f)<.1&&Math.abs(h+d)<.1&&Math.abs(s+u+p-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const t=(s+1)/2,o=(u+1)/2,m=(p+1)/2,g=(a+c)/4,v=(l+f)/4,y=(h+d)/4;return t>o&&t>m?t<.01?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(t),r=g/n,i=v/n):o>m?o<.01?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(o),n=g/r,i=y/r):m<.01?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(m),n=v/i,r=y/i),this.set(n,r,i,e),this}let m=Math.sqrt((d-h)*(d-h)+(l-f)*(l-f)+(c-a)*(c-a));return Math.abs(m)<.001&&(m=1),this.x=(d-h)/m,this.y=(l-f)/m,this.z=(c-a)/m,this.w=Math.acos((s+u+p-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}class y extends s{constructor(t,e,n){super(),Object.defineProperty(this,"isWebGLRenderTarget",{value:!0}),this.width=t,this.height=e,this.scissor=new v(0,0,t,e),this.scissorTest=!1,this.viewport=new v(0,0,t,e),n=n||{},this.texture=new m(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:1006,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}setSize(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}class b{constructor(t=0,e=0,n=0,r=1){Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=t,this._y=e,this._z=n,this._w=r}static slerp(t,e,n,r){return n.copy(t).slerp(e,r)}static slerpFlat(t,e,n,r,i,o,s){let a=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3];const h=i[o+0],f=i[o+1],d=i[o+2],p=i[o+3];if(u!==p||a!==h||l!==f||c!==d){let t=1-s;const e=a*h+l*f+c*d+u*p,n=e>=0?1:-1,r=1-e*e;if(r>Number.EPSILON){const i=Math.sqrt(r),o=Math.atan2(i,e*n);t=Math.sin(t*o)/i,s=Math.sin(s*o)/i}const i=s*n;if(a=a*t+h*i,l=l*t+f*i,c=c*t+d*i,u=u*t+p*i,t===1-s){const t=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=t,l*=t,c*=t,u*=t}}t[e]=a,t[e+1]=l,t[e+2]=c,t[e+3]=u}static multiplyQuaternionsFlat(t,e,n,r,i,o){const s=n[r],a=n[r+1],l=n[r+2],c=n[r+3],u=i[o],h=i[o+1],f=i[o+2],d=i[o+3];return t[e]=s*d+c*u+a*f-l*h,t[e+1]=a*d+c*h+l*u-s*f,t[e+2]=l*d+c*f+s*h-a*u,t[e+3]=c*d-s*u-a*h-l*f,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,r=t._y,i=t._z,o=t._order,s=Math.cos,a=Math.sin,l=s(n/2),c=s(r/2),u=s(i/2),h=a(n/2),f=a(r/2),d=a(i/2);switch(o){case"XYZ":this._x=h*c*u+l*f*d,this._y=l*f*u-h*c*d,this._z=l*c*d+h*f*u,this._w=l*c*u-h*f*d;break;case"YXZ":this._x=h*c*u+l*f*d,this._y=l*f*u-h*c*d,this._z=l*c*d-h*f*u,this._w=l*c*u+h*f*d;break;case"ZXY":this._x=h*c*u-l*f*d,this._y=l*f*u+h*c*d,this._z=l*c*d+h*f*u,this._w=l*c*u-h*f*d;break;case"ZYX":this._x=h*c*u-l*f*d,this._y=l*f*u+h*c*d,this._z=l*c*d-h*f*u,this._w=l*c*u+h*f*d;break;case"YZX":this._x=h*c*u+l*f*d,this._y=l*f*u+h*c*d,this._z=l*c*d-h*f*u,this._w=l*c*u-h*f*d;break;case"XZY":this._x=h*c*u-l*f*d,this._y=l*f*u-h*c*d,this._z=l*c*d+h*f*u,this._w=l*c*u+h*f*d;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],i=e[8],o=e[1],s=e[5],a=e[9],l=e[2],c=e[6],u=e[10],h=n+s+u;if(h>0){const t=.5/Math.sqrt(h+1);this._w=.25/t,this._x=(c-a)*t,this._y=(i-l)*t,this._z=(o-r)*t}else if(n>s&&n>u){const t=2*Math.sqrt(1+n-s-u);this._w=(c-a)/t,this._x=.25*t,this._y=(r+o)/t,this._z=(i+l)/t}else if(s>u){const t=2*Math.sqrt(1+s-n-u);this._w=(i-l)/t,this._x=(r+o)/t,this._y=.25*t,this._z=(a+c)/t}else{const t=2*Math.sqrt(1+u-n-s);this._w=(o-r)/t,this._x=(i+l)/t,this._y=(a+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(c.clamp(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,i=t._z,o=t._w,s=e._x,a=e._y,l=e._z,c=e._w;return this._x=n*c+o*s+r*l-i*a,this._y=r*c+o*a+i*s-n*l,this._z=i*c+o*l+n*a-r*s,this._w=o*c-n*s-r*a-i*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,r=this._y,i=this._z,o=this._w;let s=o*t._w+n*t._x+r*t._y+i*t._z;if(s<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),s>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;const a=1-s*s;if(a<=Number.EPSILON){const t=1-e;return this._w=t*o+e*this._w,this._x=t*n+e*this._x,this._y=t*r+e*this._y,this._z=t*i+e*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(a),c=Math.atan2(l,s),u=Math.sin((1-e)*c)/l,h=Math.sin(e*c)/l;return this._w=o*u+this._w*h,this._x=n*u+this._x*h,this._y=r*u+this._y*h,this._z=i*u+this._z*h,this._onChangeCallback(),this}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}class _{constructor(t=0,e=0,n=0){Object.defineProperty(this,"isVector3",{value:!0}),this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(w.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(w.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,s=t.z,a=t.w,l=a*e+o*r-s*n,c=a*n+s*e-i*r,u=a*r+i*n-o*e,h=-i*e-o*n-s*r;return this.x=l*a+h*-i+c*-s-u*-o,this.y=c*a+h*-o+u*-i-l*-s,this.z=u*a+h*-s+l*-o-c*-i,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,i=t.z,o=e.x,s=e.y,a=e.z;return this.x=r*a-i*s,this.y=i*o-n*a,this.z=n*s-r*o,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return x.copy(this).projectOnVector(t),this.sub(x)}reflect(t){return this.sub(x.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(c.clamp(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}const x=new _,w=new b;class M{constructor(t,e){Object.defineProperty(this,"isBox3",{value:!0}),this.min=void 0!==t?t:new _(1/0,1/0,1/0),this.max=void 0!==e?e:new _(-1/0,-1/0,-1/0)}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0;for(let a=0,l=t.length;a<l;a+=3){const l=t[a],c=t[a+1],u=t[a+2];l<e&&(e=l),c<n&&(n=c),u<r&&(r=u),l>i&&(i=l),c>o&&(o=c),u>s&&(s=u)}return this.min.set(e,n,r),this.max.set(i,o,s),this}setFromBufferAttribute(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0;for(let a=0,l=t.count;a<l;a++){const l=t.getX(a),c=t.getY(a),u=t.getZ(a);l<e&&(e=l),c<n&&(n=c),u<r&&(r=u),l>i&&(i=l),c>o&&(o=c),u>s&&(s=u)}return this.min.set(e,n,r),this.max.set(i,o,s),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=T.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t){return this.makeEmpty(),this.expandByObject(t)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new _),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new _),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){t.updateWorldMatrix(!1,!1);const e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),C.copy(e.boundingBox),C.applyMatrix4(t.matrixWorld),this.union(C));const n=t.children;for(let t=0,e=n.length;t<e;t++)this.expandByObject(n[t]);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new _),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,T),T.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(I),D.subVectors(this.max,I),A.subVectors(t.a,I),P.subVectors(t.b,I),L.subVectors(t.c,I),R.subVectors(P,A),O.subVectors(L,P),k.subVectors(A,L);let e=[0,-R.z,R.y,0,-O.z,O.y,0,-k.z,k.y,R.z,0,-R.x,O.z,0,-O.x,k.z,0,-k.x,-R.y,R.x,0,-O.y,O.x,0,-k.y,k.x,0];return!!S(e,A,P,L,D)&&(e=[1,0,0,0,1,0,0,0,1],!!S(e,A,P,L,D)&&(N.crossVectors(R,O),e=[N.x,N.y,N.z],S(e,A,P,L,D)))}clampPoint(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new _),e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return T.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(T).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(E[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),E[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),E[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),E[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),E[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),E[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),E[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),E[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(E)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}function S(t,e,n,r,i){for(let o=0,s=t.length-3;o<=s;o+=3){j.fromArray(t,o);const s=i.x*Math.abs(j.x)+i.y*Math.abs(j.y)+i.z*Math.abs(j.z),a=e.dot(j),l=n.dot(j),c=r.dot(j);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>s)return!1}return!0}const E=[new _,new _,new _,new _,new _,new _,new _,new _],T=new _,C=new M,A=new _,P=new _,L=new _,R=new _,O=new _,k=new _,I=new _,D=new _,N=new _,j=new _,F=new M;class B{constructor(t,e){this.center=void 0!==t?t:new _,this.radius=void 0!==e?e:-1}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):F.setFromPoints(t).getCenter(n);let r=0;for(let e=0,i=t.length;e<i;e++)r=Math.max(r,n.distanceToSquared(t[e]));return this.radius=Math.sqrt(r),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new _),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new M),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}}const z=new _,U=new _,H=new _,G=new _,W=new _,V=new _,q=new _;class X{constructor(t,e){this.origin=void 0!==t?t:new _,this.direction=void 0!==e?e:new _(0,0,-1)}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new _),e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,z)),this}closestPointToPoint(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new _),e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=z.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(z.copy(this.direction).multiplyScalar(e).add(this.origin),z.distanceToSquared(t))}distanceSqToSegment(t,e,n,r){U.copy(t).add(e).multiplyScalar(.5),H.copy(e).sub(t).normalize(),G.copy(this.origin).sub(U);const i=.5*t.distanceTo(e),o=-this.direction.dot(H),s=G.dot(this.direction),a=-G.dot(H),l=G.lengthSq(),c=Math.abs(1-o*o);let u,h,f,d;if(c>0)if(u=o*a-s,h=o*s-a,d=i*c,u>=0)if(h>=-d)if(h<=d){const t=1/c;u*=t,h*=t,f=u*(u+o*h+2*s)+h*(o*u+h+2*a)+l}else h=i,u=Math.max(0,-(o*h+s)),f=-u*u+h*(h+2*a)+l;else h=-i,u=Math.max(0,-(o*h+s)),f=-u*u+h*(h+2*a)+l;else h<=-d?(u=Math.max(0,-(-o*i+s)),h=u>0?-i:Math.min(Math.max(-i,-a),i),f=-u*u+h*(h+2*a)+l):h<=d?(u=0,h=Math.min(Math.max(-i,-a),i),f=h*(h+2*a)+l):(u=Math.max(0,-(o*i+s)),h=u>0?i:Math.min(Math.max(-i,-a),i),f=-u*u+h*(h+2*a)+l);else h=o>0?-i:i,u=Math.max(0,-(o*h+s)),f=-u*u+h*(h+2*a)+l;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),r&&r.copy(H).multiplyScalar(h).add(U),f}intersectSphere(t,e){z.subVectors(t.center,this.origin);const n=z.dot(this.direction),r=z.dot(z)-n*n,i=t.radius*t.radius;if(r>i)return null;const o=Math.sqrt(i-r),s=n-o,a=n+o;return s<0&&a<0?null:s<0?this.at(a,e):this.at(s,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,r,i,o,s,a;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,r=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,r=(t.min.x-h.x)*l),c>=0?(i=(t.min.y-h.y)*c,o=(t.max.y-h.y)*c):(i=(t.max.y-h.y)*c,o=(t.min.y-h.y)*c),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),u>=0?(s=(t.min.z-h.z)*u,a=(t.max.z-h.z)*u):(s=(t.max.z-h.z)*u,a=(t.min.z-h.z)*u),n>a||s>r?null:((s>n||n!=n)&&(n=s),(a<r||r!=r)&&(r=a),r<0?null:this.at(n>=0?n:r,e)))}intersectsBox(t){return null!==this.intersectBox(t,z)}intersectTriangle(t,e,n,r,i){W.subVectors(e,t),V.subVectors(n,t),q.crossVectors(W,V);let o,s=this.direction.dot(q);if(s>0){if(r)return null;o=1}else{if(!(s<0))return null;o=-1,s=-s}G.subVectors(this.origin,t);const a=o*this.direction.dot(V.crossVectors(G,V));if(a<0)return null;const l=o*this.direction.dot(W.cross(G));if(l<0)return null;if(a+l>s)return null;const c=-o*G.dot(q);return c<0?null:this.at(c/s,i)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}class Y{constructor(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,i,o,s,a,l,c,u,h,f,d,p,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=s,g[13]=a,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=f,g[7]=d,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Y).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,r=1/Z.setFromMatrixColumn(t,0).length(),i=1/Z.setFromMatrixColumn(t,1).length(),o=1/Z.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),s=Math.sin(n),a=Math.cos(r),l=Math.sin(r),c=Math.cos(i),u=Math.sin(i);if("XYZ"===t.order){const t=o*c,n=o*u,r=s*c,i=s*u;e[0]=a*c,e[4]=-a*u,e[8]=l,e[1]=n+r*l,e[5]=t-i*l,e[9]=-s*a,e[2]=i-t*l,e[6]=r+n*l,e[10]=o*a}else if("YXZ"===t.order){const t=a*c,n=a*u,r=l*c,i=l*u;e[0]=t+i*s,e[4]=r*s-n,e[8]=o*l,e[1]=o*u,e[5]=o*c,e[9]=-s,e[2]=n*s-r,e[6]=i+t*s,e[10]=o*a}else if("ZXY"===t.order){const t=a*c,n=a*u,r=l*c,i=l*u;e[0]=t-i*s,e[4]=-o*u,e[8]=r+n*s,e[1]=n+r*s,e[5]=o*c,e[9]=i-t*s,e[2]=-o*l,e[6]=s,e[10]=o*a}else if("ZYX"===t.order){const t=o*c,n=o*u,r=s*c,i=s*u;e[0]=a*c,e[4]=r*l-n,e[8]=t*l+i,e[1]=a*u,e[5]=i*l+t,e[9]=n*l-r,e[2]=-l,e[6]=s*a,e[10]=o*a}else if("YZX"===t.order){const t=o*a,n=o*l,r=s*a,i=s*l;e[0]=a*c,e[4]=i-t*u,e[8]=r*u+n,e[1]=u,e[5]=o*c,e[9]=-s*c,e[2]=-l*c,e[6]=n*u+r,e[10]=t-i*u}else if("XZY"===t.order){const t=o*a,n=o*l,r=s*a,i=s*l;e[0]=a*c,e[4]=-u,e[8]=l*c,e[1]=t*u+i,e[5]=o*c,e[9]=n*u-r,e[2]=r*u-n,e[6]=s*c,e[10]=i*u+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(K,t,Q)}lookAt(t,e,n){const r=this.elements;return et.subVectors(t,e),0===et.lengthSq()&&(et.z=1),et.normalize(),$.crossVectors(n,et),0===$.lengthSq()&&(1===Math.abs(n.z)?et.x+=1e-4:et.z+=1e-4,et.normalize(),$.crossVectors(n,et)),$.normalize(),tt.crossVectors(et,$),r[0]=$.x,r[4]=tt.x,r[8]=et.x,r[1]=$.y,r[5]=tt.y,r[9]=et.y,r[2]=$.z,r[6]=tt.z,r[10]=et.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,o=n[0],s=n[4],a=n[8],l=n[12],c=n[1],u=n[5],h=n[9],f=n[13],d=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],b=n[11],_=n[15],x=r[0],w=r[4],M=r[8],S=r[12],E=r[1],T=r[5],C=r[9],A=r[13],P=r[2],L=r[6],R=r[10],O=r[14],k=r[3],I=r[7],D=r[11],N=r[15];return i[0]=o*x+s*E+a*P+l*k,i[4]=o*w+s*T+a*L+l*I,i[8]=o*M+s*C+a*R+l*D,i[12]=o*S+s*A+a*O+l*N,i[1]=c*x+u*E+h*P+f*k,i[5]=c*w+u*T+h*L+f*I,i[9]=c*M+u*C+h*R+f*D,i[13]=c*S+u*A+h*O+f*N,i[2]=d*x+p*E+m*P+g*k,i[6]=d*w+p*T+m*L+g*I,i[10]=d*M+p*C+m*R+g*D,i[14]=d*S+p*A+m*O+g*N,i[3]=v*x+y*E+b*P+_*k,i[7]=v*w+y*T+b*L+_*I,i[11]=v*M+y*C+b*R+_*D,i[15]=v*S+y*A+b*O+_*N,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],s=t[5],a=t[9],l=t[13],c=t[2],u=t[6],h=t[10],f=t[14];return t[3]*(+i*a*u-r*l*u-i*s*h+n*l*h+r*s*f-n*a*f)+t[7]*(+e*a*f-e*l*h+i*o*h-r*o*f+r*l*c-i*a*c)+t[11]*(+e*l*u-e*s*f-i*o*u+n*o*f+i*s*c-n*l*c)+t[15]*(-r*s*c-e*a*u+e*s*h+r*o*u-n*o*h+n*a*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],f=t[11],d=t[12],p=t[13],m=t[14],g=t[15],v=u*m*l-p*h*l+p*a*f-s*m*f-u*a*g+s*h*g,y=d*h*l-c*m*l-d*a*f+o*m*f+c*a*g-o*h*g,b=c*p*l-d*u*l+d*s*f-o*p*f-c*s*g+o*u*g,_=d*u*a-c*p*a-d*s*h+o*p*h+c*s*m-o*u*m,x=e*v+n*y+r*b+i*_;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/x;return t[0]=v*w,t[1]=(p*h*i-u*m*i-p*r*f+n*m*f+u*r*g-n*h*g)*w,t[2]=(s*m*i-p*a*i+p*r*l-n*m*l-s*r*g+n*a*g)*w,t[3]=(u*a*i-s*h*i-u*r*l+n*h*l+s*r*f-n*a*f)*w,t[4]=y*w,t[5]=(c*m*i-d*h*i+d*r*f-e*m*f-c*r*g+e*h*g)*w,t[6]=(d*a*i-o*m*i-d*r*l+e*m*l+o*r*g-e*a*g)*w,t[7]=(o*h*i-c*a*i+c*r*l-e*h*l-o*r*f+e*a*f)*w,t[8]=b*w,t[9]=(d*u*i-c*p*i-d*n*f+e*p*f+c*n*g-e*u*g)*w,t[10]=(o*p*i-d*s*i+d*n*l-e*p*l-o*n*g+e*s*g)*w,t[11]=(c*s*i-o*u*i-c*n*l+e*u*l+o*n*f-e*s*f)*w,t[12]=_*w,t[13]=(c*p*r-d*u*r+d*n*h-e*p*h-c*n*m+e*u*m)*w,t[14]=(d*s*r-o*p*r-d*n*a+e*p*a+o*n*m-e*s*m)*w,t[15]=(o*u*r-c*s*r+c*n*a-e*u*a-o*n*h+e*s*h)*w,this}scale(t){const e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,s=t.y,a=t.z,l=i*o,c=i*s;return this.set(l*o+n,l*s-r*a,l*a+r*s,0,l*s+r*a,c*s+n,c*a-r*o,0,l*a-r*s,c*a+r*o,i*a*a+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,i=e._x,o=e._y,s=e._z,a=e._w,l=i+i,c=o+o,u=s+s,h=i*l,f=i*c,d=i*u,p=o*c,m=o*u,g=s*u,v=a*l,y=a*c,b=a*u,_=n.x,x=n.y,w=n.z;return r[0]=(1-(p+g))*_,r[1]=(f+b)*_,r[2]=(d-y)*_,r[3]=0,r[4]=(f-b)*x,r[5]=(1-(h+g))*x,r[6]=(m+v)*x,r[7]=0,r[8]=(d+y)*w,r[9]=(m-v)*w,r[10]=(1-(h+p))*w,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;let i=Z.set(r[0],r[1],r[2]).length();const o=Z.set(r[4],r[5],r[6]).length(),s=Z.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],J.copy(this);const a=1/i,l=1/o,c=1/s;return J.elements[0]*=a,J.elements[1]*=a,J.elements[2]*=a,J.elements[4]*=l,J.elements[5]*=l,J.elements[6]*=l,J.elements[8]*=c,J.elements[9]*=c,J.elements[10]*=c,e.setFromRotationMatrix(J),n.x=i,n.y=o,n.z=s,this}makePerspective(t,e,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const s=this.elements,a=2*i/(e-t),l=2*i/(n-r),c=(e+t)/(e-t),u=(n+r)/(n-r),h=-(o+i)/(o-i),f=-2*o*i/(o-i);return s[0]=a,s[4]=0,s[8]=c,s[12]=0,s[1]=0,s[5]=l,s[9]=u,s[13]=0,s[2]=0,s[6]=0,s[10]=h,s[14]=f,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this}makeOrthographic(t,e,n,r,i,o){const s=this.elements,a=1/(e-t),l=1/(n-r),c=1/(o-i),u=(e+t)*a,h=(n+r)*l,f=(o+i)*c;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-u,s[1]=0,s[5]=2*l,s[9]=0,s[13]=-h,s[2]=0,s[6]=0,s[10]=-2*c,s[14]=-f,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let t=0;t<16;t++)if(e[t]!==n[t])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const Z=new _,J=new Y,K=new _(0,0,0),Q=new _(1,1,1),$=new _,tt=new _,et=new _;class nt{constructor(t=0,e=0,n=0,r=nt.DefaultOrder){Object.defineProperty(this,"isEuler",{value:!0}),this._x=t,this._y=e,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e,n){const r=c.clamp,i=t.elements,o=i[0],s=i[4],a=i[8],l=i[1],u=i[5],h=i[9],f=i[2],d=i[6],p=i[10];switch(e=e||this._order){case"XYZ":this._y=Math.asin(r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-s,o)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-r(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(a,p),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-f,o),this._z=0);break;case"ZXY":this._x=Math.asin(r(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-f,p),this._z=Math.atan2(-s,u)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-r(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-s,u));break;case"YZX":this._z=Math.asin(r(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-f,o)):(this._x=0,this._y=Math.atan2(a,p));break;case"XZY":this._z=Math.asin(-r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(a,o)):(this._x=Math.atan2(-h,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!1!==n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return rt.makeRotationFromQuaternion(t),this.setFromRotationMatrix(rt,e,n)}setFromVector3(t,e){return this.set(t.x,t.y,t.z,e||this._order)}reorder(t){return it.setFromEuler(this),this.setFromQuaternion(it,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new _(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}nt.DefaultOrder="XYZ",nt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];const rt=new Y,it=new b;class ot{constructor(){this.mask=1}set(t){this.mask=1<<t|0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}}let st=0;const at=new _,lt=new b,ct=new Y,ut=new _,ht=new _,ft=new _,dt=new b,pt=new _(1,0,0),mt=new _(0,1,0),gt=new _(0,0,1),vt={type:"added"},yt={type:"removed"};function bt(){Object.defineProperty(this,"id",{value:st++}),this.uuid=c.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=bt.DefaultUp.clone();const t=new _,e=new nt,n=new b,r=new _(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Y},normalMatrix:{value:new h}}),this.matrix=new Y,this.matrixWorld=new Y,this.matrixAutoUpdate=bt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ot,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}bt.DefaultUp=new _(0,1,0),bt.DefaultMatrixAutoUpdate=!0,bt.prototype=Object.assign(Object.create(s.prototype),{constructor:bt,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return lt.setFromAxisAngle(t,e),this.quaternion.multiply(lt),this},rotateOnWorldAxis:function(t,e){return lt.setFromAxisAngle(t,e),this.quaternion.premultiply(lt),this},rotateX:function(t){return this.rotateOnAxis(pt,t)},rotateY:function(t){return this.rotateOnAxis(mt,t)},rotateZ:function(t){return this.rotateOnAxis(gt,t)},translateOnAxis:function(t,e){return at.copy(t).applyQuaternion(this.quaternion),this.position.add(at.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(pt,t)},translateY:function(t){return this.translateOnAxis(mt,t)},translateZ:function(t){return this.translateOnAxis(gt,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(ct.copy(this.matrixWorld).invert())},lookAt:function(t,e,n){t.isVector3?ut.copy(t):ut.set(t,e,n);const r=this.parent;this.updateWorldMatrix(!0,!1),ht.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ct.lookAt(ht,ut,this.up):ct.lookAt(ut,ht,this.up),this.quaternion.setFromRotationMatrix(ct),r&&(ct.extractRotation(r.matrixWorld),lt.setFromRotationMatrix(ct),this.quaternion.premultiply(lt.invert()))},add:function(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(vt)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(yt)),this},clear:function(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(yt)}return this.children.length=0,this},attach:function(t){return this.updateWorldMatrix(!0,!1),ct.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),ct.multiply(t.parent.matrixWorld)),t.applyMatrix4(ct),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new _),this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new b),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ht,t,ft),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new _),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ht,dt,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new _),this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)},traverseAncestors:function(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++)t[e].updateWorldMatrix(!1,!0)}},toJSON:function(t){const e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,r=n.length;e<r;e++){const r=n[e];i(t.shapes,r)}else i(t.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,r=this.material.length;n<r;n++)e.push(i(t.materials,this.material[n]));r.material=e}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(let e=0;e<this.children.length;e++)r.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];r.animations.push(i(t.animations,n))}}if(e){const e=o(t.geometries),r=o(t.materials),i=o(t.textures),s=o(t.images),a=o(t.shapes),l=o(t.skeletons),c=o(t.animations);e.length>0&&(n.geometries=e),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),s.length>0&&(n.images=s),a.length>0&&(n.shapes=a),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c)}return n.object=r,n;function o(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let e=0;e<t.children.length;e++){const n=t.children[e];this.add(n.clone())}return this}});const _t=new _,xt=new _,wt=new h;class Mt{constructor(t,e){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=void 0!==t?t:new _(1,0,0),this.constant=void 0!==e?e:0}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const r=_t.subVectors(n,e).cross(xt.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new _),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new _);const n=t.delta(_t),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;const i=-(t.start.dot(this.normal)+this.constant)/r;return i<0||i>1?void 0:e.copy(n).multiplyScalar(i).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new _),t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||wt.getNormalMatrix(t),r=this.coplanarPoint(_t).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}const St=new _,Et=new _,Tt=new _,Ct=new _,At=new _,Pt=new _,Lt=new _,Rt=new _,Ot=new _,kt=new _;class It{constructor(t,e,n){this.a=void 0!==t?t:new _,this.b=void 0!==e?e:new _,this.c=void 0!==n?n:new _}static getNormal(t,e,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new _),r.subVectors(n,e),St.subVectors(t,e),r.cross(St);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(t,e,n,r,i){St.subVectors(r,e),Et.subVectors(n,e),Tt.subVectors(t,e);const o=St.dot(St),s=St.dot(Et),a=St.dot(Tt),l=Et.dot(Et),c=Et.dot(Tt),u=o*l-s*s;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new _),0===u)return i.set(-2,-1,-1);const h=1/u,f=(l*a-s*c)*h,d=(o*c-s*a)*h;return i.set(1-f-d,d,f)}static containsPoint(t,e,n,r){return this.getBarycoord(t,e,n,r,Ct),Ct.x>=0&&Ct.y>=0&&Ct.x+Ct.y<=1}static getUV(t,e,n,r,i,o,s,a){return this.getBarycoord(t,e,n,r,Ct),a.set(0,0),a.addScaledVector(i,Ct.x),a.addScaledVector(o,Ct.y),a.addScaledVector(s,Ct.z),a}static isFrontFacing(t,e,n,r){return St.subVectors(n,e),Et.subVectors(t,e),St.cross(Et).dot(r)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return St.subVectors(this.c,this.b),Et.subVectors(this.a,this.b),.5*St.cross(Et).length()}getMidpoint(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new _),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return It.getNormal(this.a,this.b,this.c,t)}getPlane(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Mt),t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return It.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,r,i){return It.getUV(t,this.a,this.b,this.c,e,n,r,i)}containsPoint(t){return It.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return It.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new _);const n=this.a,r=this.b,i=this.c;let o,s;At.subVectors(r,n),Pt.subVectors(i,n),Rt.subVectors(t,n);const a=At.dot(Rt),l=Pt.dot(Rt);if(a<=0&&l<=0)return e.copy(n);Ot.subVectors(t,r);const c=At.dot(Ot),u=Pt.dot(Ot);if(c>=0&&u<=c)return e.copy(r);const h=a*u-c*l;if(h<=0&&a>=0&&c<=0)return o=a/(a-c),e.copy(n).addScaledVector(At,o);kt.subVectors(t,i);const f=At.dot(kt),d=Pt.dot(kt);if(d>=0&&f<=d)return e.copy(i);const p=f*l-a*d;if(p<=0&&l>=0&&d<=0)return s=l/(l-d),e.copy(n).addScaledVector(Pt,s);const m=c*d-f*u;if(m<=0&&u-c>=0&&f-d>=0)return Lt.subVectors(i,r),s=(u-c)/(u-c+(f-d)),e.copy(r).addScaledVector(Lt,s);const g=1/(m+p+h);return o=p*g,s=h*g,e.copy(n).addScaledVector(At,o).addScaledVector(Pt,s)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const Dt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Nt={h:0,s:0,l:0},jt={h:0,s:0,l:0};function Ft(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function Bt(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function zt(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}class Ut{constructor(t,e,n){return Object.defineProperty(this,"isColor",{value:!0}),void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,e,n){return this.r=t,this.g=e,this.b=n,this}setHSL(t,e,n){if(t=c.euclideanModulo(t,1),e=c.clamp(e,0,1),n=c.clamp(n,0,1),0===e)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=Ft(i,r,t+1/3),this.g=Ft(i,r,t),this.b=Ft(i,r,t-1/3)}return this}setStyle(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const r=n[1],i=n[2];switch(r){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,e(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,e(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i)){const n=parseFloat(t[1])/360,r=parseInt(t[2],10)/100,i=parseInt(t[3],10)/100;return e(t[4]),this.setHSL(n,r,i)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=n[1],e=t.length;if(3===e)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,this;if(6===e)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=Dt[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyGammaToLinear(t,e=2){return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this}copyLinearToGamma(t,e=2){const n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.r=Bt(t.r),this.g=Bt(t.g),this.b=Bt(t.b),this}copyLinearToSRGB(t){return this.r=zt(t.r),this.g=zt(t.g),this.b=zt(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});const e=this.r,n=this.g,r=this.b,i=Math.max(e,n,r),o=Math.min(e,n,r);let s,a;const l=(o+i)/2;if(o===i)s=0,a=0;else{const t=i-o;switch(a=l<=.5?t/(i+o):t/(2-i-o),i){case e:s=(n-r)/t+(n<r?6:0);break;case n:s=(r-e)/t+2;break;case r:s=(e-n)/t+4}s/=6}return t.h=s,t.s=a,t.l=l,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,e,n){return this.getHSL(Nt),Nt.h+=t,Nt.s+=e,Nt.l+=n,this.setHSL(Nt.h,Nt.s,Nt.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(Nt),t.getHSL(jt);const n=c.lerp(Nt.h,jt.h,e),r=c.lerp(Nt.s,jt.s,e),i=c.lerp(Nt.l,jt.l,e);return this.setHSL(n,r,i),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Ut.NAMES=Dt,Ut.prototype.r=1,Ut.prototype.g=1,Ut.prototype.b=1;class Ht{constructor(t,e,n,r,i,o=0){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new _,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new Ut,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=o}clone(){return(new this.constructor).copy(this)}copy(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(let e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}}let Gt=0;function Wt(){Object.defineProperty(this,"id",{value:Gt++}),this.uuid=c.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function Vt(t){Wt.call(this),this.type="MeshBasicMaterial",this.color=new Ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}Wt.prototype=Object.assign(Object.create(s.prototype),{constructor:Wt,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if("shading"===e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;continue}const r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}},toJSON:function(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){const e=r(t.textures),i=r(t.images);e.length>0&&(n.textures=e),i.length>0&&(n.images=i)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let r=0;r!==t;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Wt.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Vt.prototype=Object.create(Wt.prototype),Vt.prototype.constructor=Vt,Vt.prototype.isMeshBasicMaterial=!0,Vt.prototype.copy=function(t){return Wt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};const qt=new _,Xt=new u;function Yt(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function Zt(t,e,n){Yt.call(this,new Int8Array(t),e,n)}function Jt(t,e,n){Yt.call(this,new Uint8Array(t),e,n)}function Kt(t,e,n){Yt.call(this,new Uint8ClampedArray(t),e,n)}function Qt(t,e,n){Yt.call(this,new Int16Array(t),e,n)}function $t(t,e,n){Yt.call(this,new Uint16Array(t),e,n)}function te(t,e,n){Yt.call(this,new Int32Array(t),e,n)}function ee(t,e,n){Yt.call(this,new Uint32Array(t),e,n)}function ne(t,e,n){Yt.call(this,new Uint16Array(t),e,n)}function re(t,e,n){Yt.call(this,new Float32Array(t),e,n)}function ie(t,e,n){Yt.call(this,new Float64Array(t),e,n)}function oe(t){if(0===t.length)return-1/0;let e=t[0];for(let n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}Object.defineProperty(Yt.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Yt.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),i=new Ut),e[n++]=i.r,e[n++]=i.g,e[n++]=i.b}return this},copyVector2sArray:function(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),i=new u),e[n++]=i.x,e[n++]=i.y}return this},copyVector3sArray:function(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),i=new _),e[n++]=i.x,e[n++]=i.y,e[n++]=i.z}return this},copyVector4sArray:function(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),i=new v),e[n++]=i.x,e[n++]=i.y,e[n++]=i.z,e[n++]=i.w}return this},applyMatrix3:function(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)Xt.fromBufferAttribute(this,e),Xt.applyMatrix3(t),this.setXY(e,Xt.x,Xt.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)qt.fromBufferAttribute(this,e),qt.applyMatrix3(t),this.setXYZ(e,qt.x,qt.y,qt.z);return this},applyMatrix4:function(t){for(let e=0,n=this.count;e<n;e++)qt.x=this.getX(e),qt.y=this.getY(e),qt.z=this.getZ(e),qt.applyMatrix4(t),this.setXYZ(e,qt.x,qt.y,qt.z);return this},applyNormalMatrix:function(t){for(let e=0,n=this.count;e<n;e++)qt.x=this.getX(e),qt.y=this.getY(e),qt.z=this.getZ(e),qt.applyNormalMatrix(t),this.setXYZ(e,qt.x,qt.y,qt.z);return this},transformDirection:function(t){for(let e=0,n=this.count;e<n;e++)qt.x=this.getX(e),qt.y=this.getY(e),qt.z=this.getZ(e),qt.transformDirection(t),this.setXYZ(e,qt.x,qt.y,qt.z);return this},set:function(t,e=0){return this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Zt.prototype=Object.create(Yt.prototype),Zt.prototype.constructor=Zt,Jt.prototype=Object.create(Yt.prototype),Jt.prototype.constructor=Jt,Kt.prototype=Object.create(Yt.prototype),Kt.prototype.constructor=Kt,Qt.prototype=Object.create(Yt.prototype),Qt.prototype.constructor=Qt,$t.prototype=Object.create(Yt.prototype),$t.prototype.constructor=$t,te.prototype=Object.create(Yt.prototype),te.prototype.constructor=te,ee.prototype=Object.create(Yt.prototype),ee.prototype.constructor=ee,ne.prototype=Object.create(Yt.prototype),ne.prototype.constructor=ne,ne.prototype.isFloat16BufferAttribute=!0,re.prototype=Object.create(Yt.prototype),re.prototype.constructor=re,ie.prototype=Object.create(Yt.prototype),ie.prototype.constructor=ie;const se={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function ae(t,e){return new se[t](e)}let le=0;const ce=new Y,ue=new bt,he=new _,fe=new M,de=new M,pe=new _;function me(){Object.defineProperty(this,"id",{value:le++}),this.uuid=c.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}me.prototype=Object.assign(Object.create(s.prototype),{constructor:me,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){return Array.isArray(t)?this.index=new(oe(t)>65535?ee:$t)(t,1):this.index=t,this},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},hasAttribute:function(t){return void 0!==this.attributes[t]},addGroup:function(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new h).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(t),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return ce.makeRotationX(t),this.applyMatrix4(ce),this},rotateY:function(t){return ce.makeRotationY(t),this.applyMatrix4(ce),this},rotateZ:function(t){return ce.makeRotationZ(t),this.applyMatrix4(ce),this},translate:function(t,e,n){return ce.makeTranslation(t,e,n),this.applyMatrix4(ce),this},scale:function(t,e,n){return ce.makeScale(t,e,n),this.applyMatrix4(ce),this},lookAt:function(t){return ue.lookAt(t),ue.updateMatrix(),this.applyMatrix4(ue.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(he).negate(),this.translate(he.x,he.y,he.z),this},setFromPoints:function(t){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new re(e,3)),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new M);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new _(-1/0,-1/0,-1/0),new _(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];fe.setFromBufferAttribute(n),this.morphTargetsRelative?(pe.addVectors(this.boundingBox.min,fe.min),this.boundingBox.expandByPoint(pe),pe.addVectors(this.boundingBox.max,fe.max),this.boundingBox.expandByPoint(pe)):(this.boundingBox.expandByPoint(fe.min),this.boundingBox.expandByPoint(fe.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new B);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new _,1/0);if(t){const n=this.boundingSphere.center;if(fe.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];de.setFromBufferAttribute(n),this.morphTargetsRelative?(pe.addVectors(fe.min,de.min),fe.expandByPoint(pe),pe.addVectors(fe.max,de.max),fe.expandByPoint(pe)):(fe.expandByPoint(de.min),fe.expandByPoint(de.max))}fe.getCenter(n);let r=0;for(let e=0,i=t.count;e<i;e++)pe.fromBufferAttribute(t,e),r=Math.max(r,n.distanceToSquared(pe));if(e)for(let i=0,o=e.length;i<o;i++){const o=e[i],s=this.morphTargetsRelative;for(let e=0,i=o.count;e<i;e++)pe.fromBufferAttribute(o,e),s&&(he.fromBufferAttribute(t,e),pe.add(he)),r=Math.max(r,n.distanceToSquared(pe))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.array,r=e.position.array,i=e.normal.array,o=e.uv.array,s=r.length/3;void 0===e.tangent&&this.setAttribute("tangent",new Yt(new Float32Array(4*s),4));const a=e.tangent.array,l=[],c=[];for(let t=0;t<s;t++)l[t]=new _,c[t]=new _;const h=new _,f=new _,d=new _,p=new u,m=new u,g=new u,v=new _,y=new _;function b(t,e,n){h.fromArray(r,3*t),f.fromArray(r,3*e),d.fromArray(r,3*n),p.fromArray(o,2*t),m.fromArray(o,2*e),g.fromArray(o,2*n),f.sub(h),d.sub(h),m.sub(p),g.sub(p);const i=1/(m.x*g.y-g.x*m.y);isFinite(i)&&(v.copy(f).multiplyScalar(g.y).addScaledVector(d,-m.y).multiplyScalar(i),y.copy(d).multiplyScalar(m.x).addScaledVector(f,-g.x).multiplyScalar(i),l[t].add(v),l[e].add(v),l[n].add(v),c[t].add(y),c[e].add(y),c[n].add(y))}let x=this.groups;0===x.length&&(x=[{start:0,count:n.length}]);for(let t=0,e=x.length;t<e;++t){const e=x[t],r=e.start;for(let t=r,i=r+e.count;t<i;t+=3)b(n[t+0],n[t+1],n[t+2])}const w=new _,M=new _,S=new _,E=new _;function T(t){S.fromArray(i,3*t),E.copy(S);const e=l[t];w.copy(e),w.sub(S.multiplyScalar(S.dot(e))).normalize(),M.crossVectors(E,e);const n=M.dot(c[t])<0?-1:1;a[4*t]=w.x,a[4*t+1]=w.y,a[4*t+2]=w.z,a[4*t+3]=n}for(let t=0,e=x.length;t<e;++t){const e=x[t],r=e.start;for(let t=r,i=r+e.count;t<i;t+=3)T(n[t+0]),T(n[t+1]),T(n[t+2])}},computeVertexNormals:function(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new Yt(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const r=new _,i=new _,o=new _,s=new _,a=new _,l=new _,c=new _,u=new _;if(t)for(let h=0,f=t.count;h<f;h+=3){const f=t.getX(h+0),d=t.getX(h+1),p=t.getX(h+2);r.fromBufferAttribute(e,f),i.fromBufferAttribute(e,d),o.fromBufferAttribute(e,p),c.subVectors(o,i),u.subVectors(r,i),c.cross(u),s.fromBufferAttribute(n,f),a.fromBufferAttribute(n,d),l.fromBufferAttribute(n,p),s.add(c),a.add(c),l.add(c),n.setXYZ(f,s.x,s.y,s.z),n.setXYZ(d,a.x,a.y,a.z),n.setXYZ(p,l.x,l.y,l.z)}else for(let t=0,s=e.count;t<s;t+=3)r.fromBufferAttribute(e,t+0),i.fromBufferAttribute(e,t+1),o.fromBufferAttribute(e,t+2),c.subVectors(o,i),u.subVectors(r,i),c.cross(u),n.setXYZ(t+0,c.x,c.y,c.z),n.setXYZ(t+1,c.x,c.y,c.z),n.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}},merge:function(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(void 0===t.attributes[r])continue;const i=n[r].array,o=t.attributes[r],s=o.array,a=o.itemSize*e,l=Math.min(s.length,i.length-a);for(let t=0,e=a;t<l;t++,e++)i[e]=s[t]}return this},normalizeNormals:function(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)pe.fromBufferAttribute(t,e),pe.normalize(),t.setXYZ(e,pe.x,pe.y,pe.z)},toNonIndexed:function(){function t(t,e){const n=t.array,r=t.itemSize,i=t.normalized,o=new n.constructor(e.length*r);let s=0,a=0;for(let t=0,i=e.length;t<i;t++){s=e[t]*r;for(let t=0;t<r;t++)o[a++]=n[s++]}return new Yt(o,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new me,n=this.index.array,r=this.attributes;for(const i in r){const o=t(r[i],n);e.setAttribute(i,o)}const i=this.morphAttributes;for(const r in i){const o=[],s=i[r];for(let e=0,r=s.length;e<r;e++){const r=t(s[e],n);o.push(r)}e.morphAttributes[r]=o}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let t=0,n=o.length;t<n;t++){const n=o[t];e.addGroup(n.start,n.count,n.materialIndex)}return e},toJSON:function(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const e in n){const r=n[e],i=r.toJSON(t.data);""!==r.name&&(i.name=r.name),t.data.attributes[e]=i}const r={};let i=!1;for(const e in this.morphAttributes){const n=this.morphAttributes[e],o=[];for(let e=0,r=n.length;e<r;e++){const r=n[e],i=r.toJSON(t.data);""!==r.name&&(i.name=r.name),o.push(i)}o.length>0&&(r[e]=o,i=!0)}i&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const s=this.boundingSphere;return null!==s&&(t.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),t},clone:function(){return(new me).copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const r=t.attributes;for(const t in r){const n=r[t];this.setAttribute(t,n.clone(e))}const i=t.morphAttributes;for(const t in i){const n=[],r=i[t];for(let t=0,i=r.length;t<i;t++)n.push(r[t].clone(e));this.morphAttributes[t]=n}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let t=0,e=o.length;t<e;t++){const e=o[t];this.addGroup(e.start,e.count,e.materialIndex)}const s=t.boundingBox;null!==s&&(this.boundingBox=s.clone());const a=t.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const ge=new Y,ve=new X,ye=new B,be=new _,_e=new _,xe=new _,we=new _,Me=new _,Se=new _,Ee=new _,Te=new _,Ce=new _,Ae=new u,Pe=new u,Le=new u,Re=new _,Oe=new _;function ke(t=new me,e=new Vt){bt.call(this),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}function Ie(t,e,n,r,i,o,s,a,l,c,h,f){be.fromBufferAttribute(i,c),_e.fromBufferAttribute(i,h),xe.fromBufferAttribute(i,f);const d=t.morphTargetInfluences;if(e.morphTargets&&o&&d){Ee.set(0,0,0),Te.set(0,0,0),Ce.set(0,0,0);for(let t=0,e=o.length;t<e;t++){const e=d[t],n=o[t];0!==e&&(we.fromBufferAttribute(n,c),Me.fromBufferAttribute(n,h),Se.fromBufferAttribute(n,f),s?(Ee.addScaledVector(we,e),Te.addScaledVector(Me,e),Ce.addScaledVector(Se,e)):(Ee.addScaledVector(we.sub(be),e),Te.addScaledVector(Me.sub(_e),e),Ce.addScaledVector(Se.sub(xe),e)))}be.add(Ee),_e.add(Te),xe.add(Ce)}t.isSkinnedMesh&&(t.boneTransform(c,be),t.boneTransform(h,_e),t.boneTransform(f,xe));const p=function(t,e,n,r,i,o,s,a){let l;if(l=1===e.side?r.intersectTriangle(s,o,i,!0,a):r.intersectTriangle(i,o,s,2!==e.side,a),null===l)return null;Oe.copy(a),Oe.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(Oe);return c<n.near||c>n.far?null:{distance:c,point:Oe.clone(),object:t}}(t,e,n,r,be,_e,xe,Re);if(p){a&&(Ae.fromBufferAttribute(a,c),Pe.fromBufferAttribute(a,h),Le.fromBufferAttribute(a,f),p.uv=It.getUV(Re,be,_e,xe,Ae,Pe,Le,new u)),l&&(Ae.fromBufferAttribute(l,c),Pe.fromBufferAttribute(l,h),Le.fromBufferAttribute(l,f),p.uv2=It.getUV(Re,be,_e,xe,Ae,Pe,Le,new u));const t=new Ht(c,h,f);It.getNormal(be,_e,xe,t.normal),p.face=t}return p}ke.prototype=Object.assign(Object.create(bt.prototype),{constructor:ke,isMesh:!0,copy:function(t){return bt.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,e){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0===r)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),ye.copy(n.boundingSphere),ye.applyMatrix4(i),!1===t.ray.intersectsSphere(ye))return;if(ge.copy(i).invert(),ve.copy(t.ray).applyMatrix4(ge),null!==n.boundingBox&&!1===ve.intersectsBox(n.boundingBox))return;let o;if(n.isBufferGeometry){const i=n.index,s=n.attributes.position,a=n.morphAttributes.position,l=n.morphTargetsRelative,c=n.attributes.uv,u=n.attributes.uv2,h=n.groups,f=n.drawRange;if(null!==i)if(Array.isArray(r))for(let n=0,d=h.length;n<d;n++){const d=h[n],p=r[d.materialIndex];for(let n=Math.max(d.start,f.start),r=Math.min(d.start+d.count,f.start+f.count);n<r;n+=3){const r=i.getX(n),h=i.getX(n+1),f=i.getX(n+2);o=Ie(this,p,t,ve,s,a,l,c,u,r,h,f),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=d.materialIndex,e.push(o))}}else{for(let n=Math.max(0,f.start),h=Math.min(i.count,f.start+f.count);n<h;n+=3){const h=i.getX(n),f=i.getX(n+1),d=i.getX(n+2);o=Ie(this,r,t,ve,s,a,l,c,u,h,f,d),o&&(o.faceIndex=Math.floor(n/3),e.push(o))}}else if(void 0!==s)if(Array.isArray(r))for(let n=0,i=h.length;n<i;n++){const i=h[n],d=r[i.materialIndex];for(let n=Math.max(i.start,f.start),r=Math.min(i.start+i.count,f.start+f.count);n<r;n+=3){o=Ie(this,d,t,ve,s,a,l,c,u,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=i.materialIndex,e.push(o))}}else{for(let n=Math.max(0,f.start),i=Math.min(s.count,f.start+f.count);n<i;n+=3){o=Ie(this,r,t,ve,s,a,l,c,u,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),e.push(o))}}}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}});class De extends me{constructor(t=1,e=1,n=1,r=1,i=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};const s=this;r=Math.floor(r),i=Math.floor(i),o=Math.floor(o);const a=[],l=[],c=[],u=[];let h=0,f=0;function d(t,e,n,r,i,o,d,p,m,g,v){const y=o/m,b=d/g,x=o/2,w=d/2,M=p/2,S=m+1,E=g+1;let T=0,C=0;const A=new _;for(let o=0;o<E;o++){const s=o*b-w;for(let a=0;a<S;a++){const h=a*y-x;A[t]=h*r,A[e]=s*i,A[n]=M,l.push(A.x,A.y,A.z),A[t]=0,A[e]=0,A[n]=p>0?1:-1,c.push(A.x,A.y,A.z),u.push(a/m),u.push(1-o/g),T+=1}}for(let t=0;t<g;t++)for(let e=0;e<m;e++){const n=h+e+S*t,r=h+e+S*(t+1),i=h+(e+1)+S*(t+1),o=h+(e+1)+S*t;a.push(n,r,o),a.push(r,i,o),C+=6}s.addGroup(f,C,v),f+=C,h+=T}d("z","y","x",-1,-1,n,e,t,o,i,0),d("z","y","x",1,-1,n,e,-t,o,i,1),d("x","z","y",1,1,t,n,e,r,o,2),d("x","z","y",1,-1,t,n,-e,r,o,3),d("x","y","z",1,-1,t,e,n,r,i,4),d("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(a),this.setAttribute("position",new re(l,3)),this.setAttribute("normal",new re(c,3)),this.setAttribute("uv",new re(u,2))}}function Ne(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}}return e}function je(t){const e={};for(let n=0;n<t.length;n++){const r=Ne(t[n]);for(const t in r)e[t]=r[t]}return e}const Fe={clone:Ne,merge:je};function Be(t){Wt.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function ze(){bt.call(this),this.type="Camera",this.matrixWorldInverse=new Y,this.projectionMatrix=new Y,this.projectionMatrixInverse=new Y}function Ue(t=50,e=1,n=.1,r=2e3){ze.call(this),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Be.prototype=Object.create(Wt.prototype),Be.prototype.constructor=Be,Be.prototype.isShaderMaterial=!0,Be.prototype.copy=function(t){return Wt.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Ne(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this},Be.prototype.toJSON=function(t){const e=Wt.prototype.toJSON.call(this,t);e.glslVersion=this.glslVersion,e.uniforms={};for(const n in this.uniforms){const r=this.uniforms[n].value;r&&r.isTexture?e.uniforms[n]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[n]={type:"m4",value:r.toArray()}:e.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const t in this.extensions)!0===this.extensions[t]&&(n[t]=!0);return Object.keys(n).length>0&&(e.extensions=n),e},ze.prototype=Object.assign(Object.create(bt.prototype),{constructor:ze,isCamera:!0,copy:function(t,e){return bt.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new _),this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){bt.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(t,e){bt.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return(new this.constructor).copy(this)}}),Ue.prototype=Object.assign(Object.create(ze.prototype),{constructor:Ue,isPerspectiveCamera:!0,copy:function(t,e){return ze.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){const e=.5*this.getFilmHeight()/t;this.fov=2*c.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){const t=Math.tan(.5*c.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*c.RAD2DEG*Math.atan(Math.tan(.5*c.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const t=this.near;let e=t*Math.tan(.5*c.DEG2RAD*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const t=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/t,e-=o.offsetY*n/s,r*=o.width/t,n*=o.height/s}const s=this.filmOffset;0!==s&&(i+=t*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(t){const e=bt.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});function He(t,e,n){if(bt.call(this),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const r=new Ue(90,1,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new _(1,0,0)),this.add(r);const i=new Ue(90,1,t,e);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new _(-1,0,0)),this.add(i);const o=new Ue(90,1,t,e);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new _(0,1,0)),this.add(o);const s=new Ue(90,1,t,e);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(new _(0,-1,0)),this.add(s);const a=new Ue(90,1,t,e);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new _(0,0,1)),this.add(a);const l=new Ue(90,1,t,e);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new _(0,0,-1)),this.add(l),this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();const c=t.xr.enabled,u=t.getRenderTarget();t.xr.enabled=!1;const h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,r),t.setRenderTarget(n,1),t.render(e,i),t.setRenderTarget(n,2),t.render(e,o),t.setRenderTarget(n,3),t.render(e,s),t.setRenderTarget(n,4),t.render(e,a),n.texture.generateMipmaps=h,t.setRenderTarget(n,5),t.render(e,l),t.setRenderTarget(u),t.xr.enabled=c}}function Ge(t,e,n,r,i,o,s,a,l,c){t=void 0!==t?t:[],e=void 0!==e?e:301,s=void 0!==s?s:1022,m.call(this,t,e,n,r,i,o,s,a,l,c),this.flipY=!1,this._needsFlipEnvMap=!0}He.prototype=Object.create(bt.prototype),He.prototype.constructor=He,Ge.prototype=Object.create(m.prototype),Ge.prototype.constructor=Ge,Ge.prototype.isCubeTexture=!0,Object.defineProperty(Ge.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});class We extends y{constructor(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),super(t,t,e),Object.defineProperty(this,"isWebGLCubeRenderTarget",{value:!0}),e=e||{},this.texture=new Ge(void 0,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.format=1023,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},r=new De(5,5,5),i=new Be({name:"CubemapFromEquirect",uniforms:Ne(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:1,blending:0});i.uniforms.tEquirect.value=e;const o=new ke(r,i),s=e.minFilter;1008===e.minFilter&&(e.minFilter=1006);return new He(1,10,this).update(t,o),e.minFilter=s,o.geometry.dispose(),o.material.dispose(),this}clear(t,e,n,r){const i=t.getRenderTarget();for(let i=0;i<6;i++)t.setRenderTarget(this,i),t.clear(e,n,r);t.setRenderTarget(i)}}function Ve(t,e,n,r,i,o,s,a,l,c,u,h){m.call(this,null,o,s,a,l,c,r,i,u,h),this.image={data:t||null,width:e||1,height:n||1},this.magFilter=void 0!==l?l:1003,this.minFilter=void 0!==c?c:1003,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}Ve.prototype=Object.create(m.prototype),Ve.prototype.constructor=Ve,Ve.prototype.isDataTexture=!0;const qe=new B,Xe=new _;class Ye{constructor(t,e,n,r,i,o){this.planes=[void 0!==t?t:new Mt,void 0!==e?e:new Mt,void 0!==n?n:new Mt,void 0!==r?r:new Mt,void 0!==i?i:new Mt,void 0!==o?o:new Mt]}set(t,e,n,r,i,o){const s=this.planes;return s[0].copy(t),s[1].copy(e),s[2].copy(n),s[3].copy(r),s[4].copy(i),s[5].copy(o),this}clone(){return(new this.constructor).copy(this)}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],l=n[5],c=n[6],u=n[7],h=n[8],f=n[9],d=n[10],p=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return e[0].setComponents(s-r,u-a,p-h,y-m).normalize(),e[1].setComponents(s+r,u+a,p+h,y+m).normalize(),e[2].setComponents(s+i,u+l,p+f,y+g).normalize(),e[3].setComponents(s-i,u-l,p-f,y-g).normalize(),e[4].setComponents(s-o,u-c,p-d,y-v).normalize(),e[5].setComponents(s+o,u+c,p+d,y+v).normalize(),this}intersectsObject(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),qe.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(qe)}intersectsSprite(t){return qe.center.set(0,0,0),qe.radius=.7071067811865476,qe.applyMatrix4(t.matrixWorld),this.intersectsSphere(qe)}intersectsSphere(t){const e=this.planes,n=t.center,r=-t.radius;for(let t=0;t<6;t++){if(e[t].distanceToPoint(n)<r)return!1}return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const r=e[n];if(Xe.x=r.normal.x>0?t.max.x:t.min.x,Xe.y=r.normal.y>0?t.max.y:t.min.y,Xe.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(Xe)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}}function Ze(){let t=null,e=!1,n=null,r=null;function i(e,o){n(e,o),r=t.requestAnimationFrame(i)}return{start:function(){!0!==e&&null!==n&&(r=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function Je(t,e){const n=e.isWebGL2,r=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),r.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const n=r.get(e);n&&(t.deleteBuffer(n.buffer),r.delete(e))},update:function(e,i){if(e.isGLBufferAttribute){const t=r.get(e);return void((!t||t.version<e.version)&&r.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version}))}e.isInterleavedBufferAttribute&&(e=e.data);const o=r.get(e);void 0===o?r.set(e,function(e,r){const i=e.array,o=e.usage,s=t.createBuffer();t.bindBuffer(r,s),t.bufferData(r,i,o),e.onUploadCallback();let a=5126;return i instanceof Float32Array?a=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?e.isFloat16BufferAttribute?n?a=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):a=5123:i instanceof Int16Array?a=5122:i instanceof Uint32Array?a=5125:i instanceof Int32Array?a=5124:i instanceof Int8Array?a=5120:i instanceof Uint8Array&&(a=5121),{buffer:s,type:a,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version}}(e,i)):o.version<e.version&&(!function(e,r,i){const o=r.array,s=r.updateRange;t.bindBuffer(i,e),-1===s.count?t.bufferSubData(i,0,o):(n?t.bufferSubData(i,s.offset*o.BYTES_PER_ELEMENT,o,s.offset,s.count):t.bufferSubData(i,s.offset*o.BYTES_PER_ELEMENT,o.subarray(s.offset,s.offset+s.count)),s.count=-1)}(o.buffer,e,i),o.version=e.version)}}}class Ke extends me{constructor(t=1,e=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};const i=t/2,o=e/2,s=Math.floor(n),a=Math.floor(r),l=s+1,c=a+1,u=t/s,h=e/a,f=[],d=[],p=[],m=[];for(let t=0;t<c;t++){const e=t*h-o;for(let n=0;n<l;n++){const r=n*u-i;d.push(r,-e,0),p.push(0,0,1),m.push(n/s),m.push(1-t/a)}}for(let t=0;t<a;t++)for(let e=0;e<s;e++){const n=e+l*t,r=e+l*(t+1),i=e+1+l*(t+1),o=e+1+l*t;f.push(n,r,o),f.push(r,i,o)}this.setIndex(f),this.setAttribute("position",new re(d,3)),this.setAttribute("normal",new re(p,3)),this.setAttribute("uv",new re(m,2))}}const Qe={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor.xyz *= color.xyz;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},$e={common:{diffuse:{value:new Ut(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new h},uv2Transform:{value:new h},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new u(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ut(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ut(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new h}},sprite:{diffuse:{value:new Ut(15658734)},opacity:{value:1},center:{value:new u(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new h}}},tn={basic:{uniforms:je([$e.common,$e.specularmap,$e.envmap,$e.aomap,$e.lightmap,$e.fog]),vertexShader:Qe.meshbasic_vert,fragmentShader:Qe.meshbasic_frag},lambert:{uniforms:je([$e.common,$e.specularmap,$e.envmap,$e.aomap,$e.lightmap,$e.emissivemap,$e.fog,$e.lights,{emissive:{value:new Ut(0)}}]),vertexShader:Qe.meshlambert_vert,fragmentShader:Qe.meshlambert_frag},phong:{uniforms:je([$e.common,$e.specularmap,$e.envmap,$e.aomap,$e.lightmap,$e.emissivemap,$e.bumpmap,$e.normalmap,$e.displacementmap,$e.fog,$e.lights,{emissive:{value:new Ut(0)},specular:{value:new Ut(1118481)},shininess:{value:30}}]),vertexShader:Qe.meshphong_vert,fragmentShader:Qe.meshphong_frag},standard:{uniforms:je([$e.common,$e.envmap,$e.aomap,$e.lightmap,$e.emissivemap,$e.bumpmap,$e.normalmap,$e.displacementmap,$e.roughnessmap,$e.metalnessmap,$e.fog,$e.lights,{emissive:{value:new Ut(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Qe.meshphysical_vert,fragmentShader:Qe.meshphysical_frag},toon:{uniforms:je([$e.common,$e.aomap,$e.lightmap,$e.emissivemap,$e.bumpmap,$e.normalmap,$e.displacementmap,$e.gradientmap,$e.fog,$e.lights,{emissive:{value:new Ut(0)}}]),vertexShader:Qe.meshtoon_vert,fragmentShader:Qe.meshtoon_frag},matcap:{uniforms:je([$e.common,$e.bumpmap,$e.normalmap,$e.displacementmap,$e.fog,{matcap:{value:null}}]),vertexShader:Qe.meshmatcap_vert,fragmentShader:Qe.meshmatcap_frag},points:{uniforms:je([$e.points,$e.fog]),vertexShader:Qe.points_vert,fragmentShader:Qe.points_frag},dashed:{uniforms:je([$e.common,$e.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Qe.linedashed_vert,fragmentShader:Qe.linedashed_frag},depth:{uniforms:je([$e.common,$e.displacementmap]),vertexShader:Qe.depth_vert,fragmentShader:Qe.depth_frag},normal:{uniforms:je([$e.common,$e.bumpmap,$e.normalmap,$e.displacementmap,{opacity:{value:1}}]),vertexShader:Qe.normal_vert,fragmentShader:Qe.normal_frag},sprite:{uniforms:je([$e.sprite,$e.fog]),vertexShader:Qe.sprite_vert,fragmentShader:Qe.sprite_frag},background:{uniforms:{uvTransform:{value:new h},t2D:{value:null}},vertexShader:Qe.background_vert,fragmentShader:Qe.background_frag},cube:{uniforms:je([$e.envmap,{opacity:{value:1}}]),vertexShader:Qe.cube_vert,fragmentShader:Qe.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Qe.equirect_vert,fragmentShader:Qe.equirect_frag},distanceRGBA:{uniforms:je([$e.common,$e.displacementmap,{referencePosition:{value:new _},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Qe.distanceRGBA_vert,fragmentShader:Qe.distanceRGBA_frag},shadow:{uniforms:je([$e.lights,$e.fog,{color:{value:new Ut(0)},opacity:{value:1}}]),vertexShader:Qe.shadow_vert,fragmentShader:Qe.shadow_frag}};function en(t,e,n,r,i){const o=new Ut(0);let s,a,l=0,c=null,u=0,h=null;function f(t,e){n.buffers.color.setClear(t.r,t.g,t.b,e,i)}return{getClearColor:function(){return o},setClearColor:function(t,e=1){o.set(t),l=e,f(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(t){l=t,f(o,l)},render:function(n,i,d,p){let m=!0===i.isScene?i.background:null;m&&m.isTexture&&(m=e.get(m));const g=t.xr,v=g.getSession&&g.getSession();v&&"additive"===v.environmentBlendMode&&(m=null),null===m?f(o,l):m&&m.isColor&&(f(m,1),p=!0),(t.autoClear||p)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),m&&(m.isCubeTexture||m.isWebGLCubeRenderTarget||306===m.mapping)?(void 0===a&&(a=new ke(new De(1,1,1),new Be({name:"BackgroundCubeMaterial",uniforms:Ne(tn.cube.uniforms),vertexShader:tn.cube.vertexShader,fragmentShader:tn.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(a)),m.isWebGLCubeRenderTarget&&(m=m.texture),a.material.uniforms.envMap.value=m,a.material.uniforms.flipEnvMap.value=m.isCubeTexture&&m._needsFlipEnvMap?-1:1,c===m&&u===m.version&&h===t.toneMapping||(a.material.needsUpdate=!0,c=m,u=m.version,h=t.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null)):m&&m.isTexture&&(void 0===s&&(s=new ke(new Ke(2,2),new Be({name:"BackgroundMaterial",uniforms:Ne(tn.background.uniforms),vertexShader:tn.background.vertexShader,fragmentShader:tn.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),s.geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(s)),s.material.uniforms.t2D.value=m,!0===m.matrixAutoUpdate&&m.updateMatrix(),s.material.uniforms.uvTransform.value.copy(m.matrix),c===m&&u===m.version&&h===t.toneMapping||(s.material.needsUpdate=!0,c=m,u=m.version,h=t.toneMapping),n.unshift(s,s.geometry,s.material,0,0,null))}}}function nn(t,e,n,r){const i=t.getParameter(34921),o=r.isWebGL2?null:e.get("OES_vertex_array_object"),s=r.isWebGL2||null!==o,a={},l=f(null);let c=l;function u(e){return r.isWebGL2?t.bindVertexArray(e):o.bindVertexArrayOES(e)}function h(e){return r.isWebGL2?t.deleteVertexArray(e):o.deleteVertexArrayOES(e)}function f(t){const e=[],n=[],r=[];for(let t=0;t<i;t++)e[t]=0,n[t]=0,r[t]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:n,attributeDivisors:r,object:t,attributes:{},index:null}}function d(){const t=c.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function p(t){m(t,0)}function m(n,i){const o=c.newAttributes,s=c.enabledAttributes,a=c.attributeDivisors;if(o[n]=1,0===s[n]&&(t.enableVertexAttribArray(n),s[n]=1),a[n]!==i){(r.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),a[n]=i}}function g(){const e=c.newAttributes,n=c.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==e[r]&&(t.disableVertexAttribArray(r),n[r]=0)}function v(e,n,i,o,s,a){!0!==r.isWebGL2||5124!==i&&5125!==i?t.vertexAttribPointer(e,n,i,o,s,a):t.vertexAttribIPointer(e,n,i,s,a)}function y(){b(),c!==l&&(c=l,u(c.object))}function b(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,h,y,b){let _=!1;if(s){const e=function(e,n,i){const s=!0===i.wireframe;let l=a[e.id];void 0===l&&(l={},a[e.id]=l);let c=l[n.id];void 0===c&&(c={},l[n.id]=c);let u=c[s];void 0===u&&(u=f(r.isWebGL2?t.createVertexArray():o.createVertexArrayOES()),c[s]=u);return u}(y,h,l);c!==e&&(c=e,u(c.object)),_=function(t,e){const n=c.attributes,r=t.attributes;let i=0;for(const t in r){const e=n[t],o=r[t];if(void 0===e)return!0;if(e.attribute!==o)return!0;if(e.data!==o.data)return!0;i++}return c.attributesNum!==i||c.index!==e}(y,b),_&&function(t,e){const n={},r=t.attributes;let i=0;for(const t in r){const e=r[t],o={};o.attribute=e,e.data&&(o.data=e.data),n[t]=o,i++}c.attributes=n,c.attributesNum=i,c.index=e}(y,b)}else{const t=!0===l.wireframe;c.geometry===y.id&&c.program===h.id&&c.wireframe===t||(c.geometry=y.id,c.program=h.id,c.wireframe=t,_=!0)}!0===i.isInstancedMesh&&(_=!0),null!==b&&n.update(b,34963),_&&(!function(i,o,s,a){if(!1===r.isWebGL2&&(i.isInstancedMesh||a.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;d();const l=a.attributes,c=s.getAttributes(),u=o.defaultAttributeValues;for(const e in c){const r=c[e];if(r>=0){const o=l[e];if(void 0!==o){const e=o.normalized,i=o.itemSize,s=n.get(o);if(void 0===s)continue;const l=s.buffer,c=s.type,u=s.bytesPerElement;if(o.isInterleavedBufferAttribute){const n=o.data,s=n.stride,h=o.offset;n&&n.isInstancedInterleavedBuffer?(m(r,n.meshPerAttribute),void 0===a._maxInstanceCount&&(a._maxInstanceCount=n.meshPerAttribute*n.count)):p(r),t.bindBuffer(34962,l),v(r,i,c,e,s*u,h*u)}else o.isInstancedBufferAttribute?(m(r,o.meshPerAttribute),void 0===a._maxInstanceCount&&(a._maxInstanceCount=o.meshPerAttribute*o.count)):p(r),t.bindBuffer(34962,l),v(r,i,c,e,0,0)}else if("instanceMatrix"===e){const e=n.get(i.instanceMatrix);if(void 0===e)continue;const o=e.buffer,s=e.type;m(r+0,1),m(r+1,1),m(r+2,1),m(r+3,1),t.bindBuffer(34962,o),t.vertexAttribPointer(r+0,4,s,!1,64,0),t.vertexAttribPointer(r+1,4,s,!1,64,16),t.vertexAttribPointer(r+2,4,s,!1,64,32),t.vertexAttribPointer(r+3,4,s,!1,64,48)}else if("instanceColor"===e){const e=n.get(i.instanceColor);if(void 0===e)continue;const o=e.buffer,s=e.type;m(r,1),t.bindBuffer(34962,o),t.vertexAttribPointer(r,3,s,!1,12,0)}else if(void 0!==u){const n=u[e];if(void 0!==n)switch(n.length){case 2:t.vertexAttrib2fv(r,n);break;case 3:t.vertexAttrib3fv(r,n);break;case 4:t.vertexAttrib4fv(r,n);break;default:t.vertexAttrib1fv(r,n)}}}}g()}(i,l,h,y),null!==b&&t.bindBuffer(34963,n.get(b).buffer))},reset:y,resetDefaultState:b,dispose:function(){y();for(const t in a){const e=a[t];for(const t in e){const n=e[t];for(const t in n)h(n[t].object),delete n[t];delete e[t]}delete a[t]}},releaseStatesOfGeometry:function(t){if(void 0===a[t.id])return;const e=a[t.id];for(const t in e){const n=e[t];for(const t in n)h(n[t].object),delete n[t];delete e[t]}delete a[t.id]},releaseStatesOfProgram:function(t){for(const e in a){const n=a[e];if(void 0===n[t.id])continue;const r=n[t.id];for(const t in r)h(r[t].object),delete r[t];delete n[t.id]}},initAttributes:d,enableAttribute:p,disableUnusedAttributes:g}}function rn(t,e,n,r){const i=r.isWebGL2;let o;this.setMode=function(t){o=t},this.render=function(e,r){t.drawArrays(o,e,r),n.update(r,o,1)},this.renderInstances=function(r,s,a){if(0===a)return;let l,c;if(i)l=t,c="drawArraysInstanced";else if(l=e.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](o,r,s,a),n.update(s,o,a)}}function on(t,e,n){let r;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext;let s=void 0!==n.precision?n.precision:"highp";const a=i(s);a!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",a,"instead."),s=a);const l=!0===n.logarithmicDepthBuffer,c=t.getParameter(34930),u=t.getParameter(35660),h=t.getParameter(3379),f=t.getParameter(34076),d=t.getParameter(34921),p=t.getParameter(36347),m=t.getParameter(36348),g=t.getParameter(36349),v=u>0,y=o||!!e.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==r)return r;const n=e.get("EXT_texture_filter_anisotropic");return r=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,r},getMaxPrecision:i,precision:s,logarithmicDepthBuffer:l,maxTextures:c,maxVertexTextures:u,maxTextureSize:h,maxCubemapSize:f,maxAttributes:d,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:o?t.getParameter(36183):0}}function sn(t){const e=this;let n=null,r=0,i=!1,o=!1;const s=new Mt,a=new h,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(t,n,r,i){const o=null!==t?t.length:0;let c=null;if(0!==o){if(c=l.value,!0!==i||null===c){const e=r+4*o,i=n.matrixWorldInverse;a.getNormalMatrix(i),(null===c||c.length<e)&&(c=new Float32Array(e));for(let e=0,n=r;e!==o;++e,n+=4)s.copy(t[e]).applyMatrix4(i,a),s.normal.toArray(c,n),c[n+3]=s.constant}l.value=c,l.needsUpdate=!0}return e.numPlanes=o,e.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,o){const s=0!==t.length||e||0!==r||i;return i=e,n=u(t,o,0),r=t.length,s},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1,c()},this.setState=function(e,s,a){const h=e.clippingPlanes,f=e.clipIntersection,d=e.clipShadows,p=t.get(e);if(!i||null===h||0===h.length||o&&!d)o?u(null):c();else{const t=o?0:r,e=4*t;let i=p.clippingState||null;l.value=i,i=u(h,s,e,a);for(let t=0;t!==e;++t)i[t]=n[t];p.clippingState=i,this.numIntersection=f?this.numPlanes:0,this.numPlanes+=t}}}function an(t){let e=new WeakMap;function n(t,e){return 303===e?t.mapping=301:304===e&&(t.mapping=302),t}function r(t){const n=t.target;n.removeEventListener("dispose",r);const i=e.get(n);void 0!==i&&(e.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const o=i.mapping;if(303===o||304===o){if(e.has(i)){return n(e.get(i).texture,i.mapping)}{const o=i.image;if(o&&o.height>0){const s=t.getRenderList(),a=t.getRenderTarget(),l=new We(o.height/2);return l.fromEquirectangularTexture(t,i),e.set(i,l),t.setRenderTarget(a),t.setRenderList(s),i.addEventListener("dispose",r),n(l.texture,i.mapping)}return null}}}return i},dispose:function(){e=new WeakMap}}}function ln(t){const e={};function n(n){if(void 0!==e[n])return e[n];let r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return e[n]=r,r}return{has:function(t){return null!==n(t)},init:function(t){t.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float")},get:function(t){const e=n(t);return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}function cn(t,e,n,r){const i={},o=new WeakMap;function s(t){const a=t.target;null!==a.index&&e.remove(a.index);for(const t in a.attributes)e.remove(a.attributes[t]);a.removeEventListener("dispose",s),delete i[a.id];const l=o.get(a);l&&(e.remove(l),o.delete(a)),r.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,n.memory.geometries--}function a(t){const n=[],r=t.index,i=t.attributes.position;let s=0;if(null!==r){const t=r.array;s=r.version;for(let e=0,r=t.length;e<r;e+=3){const r=t[e+0],i=t[e+1],o=t[e+2];n.push(r,i,i,o,o,r)}}else{const t=i.array;s=i.version;for(let e=0,r=t.length/3-1;e<r;e+=3){const t=e+0,r=e+1,i=e+2;n.push(t,r,r,i,i,t)}}const a=new(oe(n)>65535?ee:$t)(n,1);a.version=s;const l=o.get(t);l&&e.remove(l),o.set(t,a)}return{get:function(t,e){return!0===i[e.id]||(e.addEventListener("dispose",s),i[e.id]=!0,n.memory.geometries++),e},update:function(t){const n=t.attributes;for(const t in n)e.update(n[t],34962);const r=t.morphAttributes;for(const t in r){const n=r[t];for(let t=0,r=n.length;t<r;t++)e.update(n[t],34962)}},getWireframeAttribute:function(t){const e=o.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&a(t)}else a(t);return o.get(t)}}}function un(t,e,n,r){const i=r.isWebGL2;let o,s,a;this.setMode=function(t){o=t},this.setIndex=function(t){s=t.type,a=t.bytesPerElement},this.render=function(e,r){t.drawElements(o,r,s,e*a),n.update(r,o,1)},this.renderInstances=function(r,l,c){if(0===c)return;let u,h;if(i)u=t,h="drawElementsInstanced";else if(u=e.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](o,l,s,r*a,c),n.update(l,o,c)}}function hn(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,r){switch(e.calls++,n){case 4:e.triangles+=r*(t/3);break;case 1:e.lines+=r*(t/2);break;case 3:e.lines+=r*(t-1);break;case 2:e.lines+=r*t;break;case 0:e.points+=r*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function fn(t,e){return t[0]-e[0]}function dn(t,e){return Math.abs(e[1])-Math.abs(t[1])}function pn(t){const e={},n=new Float32Array(8),r=[];for(let t=0;t<8;t++)r[t]=[t,0];return{update:function(i,o,s,a){const l=i.morphTargetInfluences,c=void 0===l?0:l.length;let u=e[o.id];if(void 0===u){u=[];for(let t=0;t<c;t++)u[t]=[t,0];e[o.id]=u}for(let t=0;t<c;t++){const e=u[t];e[0]=t,e[1]=l[t]}u.sort(dn);for(let t=0;t<8;t++)t<c&&u[t][1]?(r[t][0]=u[t][0],r[t][1]=u[t][1]):(r[t][0]=Number.MAX_SAFE_INTEGER,r[t][1]=0);r.sort(fn);const h=s.morphTargets&&o.morphAttributes.position,f=s.morphNormals&&o.morphAttributes.normal;let d=0;for(let t=0;t<8;t++){const e=r[t],i=e[0],s=e[1];i!==Number.MAX_SAFE_INTEGER&&s?(h&&o.getAttribute("morphTarget"+t)!==h[i]&&o.setAttribute("morphTarget"+t,h[i]),f&&o.getAttribute("morphNormal"+t)!==f[i]&&o.setAttribute("morphNormal"+t,f[i]),n[t]=s,d+=s):(h&&!0===o.hasAttribute("morphTarget"+t)&&o.deleteAttribute("morphTarget"+t),f&&!0===o.hasAttribute("morphNormal"+t)&&o.deleteAttribute("morphNormal"+t),n[t]=0)}const p=o.morphTargetsRelative?1:1-d;a.getUniforms().setValue(t,"morphTargetBaseInfluence",p),a.getUniforms().setValue(t,"morphTargetInfluences",n)}}}function mn(t,e,n,r){let i=new WeakMap;function o(t){const e=t.target;e.removeEventListener("dispose",o),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(t){const s=r.render.frame,a=t.geometry,l=e.get(t,a);return i.get(l)!==s&&(e.update(l),i.set(l,s)),t.isInstancedMesh&&(!1===t.hasEventListener("dispose",o)&&t.addEventListener("dispose",o),n.update(t.instanceMatrix,34962),null!==t.instanceColor&&n.update(t.instanceColor,34962)),l},dispose:function(){i=new WeakMap}}}function gn(t=null,e=1,n=1,r=1){m.call(this,null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function vn(t=null,e=1,n=1,r=1){m.call(this,null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}tn.physical={uniforms:je([tn.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new u(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Ut(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Qe.meshphysical_vert,fragmentShader:Qe.meshphysical_frag},gn.prototype=Object.create(m.prototype),gn.prototype.constructor=gn,gn.prototype.isDataTexture2DArray=!0,vn.prototype=Object.create(m.prototype),vn.prototype.constructor=vn,vn.prototype.isDataTexture3D=!0;const yn=new m,bn=new gn,_n=new vn,xn=new Ge,wn=[],Mn=[],Sn=new Float32Array(16),En=new Float32Array(9),Tn=new Float32Array(4);function Cn(t,e,n){const r=t[0];if(r<=0||r>0)return t;const i=e*n;let o=wn[i];if(void 0===o&&(o=new Float32Array(i),wn[i]=o),0!==e){r.toArray(o,0);for(let r=1,i=0;r!==e;++r)i+=n,t[r].toArray(o,i)}return o}function An(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Pn(t,e){for(let n=0,r=e.length;n<r;n++)t[n]=e[n]}function Ln(t,e){let n=Mn[e];void 0===n&&(n=new Int32Array(e),Mn[e]=n);for(let r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function Rn(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function On(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(An(n,e))return;t.uniform2fv(this.addr,e),Pn(n,e)}}function kn(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(An(n,e))return;t.uniform3fv(this.addr,e),Pn(n,e)}}function In(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(An(n,e))return;t.uniform4fv(this.addr,e),Pn(n,e)}}function Dn(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(An(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Pn(n,e)}else{if(An(n,r))return;Tn.set(r),t.uniformMatrix2fv(this.addr,!1,Tn),Pn(n,r)}}function Nn(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(An(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Pn(n,e)}else{if(An(n,r))return;En.set(r),t.uniformMatrix3fv(this.addr,!1,En),Pn(n,r)}}function jn(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(An(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Pn(n,e)}else{if(An(n,r))return;Sn.set(r),t.uniformMatrix4fv(this.addr,!1,Sn),Pn(n,r)}}function Fn(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(e||yn,i)}function Bn(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||bn,i)}function zn(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||_n,i)}function Un(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(e||xn,i)}function Hn(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Gn(t,e){const n=this.cache;An(n,e)||(t.uniform2iv(this.addr,e),Pn(n,e))}function Wn(t,e){const n=this.cache;An(n,e)||(t.uniform3iv(this.addr,e),Pn(n,e))}function Vn(t,e){const n=this.cache;An(n,e)||(t.uniform4iv(this.addr,e),Pn(n,e))}function qn(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Xn(t,e){t.uniform1fv(this.addr,e)}function Yn(t,e){t.uniform1iv(this.addr,e)}function Zn(t,e){t.uniform2iv(this.addr,e)}function Jn(t,e){t.uniform3iv(this.addr,e)}function Kn(t,e){t.uniform4iv(this.addr,e)}function Qn(t,e){const n=Cn(e,this.size,2);t.uniform2fv(this.addr,n)}function $n(t,e){const n=Cn(e,this.size,3);t.uniform3fv(this.addr,n)}function tr(t,e){const n=Cn(e,this.size,4);t.uniform4fv(this.addr,n)}function er(t,e){const n=Cn(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function nr(t,e){const n=Cn(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function rr(t,e){const n=Cn(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function ir(t,e,n){const r=e.length,i=Ln(n,r);t.uniform1iv(this.addr,i);for(let t=0;t!==r;++t)n.safeSetTexture2D(e[t]||yn,i[t])}function or(t,e,n){const r=e.length,i=Ln(n,r);t.uniform1iv(this.addr,i);for(let t=0;t!==r;++t)n.safeSetTextureCube(e[t]||xn,i[t])}function sr(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return Rn;case 35664:return On;case 35665:return kn;case 35666:return In;case 35674:return Dn;case 35675:return Nn;case 35676:return jn;case 5124:case 35670:return Hn;case 35667:case 35671:return Gn;case 35668:case 35672:return Wn;case 35669:case 35673:return Vn;case 5125:return qn;case 35678:case 36198:case 36298:case 36306:case 35682:return Fn;case 35679:case 36299:case 36307:return zn;case 35680:case 36300:case 36308:case 36293:return Un;case 36289:case 36303:case 36311:case 36292:return Bn}}(e.type)}function ar(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Xn;case 35664:return Qn;case 35665:return $n;case 35666:return tr;case 35674:return er;case 35675:return nr;case 35676:return rr;case 5124:case 35670:return Yn;case 35667:case 35671:return Zn;case 35668:case 35672:return Jn;case 35669:case 35673:return Kn;case 35678:case 36198:case 36298:case 36306:case 35682:return ir;case 35680:case 36300:case 36308:case 36293:return or}}(e.type)}function lr(t){this.id=t,this.seq=[],this.map={}}ar.prototype.updateCache=function(t){const e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),Pn(e,t)},lr.prototype.setValue=function(t,e,n){const r=this.seq;for(let i=0,o=r.length;i!==o;++i){const o=r[i];o.setValue(t,e[o.id],n)}};const cr=/(\w+)(\])?(\[|\.)?/g;function ur(t,e){t.seq.push(e),t.map[e.id]=e}function hr(t,e,n){const r=t.name,i=r.length;for(cr.lastIndex=0;;){const o=cr.exec(r),s=cr.lastIndex;let a=o[1];const l="]"===o[2],c=o[3];if(l&&(a|=0),void 0===c||"["===c&&s+2===i){ur(n,void 0===c?new sr(a,t,e):new ar(a,t,e));break}{let t=n.map[a];void 0===t&&(t=new lr(a),ur(n,t)),n=t}}}function fr(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,35718);for(let r=0;r<n;++r){const n=t.getActiveUniform(e,r);hr(n,t.getUniformLocation(e,n.name),this)}}function dr(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}fr.prototype.setValue=function(t,e,n,r){const i=this.map[e];void 0!==i&&i.setValue(t,n,r)},fr.prototype.setOptional=function(t,e,n){const r=e[n];void 0!==r&&this.setValue(t,n,r)},fr.upload=function(t,e,n,r){for(let i=0,o=e.length;i!==o;++i){const o=e[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(t,s.value,r)}},fr.seqWithValue=function(t,e){const n=[];for(let r=0,i=t.length;r!==i;++r){const i=t[r];i.id in e&&n.push(i)}return n};let pr=0;function mr(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function gr(t,e,n){const r=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();if(r&&""===i)return"";return"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(t){const e=t.split("\n");for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join("\n")}(t.getShaderSource(e))}function vr(t,e){const n=mr(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function yr(t,e){const n=mr(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function br(t,e){let n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function _r(t){return""!==t}function xr(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function wr(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Mr=/^[ \t]*#include +<([\w\d./]+)>/gm;function Sr(t){return t.replace(Mr,Er)}function Er(t,e){const n=Qe[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return Sr(n)}const Tr=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Cr=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Ar(t){return t.replace(Cr,Lr).replace(Tr,Pr)}function Pr(t,e,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Lr(t,e,n,r)}function Lr(t,e,n,r){let i="";for(let t=parseInt(e);t<parseInt(n);t++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+t+" ]").replace(/UNROLLED_LOOP_INDEX/g,t);return i}function Rr(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function Or(t,e,n,r){const i=t.getContext(),o=n.defines;let s=n.vertexShader,a=n.fragmentShader;const l=function(t){let e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(n),c=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV"}return e}(n),u=function(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 307:e="ENVMAP_MODE_REFRACTION"}return e}(n),h=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(n),f=t.gammaFactor>0?t.gammaFactor:1,d=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(_r).join("\n")}(n),p=function(t){const e=[];for(const n in t){const r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(o),m=i.createProgram();let g,v,y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=[p].filter(_r).join("\n"),g.length>0&&(g+="\n"),v=[d,p].filter(_r).join("\n"),v.length>0&&(v+="\n")):(g=[Rr(n),"#define SHADER_NAME "+n.shaderName,p,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+f,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(_r).join("\n"),v=[d,Rr(n),"#define SHADER_NAME "+n.shaderName,p,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+f,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?Qe.tonemapping_pars_fragment:"",0!==n.toneMapping?br("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",Qe.encodings_pars_fragment,n.map?vr("mapTexelToLinear",n.mapEncoding):"",n.matcap?vr("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?vr("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?vr("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?vr("lightMapTexelToLinear",n.lightMapEncoding):"",yr("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(_r).join("\n")),s=Sr(s),s=xr(s,n),s=wr(s,n),a=Sr(a),a=xr(a,n),a=wr(a,n),s=Ar(s),a=Ar(a),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",g=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#define varying in","300 es"===n.glslVersion?"":"out highp vec4 pc_fragColor;","300 es"===n.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const b=y+v+a,_=dr(i,35633,y+g+s),x=dr(i,35632,b);if(i.attachShader(m,_),i.attachShader(m,x),void 0!==n.index0AttributeName?i.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(m,0,"position"),i.linkProgram(m),t.debug.checkShaderErrors){const t=i.getProgramInfoLog(m).trim(),e=i.getShaderInfoLog(_).trim(),n=i.getShaderInfoLog(x).trim();let r=!0,o=!0;if(!1===i.getProgramParameter(m,35714)){r=!1;const e=gr(i,_,"vertex"),n=gr(i,x,"fragment");console.error("THREE.WebGLProgram: shader error: ",i.getError(),"35715",i.getProgramParameter(m,35715),"gl.getProgramInfoLog",t,e,n)}else""!==t?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",t):""!==e&&""!==n||(o=!1);o&&(this.diagnostics={runnable:r,programLog:t,vertexShader:{log:e,prefix:g},fragmentShader:{log:n,prefix:v}})}let w,M;return i.deleteShader(_),i.deleteShader(x),this.getUniforms=function(){return void 0===w&&(w=new fr(i,m)),w},this.getAttributes=function(){return void 0===M&&(M=function(t,e){const n={},r=t.getProgramParameter(e,35721);for(let i=0;i<r;i++){const r=t.getActiveAttrib(e,i).name;n[r]=t.getAttribLocation(e,r)}return n}(i,m)),M},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(m),this.program=void 0},this.name=n.shaderName,this.id=pr++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=_,this.fragmentShader=x,this}function kr(t,e,n,r,i,o){const s=[],a=r.isWebGL2,l=r.logarithmicDepthBuffer,c=r.floatVertexTextures,u=r.maxVertexUniforms,h=r.vertexTextures;let f=r.precision;const d={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},p=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function m(t){let e;return t&&t.isTexture?e=t.encoding:t&&t.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding):e=3e3,e}return{getParameters:function(i,s,p,g,v){const y=g.fog,b=i.isMeshStandardMaterial?g.environment:null,_=e.get(i.envMap||b),x=d[i.type],w=v.isSkinnedMesh?function(t){const e=t.skeleton.bones;if(c)return 1024;{const t=u,n=Math.floor((t-20)/4),r=Math.min(n,e.length);return r<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+r+"."),0):r}}(v):0;let M,S;if(null!==i.precision&&(f=r.getMaxPrecision(i.precision),f!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",f,"instead.")),x){const t=tn[x];M=t.vertexShader,S=t.fragmentShader}else M=i.vertexShader,S=i.fragmentShader;const E=t.getRenderTarget();return{isWebGL2:a,shaderID:x,shaderName:i.type,vertexShader:M,fragmentShader:S,defines:i.defines,isRawShaderMaterial:!0===i.isRawShaderMaterial,glslVersion:i.glslVersion,precision:f,instancing:!0===v.isInstancedMesh,instancingColor:!0===v.isInstancedMesh&&null!==v.instanceColor,supportsVertexTextures:h,outputEncoding:null!==E?m(E.texture):t.outputEncoding,map:!!i.map,mapEncoding:m(i.map),matcap:!!i.matcap,matcapEncoding:m(i.matcap),envMap:!!_,envMapMode:_&&_.mapping,envMapEncoding:m(_),envMapCubeUV:!!_&&(306===_.mapping||307===_.mapping),lightMap:!!i.lightMap,lightMapEncoding:m(i.lightMap),aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:m(i.emissiveMap),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,objectSpaceNormalMap:1===i.normalMapType,tangentSpaceNormalMap:0===i.normalMapType,clearcoatMap:!!i.clearcoatMap,clearcoatRoughnessMap:!!i.clearcoatRoughnessMap,clearcoatNormalMap:!!i.clearcoatNormalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,sheen:!!i.sheen,transmissionMap:!!i.transmissionMap,combine:i.combine,vertexTangents:i.normalMap&&i.vertexTangents,vertexColors:i.vertexColors,vertexUvs:!!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatMap||i.clearcoatRoughnessMap||i.clearcoatNormalMap||i.displacementMap||i.transmissionMap),uvsVertexOnly:!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||i.transmissionMap||!i.displacementMap),fog:!!y,useFog:i.fog,fogExp2:y&&y.isFogExp2,flatShading:i.flatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:l,skinning:i.skinning&&w>0,maxBones:w,useVertexTexture:c,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:i.dithering,shadowMapEnabled:t.shadowMap.enabled&&p.length>0,shadowMapType:t.shadowMap.type,toneMapping:i.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:2===i.side,flipSided:1===i.side,depthPacking:void 0!==i.depthPacking&&i.depthPacking,index0AttributeName:i.index0AttributeName,extensionDerivatives:i.extensions&&i.extensions.derivatives,extensionFragDepth:i.extensions&&i.extensions.fragDepth,extensionDrawBuffers:i.extensions&&i.extensions.drawBuffers,extensionShaderTextureLOD:i.extensions&&i.extensions.shaderTextureLOD,rendererExtensionFragDepth:a||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:a||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:a||n.has("EXT_shader_texture_lod"),customProgramCacheKey:i.customProgramCacheKey()}},getProgramCacheKey:function(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);if(!1===e.isRawShaderMaterial){for(let t=0;t<p.length;t++)n.push(e[p[t]]);n.push(t.outputEncoding),n.push(t.gammaFactor)}return n.push(e.customProgramCacheKey),n.join()},getUniforms:function(t){const e=d[t.type];let n;if(e){const t=tn[e];n=Fe.clone(t.uniforms)}else n=t.uniforms;return n},acquireProgram:function(e,n){let r;for(let t=0,e=s.length;t<e;t++){const e=s[t];if(e.cacheKey===n){r=e,++r.usedTimes;break}}return void 0===r&&(r=new Or(t,n,e,i),s.push(r)),r},releaseProgram:function(t){if(0==--t.usedTimes){const e=s.indexOf(t);s[e]=s[s.length-1],s.pop(),t.destroy()}},programs:s}}function Ir(){let t=new WeakMap;return{get:function(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}}function Dr(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Nr(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function jr(t){const e=[];let n=0;const r=[],i=[],o={id:-1};function s(r,i,s,a,l,c){let u=e[n];const h=t.get(s);return void 0===u?(u={id:r.id,object:r,geometry:i,material:s,program:h.program||o,groupOrder:a,renderOrder:r.renderOrder,z:l,group:c},e[n]=u):(u.id=r.id,u.object=r,u.geometry=i,u.material=s,u.program=h.program||o,u.groupOrder=a,u.renderOrder=r.renderOrder,u.z=l,u.group=c),n++,u}return{opaque:r,transparent:i,init:function(){n=0,r.length=0,i.length=0},push:function(t,e,n,o,a,l){const c=s(t,e,n,o,a,l);(!0===n.transparent?i:r).push(c)},unshift:function(t,e,n,o,a,l){const c=s(t,e,n,o,a,l);(!0===n.transparent?i:r).unshift(c)},finish:function(){for(let t=n,r=e.length;t<r;t++){const n=e[t];if(null===n.id)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.program=null,n.group=null}},sort:function(t,e){r.length>1&&r.sort(t||Dr),i.length>1&&i.sort(e||Nr)}}}function Fr(t){let e=new WeakMap;return{get:function(n,r){const i=e.get(n);let o;return void 0===i?(o=new jr(t),e.set(n,new WeakMap),e.get(n).set(r,o)):(o=i.get(r),void 0===o&&(o=new jr(t),i.set(r,o))),o},dispose:function(){e=new WeakMap}}}function Br(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new _,color:new Ut};break;case"SpotLight":n={position:new _,direction:new _,color:new Ut,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new _,color:new Ut,distance:0,decay:0};break;case"HemisphereLight":n={direction:new _,skyColor:new Ut,groundColor:new Ut};break;case"RectAreaLight":n={color:new Ut,position:new _,halfWidth:new _,halfHeight:new _}}return t[e.id]=n,n}}}let zr=0;function Ur(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function Hr(t,e){const n=new Br,r=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new u};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new u,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let t=0;t<9;t++)i.probe.push(new _);const o=new _,s=new Y,a=new Y;return{setup:function(o){let s=0,a=0,l=0;for(let t=0;t<9;t++)i.probe[t].set(0,0,0);let c=0,u=0,h=0,f=0,d=0,p=0,m=0,g=0;o.sort(Ur);for(let t=0,e=o.length;t<e;t++){const e=o[t],v=e.color,y=e.intensity,b=e.distance,_=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)s+=v.r*y,a+=v.g*y,l+=v.b*y;else if(e.isLightProbe)for(let t=0;t<9;t++)i.probe[t].addScaledVector(e.sh.coefficients[t],y);else if(e.isDirectionalLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity),e.castShadow){const t=e.shadow,n=r.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,i.directionalShadow[c]=n,i.directionalShadowMap[c]=_,i.directionalShadowMatrix[c]=e.shadow.matrix,p++}i.directional[c]=t,c++}else if(e.isSpotLight){const t=n.get(e);if(t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(v).multiplyScalar(y),t.distance=b,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,e.castShadow){const t=e.shadow,n=r.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,i.spotShadow[h]=n,i.spotShadowMap[h]=_,i.spotShadowMatrix[h]=e.shadow.matrix,g++}i.spot[h]=t,h++}else if(e.isRectAreaLight){const t=n.get(e);t.color.copy(v).multiplyScalar(y),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),i.rectArea[f]=t,f++}else if(e.isPointLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,n=r.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,n.shadowCameraNear=t.camera.near,n.shadowCameraFar=t.camera.far,i.pointShadow[u]=n,i.pointShadowMap[u]=_,i.pointShadowMatrix[u]=e.shadow.matrix,m++}i.point[u]=t,u++}else if(e.isHemisphereLight){const t=n.get(e);t.skyColor.copy(e.color).multiplyScalar(y),t.groundColor.copy(e.groundColor).multiplyScalar(y),i.hemi[d]=t,d++}}f>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(i.rectAreaLTC1=$e.LTC_FLOAT_1,i.rectAreaLTC2=$e.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=$e.LTC_HALF_1,i.rectAreaLTC2=$e.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=s,i.ambient[1]=a,i.ambient[2]=l;const v=i.hash;v.directionalLength===c&&v.pointLength===u&&v.spotLength===h&&v.rectAreaLength===f&&v.hemiLength===d&&v.numDirectionalShadows===p&&v.numPointShadows===m&&v.numSpotShadows===g||(i.directional.length=c,i.spot.length=h,i.rectArea.length=f,i.point.length=u,i.hemi.length=d,i.directionalShadow.length=p,i.directionalShadowMap.length=p,i.pointShadow.length=m,i.pointShadowMap.length=m,i.spotShadow.length=g,i.spotShadowMap.length=g,i.directionalShadowMatrix.length=p,i.pointShadowMatrix.length=m,i.spotShadowMatrix.length=g,v.directionalLength=c,v.pointLength=u,v.spotLength=h,v.rectAreaLength=f,v.hemiLength=d,v.numDirectionalShadows=p,v.numPointShadows=m,v.numSpotShadows=g,i.version=zr++)},setupView:function(t,e){let n=0,r=0,l=0,c=0,u=0;const h=e.matrixWorldInverse;for(let e=0,f=t.length;e<f;e++){const f=t[e];if(f.isDirectionalLight){const t=i.directional[n];t.direction.setFromMatrixPosition(f.matrixWorld),o.setFromMatrixPosition(f.target.matrixWorld),t.direction.sub(o),t.direction.transformDirection(h),n++}else if(f.isSpotLight){const t=i.spot[l];t.position.setFromMatrixPosition(f.matrixWorld),t.position.applyMatrix4(h),t.direction.setFromMatrixPosition(f.matrixWorld),o.setFromMatrixPosition(f.target.matrixWorld),t.direction.sub(o),t.direction.transformDirection(h),l++}else if(f.isRectAreaLight){const t=i.rectArea[c];t.position.setFromMatrixPosition(f.matrixWorld),t.position.applyMatrix4(h),a.identity(),s.copy(f.matrixWorld),s.premultiply(h),a.extractRotation(s),t.halfWidth.set(.5*f.width,0,0),t.halfHeight.set(0,.5*f.height,0),t.halfWidth.applyMatrix4(a),t.halfHeight.applyMatrix4(a),c++}else if(f.isPointLight){const t=i.point[r];t.position.setFromMatrixPosition(f.matrixWorld),t.position.applyMatrix4(h),r++}else if(f.isHemisphereLight){const t=i.hemi[u];t.direction.setFromMatrixPosition(f.matrixWorld),t.direction.transformDirection(h),t.direction.normalize(),u++}}},state:i}}function Gr(t,e){const n=new Hr(t,e),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(){n.setup(r)},setupLightsView:function(t){n.setupView(r,t)},pushLight:function(t){r.push(t)},pushShadow:function(t){i.push(t)}}}function Wr(t,e){let n=new WeakMap;return{get:function(r,i=0){let o;return!1===n.has(r)?(o=new Gr(t,e),n.set(r,[]),n.get(r).push(o)):i>=n.get(r).length?(o=new Gr(t,e),n.get(r).push(o)):o=n.get(r)[i],o},dispose:function(){n=new WeakMap}}}function Vr(t){Wt.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function qr(t){Wt.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new _,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}Vr.prototype=Object.create(Wt.prototype),Vr.prototype.constructor=Vr,Vr.prototype.isMeshDepthMaterial=!0,Vr.prototype.copy=function(t){return Wt.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},qr.prototype=Object.create(Wt.prototype),qr.prototype.constructor=qr,qr.prototype.isMeshDistanceMaterial=!0,qr.prototype.copy=function(t){return Wt.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};function Xr(t,e,n){let r=new Ye;const i=new u,o=new u,s=new v,a=[],l=[],c={},h={0:1,1:0,2:2},f=new Be({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new u},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),d=f.clone();d.defines.HORIZONTAL_PASS=1;const p=new me;p.setAttribute("position",new Yt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new ke(p,f),g=this;function b(n,r){const i=e.update(m);f.uniforms.shadow_pass.value=n.map.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(r,null,i,f,m,null),d.uniforms.shadow_pass.value=n.mapPass.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(r,null,i,d,m,null)}function _(t,e,n){const r=t<<0|e<<1|n<<2;let i=a[r];return void 0===i&&(i=new Vr({depthPacking:3201,morphTargets:t,skinning:e}),a[r]=i),i}function x(t,e,n){const r=t<<0|e<<1|n<<2;let i=l[r];return void 0===i&&(i=new qr({morphTargets:t,skinning:e}),l[r]=i),i}function w(e,n,r,i,o,s,a){let l=null,u=_,f=e.customDepthMaterial;if(!0===i.isPointLight&&(u=x,f=e.customDistanceMaterial),void 0===f){let t=!1;!0===r.morphTargets&&(t=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0);let i=!1;!0===e.isSkinnedMesh&&(!0===r.skinning?i=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e));l=u(t,i,!0===e.isInstancedMesh)}else l=f;if(t.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){const t=l.uuid,e=r.uuid;let n=c[t];void 0===n&&(n={},c[t]=n);let i=n[e];void 0===i&&(i=l.clone(),n[e]=i),l=i}return l.visible=r.visible,l.wireframe=r.wireframe,l.side=3===a?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:h[r.side],l.clipShadows=r.clipShadows,l.clippingPlanes=r.clippingPlanes,l.clipIntersection=r.clipIntersection,l.wireframeLinewidth=r.wireframeLinewidth,l.linewidth=r.linewidth,!0===i.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(i.matrixWorld),l.nearDistance=o,l.farDistance=s),l}function M(n,i,o,s,a){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===a)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);const r=e.update(n),i=n.material;if(Array.isArray(i)){const e=r.groups;for(let l=0,c=e.length;l<c;l++){const c=e[l],u=i[c.materialIndex];if(u&&u.visible){const e=w(n,r,u,s,o.near,o.far,a);t.renderBufferDirect(o,null,r,e,n,c)}}}else if(i.visible){const e=w(n,r,i,s,o.near,o.far,a);t.renderBufferDirect(o,null,r,e,n,null)}}const l=n.children;for(let t=0,e=l.length;t<e;t++)M(l[t],i,o,s,a)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(e,a,l){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===e.length)return;const c=t.getRenderTarget(),u=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),f=t.state;f.setBlending(0),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(let c=0,u=e.length;c<u;c++){const u=e[c],h=u.shadow;if(void 0===h){console.warn("THREE.WebGLShadowMap:",u,"has no shadow.");continue}if(!1===h.autoUpdate&&!1===h.needsUpdate)continue;i.copy(h.mapSize);const d=h.getFrameExtents();if(i.multiply(d),o.copy(h.mapSize),(i.x>n||i.y>n)&&(i.x>n&&(o.x=Math.floor(n/d.x),i.x=o.x*d.x,h.mapSize.x=o.x),i.y>n&&(o.y=Math.floor(n/d.y),i.y=o.y*d.y,h.mapSize.y=o.y)),null===h.map&&!h.isPointLightShadow&&3===this.type){const t={minFilter:1006,magFilter:1006,format:1023};h.map=new y(i.x,i.y,t),h.map.texture.name=u.name+".shadowMap",h.mapPass=new y(i.x,i.y,t),h.camera.updateProjectionMatrix()}if(null===h.map){const t={minFilter:1003,magFilter:1003,format:1023};h.map=new y(i.x,i.y,t),h.map.texture.name=u.name+".shadowMap",h.camera.updateProjectionMatrix()}t.setRenderTarget(h.map),t.clear();const p=h.getViewportCount();for(let t=0;t<p;t++){const e=h.getViewport(t);s.set(o.x*e.x,o.y*e.y,o.x*e.z,o.y*e.w),f.viewport(s),h.updateMatrices(u,t),r=h.getFrustum(),M(a,l,h.camera,u,this.type)}h.isPointLightShadow||3!==this.type||b(h,l),h.needsUpdate=!1}g.needsUpdate=!1,t.setRenderTarget(c,u,h)}}function Yr(t,e,n){const r=n.isWebGL2;const i=new function(){let e=!1;const n=new v;let r=null;const i=new v(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,o,s,a){!0===a&&(e*=s,r*=s,o*=s),n.set(e,r,o,s),!1===i.equals(n)&&(t.clearColor(e,r,o,s),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},o=new function(){let e=!1,n=null,r=null,i=null;return{setTest:function(t){t?I(2929):D(2929)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},s=new function(){let e=!1,n=null,r=null,i=null,o=null,s=null,a=null,l=null,c=null;return{setTest:function(t){e||(t?I(2960):D(2960))},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,s){r===e&&i===n&&o===s||(t.stencilFunc(e,n,s),r=e,i=n,o=s)},setOp:function(e,n,r){s===e&&a===n&&l===r||(t.stencilOp(e,n,r),s=e,a=n,l=r)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,r=null,i=null,o=null,s=null,a=null,l=null,c=null}}};let a={},l=null,c=null,u=null,h=null,f=null,d=null,p=null,m=null,g=null,y=!1,b=null,_=null,x=null,w=null,M=null;const S=t.getParameter(35661);let E=!1,T=0;const C=t.getParameter(7938);-1!==C.indexOf("WebGL")?(T=parseFloat(/^WebGL (\d)/.exec(C)[1]),E=T>=1):-1!==C.indexOf("OpenGL ES")&&(T=parseFloat(/^OpenGL ES (\d)/.exec(C)[1]),E=T>=2);let A=null,P={};const L=new v,R=new v;function O(e,n,r){const i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(let e=0;e<r;e++)t.texImage2D(n+e,0,6408,1,1,0,6408,5121,i);return o}const k={};function I(e){!0!==a[e]&&(t.enable(e),a[e]=!0)}function D(e){!1!==a[e]&&(t.disable(e),a[e]=!1)}k[3553]=O(3553,3553,1),k[34067]=O(34067,34069,6),i.setClear(0,0,0,1),o.setClear(1),s.setClear(0),I(2929),o.setFunc(3),B(!1),z(1),I(2884),F(0);const N={100:32774,101:32778,102:32779};if(r)N[103]=32775,N[104]=32776;else{const t=e.get("EXT_blend_minmax");null!==t&&(N[103]=t.MIN_EXT,N[104]=t.MAX_EXT)}const j={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function F(e,n,r,i,o,s,a,l){if(0!==e){if(c||(I(3042),c=!0),5===e)o=o||n,s=s||r,a=a||i,n===h&&o===p||(t.blendEquationSeparate(N[n],N[o]),h=n,p=o),r===f&&i===d&&s===m&&a===g||(t.blendFuncSeparate(j[r],j[i],j[s],j[a]),f=r,d=i,m=s,g=a),u=e,y=null;else if(e!==u||l!==y){if(100===h&&100===p||(t.blendEquation(32774),h=100,p=100),l)switch(e){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,0,769,771);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFunc(0,769);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}f=null,d=null,m=null,g=null,u=e,y=l}}else c&&(D(3042),c=!1)}function B(e){b!==e&&(e?t.frontFace(2304):t.frontFace(2305),b=e)}function z(e){0!==e?(I(2884),e!==_&&(1===e?t.cullFace(1029):2===e?t.cullFace(1028):t.cullFace(1032))):D(2884),_=e}function U(e,n,r){e?(I(32823),w===n&&M===r||(t.polygonOffset(n,r),w=n,M=r)):D(32823)}function H(e){void 0===e&&(e=33984+S-1),A!==e&&(t.activeTexture(e),A=e)}return{buffers:{color:i,depth:o,stencil:s},enable:I,disable:D,useProgram:function(e){return l!==e&&(t.useProgram(e),l=e,!0)},setBlending:F,setMaterial:function(t,e){2===t.side?D(2884):I(2884);let n=1===t.side;e&&(n=!n),B(n),1===t.blending&&!1===t.transparent?F(0):F(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),o.setFunc(t.depthFunc),o.setTest(t.depthTest),o.setMask(t.depthWrite),i.setMask(t.colorWrite);const r=t.stencilWrite;s.setTest(r),r&&(s.setMask(t.stencilWriteMask),s.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),s.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),U(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:B,setCullFace:z,setLineWidth:function(e){e!==x&&(E&&t.lineWidth(e),x=e)},setPolygonOffset:U,setScissorTest:function(t){t?I(3089):D(3089)},activeTexture:H,bindTexture:function(e,n){null===A&&H();let r=P[A];void 0===r&&(r={type:void 0,texture:void 0},P[A]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||k[e]),r.type=e,r.texture=n)},unbindTexture:function(){const e=P[A];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===L.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),L.copy(e))},viewport:function(e){!1===R.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),R.copy(e))},reset:function(){a={},A=null,P={},l=null,c=null,u=null,h=null,f=null,d=null,p=null,m=null,g=null,y=!1,b=null,_=null,x=null,w=null,M=null,i.reset(),o.reset(),s.reset()}}}function Zr(t,e,n,r,i,o,s){const a=i.isWebGL2,l=i.maxTextures,u=i.maxCubemapSize,h=i.maxTextureSize,f=i.maxSamples,d=new WeakMap;let p,m=!1;try{m="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function g(t,e){return m?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function v(t,e,n,r){let i=1;if((t.width>r||t.height>r)&&(i=r/Math.max(t.width,t.height)),i<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const r=e?c.floorPowerOfTwo:Math.floor,o=r(i*t.width),s=r(i*t.height);void 0===p&&(p=g(o,s));const a=n?g(o,s):p;a.width=o,a.height=s;return a.getContext("2d").drawImage(t,0,0,o,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+o+"x"+s+")."),a}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function y(t){return c.isPowerOfTwo(t.width)&&c.isPowerOfTwo(t.height)}function b(t,e){return t.generateMipmaps&&e&&1003!==t.minFilter&&1006!==t.minFilter}function _(e,n,i,o){t.generateMipmap(e);r.get(n).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function x(n,r,i){if(!1===a)return r;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let o=r;return 6403===r&&(5126===i&&(o=33326),5131===i&&(o=33325),5121===i&&(o=33321)),6407===r&&(5126===i&&(o=34837),5131===i&&(o=34843),5121===i&&(o=32849)),6408===r&&(5126===i&&(o=34836),5131===i&&(o=34842),5121===i&&(o=32856)),33325!==o&&33326!==o&&34842!==o&&34836!==o||e.get("EXT_color_buffer_float"),o}function w(t){return 1003===t||1004===t||1005===t?9728:9729}function M(e){const n=e.target;n.removeEventListener("dispose",M),function(e){const n=r.get(e);if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture),r.remove(e)}(n),n.isVideoTexture&&d.delete(n),s.memory.textures--}function S(e){const n=e.target;n.removeEventListener("dispose",S),function(e){const n=r.get(e),i=r.get(e.texture);if(!e)return;void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++)t.deleteFramebuffer(n.__webglFramebuffer[e]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[e]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&t.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer&&t.deleteRenderbuffer(n.__webglColorRenderbuffer),n.__webglDepthRenderbuffer&&t.deleteRenderbuffer(n.__webglDepthRenderbuffer);r.remove(e.texture),r.remove(e)}(n),s.memory.textures--}let E=0;function T(t,e){const i=r.get(t);if(t.isVideoTexture&&function(t){const e=s.render.frame;d.get(t)!==e&&(d.set(t,e),t.update())}(t),t.version>0&&i.__version!==t.version){const n=t.image;if(void 0===n)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==n.complete)return void O(i,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+e),n.bindTexture(3553,i.__webglTexture)}function C(e,i){const s=r.get(e);e.version>0&&s.__version!==e.version?function(e,r,i){if(6!==r.image.length)return;R(e,r),n.activeTexture(33984+i),n.bindTexture(34067,e.__webglTexture),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment);const s=r&&(r.isCompressedTexture||r.image[0].isCompressedTexture),l=r.image[0]&&r.image[0].isDataTexture,c=[];for(let t=0;t<6;t++)c[t]=s||l?l?r.image[t].image:r.image[t]:v(r.image[t],!1,!0,u);const h=c[0],f=y(h)||a,d=o.convert(r.format),p=o.convert(r.type),m=x(r.internalFormat,d,p);let g;if(L(34067,r,f),s){for(let t=0;t<6;t++){g=c[t].mipmaps;for(let e=0;e<g.length;e++){const i=g[e];1023!==r.format&&1022!==r.format?null!==d?n.compressedTexImage2D(34069+t,e,m,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+t,e,m,i.width,i.height,0,d,p,i.data)}}e.__maxMipLevel=g.length-1}else{g=r.mipmaps;for(let t=0;t<6;t++)if(l){n.texImage2D(34069+t,0,m,c[t].width,c[t].height,0,d,p,c[t].data);for(let e=0;e<g.length;e++){const r=g[e].image[t].image;n.texImage2D(34069+t,e+1,m,r.width,r.height,0,d,p,r.data)}}else{n.texImage2D(34069+t,0,m,d,p,c[t]);for(let e=0;e<g.length;e++){const r=g[e];n.texImage2D(34069+t,e+1,m,d,p,r.image[t])}}e.__maxMipLevel=g.length}b(r,f)&&_(34067,r,h.width,h.height);e.__version=r.version,r.onUpdate&&r.onUpdate(r)}(s,e,i):(n.activeTexture(33984+i),n.bindTexture(34067,s.__webglTexture))}const A={1e3:10497,1001:33071,1002:33648},P={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987};function L(n,o,s){s?(t.texParameteri(n,10242,A[o.wrapS]),t.texParameteri(n,10243,A[o.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,A[o.wrapR]),t.texParameteri(n,10240,P[o.magFilter]),t.texParameteri(n,10241,P[o.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),1001===o.wrapS&&1001===o.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,w(o.magFilter)),t.texParameteri(n,10241,w(o.minFilter)),1003!==o.minFilter&&1006!==o.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const l=e.get("EXT_texture_filter_anisotropic");if(l){if(1015===o.type&&null===e.get("OES_texture_float_linear"))return;if(1016===o.type&&null===(a||e.get("OES_texture_half_float_linear")))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(t.texParameterf(n,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function R(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",M),e.__webglTexture=t.createTexture(),s.memory.textures++)}function O(e,r,i){let s=3553;r.isDataTexture2DArray&&(s=35866),r.isDataTexture3D&&(s=32879),R(e,r),n.activeTexture(33984+i),n.bindTexture(s,e.__webglTexture),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment);const l=function(t){return!a&&(1001!==t.wrapS||1001!==t.wrapT||1003!==t.minFilter&&1006!==t.minFilter)}(r)&&!1===y(r.image),c=v(r.image,l,!1,h),u=y(c)||a,f=o.convert(r.format);let d,p=o.convert(r.type),m=x(r.internalFormat,f,p);L(s,r,u);const g=r.mipmaps;if(r.isDepthTexture)m=6402,a?m=1015===r.type?36012:1014===r.type?33190:1020===r.type?35056:33189:1015===r.type&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),1026===r.format&&6402===m&&1012!==r.type&&1014!==r.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=1012,p=o.convert(r.type)),1027===r.format&&6402===m&&(m=34041,1020!==r.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=1020,p=o.convert(r.type))),n.texImage2D(3553,0,m,c.width,c.height,0,f,p,null);else if(r.isDataTexture)if(g.length>0&&u){for(let t=0,e=g.length;t<e;t++)d=g[t],n.texImage2D(3553,t,m,d.width,d.height,0,f,p,d.data);r.generateMipmaps=!1,e.__maxMipLevel=g.length-1}else n.texImage2D(3553,0,m,c.width,c.height,0,f,p,c.data),e.__maxMipLevel=0;else if(r.isCompressedTexture){for(let t=0,e=g.length;t<e;t++)d=g[t],1023!==r.format&&1022!==r.format?null!==f?n.compressedTexImage2D(3553,t,m,d.width,d.height,0,d.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,t,m,d.width,d.height,0,f,p,d.data);e.__maxMipLevel=g.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,m,c.width,c.height,c.depth,0,f,p,c.data),e.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,m,c.width,c.height,c.depth,0,f,p,c.data),e.__maxMipLevel=0;else if(g.length>0&&u){for(let t=0,e=g.length;t<e;t++)d=g[t],n.texImage2D(3553,t,m,f,p,d);r.generateMipmaps=!1,e.__maxMipLevel=g.length-1}else n.texImage2D(3553,0,m,f,p,c),e.__maxMipLevel=0;b(r,u)&&_(s,r,c.width,c.height),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}function k(e,i,s,a){const l=o.convert(i.texture.format),c=o.convert(i.texture.type),u=x(i.texture.internalFormat,l,c);n.texImage2D(a,0,u,i.width,i.height,0,l,c,null),t.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,s,a,r.get(i.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function I(e,n,r){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){let i=33189;if(r){const e=n.depthTexture;e&&e.isDepthTexture&&(1015===e.type?i=36012:1014===e.type&&(i=33190));const r=N(n);t.renderbufferStorageMultisample(36161,r,i,n.width,n.height)}else t.renderbufferStorage(36161,i,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){if(r){const e=N(n);t.renderbufferStorageMultisample(36161,e,35056,n.width,n.height)}else t.renderbufferStorage(36161,34041,n.width,n.height);t.framebufferRenderbuffer(36160,33306,36161,e)}else{const e=o.convert(n.texture.format),i=o.convert(n.texture.type),s=x(n.texture.internalFormat,e,i);if(r){const e=N(n);t.renderbufferStorageMultisample(36161,e,s,n.width,n.height)}else t.renderbufferStorage(36161,s,n.width,n.height)}t.bindRenderbuffer(36161,null)}function D(e){const n=r.get(e),i=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),T(n.depthTexture,0);const i=r.get(n.depthTexture).__webglTexture;if(1026===n.depthTexture.format)t.framebufferTexture2D(36160,36096,3553,i,0);else{if(1027!==n.depthTexture.format)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,i,0)}}(n.__webglFramebuffer,e)}else if(i){n.__webglDepthbuffer=[];for(let r=0;r<6;r++)t.bindFramebuffer(36160,n.__webglFramebuffer[r]),n.__webglDepthbuffer[r]=t.createRenderbuffer(),I(n.__webglDepthbuffer[r],e,!1)}else t.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),I(n.__webglDepthbuffer,e,!1);t.bindFramebuffer(36160,null)}function N(t){return a&&t.isWebGLMultisampleRenderTarget?Math.min(f,t.samples):0}let j=!1,F=!1;this.allocateTextureUnit=function(){const t=E;return t>=l&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+l),E+=1,t},this.resetTextureUnits=function(){E=0},this.setTexture2D=T,this.setTexture2DArray=function(t,e){const i=r.get(t);t.version>0&&i.__version!==t.version?O(i,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(t,e){const i=r.get(t);t.version>0&&i.__version!==t.version?O(i,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=C,this.setupRenderTarget=function(e){const i=r.get(e),l=r.get(e.texture);e.addEventListener("dispose",S),l.__webglTexture=t.createTexture(),s.memory.textures++;const c=!0===e.isWebGLCubeRenderTarget,u=!0===e.isWebGLMultisampleRenderTarget,h=y(e)||a;if(!a||1022!==e.texture.format||1015!==e.texture.type&&1016!==e.texture.type||(e.texture.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),c){i.__webglFramebuffer=[];for(let e=0;e<6;e++)i.__webglFramebuffer[e]=t.createFramebuffer()}else if(i.__webglFramebuffer=t.createFramebuffer(),u)if(a){i.__webglMultisampledFramebuffer=t.createFramebuffer(),i.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,i.__webglColorRenderbuffer);const n=o.convert(e.texture.format),r=o.convert(e.texture.type),s=x(e.texture.internalFormat,n,r),a=N(e);t.renderbufferStorageMultisample(36161,a,s,e.width,e.height),t.bindFramebuffer(36160,i.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,i.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(i.__webglDepthRenderbuffer=t.createRenderbuffer(),I(i.__webglDepthRenderbuffer,e,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(c){n.bindTexture(34067,l.__webglTexture),L(34067,e.texture,h);for(let t=0;t<6;t++)k(i.__webglFramebuffer[t],e,36064,34069+t);b(e.texture,h)&&_(34067,e.texture,e.width,e.height),n.bindTexture(34067,null)}else n.bindTexture(3553,l.__webglTexture),L(3553,e.texture,h),k(i.__webglFramebuffer,e,36064,3553),b(e.texture,h)&&_(3553,e.texture,e.width,e.height),n.bindTexture(3553,null);e.depthBuffer&&D(e)},this.updateRenderTargetMipmap=function(t){const e=t.texture;if(b(e,y(t)||a)){const i=t.isWebGLCubeRenderTarget?34067:3553,o=r.get(e).__webglTexture;n.bindTexture(i,o),_(i,e,t.width,t.height),n.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget)if(a){const n=r.get(e);t.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,n.__webglFramebuffer);const i=e.width,o=e.height;let s=16384;e.depthBuffer&&(s|=256),e.stencilBuffer&&(s|=1024),t.blitFramebuffer(0,0,i,o,0,0,i,o,s,9728),t.bindFramebuffer(36160,n.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===j&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),j=!0),t=t.texture),T(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===F&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),F=!0),t=t.texture),C(t,e)}}function Jr(t,e,n){const r=n.isWebGL2;return{convert:function(t){let n;if(1009===t)return 5121;if(1017===t)return 32819;if(1018===t)return 32820;if(1019===t)return 33635;if(1010===t)return 5120;if(1011===t)return 5122;if(1012===t)return 5123;if(1013===t)return 5124;if(1014===t)return 5125;if(1015===t)return 5126;if(1016===t)return r?5131:(n=e.get("OES_texture_half_float"),null!==n?n.HALF_FLOAT_OES:null);if(1021===t)return 6406;if(1022===t)return 6407;if(1023===t)return 6408;if(1024===t)return 6409;if(1025===t)return 6410;if(1026===t)return 6402;if(1027===t)return 34041;if(1028===t)return 6403;if(1029===t)return 36244;if(1030===t)return 33319;if(1031===t)return 33320;if(1032===t)return 36248;if(1033===t)return 36249;if(33776===t||33777===t||33778===t||33779===t){if(n=e.get("WEBGL_compressed_texture_s3tc"),null===n)return null;if(33776===t)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===t)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===t)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===t)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===t||35841===t||35842===t||35843===t){if(n=e.get("WEBGL_compressed_texture_pvrtc"),null===n)return null;if(35840===t)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===t)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===t)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===t)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===t)return n=e.get("WEBGL_compressed_texture_etc1"),null!==n?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===t||37496===t)&&(n=e.get("WEBGL_compressed_texture_etc"),null!==n)){if(37492===t)return n.COMPRESSED_RGB8_ETC2;if(37496===t)return n.COMPRESSED_RGBA8_ETC2_EAC}return 37808===t||37809===t||37810===t||37811===t||37812===t||37813===t||37814===t||37815===t||37816===t||37817===t||37818===t||37819===t||37820===t||37821===t||37840===t||37841===t||37842===t||37843===t||37844===t||37845===t||37846===t||37847===t||37848===t||37849===t||37850===t||37851===t||37852===t||37853===t?(n=e.get("WEBGL_compressed_texture_astc"),null!==n?t:null):36492===t?(n=e.get("EXT_texture_compression_bptc"),null!==n?t:null):1020===t?r?34042:(n=e.get("WEBGL_depth_texture"),null!==n?n.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}function Kr(t=[]){Ue.call(this),this.cameras=t}function Qr(){bt.call(this),this.type="Group"}function $r(){this._targetRay=null,this._grip=null,this._hand=null}function ti(t,e){const n=this;let r=null,i=1,o=null,s="local-floor",a=null;const l=[],c=new Map,u=new Ue;u.layers.enable(1),u.viewport=new v;const h=new Ue;h.layers.enable(2),h.viewport=new v;const f=[u,h],d=new Kr;d.layers.enable(1),d.layers.enable(2);let p=null,m=null;function g(t){const e=c.get(t.inputSource);e&&e.dispatchEvent({type:t.type,data:t.inputSource})}function y(){c.forEach((function(t,e){t.disconnect(e)})),c.clear(),p=null,m=null,t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),E.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function b(t){const e=r.inputSources;for(let t=0;t<l.length;t++)c.set(e[t],l[t]);for(let e=0;e<t.removed.length;e++){const n=t.removed[e],r=c.get(n);r&&(r.dispatchEvent({type:"disconnected",data:n}),c.delete(n))}for(let e=0;e<t.added.length;e++){const n=t.added[e],r=c.get(n);r&&r.dispatchEvent({type:"connected",data:n})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=l[t];return void 0===e&&(e=new $r,l[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=l[t];return void 0===e&&(e=new $r,l[t]=e),e.getGripSpace()},this.getHand=function(t){let e=l[t];return void 0===e&&(e=new $r,l[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){i=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){s=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getSession=function(){return r},this.setSession=async function(t){if(r=t,null!==r){r.addEventListener("select",g),r.addEventListener("selectstart",g),r.addEventListener("selectend",g),r.addEventListener("squeeze",g),r.addEventListener("squeezestart",g),r.addEventListener("squeezeend",g),r.addEventListener("end",y),r.addEventListener("inputsourceschange",b);const t=e.getContextAttributes();!0!==t.xrCompatible&&await e.makeXRCompatible();const a={antialias:t.antialias,alpha:t.alpha,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:i},l=new XRWebGLLayer(r,e,a);r.updateRenderState({baseLayer:l}),o=await r.requestReferenceSpace(s),E.setContext(r),E.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const x=new _,w=new _;function M(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.getCamera=function(t){d.near=h.near=u.near=t.near,d.far=h.far=u.far=t.far,p===d.near&&m===d.far||(r.updateRenderState({depthNear:d.near,depthFar:d.far}),p=d.near,m=d.far);const e=t.parent,n=d.cameras;M(d,e);for(let t=0;t<n.length;t++)M(n[t],e);t.matrixWorld.copy(d.matrixWorld),t.matrix.copy(d.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale);const i=t.children;for(let t=0,e=i.length;t<e;t++)i[t].updateMatrixWorld(!0);return 2===n.length?function(t,e,n){x.setFromMatrixPosition(e.matrixWorld),w.setFromMatrixPosition(n.matrixWorld);const r=x.distanceTo(w),i=e.projectionMatrix.elements,o=n.projectionMatrix.elements,s=i[14]/(i[10]-1),a=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(o[8]+1)/o[0],f=s*u,d=s*h,p=r/(-u+h),m=p*-u;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(p),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const g=s+p,v=a+p,y=f-m,b=d+(r-m),_=l*a/v*g,M=c*a/v*g;t.projectionMatrix.makePerspective(y,b,_,M,g,v)}(d,u,h):d.projectionMatrix.copy(u.projectionMatrix),d};let S=null;const E=new Ze;E.setAnimationLoop((function(e,n){if(a=n.getViewerPose(o),null!==a){const e=a.views,n=r.renderState.baseLayer;t.setFramebuffer(n.framebuffer);let i=!1;e.length!==d.cameras.length&&(d.cameras.length=0,i=!0);for(let t=0;t<e.length;t++){const r=e[t],o=n.getViewport(r),s=f[t];s.matrix.fromArray(r.transform.matrix),s.projectionMatrix.fromArray(r.projectionMatrix),s.viewport.set(o.x,o.y,o.width,o.height),0===t&&d.matrix.copy(s.matrix),!0===i&&d.cameras.push(s)}}const i=r.inputSources;for(let t=0;t<l.length;t++){const e=l[t],r=i[t];e.update(r,n,o)}S&&S(e,n)})),this.setAnimationLoop=function(t){S=t},this.dispose=function(){}}function ei(t){function e(e,n){e.opacity.value=n.opacity,n.color&&e.diffuse.value.copy(n.color),n.emissive&&e.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(e.map.value=n.map),n.alphaMap&&(e.alphaMap.value=n.alphaMap),n.specularMap&&(e.specularMap.value=n.specularMap);const r=t.get(n).envMap;if(r){e.envMap.value=r,e.flipEnvMap.value=r.isCubeTexture&&r._needsFlipEnvMap?-1:1,e.reflectivity.value=n.reflectivity,e.refractionRatio.value=n.refractionRatio;const i=t.get(r).__maxMipLevel;void 0!==i&&(e.maxMipLevel.value=i)}let i,o;n.lightMap&&(e.lightMap.value=n.lightMap,e.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(e.aoMap.value=n.aoMap,e.aoMapIntensity.value=n.aoMapIntensity),n.map?i=n.map:n.specularMap?i=n.specularMap:n.displacementMap?i=n.displacementMap:n.normalMap?i=n.normalMap:n.bumpMap?i=n.bumpMap:n.roughnessMap?i=n.roughnessMap:n.metalnessMap?i=n.metalnessMap:n.alphaMap?i=n.alphaMap:n.emissiveMap?i=n.emissiveMap:n.clearcoatMap?i=n.clearcoatMap:n.clearcoatNormalMap?i=n.clearcoatNormalMap:n.clearcoatRoughnessMap&&(i=n.clearcoatRoughnessMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix)),n.aoMap?o=n.aoMap:n.lightMap&&(o=n.lightMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),e.uv2Transform.value.copy(o.matrix))}function n(e,n){e.roughness.value=n.roughness,e.metalness.value=n.metalness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(e.emissiveMap.value=n.emissiveMap),n.bumpMap&&(e.bumpMap.value=n.bumpMap,e.bumpScale.value=n.bumpScale,1===n.side&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,e.normalScale.value.copy(n.normalScale),1===n.side&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias);t.get(n).envMap&&(e.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,r,i,o){r.isMeshBasicMaterial?e(t,r):r.isMeshLambertMaterial?(e(t,r),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(t,r)):r.isMeshToonMaterial?(e(t,r),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap);e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshPhongMaterial?(e(t,r),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshStandardMaterial?(e(t,r),r.isMeshPhysicalMaterial?function(t,e){n(t,e),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen);e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap);e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap);e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,1===e.side&&t.clearcoatNormalScale.value.negate());t.transmission.value=e.transmission,e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap)}(t,r):n(t,r)):r.isMeshMatcapMaterial?(e(t,r),function(t,e){e.matcap&&(t.matcap.value=e.matcap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshDepthMaterial?(e(t,r),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshDistanceMaterial?(e(t,r),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(t,r)):r.isMeshNormalMaterial?(e(t,r),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(t,r),r.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,r)):r.isPointsMaterial?function(t,e,n,r){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*r,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);let i;e.map?i=e.map:e.alphaMap&&(i=e.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix))}(t,r,i,o):r.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);let n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(t,r):r.isShadowMaterial?(t.color.value.copy(r.color),t.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function ni(t){const e=void 0!==(t=t||{}).canvas?t.canvas:function(){const t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return t.style.display="block",t}(),n=void 0!==t.context?t.context:null,r=void 0!==t.alpha&&t.alpha,i=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,s=void 0!==t.antialias&&t.antialias,a=void 0===t.premultipliedAlpha||t.premultipliedAlpha,l=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,h=void 0!==t.powerPreference?t.powerPreference:"default",f=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let d=null,p=null;const m=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const g=this;let y=!1,b=null,x=0,w=0,M=null,S=null,E=-1,T=null;const C=new v,A=new v;let P=null,L=e.width,R=e.height,O=1,k=null,I=null;const D=new v(0,0,L,R),N=new v(0,0,L,R);let j=!1;const F=new Ye;let B=!1,z=!1;const U=new Y,H=new _,G={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function W(){return null===M?O:1}let V,q,X,Z,J,K,Q,$,tt,et,nt,rt,it,ot,st,at,lt,ct,ut,ht,ft,dt=n;function pt(t,n){for(let r=0;r<t.length;r++){const i=t[r],o=e.getContext(i,n);if(null!==o)return o}return null}try{const t={alpha:r,depth:i,stencil:o,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:h,failIfMajorPerformanceCaveat:f};if(e.addEventListener("webglcontextlost",yt,!1),e.addEventListener("webglcontextrestored",bt,!1),null===dt){const e=["webgl2","webgl","experimental-webgl"];if(!0===g.isWebGL1Renderer&&e.shift(),dt=pt(e,t),null===dt)throw pt(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===dt.getShaderPrecisionFormat&&(dt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function mt(){V=new ln(dt),q=new on(dt,V,t),V.init(q),ht=new Jr(dt,V,q),X=new Yr(dt,V,q),X.scissor(A.copy(N).multiplyScalar(O).floor()),X.viewport(C.copy(D).multiplyScalar(O).floor()),Z=new hn(dt),J=new Ir,K=new Zr(dt,V,X,J,q,ht,Z),Q=new an(g),$=new Je(dt,q),ft=new nn(dt,V,$,q),tt=new cn(dt,$,Z,ft),et=new mn(dt,tt,$,Z),lt=new pn(dt),st=new sn(J),nt=new kr(g,Q,V,q,ft,st),rt=new ei(J),it=new Fr(J),ot=new Wr(V,q),at=new en(g,Q,X,et,a),ct=new rn(dt,V,Z,q),ut=new un(dt,V,Z,q),Z.programs=nt.programs,g.capabilities=q,g.extensions=V,g.properties=J,g.renderLists=it,g.state=X,g.info=Z}mt();const gt=new ti(g,dt);this.xr=gt;const vt=new Xr(g,et,q.maxTextureSize);function yt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),y=!0}function bt(){console.log("THREE.WebGLRenderer: Context Restored."),y=!1,mt()}function _t(t){const e=t.target;e.removeEventListener("dispose",_t),function(t){xt(t),J.remove(t)}(e)}function xt(t){const e=J.get(t).program;void 0!==e&&nt.releaseProgram(e)}this.shadowMap=vt,this.getContext=function(){return dt},this.getContextAttributes=function(){return dt.getContextAttributes()},this.forceContextLoss=function(){const t=V.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=V.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return O},this.setPixelRatio=function(t){void 0!==t&&(O=t,this.setSize(L,R,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new u),t.set(L,R)},this.setSize=function(t,n,r){gt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(L=t,R=n,e.width=Math.floor(t*O),e.height=Math.floor(n*O),!1!==r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new u),t.set(L*O,R*O).floor()},this.setDrawingBufferSize=function(t,n,r){L=t,R=n,O=r,e.width=Math.floor(t*r),e.height=Math.floor(n*r),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new v),t.copy(C)},this.getViewport=function(t){return t.copy(D)},this.setViewport=function(t,e,n,r){t.isVector4?D.set(t.x,t.y,t.z,t.w):D.set(t,e,n,r),X.viewport(C.copy(D).multiplyScalar(O).floor())},this.getScissor=function(t){return t.copy(N)},this.setScissor=function(t,e,n,r){t.isVector4?N.set(t.x,t.y,t.z,t.w):N.set(t,e,n,r),X.scissor(A.copy(N).multiplyScalar(O).floor())},this.getScissorTest=function(){return j},this.setScissorTest=function(t){X.setScissorTest(j=t)},this.setOpaqueSort=function(t){k=t},this.setTransparentSort=function(t){I=t},this.getClearColor=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),t=new Ut),t.copy(at.getClearColor())},this.setClearColor=function(){at.setClearColor.apply(at,arguments)},this.getClearAlpha=function(){return at.getClearAlpha()},this.setClearAlpha=function(){at.setClearAlpha.apply(at,arguments)},this.clear=function(t,e,n){let r=0;(void 0===t||t)&&(r|=16384),(void 0===e||e)&&(r|=256),(void 0===n||n)&&(r|=1024),dt.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",yt,!1),e.removeEventListener("webglcontextrestored",bt,!1),it.dispose(),ot.dispose(),J.dispose(),Q.dispose(),et.dispose(),ft.dispose(),gt.dispose(),Mt.stop()},this.renderBufferImmediate=function(t,e){ft.initAttributes();const n=J.get(t);t.hasPositions&&!n.position&&(n.position=dt.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=dt.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=dt.createBuffer()),t.hasColors&&!n.color&&(n.color=dt.createBuffer());const r=e.getAttributes();t.hasPositions&&(dt.bindBuffer(34962,n.position),dt.bufferData(34962,t.positionArray,35048),ft.enableAttribute(r.position),dt.vertexAttribPointer(r.position,3,5126,!1,0,0)),t.hasNormals&&(dt.bindBuffer(34962,n.normal),dt.bufferData(34962,t.normalArray,35048),ft.enableAttribute(r.normal),dt.vertexAttribPointer(r.normal,3,5126,!1,0,0)),t.hasUvs&&(dt.bindBuffer(34962,n.uv),dt.bufferData(34962,t.uvArray,35048),ft.enableAttribute(r.uv),dt.vertexAttribPointer(r.uv,2,5126,!1,0,0)),t.hasColors&&(dt.bindBuffer(34962,n.color),dt.bufferData(34962,t.colorArray,35048),ft.enableAttribute(r.color),dt.vertexAttribPointer(r.color,3,5126,!1,0,0)),ft.disableUnusedAttributes(),dt.drawArrays(4,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,r,i,o){null===e&&(e=G);const s=i.isMesh&&i.matrixWorld.determinant()<0,a=At(t,e,r,i);X.setMaterial(r,s);let l=n.index;const c=n.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;let u,h=1;!0===r.wireframe&&(l=tt.getWireframeAttribute(n),h=2),(r.morphTargets||r.morphNormals)&&lt.update(i,n,r,a),ft.setup(i,r,a,n,l);let f=ct;null!==l&&(u=$.get(l),f=ut,f.setIndex(u));const d=null!==l?l.count:c.count,p=n.drawRange.start*h,m=n.drawRange.count*h,g=null!==o?o.start*h:0,v=null!==o?o.count*h:1/0,y=Math.max(p,g),b=Math.min(d,p+m,g+v)-1,_=Math.max(0,b-y+1);if(0!==_){if(i.isMesh)!0===r.wireframe?(X.setLineWidth(r.wireframeLinewidth*W()),f.setMode(1)):f.setMode(4);else if(i.isLine){let t=r.linewidth;void 0===t&&(t=1),X.setLineWidth(t*W()),i.isLineSegments?f.setMode(1):i.isLineLoop?f.setMode(2):f.setMode(3)}else i.isPoints?f.setMode(0):i.isSprite&&f.setMode(4);if(i.isInstancedMesh)f.renderInstances(y,_,i.count);else if(n.isInstancedBufferGeometry){const t=Math.min(n.instanceCount,n._maxInstanceCount);f.renderInstances(y,_,t)}else f.render(y,_)}},this.compile=function(t,e){p=ot.get(t),p.init(),t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(p.pushLight(t),t.castShadow&&p.pushShadow(t))})),p.setupLights();const n=new WeakMap;t.traverse((function(e){const r=e.material;if(r)if(Array.isArray(r))for(let i=0;i<r.length;i++){const o=r[i];!1===n.has(o)&&(Ct(o,t,e),n.set(o))}else!1===n.has(r)&&(Ct(r,t,e),n.set(r))}))};let wt=null;const Mt=new Ze;function St(t,e,n,r){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)p.pushLight(t),t.castShadow&&p.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||F.intersectsSprite(t)){r&&H.setFromMatrixPosition(t.matrixWorld).applyMatrix4(U);const e=et.update(t),i=t.material;i.visible&&d.push(t,e,i,n,H.z,null)}}else if(t.isImmediateRenderObject)r&&H.setFromMatrixPosition(t.matrixWorld).applyMatrix4(U),d.push(t,null,t.material,n,H.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==Z.render.frame&&(t.skeleton.update(),t.skeleton.frame=Z.render.frame),!t.frustumCulled||F.intersectsObject(t))){r&&H.setFromMatrixPosition(t.matrixWorld).applyMatrix4(U);const e=et.update(t),i=t.material;if(Array.isArray(i)){const r=e.groups;for(let o=0,s=r.length;o<s;o++){const s=r[o],a=i[s.materialIndex];a&&a.visible&&d.push(t,e,a,n,H.z,s)}}else i.visible&&d.push(t,e,i,n,H.z,null)}const i=t.children;for(let t=0,o=i.length;t<o;t++)St(i[t],e,n,r)}function Et(t,e,n){const r=!0===e.isScene?e.overrideMaterial:null;for(let i=0,o=t.length;i<o;i++){const o=t[i],s=o.object,a=o.geometry,l=null===r?o.material:r,c=o.group;if(n.isArrayCamera){const t=n.cameras;for(let n=0,r=t.length;n<r;n++){const r=t[n];s.layers.test(r.layers)&&(X.viewport(C.copy(r.viewport)),p.setupLightsView(r),Tt(s,e,r,a,l,c))}}else Tt(s,e,n,a,l,c)}}function Tt(t,e,n,r,i,o){if(t.onBeforeRender(g,e,n,r,i,o),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){const r=At(n,e,i,t);X.setMaterial(i),ft.reset(),function(t,e){t.render((function(t){g.renderBufferImmediate(t,e)}))}(t,r)}else g.renderBufferDirect(n,e,r,i,t,o);t.onAfterRender(g,e,n,r,i,o)}function Ct(t,e,n){!0!==e.isScene&&(e=G);const r=J.get(t),i=p.state.lights,o=p.state.shadowsArray,s=i.state.version,a=nt.getParameters(t,i.state,o,e,n),l=nt.getProgramCacheKey(a);let c=r.program,u=!0;if(r.environment=t.isMeshStandardMaterial?e.environment:null,r.fog=e.fog,r.envMap=Q.get(t.envMap||r.environment),void 0===c)t.addEventListener("dispose",_t);else if(c.cacheKey!==l)xt(t);else if(r.lightsStateVersion!==s)u=!1;else{if(void 0!==a.shaderID)return;u=!1}u&&(a.uniforms=nt.getUniforms(t),t.onBeforeCompile(a,g),c=nt.acquireProgram(a,l),r.program=c,r.uniforms=a.uniforms,r.outputEncoding=a.outputEncoding);const h=r.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=st.numPlanes,r.numIntersection=st.numIntersection,h.clippingPlanes=st.uniform),r.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),r.lightsStateVersion=s,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotShadowMatrix.value=i.state.spotShadowMatrix,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix);const f=r.program.getUniforms(),d=fr.seqWithValue(f.seq,h);r.uniformsList=d}function At(t,e,n,r){!0!==e.isScene&&(e=G),K.resetTextureUnits();const i=e.fog,o=n.isMeshStandardMaterial?e.environment:null,s=null===M?g.outputEncoding:M.texture.encoding,a=Q.get(n.envMap||o),l=J.get(n),u=p.state.lights;if(!0===B&&(!0===z||t!==T)){const e=t===T&&n.id===E;st.setState(n,t,e)}n.version===l.__version?n.fog&&l.fog!==i||l.environment!==o||l.needsLights&&l.lightsStateVersion!==u.state.version?Ct(n,e,r):void 0===l.numClippingPlanes||l.numClippingPlanes===st.numPlanes&&l.numIntersection===st.numIntersection?(l.outputEncoding!==s||l.envMap!==a)&&Ct(n,e,r):Ct(n,e,r):(Ct(n,e,r),l.__version=n.version);let h=!1,f=!1,d=!1;const m=l.program,v=m.getUniforms(),y=l.uniforms;if(X.useProgram(m.program)&&(h=!0,f=!0,d=!0),n.id!==E&&(E=n.id,f=!0),h||T!==t){if(v.setValue(dt,"projectionMatrix",t.projectionMatrix),q.logarithmicDepthBuffer&&v.setValue(dt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),T!==t&&(T=t,f=!0,d=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){const e=v.map.cameraPosition;void 0!==e&&e.setValue(dt,H.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&v.setValue(dt,"isOrthographic",!0===t.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||n.skinning)&&v.setValue(dt,"viewMatrix",t.matrixWorldInverse)}if(n.skinning){v.setOptional(dt,r,"bindMatrix"),v.setOptional(dt,r,"bindMatrixInverse");const t=r.skeleton;if(t){const e=t.bones;if(q.floatVertexTextures){if(null===t.boneTexture){let n=Math.sqrt(4*e.length);n=c.ceilPowerOfTwo(n),n=Math.max(n,4);const r=new Float32Array(n*n*4);r.set(t.boneMatrices);const i=new Ve(r,n,n,1023,1015);t.boneMatrices=r,t.boneTexture=i,t.boneTextureSize=n}v.setValue(dt,"boneTexture",t.boneTexture,K),v.setValue(dt,"boneTextureSize",t.boneTextureSize)}else v.setOptional(dt,t,"boneMatrices")}}var b,_;return(f||l.receiveShadow!==r.receiveShadow)&&(l.receiveShadow=r.receiveShadow,v.setValue(dt,"receiveShadow",r.receiveShadow)),f&&(v.setValue(dt,"toneMappingExposure",g.toneMappingExposure),l.needsLights&&(_=d,(b=y).ambientLightColor.needsUpdate=_,b.lightProbe.needsUpdate=_,b.directionalLights.needsUpdate=_,b.directionalLightShadows.needsUpdate=_,b.pointLights.needsUpdate=_,b.pointLightShadows.needsUpdate=_,b.spotLights.needsUpdate=_,b.spotLightShadows.needsUpdate=_,b.rectAreaLights.needsUpdate=_,b.hemisphereLights.needsUpdate=_),i&&n.fog&&rt.refreshFogUniforms(y,i),rt.refreshMaterialUniforms(y,n,O,R),fr.upload(dt,l.uniformsList,y,K)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(fr.upload(dt,l.uniformsList,y,K),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&v.setValue(dt,"center",r.center),v.setValue(dt,"modelViewMatrix",r.modelViewMatrix),v.setValue(dt,"normalMatrix",r.normalMatrix),v.setValue(dt,"modelMatrix",r.matrixWorld),m}Mt.setAnimationLoop((function(t){gt.isPresenting||wt&&wt(t)})),"undefined"!=typeof window&&Mt.setContext(window),this.setAnimationLoop=function(t){wt=t,gt.setAnimationLoop(t),null===t?Mt.stop():Mt.start()},this.render=function(t,e){let n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===y)return;ft.resetDefaultState(),E=-1,T=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===gt.enabled&&!0===gt.isPresenting&&(e=gt.getCamera(e)),!0===t.isScene&&t.onBeforeRender(g,t,e,n||M),p=ot.get(t,m.length),p.init(),m.push(p),U.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),F.setFromProjectionMatrix(U),z=this.localClippingEnabled,B=st.init(this.clippingPlanes,z,e),d=it.get(t,e),d.init(),St(t,e,0,g.sortObjects),d.finish(),!0===g.sortObjects&&d.sort(k,I),!0===B&&st.beginShadows();const i=p.state.shadowsArray;vt.render(i,t,e),p.setupLights(),p.setupLightsView(e),!0===B&&st.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),at.render(d,t,e,r);const o=d.opaque,s=d.transparent;o.length>0&&Et(o,t,e),s.length>0&&Et(s,t,e),!0===t.isScene&&t.onAfterRender(g,t,e),null!==M&&(K.updateRenderTargetMipmap(M),K.updateMultisampleRenderTarget(M)),X.buffers.depth.setTest(!0),X.buffers.depth.setMask(!0),X.buffers.color.setMask(!0),X.setPolygonOffset(!1),m.pop(),p=m.length>0?m[m.length-1]:null,d=null},this.setFramebuffer=function(t){b!==t&&null===M&&dt.bindFramebuffer(36160,t),b=t},this.getActiveCubeFace=function(){return x},this.getActiveMipmapLevel=function(){return w},this.getRenderList=function(){return d},this.setRenderList=function(t){d=t},this.getRenderTarget=function(){return M},this.setRenderTarget=function(t,e=0,n=0){M=t,x=e,w=n,t&&void 0===J.get(t).__webglFramebuffer&&K.setupRenderTarget(t);let r=b,i=!1;if(t){const n=J.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=n[e],i=!0):r=t.isWebGLMultisampleRenderTarget?J.get(t).__webglMultisampledFramebuffer:n,C.copy(t.viewport),A.copy(t.scissor),P=t.scissorTest}else C.copy(D).multiplyScalar(O).floor(),A.copy(N).multiplyScalar(O).floor(),P=j;if(S!==r&&(dt.bindFramebuffer(36160,r),S=r),X.viewport(C),X.scissor(A),X.setScissorTest(P),i){const r=J.get(t.texture);dt.framebufferTexture2D(36160,36064,34069+e,r.__webglTexture,n)}},this.readRenderTargetPixels=function(t,e,n,r,i,o,s){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=J.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==s&&(a=a[s]),a){let s=!1;a!==S&&(dt.bindFramebuffer(36160,a),s=!0);try{const a=t.texture,l=a.format,c=a.type;if(1023!==l&&ht.convert(l)!==dt.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const u=1016===c&&(V.has("EXT_color_buffer_half_float")||q.isWebGL2&&V.has("EXT_color_buffer_float"));if(!(1009===c||ht.convert(c)===dt.getParameter(35738)||1015===c&&(q.isWebGL2||V.has("OES_texture_float")||V.has("WEBGL_color_buffer_float"))||u))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===dt.checkFramebufferStatus(36160)?e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&dt.readPixels(e,n,r,i,ht.convert(l),ht.convert(c),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&dt.bindFramebuffer(36160,S)}}},this.copyFramebufferToTexture=function(t,e,n=0){const r=Math.pow(2,-n),i=Math.floor(e.image.width*r),o=Math.floor(e.image.height*r),s=ht.convert(e.format);K.setTexture2D(e,0),dt.copyTexImage2D(3553,n,s,t.x,t.y,i,o,0),X.unbindTexture()},this.copyTextureToTexture=function(t,e,n,r=0){const i=e.image.width,o=e.image.height,s=ht.convert(n.format),a=ht.convert(n.type);K.setTexture2D(n,0),dt.pixelStorei(37440,n.flipY),dt.pixelStorei(37441,n.premultiplyAlpha),dt.pixelStorei(3317,n.unpackAlignment),e.isDataTexture?dt.texSubImage2D(3553,r,t.x,t.y,i,o,s,a,e.image.data):e.isCompressedTexture?dt.compressedTexSubImage2D(3553,r,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,s,e.mipmaps[0].data):dt.texSubImage2D(3553,r,t.x,t.y,s,a,e.image),0===r&&n.generateMipmaps&&dt.generateMipmap(3553),X.unbindTexture()},this.initTexture=function(t){K.setTexture2D(t,0),X.unbindTexture()},this.resetState=function(){X.reset(),ft.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function ri(t){ni.call(this,t)}Kr.prototype=Object.assign(Object.create(Ue.prototype),{constructor:Kr,isArrayCamera:!0}),Qr.prototype=Object.assign(Object.create(bt.prototype),{constructor:Qr,isGroup:!0}),Object.assign($r.prototype,{constructor:$r,getHandSpace:function(){return null===this._hand&&(this._hand=new Qr,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Qr,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Qr,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(t,e,n){let r=null,i=null,o=null;const s=this._targetRay,a=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState)if(l&&t.hand){o=!0;for(const r of t.hand.values()){const t=e.getJointPose(r,n);if(void 0===l.joints[r.jointName]){const t=new Qr;t.matrixAutoUpdate=!1,t.visible=!1,l.joints[r.jointName]=t,l.add(t)}const i=l.joints[r.jointName];null!==t&&(i.matrix.fromArray(t.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.jointRadius=t.radius),i.visible=null!==t}const r=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],s=r.position.distanceTo(i.position),a=.02,c=.005;l.inputState.pinching&&s>a+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&s<=a-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==s&&(r=e.getPose(t.targetRaySpace,n),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale))),null!==a&&t.gripSpace&&(i=e.getPose(t.gripSpace,n),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale)));return null!==s&&(s.visible=null!==r),null!==a&&(a.visible=null!==i),null!==l&&(l.visible=null!==o),this}}),Object.assign(ti.prototype,s.prototype),ri.prototype=Object.assign(Object.create(ni.prototype),{constructor:ri,isWebGL1Renderer:!0});class ii extends bt{constructor(){super(),Object.defineProperty(this,"isScene",{value:!0}),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}function oi(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=c.generateUUID()}Object.defineProperty(oi.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(oi.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(let r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e=0){return this.array.set(t,e),this},clone:function(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=c.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new oi(new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),this.stride);return e.setUsage(this.usage),e},onUpload:function(t){return this.onUploadCallback=t,this},toJSON:function(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=c.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const si=new _;function ai(t,e,n,r){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function li(t){Wt.call(this),this.type="SpriteMaterial",this.color=new Ut(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}let ci;Object.defineProperties(ai.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(t){this.data.needsUpdate=t}}}),Object.assign(ai.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(let e=0,n=this.data.count;e<n;e++)si.x=this.getX(e),si.y=this.getY(e),si.z=this.getZ(e),si.applyMatrix4(t),this.setXYZ(e,si.x,si.y,si.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this},clone:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return new Yt(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new ai(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),li.prototype=Object.create(Wt.prototype),li.prototype.constructor=li,li.prototype.isSpriteMaterial=!0,li.prototype.copy=function(t){return Wt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};const ui=new _,hi=new _,fi=new _,di=new u,pi=new u,mi=new Y,gi=new _,vi=new _,yi=new _,bi=new u,_i=new u,xi=new u;function wi(t){if(bt.call(this),this.type="Sprite",void 0===ci){ci=new me;const t=new oi(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);ci.setIndex([0,1,2,0,2,3]),ci.setAttribute("position",new ai(t,3,0,!1)),ci.setAttribute("uv",new ai(t,2,3,!1))}this.geometry=ci,this.material=void 0!==t?t:new li,this.center=new u(.5,.5)}function Mi(t,e,n,r,i,o){di.subVectors(t,n).addScalar(.5).multiply(r),void 0!==i?(pi.x=o*di.x-i*di.y,pi.y=i*di.x+o*di.y):pi.copy(di),t.copy(e),t.x+=pi.x,t.y+=pi.y,t.applyMatrix4(mi)}wi.prototype=Object.assign(Object.create(bt.prototype),{constructor:wi,isSprite:!0,raycast:function(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),hi.setFromMatrixScale(this.matrixWorld),mi.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),fi.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&hi.multiplyScalar(-fi.z);const n=this.material.rotation;let r,i;0!==n&&(i=Math.cos(n),r=Math.sin(n));const o=this.center;Mi(gi.set(-.5,-.5,0),fi,o,hi,r,i),Mi(vi.set(.5,-.5,0),fi,o,hi,r,i),Mi(yi.set(.5,.5,0),fi,o,hi,r,i),bi.set(0,0),_i.set(1,0),xi.set(1,1);let s=t.ray.intersectTriangle(gi,vi,yi,!1,ui);if(null===s&&(Mi(vi.set(-.5,.5,0),fi,o,hi,r,i),_i.set(0,1),s=t.ray.intersectTriangle(gi,yi,vi,!1,ui),null===s))return;const a=t.ray.origin.distanceTo(ui);a<t.near||a>t.far||e.push({distance:a,point:ui.clone(),uv:It.getUV(ui,gi,vi,yi,bi,_i,xi,new u),face:null,object:this})},copy:function(t){return bt.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}});const Si=new _,Ei=new _;function Ti(){bt.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}Ti.prototype=Object.assign(Object.create(bt.prototype),{constructor:Ti,isLOD:!0,copy:function(t){bt.prototype.copy.call(this,t,!1);const e=t.levels;for(let t=0,n=e.length;t<n;t++){const n=e[t];this.addLevel(n.object.clone(),n.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,e=0){e=Math.abs(e);const n=this.levels;let r;for(r=0;r<n.length&&!(e<n[r].distance);r++);return n.splice(r,0,{distance:e,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){const e=this.levels;if(e.length>0){let n,r;for(n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object}return null},raycast:function(t,e){if(this.levels.length>0){Si.setFromMatrixPosition(this.matrixWorld);const n=t.ray.origin.distanceTo(Si);this.getObjectForDistance(n).raycast(t,e)}},update:function(t){const e=this.levels;if(e.length>1){Si.setFromMatrixPosition(t.matrixWorld),Ei.setFromMatrixPosition(this.matrixWorld);const n=Si.distanceTo(Ei)/t.zoom;let r,i;for(e[0].object.visible=!0,r=1,i=e.length;r<i&&n>=e[r].distance;r++)e[r-1].object.visible=!1,e[r].object.visible=!0;for(this._currentLevel=r-1;r<i;r++)e[r].object.visible=!1}},toJSON:function(t){const e=bt.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];const n=this.levels;for(let t=0,r=n.length;t<r;t++){const r=n[t];e.object.levels.push({object:r.object.uuid,distance:r.distance})}return e}});const Ci=new _,Ai=new v,Pi=new v,Li=new _,Ri=new Y;function Oi(t,e){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),ke.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Y,this.bindMatrixInverse=new Y}function ki(){bt.call(this),this.type="Bone"}Oi.prototype=Object.assign(Object.create(ke.prototype),{constructor:Oi,isSkinnedMesh:!0,copy:function(t){return ke.prototype.copy.call(this,t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const t=new v,e=this.geometry.attributes.skinWeight;for(let n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);const r=1/t.manhattanLength();r!==1/0?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){ke.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(t,e){const n=this.skeleton,r=this.geometry;Ai.fromBufferAttribute(r.attributes.skinIndex,t),Pi.fromBufferAttribute(r.attributes.skinWeight,t),Ci.fromBufferAttribute(r.attributes.position,t).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let t=0;t<4;t++){const r=Pi.getComponent(t);if(0!==r){const i=Ai.getComponent(t);Ri.multiplyMatrices(n.bones[i].matrixWorld,n.boneInverses[i]),e.addScaledVector(Li.copy(Ci).applyMatrix4(Ri),r)}}return e.applyMatrix4(this.bindMatrixInverse)}}),ki.prototype=Object.assign(Object.create(bt.prototype),{constructor:ki,isBone:!0});const Ii=new Y,Di=new Y;function Ni(t=[],e=[]){this.uuid=c.generateUUID(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}Object.assign(Ni.prototype,{init:function(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new Y)}},calculateInverses:function(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const e=new Y;this.bones[t]&&e.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(e)}},pose:function(){for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&e.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&(e.parent&&e.parent.isBone?(e.matrix.copy(e.parent.matrixWorld).invert(),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}},update:function(){const t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let r=0,i=t.length;r<i;r++){const i=t[r]?t[r].matrixWorld:Di;Ii.multiplyMatrices(i,e[r]),Ii.toArray(n,16*r)}null!==r&&(r.needsUpdate=!0)},clone:function(){return new Ni(this.bones,this.boneInverses)},getBoneByName:function(t){for(let e=0,n=this.bones.length;e<n;e++){const n=this.bones[e];if(n.name===t)return n}},dispose:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)},fromJSON:function(t,e){this.uuid=t.uuid;for(let n=0,r=t.bones.length;n<r;n++){const r=t.bones[n];let i=e[r];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),i=new ki),this.bones.push(i),this.boneInverses.push((new Y).fromArray(t.boneInverses[n]))}return this.init(),this},toJSON:function(){const t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,n=this.boneInverses;for(let r=0,i=e.length;r<i;r++){const i=e[r];t.bones.push(i.uuid);const o=n[r];t.boneInverses.push(o.toArray())}return t}});const ji=new Y,Fi=new Y,Bi=[],zi=new ke;function Ui(t,e,n){ke.call(this,t,e),this.instanceMatrix=new Yt(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}function Hi(t){Wt.call(this),this.type="LineBasicMaterial",this.color=new Ut(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(t)}Ui.prototype=Object.assign(Object.create(ke.prototype),{constructor:Ui,isInstancedMesh:!0,copy:function(t){return ke.prototype.copy.call(this,t),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this},getColorAt:function(t,e){e.fromArray(this.instanceColor.array,3*t)},getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){const n=this.matrixWorld,r=this.count;if(zi.geometry=this.geometry,zi.material=this.material,void 0!==zi.material)for(let i=0;i<r;i++){this.getMatrixAt(i,ji),Fi.multiplyMatrices(n,ji),zi.matrixWorld=Fi,zi.raycast(t,Bi);for(let t=0,n=Bi.length;t<n;t++){const n=Bi[t];n.instanceId=i,n.object=this,e.push(n)}Bi.length=0}},setColorAt:function(t,e){null===this.instanceColor&&(this.instanceColor=new Yt(new Float32Array(3*this.count),3)),e.toArray(this.instanceColor.array,3*t)},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Hi.prototype=Object.create(Wt.prototype),Hi.prototype.constructor=Hi,Hi.prototype.isLineBasicMaterial=!0,Hi.prototype.copy=function(t){return Wt.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this};const Gi=new _,Wi=new _,Vi=new Y,qi=new X,Xi=new B;function Yi(t=new me,e=new Hi){bt.call(this),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}Yi.prototype=Object.assign(Object.create(bt.prototype),{constructor:Yi,isLine:!0,copy:function(t){return bt.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[0];for(let t=1,r=e.count;t<r;t++)Gi.fromBufferAttribute(e,t-1),Wi.fromBufferAttribute(e,t),n[t]=n[t-1],n[t]+=Gi.distanceTo(Wi);t.setAttribute("lineDistance",new re(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Xi.copy(n.boundingSphere),Xi.applyMatrix4(r),Xi.radius+=i,!1===t.ray.intersectsSphere(Xi))return;Vi.copy(r).invert(),qi.copy(t.ray).applyMatrix4(Vi);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,a=new _,l=new _,c=new _,u=new _,h=this.isLineSegments?2:1;if(n.isBufferGeometry){const r=n.index,i=n.attributes.position;if(null!==r){const n=r.array;for(let r=0,o=n.length-1;r<o;r+=h){const o=n[r],h=n[r+1];a.fromBufferAttribute(i,o),l.fromBufferAttribute(i,h);if(qi.distanceSqToSegment(a,l,u,c)>s)continue;u.applyMatrix4(this.matrixWorld);const f=t.ray.origin.distanceTo(u);f<t.near||f>t.far||e.push({distance:f,point:c.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}else for(let n=0,r=i.count-1;n<r;n+=h){a.fromBufferAttribute(i,n),l.fromBufferAttribute(i,n+1);if(qi.distanceSqToSegment(a,l,u,c)>s)continue;u.applyMatrix4(this.matrixWorld);const r=t.ray.origin.distanceTo(u);r<t.near||r>t.far||e.push({distance:r,point:c.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const Zi=new _,Ji=new _;function Ki(t,e){Yi.call(this,t,e),this.type="LineSegments"}function Qi(t,e){Yi.call(this,t,e),this.type="LineLoop"}function $i(t){Wt.call(this),this.type="PointsMaterial",this.color=new Ut(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}Ki.prototype=Object.assign(Object.create(Yi.prototype),{constructor:Ki,isLineSegments:!0,computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[];for(let t=0,r=e.count;t<r;t+=2)Zi.fromBufferAttribute(e,t),Ji.fromBufferAttribute(e,t+1),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+Zi.distanceTo(Ji);t.setAttribute("lineDistance",new re(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}),Qi.prototype=Object.assign(Object.create(Yi.prototype),{constructor:Qi,isLineLoop:!0}),$i.prototype=Object.create(Wt.prototype),$i.prototype.constructor=$i,$i.prototype.isPointsMaterial=!0,$i.prototype.copy=function(t){return Wt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};const to=new Y,eo=new X,no=new B,ro=new _;function io(t=new me,e=new $i){bt.call(this),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}function oo(t,e,n,r,i,o,s){const a=eo.distanceSqToPoint(t);if(a<n){const n=new _;eo.closestPointToPoint(t,n),n.applyMatrix4(r);const l=i.ray.origin.distanceTo(n);if(l<i.near||l>i.far)return;o.push({distance:l,distanceToRay:Math.sqrt(a),point:n,index:e,face:null,object:s})}}function so(t,e,n,r,i,o,s,a,l){m.call(this,t,e,n,r,i,o,s,a,l),this.format=void 0!==s?s:1022,this.minFilter=void 0!==o?o:1006,this.magFilter=void 0!==i?i:1006,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback((function e(){c.needsUpdate=!0,t.requestVideoFrameCallback(e)}))}function ao(t,e,n,r,i,o,s,a,l,c,u,h){m.call(this,null,o,s,a,l,c,r,i,u,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function lo(t,e,n,r,i,o,s,a,l){m.call(this,t,e,n,r,i,o,s,a,l),this.needsUpdate=!0}function co(t,e,n,r,i,o,s,a,l,c){if(1026!==(c=void 0!==c?c:1026)&&1027!==c)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&1026===c&&(n=1012),void 0===n&&1027===c&&(n=1020),m.call(this,null,r,i,o,s,a,c,n,l),this.image={width:t,height:e},this.magFilter=void 0!==s?s:1003,this.minFilter=void 0!==a?a:1003,this.flipY=!1,this.generateMipmaps=!1}io.prototype=Object.assign(Object.create(bt.prototype),{constructor:io,isPoints:!0,copy:function(t){return bt.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},raycast:function(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),no.copy(n.boundingSphere),no.applyMatrix4(r),no.radius+=i,!1===t.ray.intersectsSphere(no))return;to.copy(r).invert(),eo.copy(t.ray).applyMatrix4(to);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o;if(n.isBufferGeometry){const i=n.index,o=n.attributes.position;if(null!==i){const n=i.array;for(let i=0,a=n.length;i<a;i++){const a=n[i];ro.fromBufferAttribute(o,a),oo(ro,a,s,r,t,e,this)}}else for(let n=0,i=o.count;n<i;n++)ro.fromBufferAttribute(o,n),oo(ro,n,s,r,t,e,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),so.prototype=Object.assign(Object.create(m.prototype),{constructor:so,clone:function(){return new this.constructor(this.image).copy(this)},isVideoTexture:!0,update:function(){const t=this.image;!1==="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),ao.prototype=Object.create(m.prototype),ao.prototype.constructor=ao,ao.prototype.isCompressedTexture=!0,lo.prototype=Object.create(m.prototype),lo.prototype.constructor=lo,lo.prototype.isCanvasTexture=!0,co.prototype=Object.create(m.prototype),co.prototype.constructor=co,co.prototype.isDepthTexture=!0;new _,new _,new _,new It;const uo=function(t,e,n){n=n||2;const r=e&&e.length,i=r?e[0]*n:t.length;let o=ho(t,0,i,n,!0);const s=[];if(!o||o.next===o.prev)return s;let a,l,c,u,h,f,d;if(r&&(o=function(t,e,n,r){const i=[];let o,s,a,l,c;for(o=0,s=e.length;o<s;o++)a=e[o]*r,l=o<s-1?e[o+1]*r:t.length,c=ho(t,a,l,r,!1),c===c.next&&(c.steiner=!0),i.push(Mo(c));for(i.sort(bo),o=0;o<i.length;o++)_o(i[o],n),n=fo(n,n.next);return n}(t,e,o,n)),t.length>80*n){a=c=t[0],l=u=t[1];for(let e=n;e<i;e+=n)h=t[e],f=t[e+1],h<a&&(a=h),f<l&&(l=f),h>c&&(c=h),f>u&&(u=f);d=Math.max(c-a,u-l),d=0!==d?1/d:0}return po(o,s,n,a,l,d),s};function ho(t,e,n,r,i){let o,s;if(i===function(t,e,n,r){let i=0;for(let o=e,s=n-r;o<n;o+=r)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}(t,e,n,r)>0)for(o=e;o<n;o+=r)s=ko(o,t[o],t[o+1],s);else for(o=n-r;o>=e;o-=r)s=ko(o,t[o],t[o+1],s);return s&&Co(s,s.next)&&(Io(s),s=s.next),s}function fo(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!Co(r,r.next)&&0!==To(r.prev,r,r.next))r=r.next;else{if(Io(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function po(t,e,n,r,i,o,s){if(!t)return;!s&&o&&function(t,e,n,r){let i=t;do{null===i.z&&(i.z=wo(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){let e,n,r,i,o,s,a,l,c=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,r=n,a=0,e=0;e<c&&(a++,r=r.nextZ,r);e++);for(l=c;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(s>1)}(i)}(t,r,i,o);let a,l,c=t;for(;t.prev!==t.next;)if(a=t.prev,l=t.next,o?go(t,r,i,o):mo(t))e.push(a.i/n),e.push(t.i/n),e.push(l.i/n),Io(t),t=l.next,c=l.next;else if((t=l)===c){s?1===s?po(t=vo(fo(t),e,n),e,n,r,i,o,2):2===s&&yo(t,e,n,r,i,o):po(fo(t),e,n,r,i,o,1);break}}function mo(t){const e=t.prev,n=t,r=t.next;if(To(e,n,r)>=0)return!1;let i=t.next.next;for(;i!==t.prev;){if(So(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&To(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function go(t,e,n,r){const i=t.prev,o=t,s=t.next;if(To(i,o,s)>=0)return!1;const a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,l=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,c=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,u=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,h=wo(a,l,e,n,r),f=wo(c,u,e,n,r);let d=t.prevZ,p=t.nextZ;for(;d&&d.z>=h&&p&&p.z<=f;){if(d!==t.prev&&d!==t.next&&So(i.x,i.y,o.x,o.y,s.x,s.y,d.x,d.y)&&To(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,p!==t.prev&&p!==t.next&&So(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&To(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;d&&d.z>=h;){if(d!==t.prev&&d!==t.next&&So(i.x,i.y,o.x,o.y,s.x,s.y,d.x,d.y)&&To(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;p&&p.z<=f;){if(p!==t.prev&&p!==t.next&&So(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&To(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function vo(t,e,n){let r=t;do{const i=r.prev,o=r.next.next;!Co(i,o)&&Ao(i,r,r.next,o)&&Ro(i,o)&&Ro(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),Io(r),Io(r.next),r=t=o),r=r.next}while(r!==t);return fo(r)}function yo(t,e,n,r,i,o){let s=t;do{let t=s.next.next;for(;t!==s.prev;){if(s.i!==t.i&&Eo(s,t)){let a=Oo(s,t);return s=fo(s,s.next),a=fo(a,a.next),po(s,e,n,r,i,o),void po(a,e,n,r,i,o)}t=t.next}s=s.next}while(s!==t)}function bo(t,e){return t.x-e.x}function _o(t,e){if(e=function(t,e){let n=e;const r=t.x,i=t.y;let o,s=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const t=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>s){if(s=t,t===r){if(i===n.y)return n;if(i===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!o)return null;if(r===s)return o;const a=o,l=o.x,c=o.y;let u,h=1/0;n=o;do{r>=n.x&&n.x>=l&&r!==n.x&&So(i<c?r:s,i,l,c,i<c?s:r,i,n.x,n.y)&&(u=Math.abs(i-n.y)/(r-n.x),Ro(n,t)&&(u<h||u===h&&(n.x>o.x||n.x===o.x&&xo(o,n)))&&(o=n,h=u)),n=n.next}while(n!==a);return o}(t,e)){const n=Oo(e,t);fo(e,e.next),fo(n,n.next)}}function xo(t,e){return To(t.prev,t,e.prev)<0&&To(e.next,t,t.next)<0}function wo(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Mo(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function So(t,e,n,r,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function Eo(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Ao(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Ro(t,e)&&Ro(e,t)&&function(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(To(t.prev,t,e.prev)||To(t,e.prev,e))||Co(t,e)&&To(t.prev,t,t.next)>0&&To(e.prev,e,e.next)>0)}function To(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Co(t,e){return t.x===e.x&&t.y===e.y}function Ao(t,e,n,r){const i=Lo(To(t,e,n)),o=Lo(To(t,e,r)),s=Lo(To(n,r,t)),a=Lo(To(n,r,e));return i!==o&&s!==a||(!(0!==i||!Po(t,n,e))||(!(0!==o||!Po(t,r,e))||(!(0!==s||!Po(n,t,r))||!(0!==a||!Po(n,e,r)))))}function Po(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Lo(t){return t>0?1:t<0?-1:0}function Ro(t,e){return To(t.prev,t,t.next)<0?To(t,e,t.next)>=0&&To(t,t.prev,e)>=0:To(t,e,t.prev)<0||To(t,t.next,e)<0}function Oo(t,e){const n=new Do(t.i,t.x,t.y),r=new Do(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function ko(t,e,n,r){const i=new Do(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Io(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Do(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}const No={area:function(t){const e=t.length;let n=0;for(let r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},isClockWise:function(t){return No.area(t)<0},triangulateShape:function(t,e){const n=[],r=[],i=[];jo(t),Fo(n,t);let o=t.length;e.forEach(jo);for(let t=0;t<e.length;t++)r.push(o),o+=e[t].length,Fo(n,e[t]);const s=uo(n,r);for(let t=0;t<s.length;t+=3)i.push(s.slice(t,t+3));return i}};function jo(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Fo(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class Bo extends me{constructor(t,e){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,r=[],i=[];for(let e=0,n=t.length;e<n;e++){o(t[e])}function o(t){const o=[],s=void 0!==e.curveSegments?e.curveSegments:12,a=void 0!==e.steps?e.steps:1;let l=void 0!==e.depth?e.depth:100,c=void 0===e.bevelEnabled||e.bevelEnabled,h=void 0!==e.bevelThickness?e.bevelThickness:6,f=void 0!==e.bevelSize?e.bevelSize:h-2,d=void 0!==e.bevelOffset?e.bevelOffset:0,p=void 0!==e.bevelSegments?e.bevelSegments:3;const m=e.extrudePath,g=void 0!==e.UVGenerator?e.UVGenerator:zo;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=e.amount);let v,y,b,x,w,M=!1;m&&(v=m.getSpacedPoints(a),M=!0,c=!1,y=m.computeFrenetFrames(a,!1),b=new _,x=new _,w=new _),c||(p=0,h=0,f=0,d=0);const S=t.extractPoints(s);let E=S.shape;const T=S.holes;if(!No.isClockWise(E)){E=E.reverse();for(let t=0,e=T.length;t<e;t++){const e=T[t];No.isClockWise(e)&&(T[t]=e.reverse())}}const C=No.triangulateShape(E,T),A=E;for(let t=0,e=T.length;t<e;t++){const e=T[t];E=E.concat(e)}function P(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}const L=E.length,R=C.length;function O(t,e,n){let r,i,o;const s=t.x-e.x,a=t.y-e.y,l=n.x-t.x,c=n.y-t.y,h=s*s+a*a,f=s*c-a*l;if(Math.abs(f)>Number.EPSILON){const f=Math.sqrt(h),d=Math.sqrt(l*l+c*c),p=e.x-a/f,m=e.y+s/f,g=((n.x-c/d-p)*c-(n.y+l/d-m)*l)/(s*c-a*l);r=p+s*g-t.x,i=m+a*g-t.y;const v=r*r+i*i;if(v<=2)return new u(r,i);o=Math.sqrt(v/2)}else{let t=!1;s>Number.EPSILON?l>Number.EPSILON&&(t=!0):s<-Number.EPSILON?l<-Number.EPSILON&&(t=!0):Math.sign(a)===Math.sign(c)&&(t=!0),t?(r=-a,i=s,o=Math.sqrt(h)):(r=s,i=a,o=Math.sqrt(h/2))}return new u(r/o,i/o)}const k=[];for(let t=0,e=A.length,n=e-1,r=t+1;t<e;t++,n++,r++)n===e&&(n=0),r===e&&(r=0),k[t]=O(A[t],A[n],A[r]);const I=[];let D,N=k.concat();for(let t=0,e=T.length;t<e;t++){const e=T[t];D=[];for(let t=0,n=e.length,r=n-1,i=t+1;t<n;t++,r++,i++)r===n&&(r=0),i===n&&(i=0),D[t]=O(e[t],e[r],e[i]);I.push(D),N=N.concat(D)}for(let t=0;t<p;t++){const e=t/p,n=h*Math.cos(e*Math.PI/2),r=f*Math.sin(e*Math.PI/2)+d;for(let t=0,e=A.length;t<e;t++){const e=P(A[t],k[t],r);B(e.x,e.y,-n)}for(let t=0,e=T.length;t<e;t++){const e=T[t];D=I[t];for(let t=0,i=e.length;t<i;t++){const i=P(e[t],D[t],r);B(i.x,i.y,-n)}}}const j=f+d;for(let t=0;t<L;t++){const e=c?P(E[t],N[t],j):E[t];M?(x.copy(y.normals[0]).multiplyScalar(e.x),b.copy(y.binormals[0]).multiplyScalar(e.y),w.copy(v[0]).add(x).add(b),B(w.x,w.y,w.z)):B(e.x,e.y,0)}for(let t=1;t<=a;t++)for(let e=0;e<L;e++){const n=c?P(E[e],N[e],j):E[e];M?(x.copy(y.normals[t]).multiplyScalar(n.x),b.copy(y.binormals[t]).multiplyScalar(n.y),w.copy(v[t]).add(x).add(b),B(w.x,w.y,w.z)):B(n.x,n.y,l/a*t)}for(let t=p-1;t>=0;t--){const e=t/p,n=h*Math.cos(e*Math.PI/2),r=f*Math.sin(e*Math.PI/2)+d;for(let t=0,e=A.length;t<e;t++){const e=P(A[t],k[t],r);B(e.x,e.y,l+n)}for(let t=0,e=T.length;t<e;t++){const e=T[t];D=I[t];for(let t=0,i=e.length;t<i;t++){const i=P(e[t],D[t],r);M?B(i.x,i.y+v[a-1].y,v[a-1].x+n):B(i.x,i.y,l+n)}}}function F(t,e){let n=t.length;for(;--n>=0;){const r=n;let i=n-1;i<0&&(i=t.length-1);for(let t=0,n=a+2*p;t<n;t++){const n=L*t,o=L*(t+1);U(e+r+n,e+i+n,e+i+o,e+r+o)}}}function B(t,e,n){o.push(t),o.push(e),o.push(n)}function z(t,e,i){H(t),H(e),H(i);const o=r.length/3,s=g.generateTopUV(n,r,o-3,o-2,o-1);G(s[0]),G(s[1]),G(s[2])}function U(t,e,i,o){H(t),H(e),H(o),H(e),H(i),H(o);const s=r.length/3,a=g.generateSideWallUV(n,r,s-6,s-3,s-2,s-1);G(a[0]),G(a[1]),G(a[3]),G(a[1]),G(a[2]),G(a[3])}function H(t){r.push(o[3*t+0]),r.push(o[3*t+1]),r.push(o[3*t+2])}function G(t){i.push(t.x),i.push(t.y)}!function(){const t=r.length/3;if(c){let t=0,e=L*t;for(let t=0;t<R;t++){const n=C[t];z(n[2]+e,n[1]+e,n[0]+e)}t=a+2*p,e=L*t;for(let t=0;t<R;t++){const n=C[t];z(n[0]+e,n[1]+e,n[2]+e)}}else{for(let t=0;t<R;t++){const e=C[t];z(e[2],e[1],e[0])}for(let t=0;t<R;t++){const e=C[t];z(e[0]+L*a,e[1]+L*a,e[2]+L*a)}}n.addGroup(t,r.length/3-t,0)}(),function(){const t=r.length/3;let e=0;F(A,e),e+=A.length;for(let t=0,n=T.length;t<n;t++){const n=T[t];F(n,e),e+=n.length}n.addGroup(t,r.length/3-t,1)}()}this.setAttribute("position",new re(r,3)),this.setAttribute("uv",new re(i,2)),this.computeVertexNormals()}toJSON(){const t=me.prototype.toJSON.call(this);return function(t,e,n){if(n.shapes=[],Array.isArray(t))for(let e=0,r=t.length;e<r;e++){const r=t[e];n.shapes.push(r.uuid)}else n.shapes.push(t.uuid);void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,t)}}const zo={generateTopUV:function(t,e,n,r,i){const o=e[3*n],s=e[3*n+1],a=e[3*r],l=e[3*r+1],c=e[3*i],h=e[3*i+1];return[new u(o,s),new u(a,l),new u(c,h)]},generateSideWallUV:function(t,e,n,r,i,o){const s=e[3*n],a=e[3*n+1],l=e[3*n+2],c=e[3*r],h=e[3*r+1],f=e[3*r+2],d=e[3*i],p=e[3*i+1],m=e[3*i+2],g=e[3*o],v=e[3*o+1],y=e[3*o+2];return Math.abs(a-h)<.01?[new u(s,1-l),new u(c,1-f),new u(d,1-m),new u(g,1-y)]:[new u(a,1-l),new u(h,1-f),new u(p,1-m),new u(v,1-y)]}};function Uo(t,e,n){me.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n};const r=[],i=[],o=[],s=[],a=1e-5,l=new _,c=new _,u=new _,h=new _,f=new _;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const d=e+1;for(let r=0;r<=n;r++){const d=r/n;for(let n=0;n<=e;n++){const r=n/e;t(r,d,c),i.push(c.x,c.y,c.z),r-a>=0?(t(r-a,d,u),h.subVectors(c,u)):(t(r+a,d,u),h.subVectors(u,c)),d-a>=0?(t(r,d-a,u),f.subVectors(c,u)):(t(r,d+a,u),f.subVectors(u,c)),l.crossVectors(h,f).normalize(),o.push(l.x,l.y,l.z),s.push(r,d)}}for(let t=0;t<n;t++)for(let n=0;n<e;n++){const e=t*d+n,i=t*d+n+1,o=(t+1)*d+n+1,s=(t+1)*d+n;r.push(e,i,s),r.push(i,o,s)}this.setIndex(r),this.setAttribute("position",new re(i,3)),this.setAttribute("normal",new re(o,3)),this.setAttribute("uv",new re(s,2))}Uo.prototype=Object.create(me.prototype),Uo.prototype.constructor=Uo;class Ho extends me{constructor(t,e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],r=[],i=[],o=[];let s=0,a=0;if(!1===Array.isArray(t))l(t);else for(let e=0;e<t.length;e++)l(t[e]),this.addGroup(s,a,e),s+=a,a=0;function l(t){const s=r.length/3,l=t.extractPoints(e);let c=l.shape;const u=l.holes;!1===No.isClockWise(c)&&(c=c.reverse());for(let t=0,e=u.length;t<e;t++){const e=u[t];!0===No.isClockWise(e)&&(u[t]=e.reverse())}const h=No.triangulateShape(c,u);for(let t=0,e=u.length;t<e;t++){const e=u[t];c=c.concat(e)}for(let t=0,e=c.length;t<e;t++){const e=c[t];r.push(e.x,e.y,0),i.push(0,0,1),o.push(e.x,e.y)}for(let t=0,e=h.length;t<e;t++){const e=h[t],r=e[0]+s,i=e[1]+s,o=e[2]+s;n.push(r,i,o),a+=3}}this.setIndex(n),this.setAttribute("position",new re(r,3)),this.setAttribute("normal",new re(i,3)),this.setAttribute("uv",new re(o,2))}toJSON(){const t=me.prototype.toJSON.call(this);return function(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,r=t.length;n<r;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)}}class Go extends me{constructor(t=1,e=8,n=6,r=0,i=2*Math.PI,o=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:s},e=Math.max(3,Math.floor(e)),n=Math.max(2,Math.floor(n));const a=Math.min(o+s,Math.PI);let l=0;const c=[],u=new _,h=new _,f=[],d=[],p=[],m=[];for(let f=0;f<=n;f++){const g=[],v=f/n;let y=0;0==f&&0==o?y=.5/e:f==n&&a==Math.PI&&(y=-.5/e);for(let n=0;n<=e;n++){const a=n/e;u.x=-t*Math.cos(r+a*i)*Math.sin(o+v*s),u.y=t*Math.cos(o+v*s),u.z=t*Math.sin(r+a*i)*Math.sin(o+v*s),d.push(u.x,u.y,u.z),h.copy(u).normalize(),p.push(h.x,h.y,h.z),m.push(a+y,1-v),g.push(l++)}c.push(g)}for(let t=0;t<n;t++)for(let r=0;r<e;r++){const e=c[t][r+1],i=c[t][r],s=c[t+1][r],l=c[t+1][r+1];(0!==t||o>0)&&f.push(e,i,l),(t!==n-1||a<Math.PI)&&f.push(i,s,l)}this.setIndex(f),this.setAttribute("position",new re(d,3)),this.setAttribute("normal",new re(p,3)),this.setAttribute("uv",new re(m,2))}}class Wo extends me{constructor(t){if(super(),this.type="WireframeGeometry",!0===t.isGeometry)return void console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const e=[],n=[0,0],r={},i=new _;if(null!==t.index){const o=t.attributes.position,s=t.index;let a=t.groups;0===a.length&&(a=[{start:0,count:s.count,materialIndex:0}]);for(let t=0,e=a.length;t<e;++t){const e=a[t],i=e.start;for(let t=i,o=i+e.count;t<o;t+=3)for(let e=0;e<3;e++){const i=s.getX(t+e),o=s.getX(t+(e+1)%3);n[0]=Math.min(i,o),n[1]=Math.max(i,o);const a=n[0]+","+n[1];void 0===r[a]&&(r[a]={index1:n[0],index2:n[1]})}}for(const t in r){const n=r[t];i.fromBufferAttribute(o,n.index1),e.push(i.x,i.y,i.z),i.fromBufferAttribute(o,n.index2),e.push(i.x,i.y,i.z)}}else{const n=t.attributes.position;for(let t=0,r=n.count/3;t<r;t++)for(let r=0;r<3;r++){const o=3*t+r;i.fromBufferAttribute(n,o),e.push(i.x,i.y,i.z);const s=3*t+(r+1)%3;i.fromBufferAttribute(n,s),e.push(i.x,i.y,i.z)}}this.setAttribute("position",new re(e,3))}}function Vo(t){Wt.call(this),this.type="ShadowMaterial",this.color=new Ut(0),this.transparent=!0,this.setValues(t)}function qo(t){Be.call(this,t),this.type="RawShaderMaterial"}function Xo(t){Wt.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ut(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new u(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function Yo(t){Xo.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new u(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(t){this.reflectivity=c.clamp(2.5*(t-1)/(t+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(t)}function Zo(t){Wt.call(this),this.type="MeshPhongMaterial",this.color=new Ut(16777215),this.specular=new Ut(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new u(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Jo(t){Wt.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ut(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new u(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ko(t){Wt.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new u(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Qo(t){Wt.call(this),this.type="MeshLambertMaterial",this.color=new Ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function $o(t){Wt.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ut(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new u(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function ts(t){Hi.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}Vo.prototype=Object.create(Wt.prototype),Vo.prototype.constructor=Vo,Vo.prototype.isShadowMaterial=!0,Vo.prototype.copy=function(t){return Wt.prototype.copy.call(this,t),this.color.copy(t.color),this},qo.prototype=Object.create(Be.prototype),qo.prototype.constructor=qo,qo.prototype.isRawShaderMaterial=!0,Xo.prototype=Object.create(Wt.prototype),Xo.prototype.constructor=Xo,Xo.prototype.isMeshStandardMaterial=!0,Xo.prototype.copy=function(t){return Wt.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},Yo.prototype=Object.create(Xo.prototype),Yo.prototype.constructor=Yo,Yo.prototype.isMeshPhysicalMaterial=!0,Yo.prototype.copy=function(t){return Xo.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new Ut).copy(t.sheen):this.sheen=null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this},Zo.prototype=Object.create(Wt.prototype),Zo.prototype.constructor=Zo,Zo.prototype.isMeshPhongMaterial=!0,Zo.prototype.copy=function(t){return Wt.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Jo.prototype=Object.create(Wt.prototype),Jo.prototype.constructor=Jo,Jo.prototype.isMeshToonMaterial=!0,Jo.prototype.copy=function(t){return Wt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ko.prototype=Object.create(Wt.prototype),Ko.prototype.constructor=Ko,Ko.prototype.isMeshNormalMaterial=!0,Ko.prototype.copy=function(t){return Wt.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Qo.prototype=Object.create(Wt.prototype),Qo.prototype.constructor=Qo,Qo.prototype.isMeshLambertMaterial=!0,Qo.prototype.copy=function(t){return Wt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},$o.prototype=Object.create(Wt.prototype),$o.prototype.constructor=$o,$o.prototype.isMeshMatcapMaterial=!0,$o.prototype.copy=function(t){return Wt.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},ts.prototype=Object.create(Hi.prototype),ts.prototype.constructor=ts,ts.prototype.isLineDashedMaterial=!0,ts.prototype.copy=function(t){return Hi.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var es=Object.freeze({__proto__:null,ShadowMaterial:Vo,SpriteMaterial:li,RawShaderMaterial:qo,ShaderMaterial:Be,PointsMaterial:$i,MeshPhysicalMaterial:Yo,MeshStandardMaterial:Xo,MeshPhongMaterial:Zo,MeshToonMaterial:Jo,MeshNormalMaterial:Ko,MeshLambertMaterial:Qo,MeshDepthMaterial:Vr,MeshDistanceMaterial:qr,MeshBasicMaterial:Vt,MeshMatcapMaterial:$o,LineDashedMaterial:ts,LineBasicMaterial:Hi,Material:Wt});const ns={arraySlice:function(t,e,n){return ns.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const e=t.length,n=new Array(e);for(let t=0;t!==e;++t)n[t]=t;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){const r=t.length,i=new t.constructor(r);for(let o=0,s=0;s!==r;++o){const r=n[o]*e;for(let n=0;n!==e;++n)i[s++]=t[r+n]}return i},flattenJSON:function(t,e,n,r){let i=1,o=t[0];for(;void 0!==o&&void 0===o[r];)o=t[i++];if(void 0===o)return;let s=o[r];if(void 0!==s)if(Array.isArray(s))do{s=o[r],void 0!==s&&(e.push(o.time),n.push.apply(n,s)),o=t[i++]}while(void 0!==o);else if(void 0!==s.toArray)do{s=o[r],void 0!==s&&(e.push(o.time),s.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{s=o[r],void 0!==s&&(e.push(o.time),n.push(s)),o=t[i++]}while(void 0!==o)},subclip:function(t,e,n,r,i=30){const o=t.clone();o.name=e;const s=[];for(let t=0;t<o.tracks.length;++t){const e=o.tracks[t],a=e.getValueSize(),l=[],c=[];for(let t=0;t<e.times.length;++t){const o=e.times[t]*i;if(!(o<n||o>=r)){l.push(e.times[t]);for(let n=0;n<a;++n)c.push(e.values[t*a+n])}}0!==l.length&&(e.times=ns.convertArray(l,e.times.constructor),e.values=ns.convertArray(c,e.values.constructor),s.push(e))}o.tracks=s;let a=1/0;for(let t=0;t<o.tracks.length;++t)a>o.tracks[t].times[0]&&(a=o.tracks[t].times[0]);for(let t=0;t<o.tracks.length;++t)o.tracks[t].shift(-1*a);return o.resetDuration(),o},makeClipAdditive:function(t,e=0,n=t,r=30){r<=0&&(r=30);const i=n.tracks.length,o=e/r;for(let e=0;e<i;++e){const r=n.tracks[e],i=r.ValueTypeName;if("bool"===i||"string"===i)continue;const s=t.tracks.find((function(t){return t.name===r.name&&t.ValueTypeName===i}));if(void 0===s)continue;let a=0;const l=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=l/3);let c=0;const u=s.getValueSize();s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=r.times.length-1;let f;if(o<=r.times[0]){const t=a,e=l-a;f=ns.arraySlice(r.values,t,e)}else if(o>=r.times[h]){const t=h*l+a,e=t+l-a;f=ns.arraySlice(r.values,t,e)}else{const t=r.createInterpolant(),e=a,n=l-a;t.evaluate(o),f=ns.arraySlice(t.resultBuffer,e,n)}if("quaternion"===i){(new b).fromArray(f).normalize().conjugate().toArray(f)}const d=s.times.length;for(let t=0;t<d;++t){const e=t*u+c;if("quaternion"===i)b.multiplyQuaternionsFlat(s.values,e,f,0,s.values,e);else{const t=u-2*c;for(let n=0;n<t;++n)s.values[e+n]-=f[n]}}}return t.blendMode=2501,t}};function rs(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function is(t,e,n,r){rs.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function os(t,e,n,r){rs.call(this,t,e,n,r)}function ss(t,e,n,r){rs.call(this,t,e,n,r)}function as(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=ns.convertArray(e,this.TimeBufferType),this.values=ns.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function ls(t,e,n){as.call(this,t,e,n)}function cs(t,e,n,r){as.call(this,t,e,n,r)}function us(t,e,n,r){as.call(this,t,e,n,r)}function hs(t,e,n,r){rs.call(this,t,e,n,r)}function fs(t,e,n,r){as.call(this,t,e,n,r)}function ds(t,e,n,r){as.call(this,t,e,n,r)}function ps(t,e,n,r){as.call(this,t,e,n,r)}function ms(t,e=-1,n,r=2500){this.name=t,this.tracks=n,this.duration=e,this.blendMode=r,this.uuid=c.generateUUID(),this.duration<0&&this.resetDuration()}function gs(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return us;case"vector":case"vector2":case"vector3":case"vector4":return ps;case"color":return cs;case"quaternion":return fs;case"bool":case"boolean":return ls;case"string":return ds}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const e=[],n=[];ns.flattenJSON(t.keys,e,n,"value"),t.times=e,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}Object.assign(rs.prototype,{evaluate:function(t){const e=this.parameterPositions;let n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{let o;n:{r:if(!(t<r)){for(let o=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===o)break;if(i=r,r=e[++n],t<r)break e}o=e.length;break n}if(t>=i)break t;{const s=e[1];t<s&&(n=2,i=s);for(let o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===o)break;if(r=i,i=e[--n-1],t>=i)break e}o=n,n=0}}for(;n<o;){const r=n+o>>>1;t<e[r]?o=r:n=r+1}if(r=e[n],i=e[n-1],void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r;for(let t=0;t!==r;++t)e[t]=n[i+t];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(rs.prototype,{beforeStart_:rs.prototype.copySampleValue_,afterEnd_:rs.prototype.copySampleValue_}),is.prototype=Object.assign(Object.create(rs.prototype),{constructor:is,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,n){const r=this.parameterPositions;let i=t-2,o=t+1,s=r[i],a=r[o];if(void 0===s)switch(this.getSettings_().endingStart){case 2401:i=t,s=2*e-n;break;case 2402:i=r.length-2,s=e+r[i]-r[i+1];break;default:i=t,s=n}if(void 0===a)switch(this.getSettings_().endingEnd){case 2401:o=t,a=2*n-e;break;case 2402:o=1,a=n+r[1]-r[0];break;default:o=t-1,a=e}const l=.5*(n-e),c=this.valueSize;this._weightPrev=l/(e-s),this._weightNext=l/(a-n),this._offsetPrev=i*c,this._offsetNext=o*c},interpolate_:function(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=t*s,l=a-s,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,f=this._weightNext,d=(n-e)/(r-e),p=d*d,m=p*d,g=-h*m+2*h*p-h*d,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*d+1,y=(-1-f)*m+(1.5+f)*p+.5*d,b=f*m-f*p;for(let t=0;t!==s;++t)i[t]=g*o[c+t]+v*o[l+t]+y*o[a+t]+b*o[u+t];return i}}),os.prototype=Object.assign(Object.create(rs.prototype),{constructor:os,interpolate_:function(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=t*s,l=a-s,c=(n-e)/(r-e),u=1-c;for(let t=0;t!==s;++t)i[t]=o[l+t]*u+o[a+t]*c;return i}}),ss.prototype=Object.assign(Object.create(rs.prototype),{constructor:ss,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(as,{toJSON:function(t){const e=t.constructor;let n;if(void 0!==e.toJSON)n=e.toJSON(t);else{n={name:t.name,times:ns.convertArray(t.times,Array),values:ns.convertArray(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}}),Object.assign(as.prototype,{constructor:as,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new ss(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new os(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new is(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){let e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]+=t}return this},scale:function(t){if(1!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]*=t}return this},trim:function(t,e){const n=this.times,r=n.length;let i=0,o=r-1;for(;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==i||o!==r){i>=o&&(o=Math.max(o,1),i=o-1);const t=this.getValueSize();this.times=ns.arraySlice(n,i,o),this.values=ns.arraySlice(this.values,i*t,o*t)}return this},validate:function(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let o=null;for(let e=0;e!==i;e++){const r=n[e];if("number"==typeof r&&isNaN(r)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,e,r),t=!1;break}if(null!==o&&o>r){console.error("THREE.KeyframeTrack: Out of order keys.",this,e,r,o),t=!1;break}o=r}if(void 0!==r&&ns.isTypedArray(r))for(let e=0,n=r.length;e!==n;++e){const n=r[e];if(isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,e,n),t=!1;break}}return t},optimize:function(){const t=ns.arraySlice(this.times),e=ns.arraySlice(this.values),n=this.getValueSize(),r=2302===this.getInterpolation(),i=t.length-1;let o=1;for(let s=1;s<i;++s){let i=!1;const a=t[s];if(a!==t[s+1]&&(1!==s||a!==t[0]))if(r)i=!0;else{const t=s*n,r=t-n,o=t+n;for(let s=0;s!==n;++s){const n=e[t+s];if(n!==e[r+s]||n!==e[o+s]){i=!0;break}}}if(i){if(s!==o){t[o]=t[s];const r=s*n,i=o*n;for(let t=0;t!==n;++t)e[i+t]=e[r+t]}++o}}if(i>0){t[o]=t[i];for(let t=i*n,r=o*n,s=0;s!==n;++s)e[r+s]=e[t+s];++o}return o!==t.length?(this.times=ns.arraySlice(t,0,o),this.values=ns.arraySlice(e,0,o*n)):(this.times=t,this.values=e),this},clone:function(){const t=ns.arraySlice(this.times,0),e=ns.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}),ls.prototype=Object.assign(Object.create(as.prototype),{constructor:ls,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),cs.prototype=Object.assign(Object.create(as.prototype),{constructor:cs,ValueTypeName:"color"}),us.prototype=Object.assign(Object.create(as.prototype),{constructor:us,ValueTypeName:"number"}),hs.prototype=Object.assign(Object.create(rs.prototype),{constructor:hs,interpolate_:function(t,e,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=(n-e)/(r-e);let l=t*s;for(let t=l+s;l!==t;l+=4)b.slerpFlat(i,0,o,l-s,o,l,a);return i}}),fs.prototype=Object.assign(Object.create(as.prototype),{constructor:fs,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new hs(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),ds.prototype=Object.assign(Object.create(as.prototype),{constructor:ds,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ps.prototype=Object.assign(Object.create(as.prototype),{constructor:ps,ValueTypeName:"vector"}),Object.assign(ms,{parse:function(t){const e=[],n=t.tracks,r=1/(t.fps||1);for(let t=0,i=n.length;t!==i;++t)e.push(gs(n[t]).scale(r));const i=new ms(t.name,t.duration,e,t.blendMode);return i.uuid=t.uuid,i},toJSON:function(t){const e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let t=0,r=n.length;t!==r;++t)e.push(as.toJSON(n[t]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){const i=e.length,o=[];for(let t=0;t<i;t++){let s=[],a=[];s.push((t+i-1)%i,t,(t+1)%i),a.push(0,1,0);const l=ns.getKeyframeOrder(s);s=ns.sortedArray(s,1,l),a=ns.sortedArray(a,1,l),r||0!==s[0]||(s.push(i),a.push(a[0])),o.push(new us(".morphTargetInfluences["+e[t].name+"]",s,a).scale(1/n))}return new ms(t,-1,o)},findByName:function(t,e){let n=t;if(!Array.isArray(t)){const e=t;n=e.geometry&&e.geometry.animations||e.animations}for(let t=0;t<n.length;t++)if(n[t].name===e)return n[t];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let e=0,n=t.length;e<n;e++){const n=t[e],o=n.name.match(i);if(o&&o.length>1){const t=o[1];let e=r[t];e||(r[t]=e=[]),e.push(n)}}const o=[];for(const t in r)o.push(ms.CreateFromMorphTargetSequence(t,r[t],e,n));return o},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(t,e,n,r,i){if(0!==n.length){const o=[],s=[];ns.flattenJSON(n,o,s,r),0!==o.length&&i.push(new t(e,o,s))}},r=[],i=t.name||"default",o=t.fps||30,s=t.blendMode;let a=t.length||-1;const l=t.hierarchy||[];for(let t=0;t<l.length;t++){const i=l[t].keys;if(i&&0!==i.length)if(i[0].morphTargets){const t={};let e;for(e=0;e<i.length;e++)if(i[e].morphTargets)for(let n=0;n<i[e].morphTargets.length;n++)t[i[e].morphTargets[n]]=-1;for(const n in t){const t=[],o=[];for(let r=0;r!==i[e].morphTargets.length;++r){const r=i[e];t.push(r.time),o.push(r.morphTarget===n?1:0)}r.push(new us(".morphTargetInfluence["+n+"]",t,o))}a=t.length*(o||1)}else{const o=".bones["+e[t].name+"]";n(ps,o+".position",i,"pos",r),n(fs,o+".quaternion",i,"rot",r),n(ps,o+".scale",i,"scl",r)}}if(0===r.length)return null;return new ms(i,a,r,s)}}),Object.assign(ms.prototype,{resetDuration:function(){let t=0;for(let e=0,n=this.tracks.length;e!==n;++e){const n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this},trim:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new ms(this.name,this.duration,t,this.blendMode)},toJSON:function(){return ms.toJSON(this)}});const vs={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function ys(t,e,n){const r=this;let i=!1,o=0,s=0,a=void 0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){s++,!1===i&&void 0!==r.onStart&&r.onStart(t,o,s),i=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,s),o===s&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return a?a(t):t},this.setURLModifier=function(t){return a=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=l.length;e<n;e+=2){const n=l[e],r=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return r}return null}}const bs=new ys;function _s(t){this.manager=void 0!==t?t:bs,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(_s.prototype,{load:function(){},loadAsync:function(t,e){const n=this;return new Promise((function(r,i){n.load(t,r,e,i)}))},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});const xs={};function ws(t){_s.call(this,t)}function Ms(t){_s.call(this,t)}function Ss(t){_s.call(this,t)}function Es(t){_s.call(this,t)}function Ts(t){_s.call(this,t)}function Cs(t){_s.call(this,t)}function As(t){_s.call(this,t)}function Ps(){this.type="Curve",this.arcLengthDivisions=200}function Ls(t,e,n,r,i,o,s,a){Ps.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=s||!1,this.aRotation=a||0}function Rs(t,e,n,r,i,o){Ls.call(this,t,e,n,n,r,i,o),this.type="ArcCurve"}function Os(){let t=0,e=0,n=0,r=0;function i(i,o,s,a){t=i,e=s,n=-3*i+3*o-2*s-a,r=2*i-2*o+s+a}return{initCatmullRom:function(t,e,n,r,o){i(e,n,o*(n-t),o*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,o,s,a){let l=(e-t)/o-(n-t)/(o+s)+(n-e)/s,c=(n-e)/s-(r-e)/(s+a)+(r-n)/a;l*=s,c*=s,i(e,n,l,c)},calc:function(i){const o=i*i;return t+e*i+n*o+r*(o*i)}}}ws.prototype=Object.assign(Object.create(_s.prototype),{constructor:ws,load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,o=vs.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;if(void 0!==xs[t])return void xs[t].push({onLoad:e,onProgress:n,onError:r});const s=t.match(/^data:(.*?)(;base64)?,(.*)$/);let a;if(s){const n=s[1],o=!!s[2];let a=s[3];a=decodeURIComponent(a),o&&(a=atob(a));try{let r;const o=(this.responseType||"").toLowerCase();switch(o){case"arraybuffer":case"blob":const t=new Uint8Array(a.length);for(let e=0;e<a.length;e++)t[e]=a.charCodeAt(e);r="blob"===o?new Blob([t.buffer],{type:n}):t.buffer;break;case"document":const e=new DOMParser;r=e.parseFromString(a,n);break;case"json":r=JSON.parse(a);break;default:r=a}setTimeout((function(){e&&e(r),i.manager.itemEnd(t)}),0)}catch(e){setTimeout((function(){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}),0)}}else{xs[t]=[],xs[t].push({onLoad:e,onProgress:n,onError:r}),a=new XMLHttpRequest,a.open("GET",t,!0),a.addEventListener("load",(function(e){const n=this.response,r=xs[t];if(delete xs[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),vs.add(t,n);for(let t=0,e=r.length;t<e;t++){const e=r[t];e.onLoad&&e.onLoad(n)}i.manager.itemEnd(t)}else{for(let t=0,n=r.length;t<n;t++){const n=r[t];n.onError&&n.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}}),!1),a.addEventListener("progress",(function(e){const n=xs[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onProgress&&r.onProgress(e)}}),!1),a.addEventListener("error",(function(e){const n=xs[t];delete xs[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onError&&r.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),a.addEventListener("abort",(function(e){const n=xs[t];delete xs[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onError&&r.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}),!1),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.overrideMimeType&&a.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const t in this.requestHeader)a.setRequestHeader(t,this.requestHeader[t]);a.send(null)}return i.manager.itemStart(t),a},setResponseType:function(t){return this.responseType=t,this},setMimeType:function(t){return this.mimeType=t,this}}),Ms.prototype=Object.assign(Object.create(_s.prototype),{constructor:Ms,load:function(t,e,n,r){const i=this,o=new ws(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch(e){r?r(e):console.error(e),i.manager.itemError(t)}}),n,r)},parse:function(t){const e=[];for(let n=0;n<t.length;n++){const r=ms.parse(t[n]);e.push(r)}return e}}),Ss.prototype=Object.assign(Object.create(_s.prototype),{constructor:Ss,load:function(t,e,n,r){const i=this,o=[],s=new ao,a=new ws(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(i.withCredentials);let l=0;function c(c){a.load(t[c],(function(t){const n=i.parse(t,!0);o[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(s.minFilter=1006),s.image=o,s.format=n.format,s.needsUpdate=!0,e&&e(s))}),n,r)}if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)c(e);else a.load(t,(function(t){const n=i.parse(t,!0);if(n.isCubemap){const t=n.mipmaps.length/n.mipmapCount;for(let e=0;e<t;e++){o[e]={mipmaps:[]};for(let t=0;t<n.mipmapCount;t++)o[e].mipmaps.push(n.mipmaps[e*n.mipmapCount+t]),o[e].format=n.format,o[e].width=n.width,o[e].height=n.height}s.image=o}else s.image.width=n.width,s.image.height=n.height,s.mipmaps=n.mipmaps;1===n.mipmapCount&&(s.minFilter=1006),s.format=n.format,s.needsUpdate=!0,e&&e(s)}),n,r);return s}}),Es.prototype=Object.assign(Object.create(_s.prototype),{constructor:Es,load:function(t,e,n,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,o=vs.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;const s=document.createElementNS("http://www.w3.org/1999/xhtml","img");function a(){s.removeEventListener("load",a,!1),s.removeEventListener("error",l,!1),vs.add(t,this),e&&e(this),i.manager.itemEnd(t)}function l(e){s.removeEventListener("load",a,!1),s.removeEventListener("error",l,!1),r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}return s.addEventListener("load",a,!1),s.addEventListener("error",l,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),i.manager.itemStart(t),s.src=t,s}}),Ts.prototype=Object.assign(Object.create(_s.prototype),{constructor:Ts,load:function(t,e,n,r){const i=new Ge,o=new Es(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let s=0;function a(n){o.load(t[n],(function(t){i.images[n]=t,s++,6===s&&(i.needsUpdate=!0,e&&e(i))}),void 0,r)}for(let e=0;e<t.length;++e)a(e);return i}}),Cs.prototype=Object.assign(Object.create(_s.prototype),{constructor:Cs,load:function(t,e,n,r){const i=this,o=new Ve,s=new ws(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(i.withCredentials),s.load(t,(function(t){const n=i.parse(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:1001,o.wrapT=void 0!==n.wrapT?n.wrapT:1001,o.magFilter=void 0!==n.magFilter?n.magFilter:1006,o.minFilter=void 0!==n.minFilter?n.minFilter:1006,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(o.encoding=n.encoding),void 0!==n.flipY&&(o.flipY=n.flipY),void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=1008),1===n.mipmapCount&&(o.minFilter=1006),o.needsUpdate=!0,e&&e(o,n))}),n,r),o}}),As.prototype=Object.assign(Object.create(_s.prototype),{constructor:As,load:function(t,e,n,r){const i=new m,o=new Es(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,(function(n){i.image=n;const r=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);i.format=r?1022:1023,i.needsUpdate=!0,void 0!==e&&e(i)}),n,r),i}}),Object.assign(Ps.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){const t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,r=this.getPoint(0),i=0;e.push(0);for(let o=1;o<=t;o++)n=this.getPoint(o/t),i+=n.distanceTo(r),e.push(i),r=n;return this.cacheArcLengths=e,e},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){const n=this.getLengths();let r=0;const i=n.length;let o;o=e||t*n[i-1];let s,a=0,l=i-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),s=n[r]-o,s<0)a=r+1;else{if(!(s>0)){l=r;break}l=r-1}if(r=l,n[r]===o)return r/(i-1);const c=n[r];return(r+(o-c)/(n[r+1]-c))/(i-1)},getTangent:function(t,e){let n=t-1e-4,r=t+1e-4;n<0&&(n=0),r>1&&(r=1);const i=this.getPoint(n),o=this.getPoint(r),s=e||(i.isVector2?new u:new _);return s.copy(o).sub(i).normalize(),s},getTangentAt:function(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)},computeFrenetFrames:function(t,e){const n=new _,r=[],i=[],o=[],s=new _,a=new Y;for(let e=0;e<=t;e++){const n=e/t;r[e]=this.getTangentAt(n,new _),r[e].normalize()}i[0]=new _,o[0]=new _;let l=Number.MAX_VALUE;const u=Math.abs(r[0].x),h=Math.abs(r[0].y),f=Math.abs(r[0].z);u<=l&&(l=u,n.set(1,0,0)),h<=l&&(l=h,n.set(0,1,0)),f<=l&&n.set(0,0,1),s.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],s),o[0].crossVectors(r[0],i[0]);for(let e=1;e<=t;e++){if(i[e]=i[e-1].clone(),o[e]=o[e-1].clone(),s.crossVectors(r[e-1],r[e]),s.length()>Number.EPSILON){s.normalize();const t=Math.acos(c.clamp(r[e-1].dot(r[e]),-1,1));i[e].applyMatrix4(a.makeRotationAxis(s,t))}o[e].crossVectors(r[e],i[e])}if(!0===e){let e=Math.acos(c.clamp(i[0].dot(i[t]),-1,1));e/=t,r[0].dot(s.crossVectors(i[0],i[t]))>0&&(e=-e);for(let n=1;n<=t;n++)i[n].applyMatrix4(a.makeRotationAxis(r[n],e*n)),o[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:o}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),Ls.prototype=Object.create(Ps.prototype),Ls.prototype.constructor=Ls,Ls.prototype.isEllipseCurve=!0,Ls.prototype.getPoint=function(t,e){const n=e||new u,r=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const o=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);const s=this.aStartAngle+t*i;let a=this.aX+this.xRadius*Math.cos(s),l=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),n=a-this.aX,r=l-this.aY;a=n*t-r*e+this.aX,l=n*e+r*t+this.aY}return n.set(a,l)},Ls.prototype.copy=function(t){return Ps.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Ls.prototype.toJSON=function(){const t=Ps.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Ls.prototype.fromJSON=function(t){return Ps.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Rs.prototype=Object.create(Ls.prototype),Rs.prototype.constructor=Rs,Rs.prototype.isArcCurve=!0;const ks=new _,Is=new Os,Ds=new Os,Ns=new Os;function js(t=[],e=!1,n="centripetal",r=.5){Ps.call(this),this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=r}function Fs(t,e,n,r,i){const o=.5*(r-e),s=.5*(i-n),a=t*t;return(2*n-2*r+o+s)*(t*a)+(-3*n+3*r-2*o-s)*a+o*t+n}function Bs(t,e,n,r){return function(t,e){const n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,r)}function zs(t,e,n,r,i){return function(t,e){const n=1-t;return n*n*n*e}(t,e)+function(t,e){const n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,r)+function(t,e){return t*t*t*e}(t,i)}function Us(t=new u,e=new u,n=new u,r=new u){Ps.call(this),this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=r}function Hs(t=new _,e=new _,n=new _,r=new _){Ps.call(this),this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=r}function Gs(t=new u,e=new u){Ps.call(this),this.type="LineCurve",this.v1=t,this.v2=e}function Ws(t=new _,e=new _){Ps.call(this),this.type="LineCurve3",this.v1=t,this.v2=e}function Vs(t=new u,e=new u,n=new u){Ps.call(this),this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}function qs(t=new _,e=new _,n=new _){Ps.call(this),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}function Xs(t=[]){Ps.call(this),this.type="SplineCurve",this.points=t}js.prototype=Object.create(Ps.prototype),js.prototype.constructor=js,js.prototype.isCatmullRomCurve3=!0,js.prototype.getPoint=function(t,e=new _){const n=e,r=this.points,i=r.length,o=(i-(this.closed?0:1))*t;let s,a,l=Math.floor(o),c=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/i)+1)*i:0===c&&l===i-1&&(l=i-2,c=1),this.closed||l>0?s=r[(l-1)%i]:(ks.subVectors(r[0],r[1]).add(r[0]),s=ks);const u=r[l%i],h=r[(l+1)%i];if(this.closed||l+2<i?a=r[(l+2)%i]:(ks.subVectors(r[i-1],r[i-2]).add(r[i-1]),a=ks),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(s.distanceToSquared(u),t),n=Math.pow(u.distanceToSquared(h),t),r=Math.pow(h.distanceToSquared(a),t);n<1e-4&&(n=1),e<1e-4&&(e=n),r<1e-4&&(r=n),Is.initNonuniformCatmullRom(s.x,u.x,h.x,a.x,e,n,r),Ds.initNonuniformCatmullRom(s.y,u.y,h.y,a.y,e,n,r),Ns.initNonuniformCatmullRom(s.z,u.z,h.z,a.z,e,n,r)}else"catmullrom"===this.curveType&&(Is.initCatmullRom(s.x,u.x,h.x,a.x,this.tension),Ds.initCatmullRom(s.y,u.y,h.y,a.y,this.tension),Ns.initCatmullRom(s.z,u.z,h.z,a.z,this.tension));return n.set(Is.calc(c),Ds.calc(c),Ns.calc(c)),n},js.prototype.copy=function(t){Ps.prototype.copy.call(this,t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},js.prototype.toJSON=function(){const t=Ps.prototype.toJSON.call(this);t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},js.prototype.fromJSON=function(t){Ps.prototype.fromJSON.call(this,t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new _).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Us.prototype=Object.create(Ps.prototype),Us.prototype.constructor=Us,Us.prototype.isCubicBezierCurve=!0,Us.prototype.getPoint=function(t,e=new u){const n=e,r=this.v0,i=this.v1,o=this.v2,s=this.v3;return n.set(zs(t,r.x,i.x,o.x,s.x),zs(t,r.y,i.y,o.y,s.y)),n},Us.prototype.copy=function(t){return Ps.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Us.prototype.toJSON=function(){const t=Ps.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Us.prototype.fromJSON=function(t){return Ps.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Hs.prototype=Object.create(Ps.prototype),Hs.prototype.constructor=Hs,Hs.prototype.isCubicBezierCurve3=!0,Hs.prototype.getPoint=function(t,e=new _){const n=e,r=this.v0,i=this.v1,o=this.v2,s=this.v3;return n.set(zs(t,r.x,i.x,o.x,s.x),zs(t,r.y,i.y,o.y,s.y),zs(t,r.z,i.z,o.z,s.z)),n},Hs.prototype.copy=function(t){return Ps.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Hs.prototype.toJSON=function(){const t=Ps.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Hs.prototype.fromJSON=function(t){return Ps.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Gs.prototype=Object.create(Ps.prototype),Gs.prototype.constructor=Gs,Gs.prototype.isLineCurve=!0,Gs.prototype.getPoint=function(t,e=new u){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},Gs.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Gs.prototype.getTangent=function(t,e){const n=e||new u;return n.copy(this.v2).sub(this.v1).normalize(),n},Gs.prototype.copy=function(t){return Ps.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Gs.prototype.toJSON=function(){const t=Ps.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Gs.prototype.fromJSON=function(t){return Ps.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Ws.prototype=Object.create(Ps.prototype),Ws.prototype.constructor=Ws,Ws.prototype.isLineCurve3=!0,Ws.prototype.getPoint=function(t,e=new _){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},Ws.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Ws.prototype.copy=function(t){return Ps.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Ws.prototype.toJSON=function(){const t=Ps.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Ws.prototype.fromJSON=function(t){return Ps.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Vs.prototype=Object.create(Ps.prototype),Vs.prototype.constructor=Vs,Vs.prototype.isQuadraticBezierCurve=!0,Vs.prototype.getPoint=function(t,e=new u){const n=e,r=this.v0,i=this.v1,o=this.v2;return n.set(Bs(t,r.x,i.x,o.x),Bs(t,r.y,i.y,o.y)),n},Vs.prototype.copy=function(t){return Ps.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Vs.prototype.toJSON=function(){const t=Ps.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Vs.prototype.fromJSON=function(t){return Ps.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},qs.prototype=Object.create(Ps.prototype),qs.prototype.constructor=qs,qs.prototype.isQuadraticBezierCurve3=!0,qs.prototype.getPoint=function(t,e=new _){const n=e,r=this.v0,i=this.v1,o=this.v2;return n.set(Bs(t,r.x,i.x,o.x),Bs(t,r.y,i.y,o.y),Bs(t,r.z,i.z,o.z)),n},qs.prototype.copy=function(t){return Ps.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},qs.prototype.toJSON=function(){const t=Ps.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},qs.prototype.fromJSON=function(t){return Ps.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Xs.prototype=Object.create(Ps.prototype),Xs.prototype.constructor=Xs,Xs.prototype.isSplineCurve=!0,Xs.prototype.getPoint=function(t,e=new u){const n=e,r=this.points,i=(r.length-1)*t,o=Math.floor(i),s=i-o,a=r[0===o?o:o-1],l=r[o],c=r[o>r.length-2?r.length-1:o+1],h=r[o>r.length-3?r.length-1:o+2];return n.set(Fs(s,a.x,l.x,c.x,h.x),Fs(s,a.y,l.y,c.y,h.y)),n},Xs.prototype.copy=function(t){Ps.prototype.copy.call(this,t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this},Xs.prototype.toJSON=function(){const t=Ps.prototype.toJSON.call(this);t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t},Xs.prototype.fromJSON=function(t){Ps.prototype.fromJSON.call(this,t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new u).fromArray(n))}return this};var Ys=Object.freeze({__proto__:null,ArcCurve:Rs,CatmullRomCurve3:js,CubicBezierCurve:Us,CubicBezierCurve3:Hs,EllipseCurve:Ls,LineCurve:Gs,LineCurve3:Ws,QuadraticBezierCurve:Vs,QuadraticBezierCurve3:qs,SplineCurve:Xs});function Zs(){Ps.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Js(t){Zs.call(this),this.type="Path",this.currentPoint=new u,t&&this.setFromPoints(t)}function Ks(t){Js.call(this,t),this.uuid=c.generateUUID(),this.type="Shape",this.holes=[]}function Qs(t,e=1){bt.call(this),this.type="Light",this.color=new Ut(t),this.intensity=e}function $s(t,e,n){Qs.call(this,t,n),this.type="HemisphereLight",this.position.copy(bt.DefaultUp),this.updateMatrix(),this.groundColor=new Ut(e)}function ta(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new u(512,512),this.map=null,this.mapPass=null,this.matrix=new Y,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ye,this._frameExtents=new u(1,1),this._viewportCount=1,this._viewports=[new v(0,0,1,1)]}function ea(){ta.call(this,new Ue(50,1,.5,500)),this.focus=1}function na(t,e,n,r,i,o){Qs.call(this,t,e),this.type="SpotLight",this.position.copy(bt.DefaultUp),this.updateMatrix(),this.target=new bt,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new ea}function ra(){ta.call(this,new Ue(90,1,.5,500)),this._frameExtents=new u(4,2),this._viewportCount=6,this._viewports=[new v(2,1,1,1),new v(0,1,1,1),new v(3,1,1,1),new v(1,1,1,1),new v(3,0,1,1),new v(1,0,1,1)],this._cubeDirections=[new _(1,0,0),new _(-1,0,0),new _(0,0,1),new _(0,0,-1),new _(0,1,0),new _(0,-1,0)],this._cubeUps=[new _(0,1,0),new _(0,1,0),new _(0,1,0),new _(0,1,0),new _(0,0,1),new _(0,0,-1)]}function ia(t,e,n,r){Qs.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new ra}function oa(t=-1,e=1,n=1,r=-1,i=.1,o=2e3){ze.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=i,this.far=o,this.updateProjectionMatrix()}function sa(){ta.call(this,new oa(-5,5,5,-5,.5,500))}function aa(t,e){Qs.call(this,t,e),this.type="DirectionalLight",this.position.copy(bt.DefaultUp),this.updateMatrix(),this.target=new bt,this.shadow=new sa}function la(t,e){Qs.call(this,t,e),this.type="AmbientLight"}function ca(t,e,n,r){Qs.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}Zs.prototype=Object.assign(Object.create(Ps.prototype),{constructor:Zs,add:function(t){this.curves.push(t)},closePath:function(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Gs(e,t))},getPoint:function(t){const e=t*this.getLength(),n=this.getCurveLengths();let r=0;for(;r<n.length;){if(n[r]>=e){const t=n[r]-e,i=this.curves[r],o=i.getLength(),s=0===o?0:1-t/o;return i.getPointAt(s)}r++}return null},getLength:function(){const t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t=12){const e=[];let n;for(let r=0,i=this.curves;r<i.length;r++){const o=i[r],s=o&&o.isEllipseCurve?2*t:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?t*o.points.length:t,a=o.getPoints(s);for(let t=0;t<a.length;t++){const r=a[t];n&&n.equals(r)||(e.push(r),n=r)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e},copy:function(t){Ps.prototype.copy.call(this,t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){const t=Ps.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const n=this.curves[e];t.curves.push(n.toJSON())}return t},fromJSON:function(t){Ps.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push((new Ys[n.type]).fromJSON(n))}return this}}),Js.prototype=Object.assign(Object.create(Zs.prototype),{constructor:Js,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){const n=new Gs(this.currentPoint.clone(),new u(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,n,r){const i=new Vs(this.currentPoint.clone(),new u(t,e),new u(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this},bezierCurveTo:function(t,e,n,r,i,o){const s=new Us(this.currentPoint.clone(),new u(t,e),new u(n,r),new u(i,o));return this.curves.push(s),this.currentPoint.set(i,o),this},splineThru:function(t){const e=new Xs([this.currentPoint.clone()].concat(t));return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,n,r,i,o){const s=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(t+s,e+a,n,r,i,o),this},absarc:function(t,e,n,r,i,o){return this.absellipse(t,e,n,n,r,i,o),this},ellipse:function(t,e,n,r,i,o,s,a){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,n,r,i,o,s,a),this},absellipse:function(t,e,n,r,i,o,s,a){const l=new Ls(t,e,n,r,i,o,s,a);if(this.curves.length>0){const t=l.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this},copy:function(t){return Zs.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){const t=Zs.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Zs.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),Ks.prototype=Object.assign(Object.create(Js.prototype),{constructor:Ks,getPointsHoles:function(t){const e=[];for(let n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){Js.prototype.copy.call(this,t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push(n.clone())}return this},toJSON:function(){const t=Js.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const n=this.holes[e];t.holes.push(n.toJSON())}return t},fromJSON:function(t){Js.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push((new Js).fromJSON(n))}return this}}),Qs.prototype=Object.assign(Object.create(bt.prototype),{constructor:Qs,isLight:!0,copy:function(t){return bt.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){const e=bt.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),$s.prototype=Object.assign(Object.create(Qs.prototype),{constructor:$s,isHemisphereLight:!0,copy:function(t){return Qs.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(ta.prototype,{_projScreenMatrix:new Y,_lightPositionWorld:new _,_lookTarget:new _,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){const e=this.camera,n=this.matrix,r=this._projScreenMatrix,i=this._lookTarget,o=this._lightPositionWorld;o.setFromMatrixPosition(t.matrixWorld),e.position.copy(o),i.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(i),e.updateMatrixWorld(),r.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),ea.prototype=Object.assign(Object.create(ta.prototype),{constructor:ea,isSpotLightShadow:!0,updateMatrices:function(t){const e=this.camera,n=2*c.RAD2DEG*t.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix()),ta.prototype.updateMatrices.call(this,t)}}),na.prototype=Object.assign(Object.create(Qs.prototype),{constructor:na,isSpotLight:!0,copy:function(t){return Qs.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),ra.prototype=Object.assign(Object.create(ta.prototype),{constructor:ra,isPointLightShadow:!0,updateMatrices:function(t,e=0){const n=this.camera,r=this.matrix,i=this._lightPositionWorld,o=this._lookTarget,s=this._projScreenMatrix;i.setFromMatrixPosition(t.matrixWorld),n.position.copy(i),o.copy(n.position),o.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(o),n.updateMatrixWorld(),r.makeTranslation(-i.x,-i.y,-i.z),s.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(s)}}),ia.prototype=Object.assign(Object.create(Qs.prototype),{constructor:ia,isPointLight:!0,copy:function(t){return Qs.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),oa.prototype=Object.assign(Object.create(ze.prototype),{constructor:oa,isOrthographicCamera:!0,copy:function(t,e){return ze.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-t,o=n+t,s=r+e,a=r-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=t*this.view.offsetX,o=i+t*this.view.width,s-=e*this.view.offsetY,a=s-e*this.view.height}this.projectionMatrix.makeOrthographic(i,o,s,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(t){const e=bt.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),sa.prototype=Object.assign(Object.create(ta.prototype),{constructor:sa,isDirectionalLightShadow:!0,updateMatrices:function(t){ta.prototype.updateMatrices.call(this,t)}}),aa.prototype=Object.assign(Object.create(Qs.prototype),{constructor:aa,isDirectionalLight:!0,copy:function(t){return Qs.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),la.prototype=Object.assign(Object.create(Qs.prototype),{constructor:la,isAmbientLight:!0}),ca.prototype=Object.assign(Object.create(Qs.prototype),{constructor:ca,isRectAreaLight:!0,copy:function(t){return Qs.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){const e=Qs.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}});class ua{constructor(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new _)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.282095),e.addScaledVector(o[1],.488603*r),e.addScaledVector(o[2],.488603*i),e.addScaledVector(o[3],.488603*n),e.addScaledVector(o[4],n*r*1.092548),e.addScaledVector(o[5],r*i*1.092548),e.addScaledVector(o[6],.315392*(3*i*i-1)),e.addScaledVector(o[7],n*i*1.092548),e.addScaledVector(o[8],.546274*(n*n-r*r)),e}getIrradianceAt(t,e){const n=t.x,r=t.y,i=t.z,o=this.coefficients;return e.copy(o[0]).multiplyScalar(.886227),e.addScaledVector(o[1],1.023328*r),e.addScaledVector(o[2],1.023328*i),e.addScaledVector(o[3],1.023328*n),e.addScaledVector(o[4],.858086*n*r),e.addScaledVector(o[5],.858086*r*i),e.addScaledVector(o[6],.743125*i*i-.247708),e.addScaledVector(o[7],.858086*n*i),e.addScaledVector(o[8],.429043*(n*n-r*r)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this}toArray(t=[],e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}static getBasisAt(t,e){const n=t.x,r=t.y,i=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*i,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*i,e[6]=.315392*(3*i*i-1),e[7]=1.092548*n*i,e[8]=.546274*(n*n-r*r)}}function ha(t,e){Qs.call(this,void 0,e),this.type="LightProbe",this.sh=void 0!==t?t:new ua}function fa(t){_s.call(this,t),this.textures={}}ha.prototype=Object.assign(Object.create(Qs.prototype),{constructor:ha,isLightProbe:!0,copy:function(t){return Qs.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){const e=Qs.prototype.toJSON.call(this,t);return e.object.sh=this.sh.toArray(),e}}),fa.prototype=Object.assign(Object.create(_s.prototype),{constructor:fa,load:function(t,e,n,r){const i=this,o=new ws(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch(e){r?r(e):console.error(e),i.manager.itemError(t)}}),n,r)},parse:function(t){const e=this.textures;function n(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}const r=new es[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&void 0!==r.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.sheen&&(r.sheen=(new Ut).setHex(t.sheen)),void 0!==t.emissive&&void 0!==r.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&void 0!==r.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearcoat&&(r.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(r.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.combine&&(r.combine=t.combine),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(r.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(r.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(r.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(r.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(r.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(r.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(r.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(r.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(r.morphNormals=t.morphNormals),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.vertexTangents&&(r.vertexTangents=t.vertexTangents),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.toneMapped&&(r.toneMapped=t.toneMapped),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.vertexColors&&("number"==typeof t.vertexColors?r.vertexColors=t.vertexColors>0:r.vertexColors=t.vertexColors),void 0!==t.uniforms)for(const e in t.uniforms){const i=t.uniforms[e];switch(r.uniforms[e]={},i.type){case"t":r.uniforms[e].value=n(i.value);break;case"c":r.uniforms[e].value=(new Ut).setHex(i.value);break;case"v2":r.uniforms[e].value=(new u).fromArray(i.value);break;case"v3":r.uniforms[e].value=(new _).fromArray(i.value);break;case"v4":r.uniforms[e].value=(new v).fromArray(i.value);break;case"m3":r.uniforms[e].value=(new h).fromArray(i.value);break;case"m4":r.uniforms[e].value=(new Y).fromArray(i.value);break;default:r.uniforms[e].value=i.value}}if(void 0!==t.defines&&(r.defines=t.defines),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(const e in t.extensions)r.extensions[e]=t.extensions[e];if(void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.matcap&&(r.matcap=n(t.matcap)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(r.normalMapType=t.normalMapType),void 0!==t.normalScale){let e=t.normalScale;!1===Array.isArray(e)&&(e=[e,e]),r.normalScale=(new u).fromArray(e)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(r.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(r.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(r.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(r.clearcoatNormalScale=(new u).fromArray(t.clearcoatNormalScale)),void 0!==t.transmission&&(r.transmission=t.transmission),void 0!==t.transmissionMap&&(r.transmissionMap=n(t.transmissionMap)),r},setTextures:function(t){return this.textures=t,this}});const da=function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);let e="";for(let n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(t){return e}},pa=function(t){const e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)};function ma(){me.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function ga(t,e,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Yt.call(this,t,e,n),this.meshPerAttribute=r||1}function va(t){_s.call(this,t)}ma.prototype=Object.assign(Object.create(me.prototype),{constructor:ma,isInstancedBufferGeometry:!0,copy:function(t){return me.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const t=me.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),ga.prototype=Object.assign(Object.create(Yt.prototype),{constructor:ga,isInstancedBufferAttribute:!0,copy:function(t){return Yt.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){const t=Yt.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),va.prototype=Object.assign(Object.create(_s.prototype),{constructor:va,load:function(t,e,n,r){const i=this,o=new ws(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch(e){r?r(e):console.error(e),i.manager.itemError(t)}}),n,r)},parse:function(t){const e={},n={};function r(t,r){if(void 0!==e[r])return e[r];const i=t.interleavedBuffers[r],o=function(t,e){if(void 0!==n[e])return n[e];const r=t.arrayBuffers[e],i=new Uint32Array(r).buffer;return n[e]=i,i}(t,i.buffer),s=new oi(ae(i.type,o),i.stride);return s.uuid=i.uuid,e[r]=s,s}const i=t.isInstancedBufferGeometry?new ma:new me,o=t.data.index;if(void 0!==o){const t=ae(o.type,o.array);i.setIndex(new Yt(t,1))}const s=t.data.attributes;for(const e in s){const n=s[e];let o;if(n.isInterleavedBufferAttribute){o=new ai(r(t.data,n.data),n.itemSize,n.offset,n.normalized)}else{const t=ae(n.type,n.array);o=new(n.isInstancedBufferAttribute?ga:Yt)(t,n.itemSize,n.normalized)}void 0!==n.name&&(o.name=n.name),i.setAttribute(e,o)}const a=t.data.morphAttributes;if(a)for(const e in a){const n=a[e],o=[];for(let e=0,i=n.length;e<i;e++){const i=n[e];let s;if(i.isInterleavedBufferAttribute){s=new ai(r(t.data,i.data),i.itemSize,i.offset,i.normalized)}else{s=new Yt(ae(i.type,i.array),i.itemSize,i.normalized)}void 0!==i.name&&(s.name=i.name),o.push(s)}i.morphAttributes[e]=o}t.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);const l=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==l)for(let t=0,e=l.length;t!==e;++t){const e=l[t];i.addGroup(e.start,e.count,e.materialIndex)}const c=t.data.boundingSphere;if(void 0!==c){const t=new _;void 0!==c.center&&t.fromArray(c.center),i.boundingSphere=new B(t,c.radius)}return t.name&&(i.name=t.name),t.userData&&(i.userData=t.userData),i}});function ya(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),_s.call(this,t),this.options={premultiplyAlpha:"none"}}function ba(){this.type="ShapePath",this.color=new Ut,this.subPaths=[],this.currentPath=null}ya.prototype=Object.assign(Object.create(_s.prototype),{constructor:ya,isImageBitmapLoader:!0,setOptions:function(t){return this.options=t,this},load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,o=vs.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;const s={};s.credentials="anonymous"===this.crossOrigin?"same-origin":"include",fetch(t,s).then((function(t){return t.blob()})).then((function(t){return createImageBitmap(t,i.options)})).then((function(n){vs.add(t,n),e&&e(n),i.manager.itemEnd(t)})).catch((function(e){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)})),i.manager.itemStart(t)}}),Object.assign(ba.prototype,{moveTo:function(t,e){return this.currentPath=new Js,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},lineTo:function(t,e){return this.currentPath.lineTo(t,e),this},quadraticCurveTo:function(t,e,n,r){return this.currentPath.quadraticCurveTo(t,e,n,r),this},bezierCurveTo:function(t,e,n,r,i,o){return this.currentPath.bezierCurveTo(t,e,n,r,i,o),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,e){function n(t){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n],i=new Ks;i.curves=r.curves,e.push(i)}return e}function r(t,e){const n=e.length;let r=!1;for(let i=n-1,o=0;o<n;i=o++){let n=e[i],s=e[o],a=s.x-n.x,l=s.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=e[o],a=-a,s=e[i],l=-l),t.y<n.y||t.y>s.y)continue;if(t.y===n.y){if(t.x===n.x)return!0}else{const e=l*(t.x-n.x)-a*(t.y-n.y);if(0===e)return!0;if(e<0)continue;r=!r}}else{if(t.y!==n.y)continue;if(s.x<=t.x&&t.x<=n.x||n.x<=t.x&&t.x<=s.x)return!0}}return r}const i=No.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return n(o);let s,a,l;const c=[];if(1===o.length)return a=o[0],l=new Ks,l.curves=a.curves,c.push(l),c;let u=!i(o[0].getPoints());u=t?!u:u;const h=[],f=[];let d,p,m=[],g=0;f[g]=void 0,m[g]=[];for(let e=0,n=o.length;e<n;e++)a=o[e],d=a.getPoints(),s=i(d),s=t?!s:s,s?(!u&&f[g]&&g++,f[g]={s:new Ks,p:d},f[g].s.curves=a.curves,u&&g++,m[g]=[]):m[g].push({h:a,p:d[0]});if(!f[0])return n(o);if(f.length>1){let t=!1;const e=[];for(let t=0,e=f.length;t<e;t++)h[t]=[];for(let n=0,i=f.length;n<i;n++){const i=m[n];for(let o=0;o<i.length;o++){const s=i[o];let a=!0;for(let i=0;i<f.length;i++)r(s.p,f[i].p)&&(n!==i&&e.push({froms:n,tos:i,hole:o}),a?(a=!1,h[i].push(s)):t=!0);a&&h[n].push(s)}}e.length>0&&(t||(m=h))}for(let t=0,e=f.length;t<e;t++){l=f[t].s,c.push(l),p=m[t];for(let t=0,e=p.length;t<e;t++)l.holes.push(p[t].h)}return c}});class _a{constructor(t){Object.defineProperty(this,"isFont",{value:!0}),this.type="Font",this.data=t}generateShapes(t,e=100){const n=[],r=function(t,e,n){const r=Array.from?Array.from(t):String(t).split(""),i=e/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,s=[];let a=0,l=0;for(let t=0;t<r.length;t++){const e=r[t];if("\n"===e)a=0,l-=o;else{const t=xa(e,i,a,l,n);a+=t.offsetX,s.push(t.path)}}return s}(t,e,this.data);for(let t=0,e=r.length;t<e;t++)Array.prototype.push.apply(n,r[t].toShapes());return n}}function xa(t,e,n,r,i){const o=i.glyphs[t]||i.glyphs["?"];if(!o)return void console.error('THREE.Font: character "'+t+'" does not exists in font family '+i.familyName+".");const s=new ba;let a,l,c,u,h,f,d,p;if(o.o){const t=o._cachedOutline||(o._cachedOutline=o.o.split(" "));for(let i=0,o=t.length;i<o;){switch(t[i++]){case"m":a=t[i++]*e+n,l=t[i++]*e+r,s.moveTo(a,l);break;case"l":a=t[i++]*e+n,l=t[i++]*e+r,s.lineTo(a,l);break;case"q":c=t[i++]*e+n,u=t[i++]*e+r,h=t[i++]*e+n,f=t[i++]*e+r,s.quadraticCurveTo(h,f,c,u);break;case"b":c=t[i++]*e+n,u=t[i++]*e+r,h=t[i++]*e+n,f=t[i++]*e+r,d=t[i++]*e+n,p=t[i++]*e+r,s.bezierCurveTo(h,f,d,p,c,u)}}}return{offsetX:o.ha*e,path:s}}function wa(t){_s.call(this,t)}let Ma;wa.prototype=Object.assign(Object.create(_s.prototype),{constructor:wa,load:function(t,e,n,r){const i=this,o=new ws(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(i.withCredentials),o.load(t,(function(t){let n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}const r=i.parse(n);e&&e(r)}),n,r)},parse:function(t){return new _a(t)}});const Sa=function(){return void 0===Ma&&(Ma=new(window.AudioContext||window.webkitAudioContext)),Ma};function Ea(t){_s.call(this,t)}function Ta(t,e,n){ha.call(this,void 0,n);const r=(new Ut).set(t),i=(new Ut).set(e),o=new _(r.r,r.g,r.b),s=new _(i.r,i.g,i.b),a=Math.sqrt(Math.PI),l=a*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(s).multiplyScalar(a),this.sh.coefficients[1].copy(o).sub(s).multiplyScalar(l)}function Ca(t,e){ha.call(this,void 0,e);const n=(new Ut).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}Ea.prototype=Object.assign(Object.create(_s.prototype),{constructor:Ea,load:function(t,e,n,r){const i=this,o=new ws(i.manager);o.setResponseType("arraybuffer"),o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(t,(function(n){try{const t=n.slice(0);Sa().decodeAudioData(t,(function(t){e(t)}))}catch(e){r?r(e):console.error(e),i.manager.itemError(t)}}),n,r)}}),Ta.prototype=Object.assign(Object.create(ha.prototype),{constructor:Ta,isHemisphereLightProbe:!0,copy:function(t){return ha.prototype.copy.call(this,t),this},toJSON:function(t){return ha.prototype.toJSON.call(this,t)}}),Ca.prototype=Object.assign(Object.create(ha.prototype),{constructor:Ca,isAmbientLightProbe:!0,copy:function(t){return ha.prototype.copy.call(this,t),this},toJSON:function(t){return ha.prototype.toJSON.call(this,t)}});const Aa=new Y,Pa=new Y;Object.assign(function(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ue,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ue,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}.prototype,{update:function(t){const e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep;const n=t.projectionMatrix.clone(),r=e.eyeSep/2,i=r*e.near/e.focus,o=e.near*Math.tan(c.DEG2RAD*e.fov*.5)/e.zoom;let s,a;Pa.elements[12]=-r,Aa.elements[12]=r,s=-o*e.aspect+i,a=o*e.aspect+i,n.elements[0]=2*e.near/(a-s),n.elements[8]=(a+s)/(a-s),this.cameraL.projectionMatrix.copy(n),s=-o*e.aspect-i,a=o*e.aspect-i,n.elements[0]=2*e.near/(a-s),n.elements[8]=(a+s)/(a-s),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Pa),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Aa)}});class La extends bt{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}function Ra(t,e,n){let r,i,o;switch(this.binding=t,this.valueSize=n,e){case"quaternion":r=this._slerp,i=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(Ra.prototype,{accumulate:function(t,e){const n=this.buffer,r=this.valueSize,i=t*r+r;let o=this.cumulativeWeight;if(0===o){for(let t=0;t!==r;++t)n[i+t]=n[t];o=e}else{o+=e;const t=e/o;this._mixBufferRegion(n,i,0,t,r)}this.cumulativeWeight=o},accumulateAdditive:function(t){const e=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,n),this.cumulativeWeightAdditive+=t},apply:function(t){const e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,o=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const t=e*this._origIndex;this._mixBufferRegion(n,r,t,1-i,e)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*e,1,e);for(let t=e,i=e+e;t!==i;++t)if(n[t]!==n[t+e]){s.setValue(n,r);break}},saveOriginalState:function(){const t=this.binding,e=this.buffer,n=this.valueSize,r=n*this._origIndex;t.getValue(e,r);for(let t=n,i=r;t!==i;++t)e[t]=e[r+t%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_setAdditiveIdentityNumeric:function(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]},_select:function(t,e,n,r,i){if(r>=.5)for(let r=0;r!==i;++r)t[e+r]=t[n+r]},_slerp:function(t,e,n,r){b.slerpFlat(t,e,t,e,t,n,r)},_slerpAdditive:function(t,e,n,r,i){const o=this._workIndex*i;b.multiplyQuaternionsFlat(t,o,t,e,t,n),b.slerpFlat(t,e,t,e,t,o,r)},_lerp:function(t,e,n,r,i){const o=1-r;for(let s=0;s!==i;++s){const i=e+s;t[i]=t[i]*o+t[n+s]*r}},_lerpAdditive:function(t,e,n,r,i){for(let o=0;o!==i;++o){const i=e+o;t[i]=t[i]+t[n+o]*r}}});const Oa=new RegExp("[\\[\\]\\.:\\/]","g"),ka="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Ia=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),Da=/(WCOD+)?/.source.replace("WCOD",ka),Na=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),ja=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Fa=new RegExp("^"+Ia+Da+Na+ja+"$"),Ba=["material","materials","bones"];function za(t,e,n){const r=n||Ua.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function Ua(t,e,n){this.path=e,this.parsedPath=n||Ua.parseTrackName(e),this.node=Ua.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}Object.assign(za.prototype,{getValue:function(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(Ua,{Composite:za,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new Ua.Composite(t,e,n):new Ua(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(Oa,"")},parseTrackName:function(t){const e=Fa.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const t=n.nodeName.substring(r+1);-1!==Ba.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n},findNode:function(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let r=0;r<t.length;r++){const i=t[r];if(i.name===e||i.uuid===e)return i;const o=n(i.children);if(o)return o}return null},r=n(t.children);if(r)return r}return null}}),Object.assign(Ua.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){let t=this.node;const e=this.parsedPath,n=e.objectName,r=e.propertyName;let i=e.propertyIndex;if(t||(t=Ua.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let r=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===r){r=e;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==r){if(void 0===t[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[r]}}const o=t[r];if(void 0===o){const n=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+r+" but it wasn't found.",t)}let s=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?s=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(s=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[i]&&(i=t.morphTargetDictionary[i])}a=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else void 0!==o.fromArray&&void 0!==o.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(a=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][s]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Ua.prototype,{_getValue_unbound:Ua.prototype.getValue,_setValue_unbound:Ua.prototype.setValue}),Object.assign(function(){this.uuid=c.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){const t=this._objects,e=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,o=i.length;let s=void 0,a=t.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],h=u.uuid;let f=e[h];if(void 0===f){f=a++,e[h]=f,t.push(u);for(let t=0,e=o;t!==e;++t)i[t].push(new Ua(u,n[t],r[t]))}else if(f<l){s=t[f];const a=--l,c=t[a];e[c.uuid]=f,t[f]=c,e[h]=a,t[a]=u;for(let t=0,e=o;t!==e;++t){const e=i[t],o=e[a];let s=e[f];e[f]=o,void 0===s&&(s=new Ua(u,n[t],r[t])),e[a]=s}}else t[f]!==s&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l},remove:function(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_;for(let o=0,s=arguments.length;o!==s;++o){const s=arguments[o],a=s.uuid,l=e[a];if(void 0!==l&&l>=i){const o=i++,c=t[o];e[c.uuid]=l,t[l]=c,e[a]=o,t[o]=s;for(let t=0,e=r;t!==e;++t){const e=n[t],r=e[o],i=e[l];e[l]=r,e[o]=i}}}this.nCachedObjects_=i},uncache:function(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_,o=t.length;for(let s=0,a=arguments.length;s!==a;++s){const a=arguments[s].uuid,l=e[a];if(void 0!==l)if(delete e[a],l<i){const s=--i,a=t[s],c=--o,u=t[c];e[a.uuid]=l,t[l]=a,e[u.uuid]=s,t[s]=u,t.pop();for(let t=0,e=r;t!==e;++t){const e=n[t],r=e[s],i=e[c];e[l]=r,e[s]=i,e.pop()}}else{const i=--o,s=t[i];i>0&&(e[s.uuid]=l),t[l]=s,t.pop();for(let t=0,e=r;t!==e;++t){const e=n[t];e[l]=e[i],e.pop()}}}this.nCachedObjects_=i},subscribe_:function(t,e){const n=this._bindingsIndicesByPath;let r=n[t];const i=this._bindings;if(void 0!==r)return i[r];const o=this._paths,s=this._parsedPaths,a=this._objects,l=a.length,c=this.nCachedObjects_,u=new Array(l);r=i.length,n[t]=r,o.push(t),s.push(e),i.push(u);for(let n=c,r=a.length;n!==r;++n){const r=a[n];u[n]=new Ua(r,t,e)}return u},unsubscribe_:function(t){const e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){const r=this._paths,i=this._parsedPaths,o=this._bindings,s=o.length-1,a=o[s];e[t[s]]=n,o[n]=a,o.pop(),i[n]=i[s],i.pop(),r[n]=r[s],r.pop()}}});class Ha{constructor(t,e,n=null,r=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=r;const i=e.tracks,o=i.length,s=new Array(o),a={endingStart:2400,endingEnd:2400};for(let t=0;t!==o;++t){const e=i[t].createInterpolant(null);s[t]=e,e.settings=a}this._interpolantSettings=a,this._interpolants=s,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const n=this._clip.duration,r=t._clip.duration,i=r/n,o=n/r;t.warp(1,i,e),this.warp(o,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const r=this._mixer,i=r.time,o=this.timeScale;let s=this._timeScaleInterpolant;null===s&&(s=r._lendControlInterpolant(),this._timeScaleInterpolant=s);const a=s.parameterPositions,l=s.sampleValues;return a[0]=i,a[1]=i+n,l[0]=t/o,l[1]=e/o,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,r){if(!this.enabled)return void this._updateWeight(t);const i=this._startTime;if(null!==i){const r=(t-i)*n;if(r<0||0===n)return;this._startTime=null,e=n*r}e*=this._updateTimeScale(t);const o=this._updateTime(e),s=this._updateWeight(t);if(s>0){const t=this._interpolants,e=this._propertyBindings;switch(this.blendMode){case 2501:for(let n=0,r=t.length;n!==r;++n)t[n].evaluate(o),e[n].accumulateAdditive(s);break;case 2500:default:for(let n=0,i=t.length;n!==i;++n)t[n].evaluate(o),e[n].accumulate(r,s)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let r=this.time+t,i=this._loopCount;const o=2202===n;if(0===t)return-1===i?r:o&&1==(1&i)?e-r:r;if(2200===n){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(r>=e)r=e;else{if(!(r<0)){this.time=r;break t}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=e||r<0){const n=Math.floor(r/e);r-=e*n,i+=Math.abs(n);const s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){const e=t<0;this._setEndings(e,!e,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(o&&1==(1&i))return e-r}return r}_setEndings(t,e,n){const r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)}_scheduleFading(t,e,n){const r=this._mixer,i=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const s=o.parameterPositions,a=o.sampleValues;return s[0]=i,a[0]=e,s[1]=i+t,a[1]=n,this}}function Ga(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}Ga.prototype=Object.assign(Object.create(s.prototype),{constructor:Ga,_bindAction:function(t,e){const n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,s=t._interpolants,a=n.uuid,l=this._bindingsByRootAndName;let c=l[a];void 0===c&&(c={},l[a]=c);for(let t=0;t!==i;++t){const i=r[t],l=i.name;let u=c[l];if(void 0!==u)o[t]=u;else{if(u=o[t],void 0!==u){null===u._cacheIndex&&(++u.referenceCount,this._addInactiveBinding(u,a,l));continue}const r=e&&e._propertyBindings[t].binding.parsedPath;u=new Ra(Ua.create(n,l,r),i.ValueTypeName,i.getValueSize()),++u.referenceCount,this._addInactiveBinding(u,a,l),o[t]=u}s[t].resultBuffer=u.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){const r=this._actions,i=this._actionsByClip;let o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{const e=o.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){const e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;const i=t._clip.uuid,o=this._actionsByClip,s=o[i],a=s.knownActions,l=a[a.length-1],c=t._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),t._byClipCacheIndex=null;delete s.actionByRoot[(t._localRoot||this._root).uuid],0===a.length&&delete o[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.referenceCount&&this._removeInactiveBinding(n)}},_lendAction:function(t){const e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){const e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){const r=this._bindingsByRootAndName,i=this._bindings;let o=r[e];void 0===o&&(o={},r[e]=o),o[n]=t,t._cacheIndex=i.length,i.push(t)},_removeInactiveBinding:function(t){const e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,s=o[r],a=e[e.length-1],l=t._cacheIndex;a._cacheIndex=l,e[l]=a,e.pop(),delete s[i],0===Object.keys(s).length&&delete o[r]},_lendBinding:function(t){const e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){const e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return void 0===n&&(n=new os(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){const e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e,n){const r=e||this._root,i=r.uuid;let o="string"==typeof t?ms.findByName(r,t):t;const s=null!==o?o.uuid:t,a=this._actionsByClip[s];let l=null;if(void 0===n&&(n=null!==o?o.blendMode:2500),void 0!==a){const t=a.actionByRoot[i];if(void 0!==t&&t.blendMode===n)return t;l=a.knownActions[0],null===o&&(o=l._clip)}if(null===o)return null;const c=new Ha(this,o,e,n);return this._bindAction(c,l),this._addInactiveAction(c,s,i),c},existingAction:function(t,e){const n=e||this._root,r=n.uuid,i="string"==typeof t?ms.findByName(n,t):t,o=i?i.uuid:t,s=this._actionsByClip[o];return void 0!==s&&s.actionByRoot[r]||null},stopAllAction:function(){const t=this._actions;for(let e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this},update:function(t){t*=this.timeScale;const e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),o=this._accuIndex^=1;for(let s=0;s!==n;++s){e[s]._update(r,t,i,o)}const s=this._bindings,a=this._nActiveBindings;for(let t=0;t!==a;++t)s[t].apply(o);return this},setTime:function(t){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){const e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){const t=i.knownActions;for(let n=0,r=t.length;n!==r;++n){const r=t[n];this._deactivateAction(r);const i=r._cacheIndex,o=e[e.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,o._cacheIndex=i,e[i]=o,e.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}},uncacheRoot:function(t){const e=t.uuid,n=this._actionsByClip;for(const t in n){const r=n[t].actionByRoot[e];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}const r=this._bindingsByRootAndName[e];if(void 0!==r)for(const t in r){const e=r[t];e.restoreOriginalState(),this._removeInactiveBinding(e)}},uncacheAction:function(t,e){const n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}});class Wa{constructor(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}clone(){return new Wa(void 0===this.value.clone?this.value:this.value.clone())}}function Va(t,e,n){oi.call(this,t,e),this.meshPerAttribute=n||1}function qa(t,e,n,r,i){this.buffer=t,this.type=e,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}function Xa(t,e,n,r){this.ray=new X(t,e),this.near=n||0,this.far=r||1/0,this.camera=null,this.layers=new ot,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Ya(t,e){return t.distance-e.distance}function Za(t,e,n,r){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===r){const r=t.children;for(let t=0,i=r.length;t<i;t++)Za(r[t],e,n,!0)}}Va.prototype=Object.assign(Object.create(oi.prototype),{constructor:Va,isInstancedInterleavedBuffer:!0,copy:function(t){return oi.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},clone:function(t){const e=oi.prototype.clone.call(this,t);return e.meshPerAttribute=this.meshPerAttribute,e},toJSON:function(t){const e=oi.prototype.toJSON.call(this,t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}),Object.defineProperty(qa.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(qa.prototype,{isGLBufferAttribute:!0,setBuffer:function(t){return this.buffer=t,this},setType:function(t,e){return this.type=t,this.elementSize=e,this},setItemSize:function(t){return this.itemSize=t,this},setCount:function(t){return this.count=t,this}}),Object.assign(Xa.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)},intersectObject:function(t,e,n){const r=n||[];return Za(t,this,r,e),r.sort(Ya),r},intersectObjects:function(t,e,n){const r=n||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(let n=0,i=t.length;n<i;n++)Za(t[n],this,r,e);return r.sort(Ya),r}});class Ja{constructor(t=1,e=0,n=0){return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}clone(){return(new this.constructor).copy(this)}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(c.clamp(e/this.radius,-1,1))),this}}const Ka=new u;const Qa=new _,$a=new _;class tl{constructor(t,e){this.start=void 0!==t?t:new _,this.end=void 0!==e?e:new _}set(t,e){return this.start.copy(t),this.end.copy(e),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new _),t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new _),t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new _),this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){Qa.subVectors(t,this.start),$a.subVectors(this.end,this.start);const n=$a.dot($a);let r=$a.dot(Qa)/n;return e&&(r=c.clamp(r,0,1)),r}closestPointToPoint(t,e,n){const r=this.closestPointToPointParameter(t,e);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new _),this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}function el(t){bt.call(this),this.material=t,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}el.prototype=Object.create(bt.prototype),el.prototype.constructor=el,el.prototype.isImmediateRenderObject=!0;const nl=new _,rl=new Y,il=new Y;const ol=new Float32Array(1),sl=(new Int32Array(ol.buffer),Math.pow(2,8),[.125,.215,.35,.446,.526,.582]),al=5+sl.length,ll=new Vt({side:1,depthWrite:!1,depthTest:!1}),{_lodPlanes:cl,_sizeLods:ul,_sigmas:hl}=(new ke(new De,ll),fl());Math.sqrt(5);function fl(){const t=[],e=[],n=[];let r=8;for(let i=0;i<al;i++){const o=Math.pow(2,r);e.push(o);let s=1/o;i>4?s=sl[i-8+4-1]:0==i&&(s=0),n.push(s);const a=1/(o-1),l=-a/2,c=1+a/2,u=[l,l,c,l,c,c,l,l,c,c,l,c],h=6,f=6,d=3,p=2,m=1,g=new Float32Array(d*f*h),v=new Float32Array(p*f*h),y=new Float32Array(m*f*h);for(let t=0;t<h;t++){const e=t%3*2/3-1,n=t>2?0:-1,r=[e,n,0,e+2/3,n,0,e+2/3,n+1,0,e,n,0,e+2/3,n+1,0,e,n+1,0];g.set(r,d*f*t),v.set(u,p*f*t);const i=[t,t,t,t,t,t];y.set(i,m*f*t)}const b=new me;b.setAttribute("position",new Yt(g,d)),b.setAttribute("uv",new Yt(v,p)),b.setAttribute("faceIndex",new Yt(y,m)),t.push(b),r>4&&r--}return{_lodPlanes:t,_sizeLods:e,_sigmas:n}}function dl(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),js.call(this,t),this.type="catmullrom"}Ps.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Ps.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(Js.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),Object.create(js.prototype),Object.create(js.prototype),dl.prototype=Object.create(js.prototype),Object.assign(dl.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),class extends Ki{constructor(t=10,e=10,n=4473924,r=8947848){n=new Ut(n),r=new Ut(r);const i=e/2,o=t/e,s=t/2,a=[],l=[];for(let t=0,c=0,u=-s;t<=e;t++,u+=o){a.push(-s,0,u,s,0,u),a.push(u,0,-s,u,0,s);const e=t===i?n:r;e.toArray(l,c),c+=3,e.toArray(l,c),c+=3,e.toArray(l,c),c+=3,e.toArray(l,c),c+=3}const c=new me;c.setAttribute("position",new re(a,3)),c.setAttribute("color",new re(l,3));super(c,new Hi({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class extends Ki{constructor(t){const e=function t(e){const n=[];e&&e.isBone&&n.push(e);for(let r=0;r<e.children.length;r++)n.push.apply(n,t(e.children[r]));return n}(t),n=new me,r=[],i=[],o=new Ut(0,0,1),s=new Ut(0,1,0);for(let t=0;t<e.length;t++){const n=e[t];n.parent&&n.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(s.r,s.g,s.b))}n.setAttribute("position",new re(r,3)),n.setAttribute("color",new re(i,3));super(n,new Hi({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,n=this.geometry,r=n.getAttribute("position");il.copy(this.root.matrixWorld).invert();for(let t=0,n=0;t<e.length;t++){const i=e[t];i.parent&&i.parent.isBone&&(rl.multiplyMatrices(il,i.matrixWorld),nl.setFromMatrixPosition(rl),r.setXYZ(n,nl.x,nl.y,nl.z),rl.multiplyMatrices(il,i.parent.matrixWorld),nl.setFromMatrixPosition(rl),r.setXYZ(n+1,nl.x,nl.y,nl.z),n+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(_s.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),pa(t)}}),_s.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(class{constructor(t,e){Object.defineProperty(this,"isBox2",{value:!0}),this.min=void 0!==t?t:new u(1/0,1/0),this.max=void 0!==e?e:new u(-1/0,-1/0)}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=Ka.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new u),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new u),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new u),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new u),e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Ka.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(M.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(B.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Ye.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},tl.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(c,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),c.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),c.ceilPowerOfTwo(t)}}),Object.assign(h.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},getInverse:function(t){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()}}),Object.assign(Y.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new _).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,r,n,i,o)},getInverse:function(t){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()}}),Mt.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},Object.assign(b.prototype,{multiplyVector3:function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},inverse:function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()}}),Object.assign(X.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(It.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(It,{barycoordFromPoint:function(t,e,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),It.getBarycoord(t,e,n,r,i)},normal:function(t,e,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),It.getNormal(t,e,n,r)}}),Object.assign(Ks.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Bo(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Ho(this,t)}}),Object.assign(u.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(_.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(v.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(bt.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(bt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(ke.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(ke.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Ti.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Ni.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Oi.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Ps.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),Ue.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Qs.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Yt.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),35048===this.usage},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),Object.assign(Yt.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?35048:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(me.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new Yt(arguments[1],arguments[2])))},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(me.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(ma.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),Object.defineProperties(Xa.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(oi.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),35048===this.usage},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(oi.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?35048:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Bo.prototype,{getArrays:function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")}}),Object.assign(ii.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(Wa.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Wt.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Ut}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(Zo.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Yo.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(t){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=t}}}),Object.defineProperties(Be.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(ni.prototype,{clearTarget:function(t,e,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,r)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(ni.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?3001:3e3}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Xr.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(y.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(La.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new Ea).load(t,(function(t){e.setBuffer(t)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),class{constructor(t,e=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=e,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const e=this.getFrequencyData();for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}}.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},He.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},He.prototype.clear=function(t,e,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(t,e,n,r)};d.crossOrigin=void 0,d.loadTexture=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const i=new As;i.setCrossOrigin(this.crossOrigin);const o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},d.loadTextureCube=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const i=new Ts;i.setCrossOrigin(this.crossOrigin);const o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},d.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},d.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"125"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="125");var pl=function(){function t(t){var e=this;this.updateSize=function(){e.renderer.setSize(e.container.offsetWidth,e.container.offsetHeight)},this.renderer=null,this.container=t,this._init()}return t.prototype._init=function(){var t=function(){try{var t=document.createElement("canvas");return!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(t){return!1}}();this.container.innerHTML="",t?(this.renderer=new ni({logarithmicDepthBuffer:!1,alpha:!0}),this.renderer.setClearColor(0,0),this.renderer.sortObjects=!1,this.renderer.autoClear=!1,this.container.appendChild(this.renderer.domElement),this.renderer.setPixelRatio(window.devicePixelRatio),window.addEventListener("resize",this.updateSize,!1),this.updateSize()):(this.container.innerHTML="<div style='margin-bottom: 5px;'>Seems like <a target='_blank' href='https://www.khronos.org/webgl/wiki/Getting_a_WebGL_Implementation'>WebGL</a> isn't supported for you.</div><div>Find out how to get it <a target='_blank' href='https://get.webgl.org/'>here</a>.</div>",this.container.style.textAlign="center",this.container.style.fontSize="18px",console.warn("WebGL Not Supported"),this.renderer=null)},t.prototype.remove=function(){window.removeEventListener("resize",this.updateSize,!1)},t}();function ml(t,e){var n,s,a,l,c;this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new _,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=.275,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:r,ZOOM:i,PAN:o},this.enableTwoFingerZoomPan=!1,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.flipPanUp=!1,this.getPolarAngle=function(){return y.phi},this.getAzimuthalAngle=function(){return y.theta},this.reset=function(){h.target.copy(h.target0),h.object.position.copy(h.position0),h.object.zoom=h.zoom0,h.object.updateProjectionMatrix(),h.dispatchEvent(f),h.update(),g=m.NONE},this.resetPosition=function(){var t=h.object.position.y;h.object.position.copy(h.position0),h.object.position.y=t,h.object.updateProjectionMatrix(),h.dispatchEvent(f),h.update(),g=m.NONE},this.update=(n=new _,s=(new b).setFromUnitVectors(t.up,new _(0,1,0)),a=s.clone().invert(),l=new _,c=new b,function(){var t=h.object.position;return n.copy(t).sub(h.target),n.applyQuaternion(s),y.setFromVector3(n),h.autoRotate&&g===m.NONE&&N(2*Math.PI/60/60*h.autoRotateSpeed),y.theta+=x.theta,y.phi+=x.phi,y.theta=Math.max(h.minAzimuthAngle,Math.min(h.maxAzimuthAngle,y.theta)),y.phi=Math.max(h.minPolarAngle,Math.min(h.maxPolarAngle,y.phi)),y.makeSafe(),y.radius*=w,y.radius=Math.max(h.minDistance,Math.min(h.maxDistance,y.radius)),h.target.add(M),n.setFromSpherical(y),n.applyQuaternion(a),t.copy(h.target).add(n),h.object.lookAt(h.target),!0===h.enableDamping?(x.theta*=1-h.dampingFactor,x.phi*=1-h.dampingFactor):x.set(0,0,0),w=1,M.set(0,0,0),!!(S||l.distanceToSquared(h.object.position)>v||8*(1-c.dot(h.object.quaternion))>v)&&(h.dispatchEvent(f),l.copy(h.object.position),c.copy(h.object.quaternion),S=!1,!0)}),this.dispose=function(){h.domElement.removeEventListener("contextmenu",et,!1),h.domElement.removeEventListener("mousedown",X,!1),h.domElement.removeEventListener("wheel",J,!1),h.domElement.removeEventListener("touchstart",Q,!1),h.domElement.removeEventListener("touchend",tt,!1),h.domElement.removeEventListener("touchmove",$,!1),document.removeEventListener("mousemove",Y,!1),document.removeEventListener("mouseup",Z,!1),window.removeEventListener("keydown",K,!1)};var h=this,f={type:"change"},d={type:"start"},p={type:"end"},m={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5,TOUCH_DOLLY_PAN:6},g=m.NONE,v=1e-6,y=new Ja,x=new Ja,w=1,M=new _,S=!1,E=new u,T=new u,C=new u,A=new u,P=new u,L=new u,R=new u,O=new u,k=new u;function I(){return h.domElement===document?h.domElement.body:h.domElement}function D(t){return t=t||1,Math.pow(.95,h.zoomSpeed*t)}function N(t){x.theta-=t}function j(t){x.phi-=t}this.rotateLeft=N,this.rotateUp=j;var F,B=(F=new _,function(t,e){var n=e.elements;h.flipPanUp?F.set(n[0],0,n[2]).normalize():F.set(n[0],n[1],0).normalize(),F.multiplyScalar(-t),M.add(F)}),z=function(){var t=new _;return function(e,n){var r=n.elements;h.flipPanUp?t.set(r[4],0,r[6]).normalize():t.set(r[4],r[5],0).normalize(),t.multiplyScalar(e),M.add(t)}}(),U=function(){var t=new _;return function(e,n){var r=I();if(h.object instanceof Ue){var i=h.object.position;t.copy(i).sub(h.target);var o=t.length();o*=Math.tan(h.object.fov/2*Math.PI/180),B(2*e*o/r.clientHeight,h.object.matrix),z(2*n*o/r.clientHeight,h.object.matrix)}else h.object instanceof oa?(B(e*(h.object.right-h.object.left)/h.object.zoom/r.clientWidth,h.object.matrix),z(n*(h.object.top-h.object.bottom)/h.object.zoom/r.clientHeight,h.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),h.enablePan=!1)}}();function H(t){h.object instanceof Ue?w/=t:h.object instanceof oa?(h.object.zoom=Math.max(h.minZoom,Math.min(h.maxZoom,h.object.zoom*t)),h.object.updateProjectionMatrix(),S=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),h.enableZoom=!1)}function G(t){h.object instanceof Ue?w*=t:h.object instanceof oa?(h.object.zoom=Math.max(h.minZoom,Math.min(h.maxZoom,h.object.zoom/t)),h.object.updateProjectionMatrix(),S=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),h.enableZoom=!1)}function W(t){t.deltaY<0?G(D()):t.deltaY>0&&H(D()),h.update()}function V(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);R.set(0,r)}function q(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);O.set(0,r),k.subVectors(O,R);var i=I(),o=Math.abs(k.y)/(.01*i.clientHeight);k.y>0?G(D(o)):k.y<0&&H(D(o)),R.copy(O),h.update()}function X(t){if(!1!==h.enabled){if(t.preventDefault(),t.button===h.mouseButtons.ORBIT){if(!1===h.enableRotate)return;!function(t){E.set(t.clientX,t.clientY)}(t),g=m.ROTATE}else if(t.button===h.mouseButtons.ZOOM){if(!1===h.enableZoom)return;!function(t){R.set(t.clientX,t.clientY)}(t),g=m.DOLLY}else if(t.button===h.mouseButtons.PAN){if(!1===h.enablePan)return;!function(t){A.set(t.clientX,t.clientY)}(t),g=m.PAN}g!==m.NONE&&(document.addEventListener("mousemove",Y,!1),document.addEventListener("mouseup",Z,!1),h.dispatchEvent(d))}}function Y(t){if(!1!==h.enabled)if(t.preventDefault(),g===m.ROTATE){if(!1===h.enableRotate)return;!function(t){T.set(t.clientX,t.clientY),C.subVectors(T,E);var e=I();N(2*Math.PI*C.x/e.clientWidth*h.rotateSpeed),j(2*Math.PI*C.y/e.clientHeight*h.rotateSpeed),E.copy(T),h.update()}(t)}else if(g===m.DOLLY){if(!1===h.enableZoom)return;!function(t){O.set(t.clientX,t.clientY),k.subVectors(O,R);var e=I(),n=Math.abs(k.y)/(.01*e.clientHeight);k.y>0?H(D(n)):k.y<0&&G(D(n)),R.copy(O),h.update()}(t)}else if(g===m.PAN){if(!1===h.enablePan)return;!function(t){P.set(t.clientX,t.clientY),L.subVectors(P,A),U(L.x,L.y),A.copy(P),h.update()}(t)}}function Z(t){!1!==h.enabled&&(document.removeEventListener("mousemove",Y,!1),document.removeEventListener("mouseup",Z,!1),h.dispatchEvent(p),g=m.NONE)}function J(t){!1===h.enabled||!1===h.enableZoom||g!==m.NONE&&g!==m.ROTATE||(t.preventDefault(),W(t),h.dispatchEvent(d),h.dispatchEvent(p))}function K(t){!1!==h.enabled&&!1!==h.enableKeys&&!1!==h.enablePan&&function(t){switch(t.keyCode){case h.keys.UP:U(0,h.keyPanSpeed),h.update();break;case h.keys.BOTTOM:U(0,-h.keyPanSpeed),h.update();break;case h.keys.LEFT:U(h.keyPanSpeed,0),h.update();break;case h.keys.RIGHT:U(-h.keyPanSpeed,0),h.update()}}(t)}function Q(t){if(!1!==h.enabled){switch(t.touches.length){case 1:if(!1===h.enableRotate)return;!function(t){E.set(t.touches[0].pageX,t.touches[0].pageY)}(t),g=m.TOUCH_ROTATE;break;case 2:if(!1===h.enableZoom&&!1===h.enablePan)return;if(!0===h.enableTwoFingerZoomPan)!function(t){if(!0===h.enableZoom&&V(t),!0===h.enablePan){var e=(t.touches[0].pageX+t.touches[1].pageX)/2,n=(t.touches[0].pageY+t.touches[1].pageY)/2;A.set(e,n)}}(t),g=!0===h.enableZoom&&!0===h.enablePan?m.TOUCH_DOLLY_PAN:!0===h.enableZoom&&!1===h.eanblePan?m.TOUCH_DOLLY:m.TOUCH_PAN;else{if(!1===h.enableZoom)return;V(t),g=m.TOUCH_DOLLY}break;case 3:if(!1===h.enablePan)return;if(!0===h.enableTwoFingerZoomPan)return;!function(t){A.set(t.touches[0].pageX,t.touches[0].pageY)}(t),g=m.TOUCH_PAN;break;default:g=m.NONE}g!==m.NONE&&h.dispatchEvent(d)}}function $(t){if(!1!==h.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:if(!1===h.enableRotate)return;if(g!==m.TOUCH_ROTATE)return;!function(t){T.set(t.touches[0].pageX,t.touches[0].pageY),C.subVectors(T,E);var e=I();N(2*Math.PI*C.x/e.clientWidth*h.rotateSpeed),j(2*Math.PI*C.y/e.clientHeight*h.rotateSpeed),E.copy(T),h.update()}(t);break;case 2:if(!1===h.enableZoom&&!1===h.enablePan)return;if(g!==m.TOUCH_DOLLY&&g!==m.TOUCH_PAN&&g!==m.TOUCH_DOLLY_PAN)return;if(!0===h.enableTwoFingerZoomPan)!function(t){if(!0===h.enablePan){var e=(t.touches[0].pageX+t.touches[1].pageX)/2,n=(t.touches[0].pageY+t.touches[1].pageY)/2;P.set(e,n),L.subVectors(P,A),U(L.x,L.y),A.copy(P),!1===h.enableZoom&&h.update()}!0===h.enableZoom&&q(t)}(t);else{if(!1===h.enableZoom)return;q(t)}break;case 3:if(!1===h.enablePan)return;if(g!==m.TOUCH_PAN)return;!function(t){P.set(t.touches[0].pageX,t.touches[0].pageY),L.subVectors(P,A),U(L.x,L.y),A.copy(P),h.update()}(t);break;default:g=m.NONE}}function tt(t){!1!==h.enabled&&(h.dispatchEvent(p),g=m.NONE)}function et(t){t.preventDefault()}this.handleMouseWheel=W,h.domElement.addEventListener("contextmenu",et,!1),h.domElement.addEventListener("mousedown",X,!1),h.domElement.addEventListener("wheel",J,!1),h.domElement.addEventListener("touchstart",Q,!1),h.domElement.addEventListener("touchend",tt,!1),h.domElement.addEventListener("touchmove",$,!1),window.addEventListener("keydown",K,!1),this.update()}function gl(t){var e=this;t.rotation.set(0,0,0);var n=new bt;n.add(t);var r=new bt;r.position.y=10,r.add(n);var i,o,s=Math.PI/2,a=function(t){if(!1!==e.enabled){var i=t.movementX||t.mozMovementX||t.webkitMovementX||0,o=t.movementY||t.mozMovementY||t.webkitMovementY||0;r.rotation.y-=.002*i,n.rotation.x-=.002*o,n.rotation.x=Math.max(-s,Math.min(s,n.rotation.x))}};this.dispose=function(){document.removeEventListener("mousemove",a,!1)},document.addEventListener("mousemove",a,!1),this.enabled=!1,this.getObject=function(){return r},this.getPitchObject=function(){return n},this.getDirection=(i=new _(0,0,-1),o=new nt(0,0,0,"YXZ"),function(t){return o.set(n.rotation.x,r.rotation.y,0),t.copy(i).applyEuler(o),t})}ml.prototype=Object.create(s.prototype),ml.prototype.constructor=ml,Object.defineProperties(ml.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(t){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!t}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(t){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!t}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(t){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!t}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(t){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!t}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(t){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!t}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(t){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=t}}});var vl={getIn:function(t,e,n){if(null==t)return null!=n?n:null;if(null==e)return null!=n?n:null;for(var r=Object.assign({},t),i=0;i<e.length;i++){if(!r.hasOwnProperty(e[i]))return null!=n?n:null;r=r[e[i]]}return r},mod:function(t,e){var n=t%e;return Math.floor(n>=0?n:n+e)},findHighestMaxZoom:function(t){var e=0;for(var n in t)"Vectors As Tiles"!=t[n].name&&t[n].maxZoom>e&&(e=t[n].maxZoom);return e},findLowestMinZoom:function(t){var e=1/0;for(var n in t)"_vectorsastile_"!==t[n].path&&t[n].minZoom<e&&(e=t[n].minZoom);return e},isInExtent:function(t,e,n){var r=!0;if(e){var i=t.x+0,o=t.y+0,s=n.tileXYZ2LatLng(i,o,t.z),a=s.lat,l=s.lng;r=a<e[3]&&a>e[1]&&l<e[2]&&l>e[0],i=t.x+1,o=t.y+0,a=(s=n.tileXYZ2LatLng(i,o,t.z)).lat,l=s.lng,r=r||a<e[3]&&a>e[1]&&l<e[2]&&l>e[0],i=t.x+1,o=t.y+1,a=(s=n.tileXYZ2LatLng(i,o,t.z)).lat,l=s.lng,r=r||a<e[3]&&a>e[1]&&l<e[2]&&l>e[0],i=t.x+0,o=t.y+1,a=(s=n.tileXYZ2LatLng(i,o,t.z)).lat,l=s.lng,r=r||a<e[3]&&a>e[1]&&l<e[2]&&l>e[0]}return r},clone:function(t){var e;if(null==t||"object"!=typeof t)return t;if(t instanceof Date)return(e=new Date).setTime(t.getTime()),e;if(t instanceof Array){e=[];for(var n=0,r=t.length;n<r;n++)e[n]=vl.clone(t[n]);return e}if(t instanceof Object){for(var i in e={},t)t.hasOwnProperty(i)&&(e[i]=vl.clone(t[i]));return e}throw new Error("Unable to copy obj! Its type isn't supported.")},capitalizeFirstLetter:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},getExtension:function(t){return/(?:\.([^.]+))?$/.exec(t)[1]||""},getRadiansPerPixel:function(t){return 360/Math.pow(2,t)*(Math.PI/180)/256},lastTileContains:[],tileContains:function(t,e,n){if(n)for(var r=0;r<vl.lastTileContains.length;r++){var i=vl.lastTileContains[r].call.xyz;if(i[0]==t[0]&&i[1]==t[1]&&i[2]==t[2]&&vl.lastTileContains[r].call.z==e)return vl.lastTileContains[r].result}for(var o=[],s=Math.pow(2,e)/Math.pow(2,t[2]),a=[(t[0]+1)*s-1,(t[1]+1)*s-1],l=[a[0]-s+1,a[1]-s+1],c=l[0];c<=a[0];c++)for(var u=l[1];u<=a[1];u++)o.push([c,u,e]);return vl.lastTileContains.unshift({call:{xyz:t,z:e},result:o}),vl.lastTileContains.length>3&&vl.lastTileContains.pop(),o},tileIsContained:function(t,e,n){for(var r=this.tileContains(t,e[2],n),i=0;i<r.length;i++)if(r[i][0]==e[0]&&r[i][1]==e[1])return!0;return!1},arrayAverage:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=null!=e?t[r][e]:t[r];return n/t.length},hexToRGB:function(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,n,r){return e+e+n+n+r+r}));var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},rotatePoint:function(t,e,n){var r=Math.cos(n),i=Math.sin(n),o=t.x-e[0],s=t.y-e[1];return{x:e[0]+o*r-s*i,y:e[1]+o*i+s*r}},rotateAroundArbAxis:function(t,e,n,r){t.updateWorldMatrix(!0);var i=t.getWorldQuaternion(new b).invert();e.applyQuaternion(i);var o=new b;o.setFromAxisAngle(e,n),t.quaternion.multiply(o)},getParamString:function(t,e,n){var r=[],i=new URLSearchParams(e.toUpperCase());for(var o in t)i.has(o.toUpperCase())||r.push(encodeURIComponent(n?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+r.join("&")},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)}},yl=vl,bl=function(){function t(t,e,n,r){var i=this;this.onKeyDown=function(t){if(!i.firstPerson.lockControls)switch(i.isShift=t.shiftKey,t.keyCode){case 38:case 87:i.moveForward=!0;break;case 37:case 65:i.moveLeft=!0;break;case 40:case 83:i.moveBackward=!0;break;case 39:case 68:i.moveRight=!0;break;case 32:!0===i.canJump&&(i.velocity.y+=350),i.canJump=!1}},this.onKeyUp=function(t){if(!i.firstPerson.lockControls)switch(i.isShift=t.shiftKey,t.keyCode){case 38:case 87:i.moveForward=!1;break;case 37:case 65:i.moveLeft=!1;break;case 40:case 83:i.moveBackward=!1;break;case 39:case 68:i.moveRight=!1}},this.updateSize=function(){i.orbit.camera.aspect=i.sceneContainer.offsetWidth/i.sceneContainer.offsetHeight,i.orbit.camera.updateProjectionMatrix(),i.firstPerson.camera.aspect=i.sceneContainer.offsetWidth/i.sceneContainer.offsetHeight,i.firstPerson.camera.updateProjectionMatrix()},this.setNearFarPlane=function(t,e,n,r){!0===r&&(i._.keepNear=!0),!1===r&&(i._.keepNear=!1),t?i._.keepNear||(i.orbit.camera.near=1e4*i.orbit.near):(i._.keepNear||(i.orbit.camera.near=i.orbit.near),i.orbit.camera.far=i.orbit.far),null!=e&&(i.orbit.camera.near=e),null!=n&&(i.orbit.camera.far=n),i.orbit.camera.updateProjectionMatrix()},this.setFirstPersonHeight=function(t){i.firstPerson.height=t||3},this.getFirstPersonFocalLength=function(){return i.firstPerson.camera.getFocalLength()},this.setFirstPersonFocalLength=function(t){i.firstPerson.camera.setFocalLength(t)},this.getFirstPersonFOV=function(){return i.firstPerson.camera.fov},this.setFirstPersonFOV=function(t){i.firstPerson.camera.fov=t,i.firstPerson.camera.updateProjectionMatrix()},this.getFirstPersonAspect=function(){return i.firstPerson.camera.aspect},this.setFirstPersonAspect=function(t){i.firstPerson.camera.aspect=t,i.firstPerson.camera.updateProjectionMatrix()},this.setCameraAzimuthElevation=function(t,e,n){i.firstPerson.controls.getObject().rotation.y=(180-t)*(Math.PI/180),i.firstPerson.controls.getPitchObject().rotation.x=e*(Math.PI/180)},this.update=function(){if(i.isFirstPerson){var t=performance.now(),e=(t-i.prevTime)/1e3;i.prevTime=t,i.velocity.x-=10*i.velocity.x*e,i.velocity.z-=10*i.velocity.z*e,i.velocity.y-=9.8*100*e,i.moveForward&&(i.velocity.z-=400*e),i.moveBackward&&(i.velocity.z+=400*e),i.moveLeft&&(i.velocity.x-=400*e),i.moveRight&&(i.velocity.x+=400*e);var n=yl.rotatePoint({x:i.velocity.x*e,y:i.velocity.z*e},[0,0],-i.firstPerson.controls.getObject().rotation.y);return i.isShift&&(n.x*=3,n.y*=3),new u(n.x,n.y)}return null},this.container=t,this.sceneContainer=e,this.reset(),this._init(n,r)}return t.prototype.reset=function(){this.camera=null,this.controls=null,this.orbit={camera:null,controls:null,near:.1,far:15e9},this.firstPerson={camera:null,controls:null,lockControls:!1,height:3},this.isFirstPerson=!1,this._={keepNear:!1,crosshair:null},this.isShift=!1,this.moveForward=null,this.moveBackward=null,this.moveLeft=null,this.moveRight=null,this.canJump=null,this.prevTime=performance.now(),this.velocity=new _},t.prototype._init=function(t,e){this.orbit.camera=new Ue(60,this.sceneContainer.offsetWidth/this.sceneContainer.offsetHeight,this.orbit.near,this.orbit.far),this.orbit.camera.up=new _(0,-1,0),this.orbit.camera.position.set(0,-1e7/e.radiusScale,0),this.orbit.controls=new ml(this.orbit.camera,this.sceneContainer),this.orbit.controls.enabled=!0,this.orbit.controls.enableDamping=!0,this.orbit.controls.dampingFactor=.2,this.orbit.controls.target.y=1,this.orbit.controls.mouseButtons.ORBIT=o,this.orbit.controls.mouseButtons.PAN=r,this.orbit.controls.maxDistance=4*e.radii.major,this.orbit.controls.maxPolarAngle=Math.PI/2,this.orbit.controls.enablePan=!1,this.firstPerson.camera=new Ue(60,this.sceneContainer.offsetWidth/this.sceneContainer.offsetHeight,.1,15e7),this.firstPerson.controls=new gl(this.firstPerson.camera),this.firstPerson.controls.getObject().rotation.set(Math.PI,Math.PI,0),this.firstPerson.controls.getObject().position.set(0,1e7/e.radiusScale,0),t.add(this.firstPerson.controls.getObject()),this.isFirstPerson?this.requestPointerLocking():(this.camera=this.orbit.camera,this.controls=this.orbit.controls),this.updateSize(),this.setupEvents(),this.orbit.controls.update()},t.prototype.swap=function(t,e){this.isFirstPerson=!this.isFirstPerson,this.isFirstPerson?(this.firstPerson.lockControls=t||!1,e||this.requestPointerLocking(),this.inToFirstPerson()):(this.outFromFirstPerson(),this.camera=this.orbit.camera,this.controls=this.orbit.controls)},t.prototype.inToFirstPerson=function(){this.isFirstPerson=!0,this.toggleCrosshair(!0),this.camera=this.firstPerson.camera,this.firstPerson.controls.enabled=!this.firstPerson.lockControls,this.controls=this.firstPerson.controls,this.orbit.controls.resetPosition()},t.prototype.outFromFirstPerson=function(){this.isFirstPerson=!1,this.toggleCrosshair(!1),this.firstPerson.controls.enabled=!1,this.camera=this.orbit.camera,this.controls=this.orbit.controls},t.prototype.toggleCrosshair=function(t){null==this._.crosshair&&(this._.crosshair=document.createElement("div"),this._.crosshair.id="_lithosphere_crosshair",this._.crosshair.style=["position: absolute","left: calc(50% - 10px)","top: calc(50% - 10px)","width: 18px","height: 18px","border-radius: 15px","border: 3px solid lime"].join(";"),this.container.appendChild(this._.crosshair)),this._.crosshair.style.display=t?"inherit":"none"},t.prototype.requestPointerLocking=function(){var t=this;if("pointerLockElement"in document){var e=document.body,n=function(){document.pointerLockElement===e?t.inToFirstPerson():t.outFromFirstPerson()},r=function(t){alert("Pointer Lock Error")};if(document.addEventListener("pointerlockchange",n,!1),document.addEventListener("mozpointerlockchange",n,!1),document.addEventListener("webkitpointerlockchange",n,!1),document.addEventListener("pointerlockerror",r,!1),document.addEventListener("mozpointerlockerror",r,!1),document.addEventListener("webkitpointerlockerror",r,!1),/Firefox/i.test(navigator.userAgent)){var i=function(){document.fullscreenElement===e&&(document.removeEventListener("fullscreenchange",i),document.removeEventListener("mozfullscreenchange",i),e.requestPointerLock())};document.addEventListener("fullscreenchange",i,!1),document.addEventListener("mozfullscreenchange",i,!1),e.requestFullscreen()}else e.requestPointerLock()}else this.isFirstPerson=!1,alert("This browser does not support Pointer Locking.")},t.prototype.setupEvents=function(){document.addEventListener("keydown",this.onKeyDown,!1),document.addEventListener("keyup",this.onKeyUp,!1),window.addEventListener("resize",this.updateSize,!1)},t}(),_l=484813681109536e-20,xl=Math.PI/2,wl=.017453292519943295,Ml=57.29577951308232,Sl=Math.PI/4,El=2*Math.PI,Tl=3.14159265359,Cl={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},Al={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},Pl=/[\s_\-\/\(\)]/g;function Ll(t,e){if(t[e])return t[e];for(var n,r=Object.keys(t),i=e.toLowerCase().replace(Pl,""),o=-1;++o<r.length;)if((n=r[o]).toLowerCase().replace(Pl,"")===i)return t[n]}var Rl=function(t){var e,n,r,i={},o=t.split("+").map((function(t){return t.trim()})).filter((function(t){return t})).reduce((function(t,e){var n=e.split("=");return n.push(!0),t[n[0].toLowerCase()]=n[1],t}),{}),s={proj:"projName",datum:"datumCode",rf:function(t){i.rf=parseFloat(t)},lat_0:function(t){i.lat0=t*wl},lat_1:function(t){i.lat1=t*wl},lat_2:function(t){i.lat2=t*wl},lat_ts:function(t){i.lat_ts=t*wl},lon_0:function(t){i.long0=t*wl},lon_1:function(t){i.long1=t*wl},lon_2:function(t){i.long2=t*wl},alpha:function(t){i.alpha=parseFloat(t)*wl},lonc:function(t){i.longc=t*wl},x_0:function(t){i.x0=parseFloat(t)},y_0:function(t){i.y0=parseFloat(t)},k_0:function(t){i.k0=parseFloat(t)},k:function(t){i.k0=parseFloat(t)},a:function(t){i.a=parseFloat(t)},b:function(t){i.b=parseFloat(t)},r_a:function(){i.R_A=!0},zone:function(t){i.zone=parseInt(t,10)},south:function(){i.utmSouth=!0},towgs84:function(t){i.datum_params=t.split(",").map((function(t){return parseFloat(t)}))},to_meter:function(t){i.to_meter=parseFloat(t)},units:function(t){i.units=t;var e=Ll(Al,t);e&&(i.to_meter=e.to_meter)},from_greenwich:function(t){i.from_greenwich=t*wl},pm:function(t){var e=Ll(Cl,t);i.from_greenwich=(e||parseFloat(t))*wl},nadgrids:function(t){"@null"===t?i.datumCode="none":i.nadgrids=t},axis:function(t){3===t.length&&-1!=="ewnsud".indexOf(t.substr(0,1))&&-1!=="ewnsud".indexOf(t.substr(1,1))&&-1!=="ewnsud".indexOf(t.substr(2,1))&&(i.axis=t)},approx:function(){i.approx=!0}};for(e in o)n=o[e],e in s?"function"==typeof(r=s[e])?r(n):i[r]=n:i[e]=n;return"string"==typeof i.datumCode&&"WGS84"!==i.datumCode&&(i.datumCode=i.datumCode.toLowerCase()),i},Ol=function(t){return new Fl(t).output()},kl=/\s/,Il=/[A-Za-z]/,Dl=/[A-Za-z84]/,Nl=/[,\]]/,jl=/[\d\.E\-\+]/;function Fl(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=1}function Bl(t,e,n){Array.isArray(e)&&(n.unshift(e),e=null);var r=e?{}:t,i=n.reduce((function(t,e){return zl(e,t),t}),r);e&&(t[e]=i)}function zl(t,e){if(Array.isArray(t)){var n=t.shift();if("PARAMETER"===n&&(n=t.shift()),1===t.length)return Array.isArray(t[0])?(e[n]={},void zl(t[0],e[n])):void(e[n]=t[0]);if(t.length)if("TOWGS84"!==n){if("AXIS"===n)return n in e||(e[n]=[]),void e[n].push(t);var r;switch(Array.isArray(n)||(e[n]={}),n){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[n]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&zl(t[2],e[n]));case"SPHEROID":case"ELLIPSOID":return e[n]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&zl(t[3],e[n]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void Bl(e,n,t);default:for(r=-1;++r<t.length;)if(!Array.isArray(t[r]))return zl(t,e[n]);return Bl(e,n,t)}}else e[n]=t;else e[n]=!0}else e[t]=!0}Fl.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;kl.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case 1:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},Fl.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(Nl.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},Fl.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=1)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=1,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},Fl.prototype.number=function(t){if(!jl.test(t)){if(Nl.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},Fl.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},Fl.prototype.keyword=function(t){if(Dl.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=1)}if(!Nl.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},Fl.prototype.neutral=function(t){if(Il.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(jl.test(t))return this.word=t,void(this.state=3);if(!Nl.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},Fl.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Ul(t){return.017453292519943295*t}var Hl=function(t){var e=Ol(t),n=e.shift(),r=e.shift();e.unshift(["name",r]),e.unshift(["type",n]);var i={};return zl(e,i),function(t){if("GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var e="",n=0,r=t.AXIS.length;n<r;++n){var i=t.AXIS[n][0].toLowerCase();-1!==i.indexOf("north")?e+="n":-1!==i.indexOf("south")?e+="s":-1!==i.indexOf("east")?e+="e":-1!==i.indexOf("west")&&(e+="w")}2===e.length&&(e+="u"),3===e.length&&(t.axis=e)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var o=t.GEOGCS;function s(e){return e*(t.to_meter||1)}"GEOGCS"===t.type&&(o=t),o&&(o.DATUM?t.datumCode=o.DATUM.name.toLowerCase():t.datumCode=o.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"!==t.datumCode&&"world_geodetic_system_1984"!==t.datumCode||("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(t.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=o.DATUM.SPHEROID.a,t.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(t.datum_params=o.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Ul],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Ul],["x0","false_easting",s],["y0","false_northing",s],["long0","central_meridian",Ul],["lat0","latitude_of_origin",Ul],["lat0","standard_parallel_1",Ul],["lat1","standard_parallel_1",Ul],["lat2","standard_parallel_2",Ul],["azimuth","Azimuth"],["alpha","azimuth",Ul],["srsCode","name"]].forEach((function(e){return n=t,i=(r=e)[0],o=r[1],void(!(i in n)&&o in n&&(n[i]=n[o],3===r.length&&(n[i]=r[2](n[i]))));var n,r,i,o})),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName||(t.lat0=Ul(t.lat1>0?90:-90),t.lat_ts=t.lat1)}(i),i};function Gl(t){var e=this;if(2===arguments.length){var n=arguments[1];"string"==typeof n?"+"===n.charAt(0)?Gl[t]=Rl(arguments[1]):Gl[t]=Hl(arguments[1]):Gl[t]=n}else if(1===arguments.length){if(Array.isArray(t))return t.map((function(t){Array.isArray(t)?Gl.apply(e,t):Gl(t)}));if("string"==typeof t){if(t in Gl)return Gl[t]}else"EPSG"in t?Gl["EPSG:"+t.EPSG]=t:"ESRI"in t?Gl["ESRI:"+t.ESRI]=t:"IAU2000"in t?Gl["IAU2000:"+t.IAU2000]=t:console.log(t);return}}!function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}(Gl);var Wl=Gl;var Vl=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];var ql=["3857","900913","3785","102113"];var Xl=function(t){if(!function(t){return"string"==typeof t}(t))return t;if(function(t){return t in Wl}(t))return Wl[t];if(function(t){return Vl.some((function(e){return t.indexOf(e)>-1}))}(t)){var e=Hl(t);if(function(t){var e=Ll(t,"authority");if(e){var n=Ll(e,"epsg");return n&&ql.indexOf(n)>-1}}(e))return Wl["EPSG:3857"];var n=function(t){var e=Ll(t,"extension");if(e)return Ll(e,"proj4")}(e);return n?Rl(n):e}return function(t){return"+"===t[0]}(t)?Rl(t):void 0},Yl=function(t,e){var n,r;if(t=t||{},!e)return t;for(r in e)void 0!==(n=e[r])&&(t[r]=n);return t},Zl=function(t,e,n){var r=t*e;return n/Math.sqrt(1-r*r)},Jl=function(t){return t<0?-1:1},Kl=function(t){return Math.abs(t)<=Tl?t:t-Jl(t)*El},Ql=function(t,e,n){var r=t*n,i=.5*t;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(xl-e))/r},$l=function(t,e){for(var n,r,i=.5*t,o=xl-2*Math.atan(e),s=0;s<=15;s++)if(n=t*Math.sin(o),o+=r=xl-2*Math.atan(e*Math.pow((1-n)/(1+n),i))-o,Math.abs(r)<=1e-10)return o;return-9999};function tc(t){return t}var ec=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Zl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var e,n,r=t.x,i=t.y;if(i*Ml>90&&i*Ml<-90&&r*Ml>180&&r*Ml<-180)return null;if(Math.abs(Math.abs(i)-xl)<=1e-10)return null;if(this.sphere)e=this.x0+this.a*this.k0*Kl(r-this.long0),n=this.y0+this.a*this.k0*Math.log(Math.tan(Sl+.5*i));else{var o=Math.sin(i),s=Ql(this.e,i,o);e=this.x0+this.a*this.k0*Kl(r-this.long0),n=this.y0-this.a*this.k0*Math.log(s)}return t.x=e,t.y=n,t},inverse:function(t){var e,n,r=t.x-this.x0,i=t.y-this.y0;if(this.sphere)n=xl-2*Math.atan(Math.exp(-i/(this.a*this.k0)));else{var o=Math.exp(-i/(this.a*this.k0));if(-9999===(n=$l(this.e,o)))return null}return e=Kl(this.long0+r/(this.a*this.k0)),t.x=e,t.y=n,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:tc,inverse:tc,names:["longlat","identity"]}],nc={},rc=[];function ic(t,e){var n=rc.length;return t.names?(rc[n]=t,t.names.forEach((function(t){nc[t.toLowerCase()]=n})),this):(console.log(e),!0)}var oc={start:function(){ec.forEach(ic)},add:ic,get:function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==nc[e]&&rc[nc[e]]?rc[nc[e]]:void 0}},sc={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},ac=sc.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};sc.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var lc={};lc.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},lc.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},lc.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},lc.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},lc.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},lc.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},lc.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},lc.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},lc.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},lc.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},lc.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},lc.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},lc.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},lc.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},lc.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},lc.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},lc.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};var cc=function(t,e,n,r,i,o,s){var a={};return a.datum_type=void 0===t||"none"===t?5:4,e&&(a.datum_params=e.map(parseFloat),0===a.datum_params[0]&&0===a.datum_params[1]&&0===a.datum_params[2]||(a.datum_type=1),a.datum_params.length>3&&(0===a.datum_params[3]&&0===a.datum_params[4]&&0===a.datum_params[5]&&0===a.datum_params[6]||(a.datum_type=2,a.datum_params[3]*=_l,a.datum_params[4]*=_l,a.datum_params[5]*=_l,a.datum_params[6]=a.datum_params[6]/1e6+1))),s&&(a.datum_type=3,a.grids=s),a.a=n,a.b=r,a.es=i,a.ep2=o,a},uc={};function hc(t){if(0===t.length)return null;var e="@"===t[0];return e&&(t=t.slice(1)),"null"===t?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:uc[t]||null,isNull:!1}}function fc(t){return t/3600*Math.PI/180}function dc(t,e,n){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,n)))}function pc(t){return t.map((function(t){return[fc(t.longitudeShift),fc(t.latitudeShift)]}))}function mc(t,e,n){return{name:dc(t,e+8,e+16).trim(),parent:dc(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,n),upperLatitude:t.getFloat64(e+88,n),lowerLongitude:t.getFloat64(e+104,n),upperLongitude:t.getFloat64(e+120,n),latitudeInterval:t.getFloat64(e+136,n),longitudeInterval:t.getFloat64(e+152,n),gridNodeCount:t.getInt32(e+168,n)}}function gc(t,e,n,r){for(var i=e+176,o=[],s=0;s<n.gridNodeCount;s++){var a={latitudeShift:t.getFloat32(i+16*s,r),longitudeShift:t.getFloat32(i+16*s+4,r),latitudeAccuracy:t.getFloat32(i+16*s+8,r),longitudeAccuracy:t.getFloat32(i+16*s+12,r)};o.push(a)}return o}function vc(t,e){if(!(this instanceof vc))return new vc(t);e=e||function(t){if(t)throw t};var n=Xl(t);if("object"==typeof n){var r=vc.projections.get(n.projName);if(r){if(n.datumCode&&"none"!==n.datumCode){var i=Ll(lc,n.datumCode);i&&(n.datum_params=i.towgs84?i.towgs84.split(","):null,n.ellps=i.ellipse,n.datumName=i.datumName?i.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84";var o,s,a,l,c,u,h,f=function(t,e,n,r,i){if(!t){var o=Ll(sc,r);o||(o=ac),t=o.a,e=o.b,n=o.rf}return n&&!e&&(e=(1-1/n)*t),(0===n||Math.abs(t-e)<1e-10)&&(i=!0,e=t),{a:t,b:e,rf:n,sphere:i}}(n.a,n.b,n.rf,n.ellps,n.sphere),d=(o=f.a,s=f.b,f.rf,a=n.R_A,u=((l=o*o)-(c=s*s))/l,h=0,a?(l=(o*=1-u*(.16666666666666666+u*(.04722222222222222+.022156084656084655*u)))*o,u=0):h=Math.sqrt(u),{es:u,e:h,ep2:(l-c)/c}),p=function(t){return void 0===t?null:t.split(",").map(hc)}(n.nadgrids),m=n.datum||cc(n.datumCode,n.datum_params,f.a,f.b,d.es,d.ep2,p);Yl(this,n),Yl(this,r),this.a=f.a,this.b=f.b,this.rf=f.rf,this.sphere=f.sphere,this.es=d.es,this.e=d.e,this.ep2=d.ep2,this.datum=m,this.init(),e(null,this)}else e(t)}else e(t)}vc.projections=oc,vc.projections.start();var yc=vc;function bc(t,e,n){var r,i,o,s,a=t.x,l=t.y,c=t.z?t.z:0;if(l<-xl&&l>-1.001*xl)l=-xl;else if(l>xl&&l<1.001*xl)l=xl;else{if(l<-xl)return{x:-1/0,y:-1/0,z:t.z};if(l>xl)return{x:1/0,y:1/0,z:t.z}}return a>Math.PI&&(a-=2*Math.PI),i=Math.sin(l),s=Math.cos(l),o=i*i,{x:((r=n/Math.sqrt(1-e*o))+c)*s*Math.cos(a),y:(r+c)*s*Math.sin(a),z:(r*(1-e)+c)*i}}function _c(t,e,n,r){var i,o,s,a,l,c,u,h,f,d,p,m,g,v,y,b=t.x,_=t.y,x=t.z?t.z:0;if(i=Math.sqrt(b*b+_*_),o=Math.sqrt(b*b+_*_+x*x),i/n<1e-12){if(v=0,o/n<1e-12)return xl,y=-r,{x:t.x,y:t.y,z:t.z}}else v=Math.atan2(_,b);s=x/o,h=(a=i/o)*(1-e)*(l=1/Math.sqrt(1-e*(2-e)*a*a)),f=s*l,g=0;do{g++,c=e*(u=n/Math.sqrt(1-e*f*f))/(u+(y=i*h+x*f-u*(1-e*f*f))),m=(p=s*(l=1/Math.sqrt(1-c*(2-c)*a*a)))*h-(d=a*(1-c)*l)*f,h=d,f=p}while(m*m>1e-24&&g<30);return{x:v,y:Math.atan(p/Math.abs(d)),z:y}}function xc(t){return 1===t||2===t}var wc=function(t,e,n){if(function(t,e){return t.datum_type===e.datum_type&&(!(t.a!==e.a||Math.abs(t.es-e.es)>5e-11)&&(1===t.datum_type?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:2!==t.datum_type||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6]))}(t,e))return n;if(5===t.datum_type||5===e.datum_type)return n;var r=t.a,i=t.es;if(3===t.datum_type){if(0!==Mc(t,!1,n))return;r=6378137,i=.0066943799901413165}var o=e.a,s=e.b,a=e.es;if(3===e.datum_type&&(o=6378137,s=6356752.314,a=.0066943799901413165),i===a&&r===o&&!xc(t.datum_type)&&!xc(e.datum_type))return n;if((n=bc(n,i,r),xc(t.datum_type)&&(n=function(t,e,n){if(1===e)return{x:t.x+n[0],y:t.y+n[1],z:t.z+n[2]};if(2===e){var r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],l=n[5],c=n[6];return{x:c*(t.x-l*t.y+a*t.z)+r,y:c*(l*t.x+t.y-s*t.z)+i,z:c*(-a*t.x+s*t.y+t.z)+o}}}(n,t.datum_type,t.datum_params)),xc(e.datum_type)&&(n=function(t,e,n){if(1===e)return{x:t.x-n[0],y:t.y-n[1],z:t.z-n[2]};if(2===e){var r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],l=n[5],c=n[6],u=(t.x-r)/c,h=(t.y-i)/c,f=(t.z-o)/c;return{x:u+l*h-a*f,y:-l*u+h+s*f,z:a*u-s*h+f}}}(n,e.datum_type,e.datum_params)),n=_c(n,a,o,s),3===e.datum_type)&&0!==Mc(e,!0,n))return;return n};function Mc(t,e,n){if(null===t.grids||0===t.grids.length)return console.log("Grid shift grids not found"),-1;for(var r={x:-n.x,y:n.y},i={x:Number.NaN,y:Number.NaN},o=[],s=0;s<t.grids.length;s++){var a=t.grids[s];if(o.push(a.name),a.isNull){i=r;break}if(a.mandatory,null!==a.grid){var l=a.grid.subgrids[0],c=(Math.abs(l.del[1])+Math.abs(l.del[0]))/1e4,u=l.ll[0]-c,h=l.ll[1]-c,f=l.ll[0]+(l.lim[0]-1)*l.del[0]+c,d=l.ll[1]+(l.lim[1]-1)*l.del[1]+c;if(!(h>r.y||u>r.x||d<r.y||f<r.x||(i=Sc(r,e,l),isNaN(i.x))))break}else if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*Ml+" "+r.y*Ml+" tried: '"+o+"'"),-1):(n.x=-i.x,n.y=i.y,0)}function Sc(t,e,n){var r={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return r;var i={x:t.x,y:t.y};i.x-=n.ll[0],i.y-=n.ll[1],i.x=Kl(i.x-Math.PI)+Math.PI;var o=Ec(i,n);if(e){if(isNaN(o.x))return r;o.x=i.x-o.x,o.y=i.y-o.y;var s,a,l=9;do{if(a=Ec(o,n),isNaN(a.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}s={x:i.x-(a.x+o.x),y:i.y-(a.y+o.y)},o.x+=s.x,o.y+=s.y}while(l--&&Math.abs(s.x)>1e-12&&Math.abs(s.y)>1e-12);if(l<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=Kl(o.x+n.ll[0]),r.y=o.y+n.ll[1]}else isNaN(o.x)||(r.x=t.x+o.x,r.y=t.y+o.y);return r}function Ec(t,e){var n,r={x:t.x/e.del[0],y:t.y/e.del[1]},i=Math.floor(r.x),o=Math.floor(r.y),s=r.x-1*i,a=r.y-1*o,l={x:Number.NaN,y:Number.NaN};if(i<0||i>=e.lim[0])return l;if(o<0||o>=e.lim[1])return l;n=o*e.lim[0]+i;var c=e.cvs[n][0],u=e.cvs[n][1];n++;var h=e.cvs[n][0],f=e.cvs[n][1];n+=e.lim[0];var d=e.cvs[n][0],p=e.cvs[n][1];n--;var m=e.cvs[n][0],g=e.cvs[n][1],v=s*a,y=s*(1-a),b=(1-s)*(1-a),_=(1-s)*a;return l.x=b*c+y*h+_*m+v*d,l.y=b*u+y*f+_*g+v*p,l}var Tc=function(t,e,n){var r,i,o,s=n.x,a=n.y,l=n.z||0,c={};for(o=0;o<3;o++)if(!e||2!==o||void 0!==n.z)switch(0===o?(r=s,i=-1!=="ew".indexOf(t.axis[o])?"x":"y"):1===o?(r=a,i=-1!=="ns".indexOf(t.axis[o])?"y":"x"):(r=l,i="z"),t.axis[o]){case"e":c[i]=r;break;case"w":c[i]=-r;break;case"n":c[i]=r;break;case"s":c[i]=-r;break;case"u":void 0!==n[i]&&(c.z=r);break;case"d":void 0!==n[i]&&(c.z=-r);break;default:return null}return c},Cc=function(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e};function Ac(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function Pc(t,e,n){var r;if(Array.isArray(n)&&(n=Cc(n)),function(t){Ac(t.x),Ac(t.y)}(n),t.datum&&e.datum&&function(t,e){return(1===t.datum.datum_type||2===t.datum.datum_type)&&"WGS84"!==e.datumCode||(1===e.datum.datum_type||2===e.datum.datum_type)&&"WGS84"!==t.datumCode}(t,e)&&(n=Pc(t,r=new yc("WGS84"),n),t=r),"enu"!==t.axis&&(n=Tc(t,!1,n)),"longlat"===t.projName)n={x:n.x*wl,y:n.y*wl,z:n.z||0};else if(t.to_meter&&(n={x:n.x*t.to_meter,y:n.y*t.to_meter,z:n.z||0}),!(n=t.inverse(n)))return;if(t.from_greenwich&&(n.x+=t.from_greenwich),n=wc(t.datum,e.datum,n))return e.from_greenwich&&(n={x:n.x-e.from_greenwich,y:n.y,z:n.z||0}),"longlat"===e.projName?n={x:n.x*Ml,y:n.y*Ml,z:n.z||0}:(n=e.forward(n),e.to_meter&&(n={x:n.x/e.to_meter,y:n.y/e.to_meter,z:n.z||0})),"enu"!==e.axis?Tc(e,!0,n):n}var Lc=yc("WGS84");function Rc(t,e,n){var r,i,o;return Array.isArray(n)?(r=Pc(t,e,n)||{x:NaN,y:NaN},n.length>2?void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name?"number"==typeof r.z?[r.x,r.y,r.z].concat(n.splice(3)):[r.x,r.y,n[2]].concat(n.splice(3)):[r.x,r.y].concat(n.splice(2)):[r.x,r.y]):(i=Pc(t,e,n),2===(o=Object.keys(n)).length||o.forEach((function(r){if(void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name){if("x"===r||"y"===r||"z"===r)return}else if("x"===r||"y"===r)return;i[r]=n[r]})),i)}function Oc(t){return t instanceof yc?t:t.oProj?t.oProj:yc(t)}var kc=function(t,e,n){t=Oc(t);var r,i=!1;return void 0===e?(e=t,t=Lc,i=!0):(void 0!==e.x||Array.isArray(e))&&(n=e,e=t,t=Lc,i=!0),e=Oc(e),n?Rc(t,e,n):(r={forward:function(n){return Rc(t,e,n)},inverse:function(n){return Rc(e,t,n)}},i&&(r.oProj=e),r)},Ic=73,Dc=79,Nc={forward:jc,inverse:function(t){var e=Uc(Wc(t.toUpperCase()));if(e.lat&&e.lon)return[e.lon,e.lat,e.lon,e.lat];return[e.left,e.bottom,e.right,e.top]},toPoint:Fc};function jc(t,e){return e=e||5,function(t,e){var n="00000"+t.easting,r="00000"+t.northing;return t.zoneNumber+t.zoneLetter+(d=t.easting,p=t.northing,m=t.zoneNumber,g=Gc(m),v=Math.floor(d/1e5),y=Math.floor(p/1e5)%20,i=v,o=y,s=g,a=s-1,l="AJSAJS".charCodeAt(a),c="AFAFAF".charCodeAt(a),u=l+i-1,h=c+o,f=!1,u>90&&(u=u-90+65-1,f=!0),(u===Ic||l<Ic&&u>Ic||(u>Ic||l<Ic)&&f)&&u++,(u===Dc||l<Dc&&u>Dc||(u>Dc||l<Dc)&&f)&&++u===Ic&&u++,u>90&&(u=u-90+65-1),h>86?(h=h-86+65-1,f=!0):f=!1,(h===Ic||c<Ic&&h>Ic||(h>Ic||c<Ic)&&f)&&h++,(h===Dc||c<Dc&&h>Dc||(h>Dc||c<Dc)&&f)&&++h===Ic&&h++,h>86&&(h=h-86+65-1),String.fromCharCode(u)+String.fromCharCode(h))+n.substr(n.length-5,e)+r.substr(r.length-5,e);var i,o,s,a,l,c,u,h,f;var d,p,m,g,v,y}(function(t){var e,n,r,i,o,s,a,l=t.lat,c=t.lon,u=6378137,h=Bc(l),f=Bc(c);a=Math.floor((c+180)/6)+1,180===c&&(a=60);l>=56&&l<64&&c>=3&&c<12&&(a=32);l>=72&&l<84&&(c>=0&&c<9?a=31:c>=9&&c<21?a=33:c>=21&&c<33?a=35:c>=33&&c<42&&(a=37));s=Bc(6*(a-1)-180+3),.006739496752268451,e=u/Math.sqrt(1-.00669438*Math.sin(h)*Math.sin(h)),n=Math.tan(h)*Math.tan(h),r=.006739496752268451*Math.cos(h)*Math.cos(h),i=Math.cos(h)*(f-s),o=u*(.9983242984503243*h-.002514607064228144*Math.sin(2*h)+2639046602129982e-21*Math.sin(4*h)-3.418046101696858e-9*Math.sin(6*h));var d=.9996*e*(i+(1-n+r)*i*i*i/6+(5-18*n+n*n+72*r-.39089081163157013)*i*i*i*i*i/120)+5e5,p=.9996*(o+e*Math.tan(h)*(i*i/2+(5-n+9*r+4*r*r)*i*i*i*i/24+(61-58*n+n*n+600*r-2.2240339282485886)*i*i*i*i*i*i/720));l<0&&(p+=1e7);return{northing:Math.round(p),easting:Math.round(d),zoneNumber:a,zoneLetter:Hc(l)}}({lat:t[1],lon:t[0]}),e)}function Fc(t){var e=Uc(Wc(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Bc(t){return t*(Math.PI/180)}function zc(t){return t/Math.PI*180}function Uc(t){var e=t.northing,n=t.easting,r=t.zoneLetter,i=t.zoneNumber;if(i<0||i>60)return null;var o,s,a,l,c,u,h,f,d=6378137,p=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),m=n-5e5,g=e;r<"N"&&(g-=1e7),u=6*(i-1)-180+3,f=(h=g/.9996/6367449.145945056)+(3*p/2-27*p*p*p/32)*Math.sin(2*h)+(21*p*p/16-55*p*p*p*p/32)*Math.sin(4*h)+151*p*p*p/96*Math.sin(6*h),o=d/Math.sqrt(1-.00669438*Math.sin(f)*Math.sin(f)),s=Math.tan(f)*Math.tan(f),a=.006739496752268451*Math.cos(f)*Math.cos(f),l=.99330562*d/Math.pow(1-.00669438*Math.sin(f)*Math.sin(f),1.5),c=m/(.9996*o);var v=f-o*Math.tan(f)/l*(c*c/2-(5+3*s+10*a-4*a*a-.06065547077041606)*c*c*c*c/24+(61+90*s+298*a+45*s*s-1.6983531815716497-3*a*a)*c*c*c*c*c*c/720);v=zc(v);var y,b=(c-(1+2*s+a)*c*c*c/6+(5-2*a+28*s-3*a*a+.05391597401814761+24*s*s)*c*c*c*c*c/120)/Math.cos(f);if(b=u+zc(b),t.accuracy){var _=Uc({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});y={top:_.lat,right:_.lon,bottom:v,left:b}}else y={lat:v,lon:b};return y}function Hc(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function Gc(t){var e=t%6;return 0===e&&(e=6),e}function Wc(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,n=t.length,r=null,i="",o=0;!/[A-Z]/.test(e=t.charAt(o));){if(o>=2)throw"MGRSPoint bad conversion from: "+t;i+=e,o++}var s=parseInt(i,10);if(0===o||o+3>n)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(o++);if(a<="A"||"B"===a||"Y"===a||a>="Z"||"I"===a||"O"===a)throw"MGRSPoint zone letter "+a+" not handled: "+t;r=t.substring(o,o+=2);for(var l=Gc(s),c=function(t,e){var n="AJSAJS".charCodeAt(e-1),r=1e5,i=!1;for(;n!==t.charCodeAt(0);){if(++n===Ic&&n++,n===Dc&&n++,n>90){if(i)throw"Bad character: "+t;n=65,i=!0}r+=1e5}return r}(r.charAt(0),l),u=function(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;var n="AFAFAF".charCodeAt(e-1),r=0,i=!1;for(;n!==t.charCodeAt(0);){if(++n===Ic&&n++,n===Dc&&n++,n>86){if(i)throw"Bad character: "+t;n=65,i=!0}r+=1e5}return r}(r.charAt(1),l);u<Vc(a);)u+=2e6;var h=n-o;if(h%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var f,d,p,m=h/2,g=0,v=0;return m>0&&(f=1e5/Math.pow(10,m),d=t.substring(o,o+m),g=parseFloat(d)*f,p=t.substring(o+m),v=parseFloat(p)*f),{easting:g+c,northing:v+u,zoneLetter:a,zoneNumber:s,accuracy:f}}function Vc(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function qc(t,e,n){if(!(this instanceof qc))return new qc(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var r=t.split(",");this.x=parseFloat(r[0],10),this.y=parseFloat(r[1],10),this.z=parseFloat(r[2],10)||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}qc.fromMGRS=function(t){return new qc(Fc(t))},qc.prototype.toMGRS=function(t){return jc([this.x,this.y],t)};var Xc=qc,Yc=.01068115234375,Zc=function(t){var e=[];e[0]=1-t*(.25+t*(.046875+t*(.01953125+t*Yc))),e[1]=t*(.75-t*(.046875+t*(.01953125+t*Yc)));var n=t*t;return e[2]=n*(.46875-t*(.013020833333333334+.007120768229166667*t)),n*=t,e[3]=n*(.3645833333333333-.005696614583333333*t),e[4]=n*t*.3076171875,e},Jc=function(t,e,n,r){return n*=e,e*=e,r[0]*t-n*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))},Kc=function(t,e,n){for(var r=1/(1-e),i=t,o=20;o;--o){var s=Math.sin(i),a=1-e*s*s;if(i-=a=(Jc(i,s,Math.cos(i),n)-t)*(a*Math.sqrt(a))*r,Math.abs(a)<1e-10)return i}return i};var Qc={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Zc(this.es),this.ml0=Jc(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,n,r,i=t.x,o=t.y,s=Kl(i-this.long0),a=Math.sin(o),l=Math.cos(o);if(this.es){var c=l*s,u=Math.pow(c,2),h=this.ep2*Math.pow(l,2),f=Math.pow(h,2),d=Math.abs(l)>1e-10?Math.tan(o):0,p=Math.pow(d,2),m=Math.pow(p,2);e=1-this.es*Math.pow(a,2),c/=Math.sqrt(e);var g=Jc(o,a,l,this.en);n=this.a*(this.k0*c*(1+u/6*(1-p+h+u/20*(5-18*p+m+14*h-58*p*h+u/42*(61+179*m-m*p-479*p)))))+this.x0,r=this.a*(this.k0*(g-this.ml0+a*s*c/2*(1+u/12*(5-p+9*h+4*f+u/30*(61+m-58*p+270*h-330*p*h+u/56*(1385+543*m-m*p-3111*p))))))+this.y0}else{var v=l*Math.sin(s);if(Math.abs(Math.abs(v)-1)<1e-10)return 93;if(n=.5*this.a*this.k0*Math.log((1+v)/(1-v))+this.x0,r=l*Math.cos(s)/Math.sqrt(1-Math.pow(v,2)),(v=Math.abs(r))>=1){if(v-1>1e-10)return 93;r=0}else r=Math.acos(r);o<0&&(r=-r),r=this.a*this.k0*(r-this.lat0)+this.y0}return t.x=n,t.y=r,t},inverse:function(t){var e,n,r,i,o=(t.x-this.x0)*(1/this.a),s=(t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+s/this.k0,n=Kc(e,this.es,this.en),Math.abs(n)<xl){var a=Math.sin(n),l=Math.cos(n),c=Math.abs(l)>1e-10?Math.tan(n):0,u=this.ep2*Math.pow(l,2),h=Math.pow(u,2),f=Math.pow(c,2),d=Math.pow(f,2);e=1-this.es*Math.pow(a,2);var p=o*Math.sqrt(e)/this.k0,m=Math.pow(p,2);r=n-(e*=c)*m/(1-this.es)*.5*(1-m/12*(5+3*f-9*u*f+u-4*h-m/30*(61+90*f-252*u*f+45*d+46*u-m/56*(1385+3633*f+4095*d+1574*d*f)))),i=Kl(this.long0+p*(1-m/6*(1+2*f+u-m/20*(5+28*f+24*d+8*u*f+6*u-m/42*(61+662*f+1320*d+720*d*f))))/l)}else r=xl*Jl(s),i=0;else{var g=Math.exp(o/this.k0),v=.5*(g-1/g),y=this.lat0+s/this.k0,b=Math.cos(y);e=Math.sqrt((1-Math.pow(b,2))/(1+Math.pow(v,2))),r=Math.asin(e),s<0&&(r=-r),i=0===v&&0===b?0:Kl(Math.atan2(v,b)+this.long0)}return t.x=i,t.y=r,t},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]},$c=function(t){var e=Math.exp(t);return e=(e-1/e)/2},tu=function(t,e){t=Math.abs(t),e=Math.abs(e);var n=Math.max(t,e),r=Math.min(t,e)/(n||1);return n*Math.sqrt(1+Math.pow(r,2))},eu=function(t){var e=Math.abs(t);return e=function(t){var e=1+t,n=e-1;return 0===n?t:t*Math.log(e)/n}(e*(1+e/(tu(1,e)+1))),t<0?-e:e},nu=function(t,e){for(var n,r=2*Math.cos(2*e),i=t.length-1,o=t[i],s=0;--i>=0;)n=r*o-s+t[i],s=o,o=n;return e+n*Math.sin(2*e)},ru=function(t,e,n){for(var r,i,o=Math.sin(e),s=Math.cos(e),a=$c(n),l=function(t){var e=Math.exp(t);return e=(e+1/e)/2}(n),c=2*s*l,u=-2*o*a,h=t.length-1,f=t[h],d=0,p=0,m=0;--h>=0;)r=p,i=d,f=c*(p=f)-r-u*(d=m)+t[h],m=u*p-i+c*d;return[(c=o*l)*f-(u=s*a)*m,c*m+u*f]};var iu={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Qc.init.apply(this),this.forward=Qc.forward,this.inverse=Qc.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),n=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),n*=e,this.cgb[1]=n*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=n*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),n*=e,this.cgb[2]=n*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=n*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),n*=e,this.cgb[3]=n*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=n*(1237/630+e*(e*(-24832/14175)-2.4)),n*=e,this.cgb[4]=n*(4174/315+e*(-144838/6237)),this.cbg[4]=n*(-734/315+e*(109598/31185)),n*=e,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=n*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=n*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),n*=e,this.utg[2]=n*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=n*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),n*=e,this.utg[3]=n*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=n*(49561/161280+e*(-179/168+e*(6601661/7257600))),n*=e,this.utg[4]=n*(-4583/161280+e*(108847/3991680)),this.gtu[4]=n*(34729/80640+e*(-3418889/1995840)),n*=e,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=.6650675310896665*n;var r=nu(this.cbg,this.lat0);this.Zb=-this.Qn*(r+function(t,e){for(var n,r=2*Math.cos(e),i=t.length-1,o=t[i],s=0;--i>=0;)n=r*o-s+t[i],s=o,o=n;return Math.sin(e)*n}(this.gtu,2*r))},forward:function(t){var e=Kl(t.x-this.long0),n=t.y;n=nu(this.cbg,n);var r=Math.sin(n),i=Math.cos(n),o=Math.sin(e),s=Math.cos(e);n=Math.atan2(r,s*i),e=Math.atan2(o*i,tu(r,i*s)),e=eu(Math.tan(e));var a,l,c=ru(this.gtu,2*n,2*e);return n+=c[0],e+=c[1],Math.abs(e)<=2.623395162778?(a=this.a*(this.Qn*e)+this.x0,l=this.a*(this.Qn*n+this.Zb)+this.y0):(a=1/0,l=1/0),t.x=a,t.y=l,t},inverse:function(t){var e,n,r=(t.x-this.x0)*(1/this.a),i=(t.y-this.y0)*(1/this.a);if(i=(i-this.Zb)/this.Qn,r/=this.Qn,Math.abs(r)<=2.623395162778){var o=ru(this.utg,2*i,2*r);i+=o[0],r+=o[1],r=Math.atan($c(r));var s=Math.sin(i),a=Math.cos(i),l=Math.sin(r),c=Math.cos(r);i=Math.atan2(s*c,tu(l,c*a)),r=Math.atan2(l,c*a),e=Kl(r+this.long0),n=nu(this.cgb,i)}else e=1/0,n=1/0;return t.x=e,t.y=n,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"]};var ou={init:function(){var t=function(t,e){if(void 0===t){if((t=Math.floor(30*(Kl(e)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t}(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*wl,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,iu.init.apply(this),this.forward=iu.forward,this.inverse=iu.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},su=function(t,e){return Math.pow((1-t)/(1+t),e)};var au={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Sl)/(Math.pow(Math.tan(.5*this.lat0+Sl),this.C)*su(this.e*t,this.ratexp))},forward:function(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+Sl),this.C)*su(this.e*Math.sin(n),this.ratexp))-xl,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,n=t.y,r=Math.pow(Math.tan(.5*n+Sl)/this.K,1/this.C),i=20;i>0&&(n=2*Math.atan(r*su(this.e*Math.sin(t.y),-.5*this.e))-xl,!(Math.abs(n-t.y)<1e-14));--i)t.y=n;return i?(t.x=e,t.y=n,t):null},names:["gauss"]};var lu={init:function(){au.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,n,r,i;return t.x=Kl(t.x-this.long0),au.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*r),t.x=i*n*Math.sin(t.x),t.y=i*(this.cosc0*e-this.sinc0*n*r),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,n,r,i,o;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,o=Math.sqrt(t.x*t.x+t.y*t.y)){var s=2*Math.atan2(o,this.R2);e=Math.sin(s),n=Math.cos(s),i=Math.asin(n*this.sinc0+t.y*e*this.cosc0/o),r=Math.atan2(t.x*e,o*this.cosc0*n-t.y*this.sinc0*e)}else i=this.phic0,r=0;return t.x=r,t.y=i,au.inverse.apply(this,[t]),t.x=Kl(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]};var cu={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=1e-10&&(this.k0=.5*(1+Jl(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=1e-10&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=1e-10&&(this.k0=.5*this.cons*Zl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Ql(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Zl(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-xl,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,n,r,i,o,s,a=t.x,l=t.y,c=Math.sin(l),u=Math.cos(l),h=Kl(a-this.long0);return Math.abs(Math.abs(a-this.long0)-Math.PI)<=1e-10&&Math.abs(l+this.lat0)<=1e-10?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*c+this.coslat0*u*Math.cos(h)),t.x=this.a*e*u*Math.sin(h)+this.x0,t.y=this.a*e*(this.coslat0*c-this.sinlat0*u*Math.cos(h))+this.y0,t):(n=2*Math.atan(this.ssfn_(l,c,this.e))-xl,i=Math.cos(n),r=Math.sin(n),Math.abs(this.coslat0)<=1e-10?(o=Ql(this.e,l*this.con,this.con*c),s=2*this.a*this.k0*o/this.cons,t.x=this.x0+s*Math.sin(a-this.long0),t.y=this.y0-this.con*s*Math.cos(a-this.long0),t):(Math.abs(this.sinlat0)<1e-10?(e=2*this.a*this.k0/(1+i*Math.cos(h)),t.y=e*r):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*r+this.cosX0*i*Math.cos(h))),t.y=e*(this.cosX0*r-this.sinX0*i*Math.cos(h))+this.y0),t.x=e*i*Math.sin(h)+this.x0,t))},inverse:function(t){var e,n,r,i,o;t.x-=this.x0,t.y-=this.y0;var s=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var a=2*Math.atan(s/(2*this.a*this.k0));return e=this.long0,n=this.lat0,s<=1e-10?(t.x=e,t.y=n,t):(n=Math.asin(Math.cos(a)*this.sinlat0+t.y*Math.sin(a)*this.coslat0/s),e=Math.abs(this.coslat0)<1e-10?this.lat0>0?Kl(this.long0+Math.atan2(t.x,-1*t.y)):Kl(this.long0+Math.atan2(t.x,t.y)):Kl(this.long0+Math.atan2(t.x*Math.sin(a),s*this.coslat0*Math.cos(a)-t.y*this.sinlat0*Math.sin(a))),t.x=e,t.y=n,t)}if(Math.abs(this.coslat0)<=1e-10){if(s<=1e-10)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,r=s*this.cons/(2*this.a*this.k0),n=this.con*$l(this.e,r),e=this.con*Kl(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else i=2*Math.atan(s*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,s<=1e-10?o=this.X0:(o=Math.asin(Math.cos(i)*this.sinX0+t.y*Math.sin(i)*this.cosX0/s),e=Kl(this.long0+Math.atan2(t.x*Math.sin(i),s*this.cosX0*Math.cos(i)-t.y*this.sinX0*Math.sin(i)))),n=-1*$l(this.e,Math.tan(.5*(xl+o)));return t.x=e,t.y=n,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(t,e,n){return e*=n,Math.tan(.5*(xl+t))*Math.pow((1-e)/(1+e),.5*n)}};var uu={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,r=1/this.rf,i=2*r-Math.pow(r,2),o=this.e=Math.sqrt(i);this.R=this.k0*n*Math.sqrt(1-i)/(1-i*Math.pow(e,2)),this.alpha=Math.sqrt(1+i/(1-i)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),a=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+o*e)/(1-o*e));this.K=s-this.alpha*a+this.alpha*o/2*l},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),r=-this.alpha*(e+n)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),o=this.alpha*(t.x-this.lambda0),s=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(o))),a=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(o));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*s+this.x0,t},inverse:function(t){for(var e=t.x-this.x0,n=t.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),s=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),a=this.lambda0+s/this.alpha,l=0,c=o,u=-1e3,h=0;Math.abs(c-u)>1e-7;){if(++h>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(c))/2)),u=c,c=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=a,t.y=c,t},names:["somerc"]};var hu={init:function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var t=Math.sin(this.lat0),e=Math.cos(this.lat0),n=this.e*t;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(e,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-n*n);var r,i,o=Ql(this.e,this.lat0,t),s=this.bl/e*Math.sqrt((1-this.es)/(1-n*n));if(s*s<1&&(s=1),isNaN(this.longc)){var a=Ql(this.e,this.lat1,Math.sin(this.lat1)),l=Ql(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(s+Math.sqrt(s*s-1))*Math.pow(o,this.bl):this.el=(s-Math.sqrt(s*s-1))*Math.pow(o,this.bl);var c=Math.pow(a,this.bl),u=Math.pow(l,this.bl);i=.5*((r=this.el/c)-1/r);var h=(this.el*this.el-u*c)/(this.el*this.el+u*c),f=(u-c)/(u+c),d=Kl(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(h*Math.tan(.5*this.bl*d)/f)/this.bl,this.long0=Kl(this.long0);var p=Kl(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*p)/i),this.alpha=Math.asin(s*Math.sin(this.gamma0))}else r=this.lat0>=0?s+Math.sqrt(s*s-1):s-Math.sqrt(s*s-1),this.el=r*Math.pow(o,this.bl),i=.5*(r-1/r),this.gamma0=Math.asin(Math.sin(this.alpha)/s),this.long0=this.longc-Math.asin(i*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(s*s-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(s*s-1),Math.cos(this.alpha))},forward:function(t){var e,n,r,i=t.x,o=t.y,s=Kl(i-this.long0);if(Math.abs(Math.abs(o)-xl)<=1e-10)r=o>0?-1:1,n=this.al/this.bl*Math.log(Math.tan(Sl+r*this.gamma0*.5)),e=-1*r*xl*this.al/this.bl;else{var a=Ql(this.e,o,Math.sin(o)),l=this.el/Math.pow(a,this.bl),c=.5*(l-1/l),u=.5*(l+1/l),h=Math.sin(this.bl*s),f=(c*Math.sin(this.gamma0)-h*Math.cos(this.gamma0))/u;n=Math.abs(Math.abs(f)-1)<=1e-10?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-f)/(1+f))/this.bl,e=Math.abs(Math.cos(this.bl*s))<=1e-10?this.al*this.bl*s:this.al*Math.atan2(c*Math.cos(this.gamma0)+h*Math.sin(this.gamma0),Math.cos(this.bl*s))/this.bl}return this.no_rot?(t.x=this.x0+e,t.y=this.y0+n):(e-=this.uc,t.x=this.x0+n*Math.cos(this.alpha)+e*Math.sin(this.alpha),t.y=this.y0+e*Math.cos(this.alpha)-n*Math.sin(this.alpha)),t},inverse:function(t){var e,n;this.no_rot?(n=t.y-this.y0,e=t.x-this.x0):(n=(t.x-this.x0)*Math.cos(this.alpha)-(t.y-this.y0)*Math.sin(this.alpha),e=(t.y-this.y0)*Math.cos(this.alpha)+(t.x-this.x0)*Math.sin(this.alpha),e+=this.uc);var r=Math.exp(-1*this.bl*n/this.al),i=.5*(r-1/r),o=.5*(r+1/r),s=Math.sin(this.bl*e/this.al),a=(s*Math.cos(this.gamma0)+i*Math.sin(this.gamma0))/o,l=Math.pow(this.el/Math.sqrt((1+a)/(1-a)),1/this.bl);return Math.abs(a-1)<1e-10?(t.x=this.long0,t.y=xl):Math.abs(a+1)<1e-10?(t.x=this.long0,t.y=-1*xl):(t.y=$l(this.e,l),t.x=Kl(this.long0-Math.atan2(i*Math.cos(this.gamma0)-s*Math.sin(this.gamma0),Math.cos(this.bl*e/this.al))/this.bl)),t},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]};var fu={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<1e-10)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),r=Zl(this.e,e,n),i=Ql(this.e,this.lat1,e),o=Math.sin(this.lat2),s=Math.cos(this.lat2),a=Zl(this.e,o,s),l=Ql(this.e,this.lat2,o),c=Ql(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>1e-10?this.ns=Math.log(r/a)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=1e-10&&(n=Jl(n)*(xl-2e-10));var r,i,o=Math.abs(Math.abs(n)-xl);if(o>1e-10)r=Ql(this.e,n,Math.sin(n)),i=this.a*this.f0*Math.pow(r,this.ns);else{if((o=n*this.ns)<=0)return null;i=0}var s=this.ns*Kl(e-this.long0);return t.x=this.k0*(i*Math.sin(s))+this.x0,t.y=this.k0*(this.rh-i*Math.cos(s))+this.y0,t},inverse:function(t){var e,n,r,i,o,s=(t.x-this.x0)/this.k0,a=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(s*s+a*a),n=1):(e=-Math.sqrt(s*s+a*a),n=-1);var l=0;if(0!==e&&(l=Math.atan2(n*s,n*a)),0!==e||this.ns>0){if(n=1/this.ns,r=Math.pow(e/(this.a*this.f0),n),-9999===(i=$l(this.e,r)))return null}else i=-xl;return o=Kl(l/this.ns+this.long0),t.x=o,t.y=i,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]};var du={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,n,r,i,o,s,a,l=t.x,c=t.y,u=Kl(l-this.long0);return e=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/e)-this.s45),r=-u*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),o=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(i)),s=this.n*o,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),t.y=a*Math.cos(s)/1,t.x=a*Math.sin(s)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,n,r,i,o,s,a,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),o=Math.sqrt(t.x*t.x+t.y*t.y),i=Math.atan2(t.y,t.x)/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),n=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),t.x=this.long0-n/this.alfa,s=e,a=0;var c=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-t.y)<1e-10&&(a=1),s=t.y,c+=1}while(0===a&&c<15);return c>=15?null:t},names:["Krovak","krovak"]},pu=function(t,e,n,r,i){return t*i-e*Math.sin(2*i)+n*Math.sin(4*i)-r*Math.sin(6*i)},mu=function(t){return 1-.25*t*(1+t/16*(3+1.25*t))},gu=function(t){return.375*t*(1+.25*t*(1+.46875*t))},vu=function(t){return.05859375*t*t*(1+.75*t)},yu=function(t){return t*t*t*(35/3072)},bu=function(t,e,n){var r=e*n;return t/Math.sqrt(1-r*r)},_u=function(t){return Math.abs(t)<xl?t:t-Jl(t)*Math.PI},xu=function(t,e,n,r,i){var o,s;o=t/e;for(var a=0;a<15;a++)if(o+=s=(t-(e*o-n*Math.sin(2*o)+r*Math.sin(4*o)-i*Math.sin(6*o)))/(e-2*n*Math.cos(2*o)+4*r*Math.cos(4*o)-6*i*Math.cos(6*o)),Math.abs(s)<=1e-10)return o;return NaN};var wu={init:function(){this.sphere||(this.e0=mu(this.es),this.e1=gu(this.es),this.e2=vu(this.es),this.e3=yu(this.es),this.ml0=this.a*pu(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,n,r=t.x,i=t.y;if(r=Kl(r-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),n=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var o=Math.sin(i),s=Math.cos(i),a=bu(this.a,this.e,o),l=Math.tan(i)*Math.tan(i),c=r*Math.cos(i),u=c*c,h=this.es*s*s/(1-this.es);e=a*c*(1-u*l*(1/6-(8-l+8*h)*u/120)),n=this.a*pu(this.e0,this.e1,this.e2,this.e3,i)-this.ml0+a*o/s*u*(.5+(5-l+6*h)*u/24)}return t.x=e+this.x0,t.y=n+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,n,r=t.x/this.a,i=t.y/this.a;if(this.sphere){var o=i+this.lat0;e=Math.asin(Math.sin(o)*Math.cos(r)),n=Math.atan2(Math.tan(r),Math.cos(o))}else{var s=this.ml0/this.a+i,a=xu(s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-xl)<=1e-10)return t.x=this.long0,t.y=xl,i<0&&(t.y*=-1),t;var l=bu(this.a,this.e,Math.sin(a)),c=l*l*l/this.a/this.a*(1-this.es),u=Math.pow(Math.tan(a),2),h=r*this.a/l,f=h*h;e=a-l*Math.tan(a)/c*h*h*(.5-(1+3*u)*h*h/24),n=h*(1-f*(u/3+(1+3*u)*u*f/15))/Math.cos(a)}return t.x=Kl(n+this.long0),t.y=_u(e),t},names:["Cassini","Cassini_Soldner","cass"]},Mu=function(t,e){var n;return t>1e-7?(1-t*t)*(e/(1-(n=t*e)*n)-.5/t*Math.log((1-n)/(1+n))):2*e};var Su={init:function(){var t,e=Math.abs(this.lat0);if(Math.abs(e-xl)<1e-10?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<1e-10?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=Mu(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(t){var e,n=[];return n[0]=.3333333333333333*t,e=t*t,n[0]+=.17222222222222222*e,n[1]=.06388888888888888*e,e*=t,n[0]+=.10257936507936508*e,n[1]+=.0664021164021164*e,n[2]=.016415012942191543*e,n}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Mu(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,n,r,i,o,s,a,l,c,u,h=t.x,f=t.y;if(h=Kl(h-this.long0),this.sphere){if(o=Math.sin(f),u=Math.cos(f),r=Math.cos(h),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((n=this.mode===this.EQUIT?1+u*r:1+this.sinph0*o+this.cosph0*u*r)<=1e-10)return null;e=(n=Math.sqrt(2/n))*u*Math.sin(h),n*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*u*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(f+this.lat0)<1e-10)return null;n=Sl-.5*f,e=(n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)))*Math.sin(h),n*=r}}else{switch(a=0,l=0,c=0,r=Math.cos(h),i=Math.sin(h),o=Math.sin(f),s=Mu(this.e,o),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(a=s/this.qp,l=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:c=1+this.sinb1*a+this.cosb1*l*r;break;case this.EQUIT:c=1+l*r;break;case this.N_POLE:c=xl+f,s=this.qp-s;break;case this.S_POLE:c=f-xl,s=this.qp+s}if(Math.abs(c)<1e-10)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),n=this.mode===this.OBLIQ?this.ymf*c*(this.cosb1*a-this.sinb1*l*r):(c=Math.sqrt(2/(1+l*r)))*a*this.ymf,e=this.xmf*c*l*i;break;case this.N_POLE:case this.S_POLE:s>=0?(e=(c=Math.sqrt(s))*i,n=r*(this.mode===this.S_POLE?c:-c)):e=n=0}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,i,o,s,a,l,c,u,h=t.x/this.a,f=t.y/this.a;if(this.sphere){var d,p=0,m=0;if((n=.5*(d=Math.sqrt(h*h+f*f)))>1)return null;switch(n=2*Math.asin(n),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(m=Math.sin(n),p=Math.cos(n)),this.mode){case this.EQUIT:n=Math.abs(d)<=1e-10?0:Math.asin(f*m/d),h*=m,f=p*d;break;case this.OBLIQ:n=Math.abs(d)<=1e-10?this.lat0:Math.asin(p*this.sinph0+f*m*this.cosph0/d),h*=m*this.cosph0,f=(p-Math.sin(n)*this.sinph0)*d;break;case this.N_POLE:f=-f,n=xl-n;break;case this.S_POLE:n-=xl}e=0!==f||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(h,f):0}else{if(a=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(h/=this.dd,f*=this.dd,(s=Math.sqrt(h*h+f*f))<1e-10)return t.x=this.long0,t.y=this.lat0,t;i=2*Math.asin(.5*s/this.rq),r=Math.cos(i),h*=i=Math.sin(i),this.mode===this.OBLIQ?(a=r*this.sinb1+f*i*this.cosb1/s,o=this.qp*a,f=s*this.cosb1*r-f*this.sinb1*i):(a=f*i/s,o=this.qp*a,f=s*r)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(f=-f),!(o=h*h+f*f))return t.x=this.long0,t.y=this.lat0,t;a=1-o/this.qp,this.mode===this.S_POLE&&(a=-a)}e=Math.atan2(h,f),l=Math.asin(a),c=this.apa,u=l+l,n=l+c[0]*Math.sin(u)+c[1]*Math.sin(u+u)+c[2]*Math.sin(u+u+u)}return t.x=Kl(this.long0+e),t.y=n,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},Eu=function(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)};var Tu={init:function(){Math.abs(this.lat1+this.lat2)<1e-10||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Zl(this.e3,this.sin_po,this.cos_po),this.qs1=Mu(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Zl(this.e3,this.sin_po,this.cos_po),this.qs2=Mu(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Mu(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>1e-10?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var r=Mu(this.e3,this.sin_phi,this.cos_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,o=this.ns0*Kl(e-this.long0),s=i*Math.sin(o)+this.x0,a=this.rh-i*Math.cos(o)+this.y0;return t.x=s,t.y=a,t},inverse:function(t){var e,n,r,i,o,s;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),r=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),r=-1),i=0,0!==e&&(i=Math.atan2(r*t.x,r*t.y)),r=e*this.ns0/this.a,this.sphere?s=Math.asin((this.c-r*r)/(2*this.ns0)):(n=(this.c-r*r)/this.ns0,s=this.phi1z(this.e3,n)),o=Kl(i/this.ns0+this.long0),t.x=o,t.y=s,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,e){var n,r,i,o,s=Eu(.5*e);if(t<1e-10)return s;for(var a=t*t,l=1;l<=25;l++)if(s+=o=.5*(i=1-(r=t*(n=Math.sin(s)))*r)*i/Math.cos(s)*(e/(1-a)-n/i+.5/t*Math.log((1-r)/(1+r))),Math.abs(o)<=1e-7)return s;return null}};var Cu={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,n,r,i,o,s,a,l=t.x,c=t.y;return r=Kl(l-this.long0),e=Math.sin(c),n=Math.cos(c),i=Math.cos(r),1,(o=this.sin_p14*e+this.cos_p14*n*i)>0||Math.abs(o)<=1e-10?(s=this.x0+1*this.a*n*Math.sin(r)/o,a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*n*i)/o):(s=this.x0+this.infinity_dist*n*Math.sin(r),a=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*i)),t.x=s,t.y=a,t},inverse:function(t){var e,n,r,i,o,s;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(i=Math.atan2(e,this.rc),n=Math.sin(i),r=Math.cos(i),s=Eu(r*this.sin_p14+t.y*n*this.cos_p14/e),o=Math.atan2(t.x*n,e*this.cos_p14*r-t.y*this.sin_p14*n),o=Kl(this.long0+o)):(s=this.phic0,o=0),t.x=o,t.y=s,t},names:["gnom"]};var Au={init:function(){this.sphere||(this.k0=Zl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,n,r=t.x,i=t.y,o=Kl(r-this.long0);if(this.sphere)e=this.x0+this.a*o*Math.cos(this.lat_ts),n=this.y0+this.a*Math.sin(i)/Math.cos(this.lat_ts);else{var s=Mu(this.e,Math.sin(i));e=this.x0+this.a*this.k0*o,n=this.y0+this.a*s*.5/this.k0}return t.x=e,t.y=n,t},inverse:function(t){var e,n;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=Kl(this.long0+t.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=function(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*xl:xl;for(var r,i,o,s,a=Math.asin(.5*e),l=0;l<30;l++)if(i=Math.sin(a),o=Math.cos(a),s=t*i,a+=r=Math.pow(1-s*s,2)/(2*o)*(e/(1-t*t)-i/(1-s*s)+.5/t*Math.log((1-s)/(1+s))),Math.abs(r)<=1e-10)return a;return NaN}(this.e,2*t.y*this.k0/this.a),e=Kl(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=n,t},names:["cea"]};var Pu={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.x,n=t.y,r=Kl(e-this.long0),i=_u(n-this.lat0);return t.x=this.x0+this.a*r*this.rc,t.y=this.y0+this.a*i,t},inverse:function(t){var e=t.x,n=t.y;return t.x=Kl(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=_u(this.lat0+(n-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]};var Lu={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=mu(this.es),this.e1=gu(this.es),this.e2=vu(this.es),this.e3=yu(this.es),this.ml0=this.a*pu(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,n,r,i=t.x,o=t.y,s=Kl(i-this.long0);if(r=s*Math.sin(o),this.sphere)Math.abs(o)<=1e-10?(e=this.a*s,n=-1*this.a*this.lat0):(e=this.a*Math.sin(r)/Math.tan(o),n=this.a*(_u(o-this.lat0)+(1-Math.cos(r))/Math.tan(o)));else if(Math.abs(o)<=1e-10)e=this.a*s,n=-1*this.ml0;else{var a=bu(this.a,this.e,Math.sin(o))/Math.tan(o);e=a*Math.sin(r),n=this.a*pu(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+a*(1-Math.cos(r))}return t.x=e+this.x0,t.y=n+this.y0,t},inverse:function(t){var e,n,r,i,o,s,a,l,c;if(r=t.x-this.x0,i=t.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=1e-10)e=Kl(r/this.a+this.long0),n=0;else{var u;for(s=this.lat0+i/this.a,a=r*r/this.a/this.a+s*s,l=s,o=20;o;--o)if(l+=c=-1*(s*(l*(u=Math.tan(l))+1)-l-.5*(l*l+a)*u)/((l-s)/u-1),Math.abs(c)<=1e-10){n=l;break}e=Kl(this.long0+Math.asin(r*Math.tan(l)/this.a)/Math.sin(n))}else if(Math.abs(i+this.ml0)<=1e-10)n=0,e=Kl(this.long0+r/this.a);else{var h,f,d,p,m;for(s=(this.ml0+i)/this.a,a=r*r/this.a/this.a+s*s,l=s,o=20;o;--o)if(m=this.e*Math.sin(l),h=Math.sqrt(1-m*m)*Math.tan(l),f=this.a*pu(this.e0,this.e1,this.e2,this.e3,l),d=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),l-=c=(s*(h*(p=f/this.a)+1)-p-.5*h*(p*p+a))/(this.es*Math.sin(2*l)*(p*p+a-2*s*p)/(4*h)+(s-p)*(h*d-2/Math.sin(2*l))-d),Math.abs(c)<=1e-10){n=l;break}h=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=Kl(this.long0+Math.asin(r*h/this.a)/Math.sin(n))}return t.x=e,t.y=n,t},names:["Polyconic","poly"]};var Ru={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,n=t.x,r=t.y-this.lat0,i=n-this.long0,o=r/_l*1e-5,s=i,a=1,l=0;for(e=1;e<=10;e++)a*=o,l+=this.A[e]*a;var c,u=l,h=s,f=1,d=0,p=0,m=0;for(e=1;e<=6;e++)c=d*u+f*h,f=f*u-d*h,d=c,p=p+this.B_re[e]*f-this.B_im[e]*d,m=m+this.B_im[e]*f+this.B_re[e]*d;return t.x=m*this.a+this.x0,t.y=p*this.a+this.y0,t},inverse:function(t){var e,n,r=t.x,i=t.y,o=r-this.x0,s=(i-this.y0)/this.a,a=o/this.a,l=1,c=0,u=0,h=0;for(e=1;e<=6;e++)n=c*s+l*a,l=l*s-c*a,c=n,u=u+this.C_re[e]*l-this.C_im[e]*c,h=h+this.C_im[e]*l+this.C_re[e]*c;for(var f=0;f<this.iterations;f++){var d,p=u,m=h,g=s,v=a;for(e=2;e<=6;e++)d=m*u+p*h,p=p*u-m*h,m=d,g+=(e-1)*(this.B_re[e]*p-this.B_im[e]*m),v+=(e-1)*(this.B_im[e]*p+this.B_re[e]*m);p=1,m=0;var y=this.B_re[1],b=this.B_im[1];for(e=2;e<=6;e++)d=m*u+p*h,p=p*u-m*h,m=d,y+=e*(this.B_re[e]*p-this.B_im[e]*m),b+=e*(this.B_im[e]*p+this.B_re[e]*m);var _=y*y+b*b;u=(g*y+v*b)/_,h=(v*y-g*b)/_}var x=u,w=h,M=1,S=0;for(e=1;e<=9;e++)M*=x,S+=this.D[e]*M;var E=this.lat0+S*_l*1e5,T=this.long0+w;return t.x=T,t.y=E,t},names:["New_Zealand_Map_Grid","nzmg"]};var Ou={init:function(){},forward:function(t){var e=t.x,n=t.y,r=Kl(e-this.long0),i=this.x0+this.a*r,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=i,t.y=o,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=Kl(this.long0+t.x/this.a),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t},names:["Miller_Cylindrical","mill"]};var ku={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Zc(this.es)},forward:function(t){var e,n,r=t.x,i=t.y;if(r=Kl(r-this.long0),this.sphere){if(this.m)for(var o=this.n*Math.sin(i),s=20;s;--s){var a=(this.m*i+Math.sin(i)-o)/(this.m+Math.cos(i));if(i-=a,Math.abs(a)<1e-10)break}else i=1!==this.n?Math.asin(this.n*Math.sin(i)):i;e=this.a*this.C_x*r*(this.m+Math.cos(i)),n=this.a*this.C_y*i}else{var l=Math.sin(i),c=Math.cos(i);n=this.a*Jc(i,l,c,this.en),e=this.a*r*c/Math.sqrt(1-this.es*l*l)}return t.x=e,t.y=n,t},inverse:function(t){var e,n,r,i;return t.x-=this.x0,r=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,r/=this.C_x*(this.m+Math.cos(e)),this.m?e=Eu((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=Eu(Math.sin(e)/this.n)),r=Kl(r+this.long0),e=_u(e)):(e=Kc(t.y/this.a,this.es,this.en),(i=Math.abs(e))<xl?(i=Math.sin(e),n=this.long0+t.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=Kl(n)):i-1e-10<xl&&(r=this.long0)),t.x=r,t.y=e,t},names:["Sinusoidal","sinu"]};var Iu={init:function(){},forward:function(t){for(var e=t.x,n=t.y,r=Kl(e-this.long0),i=n,o=Math.PI*Math.sin(n);;){var s=-(i+Math.sin(i)-o)/(1+Math.cos(i));if(i+=s,Math.abs(s)<1e-10)break}i/=2,Math.PI/2-Math.abs(n)<1e-10&&(r=0);var a=.900316316158*this.a*r*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return t.x=a,t.y=l,t},inverse:function(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),e=Math.asin(n);var r=Kl(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,Math.abs(n)>1&&(n=1);var i=Math.asin(n);return t.x=r,t.y=i,t},names:["Mollweide","moll"]};var Du={init:function(){Math.abs(this.lat1+this.lat2)<1e-10||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=mu(this.es),this.e1=gu(this.es),this.e2=vu(this.es),this.e3=yu(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Zl(this.e,this.sinphi,this.cosphi),this.ml1=pu(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<1e-10?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Zl(this.e,this.sinphi,this.cosphi),this.ml2=pu(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=pu(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,n=t.x,r=t.y;if(this.sphere)e=this.a*(this.g-r);else{var i=pu(this.e0,this.e1,this.e2,this.e3,r);e=this.a*(this.g-i)}var o=this.ns*Kl(n-this.long0),s=this.x0+e*Math.sin(o),a=this.y0+this.rh-e*Math.cos(o);return t.x=s,t.y=a,t},inverse:function(t){var e,n,r,i;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(n=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var o=0;if(0!==n&&(o=Math.atan2(e*t.x,e*t.y)),this.sphere)return i=Kl(this.long0+o/this.ns),r=_u(this.g-n/this.a),t.x=i,t.y=r,t;var s=this.g-n/this.a;return r=xu(s,this.e0,this.e1,this.e2,this.e3),i=Kl(this.long0+o/this.ns),t.x=i,t.y=r,t},names:["Equidistant_Conic","eqdc"]};var Nu={init:function(){this.R=this.a},forward:function(t){var e,n,r=t.x,i=t.y,o=Kl(r-this.long0);Math.abs(i)<=1e-10&&(e=this.x0+this.R*o,n=this.y0);var s=Eu(2*Math.abs(i/Math.PI));(Math.abs(o)<=1e-10||Math.abs(Math.abs(i)-xl)<=1e-10)&&(e=this.x0,n=i>=0?this.y0+Math.PI*this.R*Math.tan(.5*s):this.y0+Math.PI*this.R*-Math.tan(.5*s));var a=.5*Math.abs(Math.PI/o-o/Math.PI),l=a*a,c=Math.sin(s),u=Math.cos(s),h=u/(c+u-1),f=h*h,d=h*(2/c-1),p=d*d,m=Math.PI*this.R*(a*(h-p)+Math.sqrt(l*(h-p)*(h-p)-(p+l)*(f-p)))/(p+l);o<0&&(m=-m),e=this.x0+m;var g=l+h;return m=Math.PI*this.R*(d*g-a*Math.sqrt((p+l)*(l+1)-g*g))/(p+l),n=i>=0?this.y0+m:this.y0-m,t.x=e,t.y=n,t},inverse:function(t){var e,n,r,i,o,s,a,l,c,u,h,f;return t.x-=this.x0,t.y-=this.y0,h=Math.PI*this.R,o=(r=t.x/h)*r+(i=t.y/h)*i,h=3*(i*i/(l=-2*(s=-Math.abs(i)*(1+o))+1+2*i*i+o*o)+(2*(a=s-2*i*i+r*r)*a*a/l/l/l-9*s*a/l/l)/27)/(c=(s-a*a/3/l)/l)/(u=2*Math.sqrt(-c/3)),Math.abs(h)>1&&(h=h>=0?1:-1),f=Math.acos(h)/3,n=t.y>=0?(-u*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI:-(-u*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI,e=Math.abs(r)<1e-10?this.long0:Kl(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(r*r-i*i)+o*o))/2/r),t.x=e,t.y=n,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]};var ju={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var e,n,r,i,o,s,a,l,c,u,h,f,d,p,m,g,v,y,b,_,x,w,M=t.x,S=t.y,E=Math.sin(t.y),T=Math.cos(t.y),C=Kl(M-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=1e-10?(t.x=this.x0+this.a*(xl-S)*Math.sin(C),t.y=this.y0-this.a*(xl-S)*Math.cos(C),t):Math.abs(this.sin_p12+1)<=1e-10?(t.x=this.x0+this.a*(xl+S)*Math.sin(C),t.y=this.y0+this.a*(xl+S)*Math.cos(C),t):(y=this.sin_p12*E+this.cos_p12*T*Math.cos(C),v=(g=Math.acos(y))?g/Math.sin(g):1,t.x=this.x0+this.a*v*T*Math.sin(C),t.y=this.y0+this.a*v*(this.cos_p12*E-this.sin_p12*T*Math.cos(C)),t):(e=mu(this.es),n=gu(this.es),r=vu(this.es),i=yu(this.es),Math.abs(this.sin_p12-1)<=1e-10?(o=this.a*pu(e,n,r,i,xl),s=this.a*pu(e,n,r,i,S),t.x=this.x0+(o-s)*Math.sin(C),t.y=this.y0-(o-s)*Math.cos(C),t):Math.abs(this.sin_p12+1)<=1e-10?(o=this.a*pu(e,n,r,i,xl),s=this.a*pu(e,n,r,i,S),t.x=this.x0+(o+s)*Math.sin(C),t.y=this.y0+(o+s)*Math.cos(C),t):(a=E/T,l=bu(this.a,this.e,this.sin_p12),c=bu(this.a,this.e,E),u=Math.atan((1-this.es)*a+this.es*l*this.sin_p12/(c*T)),b=0===(h=Math.atan2(Math.sin(C),this.cos_p12*Math.tan(u)-this.sin_p12*Math.cos(C)))?Math.asin(this.cos_p12*Math.sin(u)-this.sin_p12*Math.cos(u)):Math.abs(Math.abs(h)-Math.PI)<=1e-10?-Math.asin(this.cos_p12*Math.sin(u)-this.sin_p12*Math.cos(u)):Math.asin(Math.sin(C)*Math.cos(u)/Math.sin(h)),f=this.e*this.sin_p12/Math.sqrt(1-this.es),g=l*b*(1-(_=b*b)*(m=(d=this.e*this.cos_p12*Math.cos(h)/Math.sqrt(1-this.es))*d)*(1-m)/6+(x=_*b)/8*(p=f*d)*(1-2*m)+(w=x*b)/120*(m*(4-7*m)-3*f*f*(1-7*m))-w*b/48*p),t.x=this.x0+g*Math.sin(h),t.y=this.y0+g*Math.cos(h),t))},inverse:function(t){var e,n,r,i,o,s,a,l,c,u,h,f,d,p,m,g,v,y,b,_,x,w,M;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*xl*this.a)return;return n=e/this.a,r=Math.sin(n),i=Math.cos(n),o=this.long0,Math.abs(e)<=1e-10?s=this.lat0:(s=Eu(i*this.sin_p12+t.y*r*this.cos_p12/e),a=Math.abs(this.lat0)-xl,o=Math.abs(a)<=1e-10?this.lat0>=0?Kl(this.long0+Math.atan2(t.x,-t.y)):Kl(this.long0-Math.atan2(-t.x,t.y)):Kl(this.long0+Math.atan2(t.x*r,e*this.cos_p12*i-t.y*this.sin_p12*r))),t.x=o,t.y=s,t}return l=mu(this.es),c=gu(this.es),u=vu(this.es),h=yu(this.es),Math.abs(this.sin_p12-1)<=1e-10?(f=this.a*pu(l,c,u,h,xl),e=Math.sqrt(t.x*t.x+t.y*t.y),s=xu((f-e)/this.a,l,c,u,h),o=Kl(this.long0+Math.atan2(t.x,-1*t.y)),t.x=o,t.y=s,t):Math.abs(this.sin_p12+1)<=1e-10?(f=this.a*pu(l,c,u,h,xl),e=Math.sqrt(t.x*t.x+t.y*t.y),s=xu((e-f)/this.a,l,c,u,h),o=Kl(this.long0+Math.atan2(t.x,t.y)),t.x=o,t.y=s,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),m=Math.atan2(t.x,t.y),d=bu(this.a,this.e,this.sin_p12),g=Math.cos(m),y=-(v=this.e*this.cos_p12*g)*v/(1-this.es),b=3*this.es*(1-y)*this.sin_p12*this.cos_p12*g/(1-this.es),w=1-y*(x=(_=e/d)-y*(1+y)*Math.pow(_,3)/6-b*(1+3*y)*Math.pow(_,4)/24)*x/2-_*x*x*x/6,p=Math.asin(this.sin_p12*Math.cos(x)+this.cos_p12*Math.sin(x)*g),o=Kl(this.long0+Math.asin(Math.sin(m)*Math.sin(x)/Math.cos(p))),M=Math.sin(p),s=Math.atan2((M-this.es*w*this.sin_p12)*Math.tan(p),M*(1-this.es)),t.x=o,t.y=s,t)},names:["Azimuthal_Equidistant","aeqd"]};var Fu={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,n,r,i,o,s,a,l=t.x,c=t.y;return r=Kl(l-this.long0),e=Math.sin(c),n=Math.cos(c),i=Math.cos(r),1,((o=this.sin_p14*e+this.cos_p14*n*i)>0||Math.abs(o)<=1e-10)&&(s=1*this.a*n*Math.sin(r),a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*n*i)),t.x=s,t.y=a,t},inverse:function(t){var e,n,r,i,o,s,a;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),n=Eu(e/this.a),r=Math.sin(n),i=Math.cos(n),s=this.long0,Math.abs(e)<=1e-10?(a=this.lat0,t.x=s,t.y=a,t):(a=Eu(i*this.sin_p14+t.y*r*this.cos_p14/e),o=Math.abs(this.lat0)-xl,Math.abs(o)<=1e-10?(s=this.lat0>=0?Kl(this.long0+Math.atan2(t.x,-t.y)):Kl(this.long0-Math.atan2(-t.x,t.y)),t.x=s,t.y=a,t):(s=Kl(this.long0+Math.atan2(t.x*r,e*this.cos_p14*i-t.y*this.sin_p14*r)),t.x=s,t.y=a,t))},names:["ortho"]},Bu=1,zu=2,Uu=3,Hu=4,Gu=5,Wu=6,Vu=1,qu=2,Xu=3,Yu=4;function Zu(t,e,n,r){var i;return t<1e-10?(r.value=Vu,i=0):(i=Math.atan2(e,n),Math.abs(i)<=Sl?r.value=Vu:i>Sl&&i<=xl+Sl?(r.value=qu,i-=xl):i>xl+Sl||i<=-(xl+Sl)?(r.value=Xu,i=i>=0?i-Tl:i+Tl):(r.value=Yu,i+=xl)),i}function Ju(t,e){var n=t+e;return n<-Tl?n+=El:n>+Tl&&(n-=El),n}var Ku={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=xl-Sl/2?this.face=Gu:this.lat0<=-(xl-Sl/2)?this.face=Wu:Math.abs(this.long0)<=Sl?this.face=Bu:Math.abs(this.long0)<=xl+Sl?this.face=this.long0>0?zu:Hu:this.face=Uu,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,n,r,i,o,s,a={x:0,y:0},l={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,n=t.x,this.face===Gu)i=xl-e,n>=Sl&&n<=xl+Sl?(l.value=Vu,r=n-xl):n>xl+Sl||n<=-(xl+Sl)?(l.value=qu,r=n>0?n-Tl:n+Tl):n>-(xl+Sl)&&n<=-Sl?(l.value=Xu,r=n+xl):(l.value=Yu,r=n);else if(this.face===Wu)i=xl+e,n>=Sl&&n<=xl+Sl?(l.value=Vu,r=-n+xl):n<Sl&&n>=-Sl?(l.value=qu,r=-n):n<-Sl&&n>=-(xl+Sl)?(l.value=Xu,r=-n-xl):(l.value=Yu,r=n>0?-n+Tl:-n-Tl);else{var c,u,h,f,d,p;this.face===zu?n=Ju(n,+xl):this.face===Uu?n=Ju(n,+Tl):this.face===Hu&&(n=Ju(n,-xl)),f=Math.sin(e),d=Math.cos(e),p=Math.sin(n),c=d*Math.cos(n),u=d*p,h=f,this.face===Bu?r=Zu(i=Math.acos(c),h,u,l):this.face===zu?r=Zu(i=Math.acos(u),h,-c,l):this.face===Uu?r=Zu(i=Math.acos(-c),h,-u,l):this.face===Hu?r=Zu(i=Math.acos(-u),h,c,l):(i=r=0,l.value=Vu)}return s=Math.atan(12/Tl*(r+Math.acos(Math.sin(r)*Math.cos(Sl))-xl)),o=Math.sqrt((1-Math.cos(i))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(r))))),l.value===qu?s+=xl:l.value===Xu?s+=Tl:l.value===Yu&&(s+=1.5*Tl),a.x=o*Math.cos(s),a.y=o*Math.sin(s),a.x=a.x*this.a+this.x0,a.y=a.y*this.a+this.y0,t.x=a.x,t.y=a.y,t},inverse:function(t){var e,n,r,i,o,s,a,l,c,u,h,f,d={lam:0,phi:0},p={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,n=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?p.value=Vu:t.y>=0&&t.y>=Math.abs(t.x)?(p.value=qu,e-=xl):t.x<0&&-t.x>=Math.abs(t.y)?(p.value=Xu,e=e<0?e+Tl:e-Tl):(p.value=Yu,e+=xl),c=Tl/12*Math.tan(e),o=Math.sin(c)/(Math.cos(c)-1/Math.sqrt(2)),s=Math.atan(o),(a=1-(r=Math.cos(e))*r*(i=Math.tan(n))*i*(1-Math.cos(Math.atan(1/Math.cos(s)))))<-1?a=-1:a>1&&(a=1),this.face===Gu)l=Math.acos(a),d.phi=xl-l,p.value===Vu?d.lam=s+xl:p.value===qu?d.lam=s<0?s+Tl:s-Tl:p.value===Xu?d.lam=s-xl:d.lam=s;else if(this.face===Wu)l=Math.acos(a),d.phi=l-xl,p.value===Vu?d.lam=-s+xl:p.value===qu?d.lam=-s:p.value===Xu?d.lam=-s-xl:d.lam=s<0?-s-Tl:-s+Tl;else{var m,g,v;c=(m=a)*m,g=(c+=(v=c>=1?0:Math.sqrt(1-c)*Math.sin(s))*v)>=1?0:Math.sqrt(1-c),p.value===qu?(c=g,g=-v,v=c):p.value===Xu?(g=-g,v=-v):p.value===Yu&&(c=g,g=v,v=-c),this.face===zu?(c=m,m=-g,g=c):this.face===Uu?(m=-m,g=-g):this.face===Hu&&(c=m,m=g,g=-c),d.phi=Math.acos(-v)-xl,d.lam=Math.atan2(g,m),this.face===zu?d.lam=Ju(d.lam,-xl):this.face===Uu?d.lam=Ju(d.lam,-Tl):this.face===Hu&&(d.lam=Ju(d.lam,+xl))}return 0!==this.es&&(u=d.phi<0?1:0,h=Math.tan(d.phi),f=this.b/Math.sqrt(h*h+this.one_minus_f_squared),d.phi=Math.atan(Math.sqrt(this.a*this.a-f*f)/(this.one_minus_f*f)),u&&(d.phi=-d.phi)),d.lam+=this.long0,t.x=d.lam,t.y=d.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},Qu=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],$u=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],th=Ml/5,eh=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))};var nh={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=Kl(t.x-this.long0),n=Math.abs(t.y),r=Math.floor(n*th);r<0?r=0:r>=18&&(r=17);var i={x:eh(Qu[r],n=Ml*(n-.08726646259971647*r))*e,y:eh($u[r],n)};return t.y<0&&(i.y=-i.y),i.x=i.x*this.a*.8487+this.x0,i.y=i.y*this.a*1.3523+this.y0,i},inverse:function(t){var e={x:(t.x-this.x0)/(.8487*this.a),y:Math.abs(t.y-this.y0)/(1.3523*this.a)};if(e.y>=1)e.x/=Qu[18][0],e.y=t.y<0?-xl:xl;else{var n=Math.floor(18*e.y);for(n<0?n=0:n>=18&&(n=17);;)if($u[n][0]>e.y)--n;else{if(!($u[n+1][0]<=e.y))break;++n}var r=$u[n],i=5*(e.y-r[0])/($u[n+1][0]-r[0]);i=function(t,e,n,r){for(var i=e;r;--r){var o=t(i);if(i-=o,Math.abs(o)<n)break}return i}((function(t){return(eh(r,t)-e.y)/function(t,e){return t[1]+e*(2*t[2]+3*e*t[3])}(r,t)}),i,1e-10,100),e.x/=eh(Qu[n],i),e.y=(5*n+i)*wl,t.y<0&&(e.y=-e.y)}return e.x=Kl(e.x+this.long0),e},names:["Robinson","robin"]};var rh={init:function(){this.name="geocent"},forward:function(t){return bc(t,this.es,this.a)},inverse:function(t){return _c(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]},ih=0,oh=1,sh=2,ah=3,lh={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};var ch,uh={init:function(){if(Object.keys(lh).forEach(function(t){if(void 0===this[t])this[t]=lh[t].def;else{if(lh[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);lh[t].num&&(this[t]=parseFloat(this[t]))}lh[t].degrees&&(this[t]=this[t]*wl)}.bind(this)),Math.abs(Math.abs(this.lat0)-xl)<1e-10?this.mode=this.lat0<0?oh:ih:Math.abs(this.lat0)<1e-10?this.mode=sh:(this.mode=ah,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)},forward:function(t){t.x-=this.long0;var e,n,r,i,o=Math.sin(t.y),s=Math.cos(t.y),a=Math.cos(t.x);switch(this.mode){case ah:n=this.sinph0*o+this.cosph0*s*a;break;case sh:n=s*a;break;case oh:n=-o;break;case ih:n=o}switch(e=(n=this.pn1/(this.p-n))*s*Math.sin(t.x),this.mode){case ah:n*=this.cosph0*o-this.sinph0*s*a;break;case sh:n*=o;break;case ih:n*=-s*a;break;case oh:n*=s*a}return i=1/((r=n*this.cg+e*this.sg)*this.sw*this.h1+this.cw),e=(e*this.cg-n*this.sg)*this.cw*i,n=r*i,t.x=e*this.a,t.y=n*this.a,t},inverse:function(t){t.x/=this.a,t.y/=this.a;var e,n,r,i={x:t.x,y:t.y};r=1/(this.pn1-t.y*this.sw),e=this.pn1*t.x*r,n=this.pn1*t.y*this.cw*r,t.x=e*this.cg+n*this.sg,t.y=n*this.cg-e*this.sg;var o=tu(t.x,t.y);if(Math.abs(o)<1e-10)i.x=0,i.y=t.y;else{var s,a;switch(a=1-o*o*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/o+o/this.pn1),s=Math.sqrt(1-a*a),this.mode){case ah:i.y=Math.asin(s*this.sinph0+t.y*a*this.cosph0/o),t.y=(s-this.sinph0*Math.sin(i.y))*o,t.x*=a*this.cosph0;break;case sh:i.y=Math.asin(t.y*a/o),t.y=s*o,t.x*=a;break;case ih:i.y=Math.asin(s),t.y=-t.y;break;case oh:i.y=-Math.asin(s)}i.x=Math.atan2(t.x,t.y)}return t.x=i.x+this.long0,t.y=i.y,t},names:["Tilted_Perspective","tpers"]};kc.defaultDatum="WGS84",kc.Proj=yc,kc.WGS84=new kc.Proj("WGS84"),kc.Point=Xc,kc.toPoint=Cc,kc.defs=Wl,kc.nadgrid=function(t,e){var n=new DataView(e),r=function(t){var e=t.getInt32(8,!1);if(11===e)return!1;11!==(e=t.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian");return!0}(n),i=function(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:dc(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}(n,r);i.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var o={header:i,subgrids:function(t,e,n){for(var r=[],i=0;i<e.nSubgrids;i++){var o=mc(t,176,n),s=gc(t,176,o,n),a=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),l=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);r.push({ll:[fc(o.lowerLongitude),fc(o.lowerLatitude)],del:[fc(o.longitudeInterval),fc(o.latitudeInterval)],lim:[a,l],count:o.gridNodeCount,cvs:pc(s)})}return r}(n,i,r)};return uc[t]=o,o},kc.transform=Pc,kc.mgrs=Nc,kc.version="__VERSION__",(ch=kc).Proj.projections.add(Qc),ch.Proj.projections.add(iu),ch.Proj.projections.add(ou),ch.Proj.projections.add(lu),ch.Proj.projections.add(cu),ch.Proj.projections.add(uu),ch.Proj.projections.add(hu),ch.Proj.projections.add(fu),ch.Proj.projections.add(du),ch.Proj.projections.add(wu),ch.Proj.projections.add(Su),ch.Proj.projections.add(Tu),ch.Proj.projections.add(Cu),ch.Proj.projections.add(Au),ch.Proj.projections.add(Pu),ch.Proj.projections.add(Lu),ch.Proj.projections.add(Ru),ch.Proj.projections.add(Ou),ch.Proj.projections.add(ku),ch.Proj.projections.add(Iu),ch.Proj.projections.add(Du),ch.Proj.projections.add(Nu),ch.Proj.projections.add(ju),ch.Proj.projections.add(Fu),ch.Proj.projections.add(Ku),ch.Proj.projections.add(nh),ch.Proj.projections.add(rh),ch.Proj.projections.add(uh);var hh,fh=kc,dh=function(){function t(t,e,n,r){var i,o;if(this.options=n||{},this.options.bounds=n.bounds||[],this.options.transformation=new mh(1,0,-1,0),this.options.origin&&(this.transformation=new mh(1,-this.options.origin[0],-1,this.options.origin[1])),this.projection=new ph(t,e,(i=n.bounds[0],o=n.bounds[1],{min:{x:i[0],y:i[1]},max:{x:o[0],y:o[1]}})),this.R=r,this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions){this._scales=[];for(var s=this.options.resolutions.length-1;s>=0;s--)this.options.resolutions[s]&&(this._scales[s]=1/this.options.resolutions[s])}}return t.prototype.project=function(t){return this.projection.project(t)},t.prototype.unproject=function(t,e){return this.projection.unproject(t)},t.prototype.pointToLatLng=function(t,e){var n=this.scale(e),r=this.transformation.untransform(t,n);return this.projection.unproject(r)},t.prototype.scale=function(t){var e,n=Math.floor(t);return t===n?this._scales[t]:(e=this._scales[n])+(this._scales[n+1]-e)*(t-n)},t}(),ph=function(){function t(t,e,n){var r,i=void 0!==(r=t).inverse&&void 0!==r.forward;this._proj=i?t:this._projFromCodeDef(t,e),this.bounds=i?e:n}return t.prototype.project=function(t){var e=this._proj.forward([t.lng,t.lat]);return{x:e[0],y:e[1]}},t.prototype.unproject=function(t){var e=this._proj.inverse([t.x,t.y]);return{lat:e[1],lng:e[0]}},t.prototype._projFromCodeDef=function(t,e){if(e)fh.defs(t,e);else if(void 0===fh.defs[t]){var n=t.split(":");if(n.length>3&&(t=n[n.length-3]+":"+n[n.length-1]),void 0===fh.defs[t])throw"No projection definition for code "+t}return fh(t)},t}(),mh=function(){function t(t,e,n,r){if(yl.isArray(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=n,this._d=r}return t.prototype.transform=function(t,e){return this._transform({x:t.x,y:t.y},e)},t.prototype._transform=function(t,e){return e=null!=e?e:1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},t.prototype.untransform=function(t,e){return e=null!=e?e:1,{x:(t.x/e-this._b)/this._a,y:(t.y/e-this._d)/this._c}},t}();!function(t){t.Major="major",t.Minor="minor"}(hh||(hh={}));var gh=function(){function t(t,e,n,r){var i=this;if(this.setRadius=function(t,e){void 0===e&&(e=hh.Major),"major"==e.toLowerCase()?i.radii.major=t||i.baseRadius:"minor"==e.toLowerCase()&&(i.radii.minor=t||i.radii.major||i.baseRadius)},this.invertY=function(t,e){return Math.pow(2,e)-1-t},this.toBounds=function(t,e){var n={min:{x:null,y:null},max:{x:null,y:null}};return n.min.x=Math.min(t.x,e.x),n.max.x=Math.max(t.x,e.x),n.min.y=Math.min(t.y,e.y),n.max.y=Math.max(t.y,e.y),n},this.tileXYZ2NwSe=function(t,e,n,r){if(null==i.tileMapResource.proj)return null;var o=((r=Math.max(r||1,1))-1)*e,s={x:t.x*e-o,y:t.y*e-o},a={x:s.x+e+2*o,y:s.y+e+2*o},l=i.crs.pointToLatLng(s,t.z),c=i.crs.pointToLatLng(a,t.z);return n?i.toBounds(i.crs.project(l),i.crs.project(c)):{nw:l,se:c}},this.tileXYZ2LatLng=function(t,e,n,r){if(null==i.tileMapResource.proj){var o=t/Math.pow(2,n)*360-180,s=Math.PI-2*Math.PI*e/Math.pow(2,n);return{lat:180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s))),lng:o}}e=-e;var a=i.trueTileResolution*t*i.res[n]+i.tileMapResource.origin[0],l=i.trueTileResolution*e*i.res[n]+i.tileMapResource.origin[1];return i.crs.unproject({x:a,y:l})},this.latLngZ2TileXYZ=function(t,e,n,r){if(null==i.tileMapResource.proj){var o=(e+180)/360*Math.pow(2,n),s=(1-Math.log(Math.tan(t*(Math.PI/180))+1/Math.cos(t*(Math.PI/180)))/Math.PI)/2*Math.pow(2,n);return null==r&&(o=Math.floor(o),s=Math.floor(s)),{x:o,y:s,z:n}}var a=i.crs.project({lng:e,lat:t}),l=a.x,c=a.y;return{x:o=(l-i.tileMapResource.origin[0])/(i.trueTileResolution*i.res[n]),y:s=-(s=(c-i.tileMapResource.origin[1])/(i.trueTileResolution*i.res[n])),z:n}},this.vector3ToLatLng=function(t){var e=t.y,n=t.z;t.y=-n,t.z=-e;var r=i.radii.major/i.radiusScale,o=i.radii.minor/i.radiusScale,s=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2)),a=Math.pow(r,2)-Math.pow(o,2),l=54*Math.pow(r,2)*Math.pow(t.z,2),c=Math.pow(s,2)+(1-Math.pow(i.e,2))*Math.pow(t.z,2)-Math.pow(i.e,2)*a,u=Math.pow(i.e,4)*l*Math.pow(s,2)/Math.pow(c,3),h=Math.cbrt(1+u+Math.sqrt(Math.pow(u,2)+2*u)),f=l/(3*Math.pow(h+1/h+1,2)*Math.pow(c,2)),d=Math.sqrt(1+2*Math.pow(i.e,4)*f),p=-f*Math.pow(i.e,2)*s/(1+d)+Math.sqrt(.5*Math.pow(r,2)*(1+1/d)-f*(1-Math.pow(i.e,2))*Math.pow(t.z,2)/(d*(1+d))-.5*f*Math.pow(s,2)),m=Math.sqrt(s-Math.pow(i.e,2)*p+Math.pow(t.z,2)),g=Math.sqrt(Math.pow(s-Math.pow(i.e,2)*p,2)+(1-Math.pow(i.e,2))*Math.pow(t.z,2)),v=Math.pow(o,2)*t.z/(r*g),y=m*(1-Math.pow(o,2)/(r*g)),b=Math.atan((t.z+Math.pow(i.ep,2)*v)/s)*(180/Math.PI),_=-Math.atan2(t.y,t.x)*(180/Math.PI)-90;return _<-180&&(_+=360),{lat:b,lng:_,height:y}},this.lonLatToVector3=function(t,e,n){var r=e*(Math.PI/180),o=(t-180)*(Math.PI/180);return{x:(i.radii.major+n)/i.radiusScale*Math.cos(r)*Math.sin(o),y:-(i.radii.major+n)/i.radiusScale*Math.sin(r),z:-(i.radii.major+n)/i.radiusScale*Math.cos(r)*Math.cos(o)}},this.rotatePoint3D=function(t,e,n){null==n&&(n={x:0,y:0,z:0});var r=t.x-n.x,i=t.y-n.y,o=t.z-n.z,s=Math.sin(e.x),a=Math.cos(e.x),l=Math.sin(e.y),c=Math.cos(e.y),u=Math.sin(e.z),h=Math.cos(e.z);return{x:n.x+r*(c*h)+i*(-c*u)+o*l,y:n.y+r*(a*u+s*l*h)+i*(a*h-s*l*u)+o*(-s*c),z:n.z+r*(s*u-a*l*h)+i*(s*h+a*l*u)+o*(a*c)}},this.lon2tileUnfloored=function(t,e){return(t+180)/360*Math.pow(2,e)},this.lat2tileUnfloored=function(t,e){return(1-Math.log(Math.tan(t*Math.PI/180)+1/Math.cos(t*Math.PI/180))/Math.PI)/2*Math.pow(2,e)},this.lngLatDistBetween=function(t,e,n,r){var o=i.radii.major/i.radiusScale,s=e*(Math.PI/180),a=r*(Math.PI/180),l=(r-e)*(Math.PI/180),c=(n-t)*(Math.PI/180),u=Math.sin(l/2)*Math.sin(l/2)+Math.cos(s)*Math.cos(a)*Math.sin(c/2)*Math.sin(c/2);return o*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))},this._reset(),this.setRadius(t,hh.Major),this.setRadius(e,hh.Minor),this.tileMapResource=n||{bounds:null,origin:null,crsCode:null,epsg:null,proj:null,resunitsperpixel:null,reszoomlevel:null},this.tileMapResource.crsCode=this.tileMapResource.crsCode||"EPSG:4326",this.trueTileResolution=r||256,null!=this.tileMapResource.resunitsperpixel&&null!=this.tileMapResource.reszoomlevel){for(var o=this.tileMapResource.resunitsperpixel*Math.pow(2,this.tileMapResource.reszoomlevel),s=[],a=0;a<32;a++)s.push(o/Math.pow(2,a));this.res=s}var l=this.tileMapResource;this.crs=new dh(Number.isFinite(parseInt(l.crsCode[0]))?"EPSG:"+l.epsg:l.crsCode,l.proj,{origin:[parseFloat(l.origin[0]),parseFloat(l.origin[1])],resolutions:this.res,bounds:[[parseFloat(l.bounds[0]),parseFloat(l.bounds[1])],[parseFloat(l.bounds[2]),parseFloat(l.bounds[3])]]},parseFloat(this.radii.major))}return t.prototype._reset=function(){this.baseRadius=6371e3,this.radiusScale=1,this.radii={major:this.baseRadius,minor:this.baseRadius},this.tileMapResource={bounds:null,origin:null,crsCode:"EPSG:4326",proj:null,resunitsperpixel:null,reszoomlevel:null},this.e=0,this.ep=0,this.flatteningFactor=0},t}(),vh={simplePoint:function(){return new Be({uniforms:{},vertexShader:"#ifdef GL_ES\nprecision highp float;\n#endif\nvoid main() {\ngl_PointSize = 50.\ngl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.)\n}",fragmentShader:"void main() {\ngl_FragColor = vec4(0.0, 1.0, 1.0, 0.0)\n}",transparent:!0})},multiTexture:function(t,e){for(var n=t.length,r="#ifdef GL_ES\nprecision highp float;\n#endif\n",i=0;i<n;i++)r+="uniform sampler2D t"+i+";\nuniform float tA"+i+";\nuniform float tVAT"+i+";\n";r+="varying vec2 vUv;\nvarying vec3 vColor;\nvoid main(void) {\nvec4 C;\nvec4 B = vec4(0,0,0,0);\nvec4 C0 = texture2D(t0, vUv);\nfloat highestA = tA0;\n",r+="C = vec4( C0.rgb * (C0.a * tA0) + B.rgb * B.a * (1.0 - (C0.a * tA0)), 1);\n";for(i=1;i<n;i++)r+="if ( tVAT"+i+" == 0.0 && tA"+i+" > highestA ){ highestA = tA"+i+"; }\nvec4 C"+i+" = texture2D(t"+i+", vUv);\nC = vec4( C"+i+".rgb * (C"+i+".a * tA"+i+") + C.rgb * C.a * (1.0 - (C"+i+".a * tA"+i+")), 1);\n";r+="if (";for(i=0;i<n;i++)r+=" C"+i+".a == 0.0",i!=n-1&&(r+=" && ");r+="){\ndiscard;\n}\nif (vColor.r * vColor.g * vColor.b == 1.0){\ndiscard;\n}\nif (!(vColor.r == 0.0 && vColor.g == 0.0 && vColor.b == 0.0)){\nC = vec4(vColor, 1);\n}\nC.a = highestA;\ngl_FragColor = C;\n}";var o={};for(i=0;i<n;i++)o["t"+i]={value:t[i].texture},o["tA"+i]={value:e?0:t[i].opacity},o["tVAT"+i]={value:t[i].isVAT};return new Be({uniforms:o,vertexShader:"#ifdef GL_ES\nprecision highp float;\n#endif\nvarying vec2 vUv;\nattribute vec3 customColor;\nvarying vec3 vColor;\nvoid main() {\nvUv = uv;\nvColor = customColor;\nvec4 mvPosition = viewMatrix * modelMatrix * vec4(position, 1.0);\ngl_Position = projectionMatrix * mvPosition;\n}",fragmentShader:r,transparent:!0})},atmosphere:function(t){var e=["varying vec3\tvVertexWorldPosition;","varying vec3\tvVertexNormal;","void main(){","\tvVertexNormal = normalize(normalMatrix * normal);","\tvVertexWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","\t// set gl_Position","\tgl_Position\t= projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),n=["#ifdef GL_ES","precision highp float;","#endif","uniform vec3 glowColor;","uniform float coefficient;","uniform float opacity;","uniform float power;","varying vec3 vVertexNormal;","varying vec3 vVertexWorldPosition;","void main(){","\tvec3 worldCameraToVertex = vVertexWorldPosition - cameraPosition;","\tvec3 viewCameraToVertex\t= (viewMatrix * vec4(worldCameraToVertex, 0.0)).xyz;","\tviewCameraToVertex = normalize(viewCameraToVertex);","\tfloat intensity = pow(coefficient + dot(vVertexNormal, viewCameraToVertex), power);","\tgl_FragColor = vec4(glowColor * intensity * opacity, 1.0);"," if (intensity > 0.4) { gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0); }","}"].join("\n");return new Be({uniforms:{coefficient:{value:.1},power:{value:6},opacity:{value:.5},glowColor:{value:new Ut(t||"#FFFFFF")}},vertexShader:e,fragmentShader:n,blending:2,transparent:!0,depthWrite:!1})}},yh=n(3);function bh(t,e,n,r,i){return new Promise((function(n,i){fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){Object(yh.fromArrayBuffer)(t).then((function(t){t.readRasters().then((function(t){var i=t[0];if(e&&e.demFormatOptions&&!0===e.demFormatOptions.correctSeams){for(var o=--r+2,s=[],a=0;a<r+1;a++)for(var l=0;l<r+1;l++)s.push((i[a*o+l]+i[a*o+l+1]+i[(a+1)*o+l]+i[(a+1)*o+l+1])/4);i=s}n(i)})).catch((function(){i()}))}))})).catch((function(){i()}))}))}n(7),n(8);function _h(t,e,n,r,i){return new Promise((function(e,n){PNG.load(t,{withCredentials:!1},(function(t){if(0!=t){for(var r,i=t.decode(),o=[],s=0;s<i.length;s+=4)o.push(function(t){t.length<32&&(t=("00000000000000000000000000000000"+t).substr(t.length));var e="1"==t.charAt(0)?-1:1,n=parseInt(t.substr(1,8),2)-127,r=t.substr(9),i="1"+r,o=0,s=1,a=0;if(-127==n){if(-1==r.indexOf("1"))return 0;n=-126,i="0"+r}for(;o<i.length;)a+=s*parseInt(i.charAt(o)),s/=2,o++;return e*a*Math.pow(2,n)}(xh((r={r:i[s],g:i[s+1],b:i[s+2],a:i[s+3]}).r.toString(2))+xh(r.g.toString(2))+xh(r.b.toString(2))+xh(r.a.toString(2))));e(o)}else n()}),(function(t){n()}))}))}function xh(t){for(var e=t;e.length<8;)e="0"+e;return e}var wh=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))},Mh=function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};function Sh(t,e,n,r,i,o){return wh(this,void 0,void 0,(function(){return Mh(this,(function(s){return[2,new Promise((function(s,a){var l=null;if(null!=n.parser&&t.hasOwnProperty(n.parser))l=t[n.parser];else if(null!=n.parser&&["tif","rgba"].includes(n.parser))switch(n.parser.toLowerCase()){case"tif":l=bh;break;case"rgba":default:l=_h}else{switch(yl.getExtension(e).toLowerCase().toLowerCase()){case"tif":l=bh;break;case"png":default:l=_h}}l(e,n,r,i,o).then((function(t){s(t)})).catch((function(t){a()}))}))]}))}))}var Eh=function(){return(Eh=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Th={buildPath:function(t,e,n,r,i,o,s,a){var l;t=t||"tms";var c={x:n.x,y:n.y,z:n.z};switch(t){case"wmts":l=(l=(l=(l=e).replace("{z}",c.z)).replace("{x}",c.x)).replace("{y}",c.y);break;case"wms":l=Th.wmsExtension.buildPath(e,c,r,i,o,s);break;default:l=(l=(l=e).replace("{z}",c.z)).replace("{x}",c.x),c.y=r.invertY(c.y,c.z),l=l.replace("{y}",c.y)}return a?{path:l,xyz:c}:l},wmsExtension:{defaultWmsParams:{SERVICE:"WMS",REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0,VERSION:"1.1.1",WIDTH:null,HEIGHT:null},extensionOptions:{crsCode:"EPSG:4326",uppercase:!0},buildPath:function(t,e,n,r,i,o){var s=Eh({},Th.wmsExtension.defaultWmsParams);if(o&&o.wmsParams)for(var a in o.wmsParams)a in Th.wmsExtension.extensionOptions||(s[a]=o.wmsParams[a]);s.VERSION=o.wmsVersion||s.VERSION,!0===o.correctSeams?(r--,s.WIDTH=s.HEIGHT=r+2):s.WIDTH=s.HEIGHT=r;var l=n.tileMapResource.crsCode||Th.wmsExtension.extensionOptions.crsCode;s[parseFloat(s.VERSION)>=1.3?"CRS":"SRS"]=l;var c=n.tileXYZ2NwSe(e,i,!0,!0===o.correctSeams?(r+1)/r:null),u=(parseFloat(s.VERSION)>=1.3&&"EPSG:4326"===l?[c.min.y,c.min.x,c.max.y,c.max.x]:[c.min.x,c.min.y,c.max.x,c.max.y]).join(",");return t+yl.getParamString(s,t,Th.wmsExtension.extensionOptions.uppercase)+(Th.wmsExtension.extensionOptions.uppercase?"&BBOX=":"&bbox=")+u}}},Ch=Th,Ah=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))},Ph=function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Lh=function(){function t(t){this.p=t,this._reset()}return t.prototype._reset=function(){this._={loader:new As,tileDimension:6},this.tilesDrawn=[],this.tilesWanted=[],this.tilesToBeDrawn=[],this.tilesBeingDrawn=[]},t.prototype.refreshTiles=function(){var t=this;this.updateDesiredTiles(),this.tilesToBeDrawn=[];for(var e=0;e<this.tilesWanted.length;e++){for(var n=!1,r=0;r<this.tilesDrawn.length;r++)if(this.tilesWanted[e].x==this.tilesDrawn[r].x&&this.tilesWanted[e].y==this.tilesDrawn[r].y&&this.tilesWanted[e].z==this.tilesDrawn[r].z&&this.tilesWanted[e].isLODTile==this.tilesDrawn[r].isLODTile&&this.tilesWanted[e].LODLevel==this.tilesDrawn[r].LODLevel&&1!=this.tilesDrawn[r].outdated){n=!0;break}for(r=0;r<this.tilesToBeDrawn.length;r++)if(this.tilesWanted[e].x==this.tilesToBeDrawn[r].x&&this.tilesWanted[e].y==this.tilesToBeDrawn[r].y&&this.tilesWanted[e].z==this.tilesToBeDrawn[r].z&&this.tilesWanted[e].isLODTile==this.tilesToBeDrawn[r].isLODTile&&this.tilesWanted[e].LODLevel==this.tilesToBeDrawn[r].LODLevel){n=!0;break}n||this.tilesToBeDrawn.push(this.tilesWanted[e])}if(this.tilesToBeDrawn.length>0){var i=function(){t.tilesToBeDrawn.length>0&&t.addTile(t.tilesToBeDrawn.pop(),i).catch((function(){i()}))};this.addTile(this.tilesToBeDrawn.pop(),i).catch((function(){i()}))}if(0==this.tilesToBeDrawn.length&&0==this.tilesBeingDrawn.length){for(e=0;e<this.tilesDrawn.length;e++){for(n=!1,r=0;r<this.tilesWanted.length;r++)if(this.tilesDrawn[e].x==this.tilesWanted[r].x&&this.tilesDrawn[e].y==this.tilesWanted[r].y&&this.tilesDrawn[e].z==this.tilesWanted[r].z&&this.tilesDrawn[e].isLODTile==this.tilesWanted[r].isLODTile&&this.tilesDrawn[e].LODLevel==this.tilesWanted[r].LODLevel){n=!0;break}n||this.removeTile(e,!0)}this.removeAllOutdatedTiles()}0==this.tilesToBeDrawn.length&&(this.p._.firstLoad||this.p._onFirstLoad());var o=document.getElementById(this.p.options.loadingSpinnerId),s=document.getElementById(this.p.options.loadingPercentId);0==this.tilesToBeDrawn.length?o&&(o.style.opacity="0"):o&&"0"==o.style.opacity&&(o.style.opacity="1"),s&&(s.innerHTML=this.tilesToBeDrawn.length),this.fadeInTiles(),this.fadeOutTiles()},t.prototype.updateDesiredTiles=function(){this.tilesWanted=[];for(var t,e=this.p.getCenter(),n=this.p.projection.latLngZ2TileXYZ(e.lat,e.lng,this.p.zoom),r=n.x,i=n.y,o=this.p.options.radiusOfTiles,s=r-o+1;s<r+o;s++)for(var a=i-o+1;a<i+o;a++)(t=Math.pow(s-r,2)+Math.pow(a-i,2))<=o*o&&this.tilesWanted.push({x:this.p.projection.tileMapResource.proj?parseInt(s):yl.mod(s,Math.pow(2,this.p.zoom)),y:this.p.projection.tileMapResource.proj?parseInt(a):yl.mod(a,Math.pow(2,this.p.zoom)),z:this.p.zoom,d:t,make:!0,isLODTile:!1});var l=null;if(this.p.options.useLOD)for(var c=0;c<this.p.options.LOD.length;c++){var u=this.p.options.LOD[c].radiusOfTiles,h=Math.max(this.p._.minNativeZoom,this.p.zoom-this.p.options.LOD[c].zoomsUp);if(h==l)break;if(l=h,!(Math.abs(h-this.p.zoom)<=1)){r=(n=this.p.projection.latLngZ2TileXYZ(e.lat,e.lng,h)).x,i=n.y;for(s=r-u+1;s<r+u;s++)for(a=i-u+1;a<i+u;a++)(t=Math.pow(s-r,2)+Math.pow(a-i,2))<=u*u&&this.tilesWanted.push({x:this.p.projection.tileMapResource.proj?parseInt(s):yl.mod(s,Math.pow(2,h)),y:this.p.projection.tileMapResource.proj?parseInt(a):yl.mod(a,Math.pow(2,h)),z:h,d:t,make:!0,isLODTile:!0,LODLevel:c})}}this.tilesWanted.sort((function(t,e){return e.d-t.d})),this.tilesWanted.sort((function(t,e){var n=t.isLODTile?t.LODLevel:-1;return(e.isLODTile?e.LODLevel:-1)-n}))},t.prototype.addTile=function(t,e){return Ah(this,void 0,void 0,(function(){var n,r,i,o,s,a,l,c,u,h=this;return Ph(this,(function(f){switch(f.label){case 0:if(void 0===t)return[2];for(n={raster:!1,data:!1},r=new ke(new Ke(this._.tileDimension,this._.tileDimension,this.p.options.tileResolution-1,this.p.options.tileResolution-1),new Vt({visible:!1})),this.tilesBeingDrawn.push({x:t.x,y:t.y,z:t.z,isLODTile:t.isLODTile,LODLevel:t.LODLevel,make:t.make}),this.tilesDrawn.push({x:t.x,y:t.y,z:t.z,isLODTile:t.isLODTile,LODLevel:t.LODLevel,t:r,contents:[],from:{dems:[],rasters:[],data:[]}}),i=function(i){if(i&&(r.geometry.dispose(),r.material.dispose(),"function"==typeof e&&e()),n.data){var o=[];if(h.p._.events._.lastZoomDelta<=2)for(var s=h.tilesDrawn.length-1;s>=0;s--)if(t.isLODTile==h.tilesDrawn[s].isLODTile&&t.LODLevel==h.tilesDrawn[s].LODLevel){var a=[h.tilesDrawn[s].x,h.tilesDrawn[s].y,h.tilesDrawn[s].z],l=[t.x,t.y,t.z];t.z<h.tilesDrawn[s].z?yl.tileIsContained(l,a,!0)&&o.push(s):t.z>h.tilesDrawn[s].z&&yl.tileIsContained(a,l)&&(h.tilesDrawn[s].contents.push(l),h.tilesDrawn[s].contents.length>=yl.tileContains(a,t.z).length&&o.push(s))}for(s=h.tilesBeingDrawn.length-1;s>=0;s--)if(h.tilesBeingDrawn[s].x==t.x&&h.tilesBeingDrawn[s].y==t.y&&h.tilesBeingDrawn[s].z==t.z&&h.tilesBeingDrawn[s].isLODTile==t.isLODTile&&h.tilesBeingDrawn[s].LODLevel==t.LODLevel){if(h.tilesBeingDrawn[s].make)t.isLODTile?h.p.planetsLOD[t.LODLevel].add(r):h.p.planet.add(r),h.updateRastersForTile(t),o.forEach((function(t){h.removeTile(t,!0)}));else{r.geometry.dispose(),r.material.dispose();for(var c=h.tilesDrawn.length-1;c>=0;c--)h.tilesDrawn[c].x==t.x&&h.tilesDrawn[c].y==t.y&&h.tilesDrawn[c].z==t.z&&h.tilesDrawn[s].isLODTile==t.isLODTile&&h.tilesDrawn[s].LODLevel==t.LODLevel&&h.tilesDrawn.splice(c,1)}return void h.tilesBeingDrawn.splice(s,1)}}},o=function(e){var o=0,s=Math.pow(h.p.options.tileResolution,2),a=new Float32Array(3*s);null==e&&(e=new Array(s).fill(0));for(var l=0,c=Math.floor(e.length/2),u=0;(null==l||l>h.p.projection.radiusOfPlanetMajor||l<-h.p.projection.radiusOfPlanetMajor)&&u<e.length;)l=e[c],u++;var f=3*Math.floor(r.geometry.attributes.position.array.length/6),d=t.x+f/3%h.p.options.tileResolution/(h.p.options.tileResolution-1),p=t.y+Math.floor(f/3/h.p.options.tileResolution)/(h.p.options.tileResolution-1),m=h.p.projection.tileXYZ2LatLng(d,p,t.z),g=m.lat,v=m.lng,y=g,b=h.p.projection.lonLatToVector3(v,g,l*h.p.options.exaggeration);if(r.position.set(b.x,b.y,b.z),r.geometry.attributes.position.array.length/3==s){for(var _=0,x=void 0,w=0;w<r.geometry.attributes.position.array.length;w+=3){_=e[o]||0,a[w]=0,a[w+1]=0,a[w+2]=0,_<-1e5&&(_=-1e5);var M=t.x+w/3%h.p.options.tileResolution/(h.p.options.tileResolution-1),S=t.y+Math.floor(w/3/h.p.options.tileResolution)/(h.p.options.tileResolution-1),E=h.p.projection.tileXYZ2LatLng(M,S,t.z,t),T=E.lat,C=E.lng;h.p.zoom<=h.p._.zCutOff&&(y>75&&T<-88?T=90:y<-75&&T>88&&(T=-90)),x=h.p.projection.lonLatToVector3(C,T,_*h.p.options.exaggeration),r.geometry.attributes.position.array[w]=x.x-b.x,r.geometry.attributes.position.array[w+1]=x.y-b.y,r.geometry.attributes.position.array[w+2]=x.z-b.z,o+=1}r.geometry.attributes.position.needsUpdate=!0,r.geometry.computeVertexNormals(),r.geometry.computeBoundingSphere(),r.geometry.setAttribute("customColor",new Yt(a,3)),n.data=!0,i()}},s=!1,a=null,l=this.p.layers.tile.length-1;l>=0;l--)if(this.p.layers.tile[l].on&&(t.z>=this.p.layers.tile[l].minZoom&&t.z<=this.p.layers.tile[l].maxZoom&&yl.isInExtent(t,this.p.layers.tile[l].boundingBox,this.p.projection)||"_vectorsastile_"==this.p.layers.tile[l].path)&&(a=l,null!=this.p.layers.tile[l].demPath)){s=!0;break}return s&&null!=a?(c=Ch.buildPath(this.p.layers.tile[a].format,this.p.layers.tile[a].demPath,t,this.p.projection,this.p.options.tileResolution,this.p.options.trueTileResolution,this.p.layers.tile[a].demFormatOptions,!0),u=null,c?[4,Sh(this.p.options.customParsers,c.path,this.p.layers.tile[a],c.xyz,this.p.options.tileResolution,Math.pow(this.p.options.tileResolution,2)).catch((function(){}))]:[3,2]):[3,3];case 1:u=f.sent(),f.label=2;case 2:return o(u||null),[3,4];case 3:o(),f.label=4;case 4:return[2]}}))}))},t.prototype.findTileDrawnBasedOnUUID=function(t){var e=null;return this.tilesDrawn.forEach((function(n){n.t.uuid!==t||(e=n)})),e},t.prototype.findTileDrawnBasedOnXYZLOD=function(t){var e=null;return this.tilesDrawn.forEach((function(n){n.x!==t.x||n.y!==t.y||n.z!==t.z||n.isLODTile!==t.isLODTile||n.LODLevel!=t.LODLevel||(e=n)})),e},t.prototype.updateRastersForTile=function(t){var e=this,n=this.findTileDrawnBasedOnXYZLOD(t);if(null!=n){for(var r=[],i=new Array(this.p.layers.tile.length).fill(!1),o=new Array(this.p.layers.clamped.length).fill(!1),s=function(){if(i.every(Boolean)&&(t.isLODTile||o.every(Boolean))){if(0==r.length)return void(n.t.visible=!1);r.sort((function(t,e){return t.i-e.i})),n.from.rasters=[];for(var s=0,a=0;a<r.length;a++)"tile"==r[a].type&&(n.from.rasters.push({name:r[a].name,type:r[a].type,texture:r[a].texture,opacity:r[a].opacity,isVAT:0,i:s}),s++);for(a=0;a<r.length;a++)"clamped"==r[a].type&&(n.from.rasters.push({name:r[a].name,type:r[a].type,texture:r[a].texture,opacity:r[a].opacity,isVAT:1,i:s}),s++);n.t.material=vh.multiTexture(n.from.rasters,!0),e.p.options.wireframeMode&&(n.t.material=new Vt({color:16777215,wireframe:!0})),n.t.material.needsUpdate=!0}},a=function(t){if(l.p.layers.tile[t].on&&n.z>=l.p.layers.tile[t].minZoom&&n.z<=l.p.layers.tile[t].maxZoom&&yl.isInExtent({x:n.x,y:n.y,z:n.z},l.p.layers.tile[t].boundingBox,l.p.projection)){var o=Ch.buildPath(l.p.layers.tile[t].format,l.p.layers.tile[t].path,n,l.p.projection,l.p.options.trueTileResolution,l.p.options.trueTileResolution,l.p.layers.tile[t].formatOptions);o?function(t){e._.loader.load(o,(function(n){n.magFilter=1003,n.minFilter=1003,e.p.layers.tile[t]&&r.push({name:e.p.layers.tile[t].name,type:"tile",texture:n,opacity:e.p.layers.tile[t].opacity,i:t}),i[t]=!0,s()}),(function(){console.log("")}),(function(){i[t]=!0,s()}))}(t):(i[t]=!0,s())}else i[t]=!0,s()},l=this,c=0;c<this.p.layers.tile.length;c++)a(c);if(!t.isLODTile)for(c=0;c<this.p.layers.clamped.length;c++)if(this.p.layers.clamped[c].on&&(null==this.p.layers.clamped[c].minZoom||n.z>=this.p.layers.clamped[c].minZoom)&&(null==this.p.layers.clamped[c].maxZoom||n.z<=this.p.layers.clamped[c].maxZoom)&&(null==this.p.layers.clamped[c].boundingBox||yl.isInExtent({x:n.x,y:n.y,z:n.z},this.p.layers.clamped[c].boundingBox,this.p.projection))){var u=this.p.layers._.layerers.clamped.getClampedTexture(c,{x:n.x,y:n.y,z:n.z});n.contains=n.contains||{},n.contains[this.p.layers.clamped[c].name]=u.features;var h=new lo(u.canvas);h.magFilter=1003,h.minFilter=1003,this.p.layers.clamped[c]&&r.push({name:this.p.layers.clamped[c].name,type:"clamped",texture:h,opacity:this.p.layers.clamped[c].opacity,i:c}),o[c]=!0,s()}else o[c]=!0,s()}},t.prototype.updateClampedRasterForTile=function(t,e){if(!this.p.options.wireframeMode&&!t.isLODTile){for(var n=null,r=0;r<this.p.layers.clamped.length;r++)if(this.p.layers.clamped[r].name===e){n=r;break}var i=null!=n?this.p.layers.clamped[n]:null;if(i&&i.on&&(null==i.minZoom||t.z>=i.minZoom)&&(null==i.maxZoom||t.z<=i.maxZoom)&&(null==i.boundingBox||yl.isInExtent({x:t.x,y:t.y,z:t.z},i.boundingBox,this.p.projection))){var o=this.p.layers._.layerers.clamped.getClampedTexture(n,{x:t.x,y:t.y,z:t.z});t.contains=t.contains||{},t.contains[this.p.layers.clamped[n].name]=o.features;var s=new lo(o.canvas);s.magFilter=1003,s.minFilter=1003;for(r=0;r<t.from.rasters.length;r++)if(t.from.rasters[r].name===e){t.from.rasters[r].texture=s;break}t.t.material=vh.multiTexture(t.from.rasters),t.t.material.needsUpdate=!0}}},t.prototype.updateAllRasters=function(){this.killDrawingTiles();for(var t=this.tilesDrawn.length,e=0;e<t;e++){var n=this.tilesDrawn[e];this.updateRastersForTile({x:n.x,y:n.y,z:n.z,isLODTile:n.isLODTile,LODLevel:n.LODLevel})}},t.prototype.removeTile=function(t,e){this.tilesDrawn[t]&&(e?this.tilesDrawn[t].fadeOutAndRemove=!0:(this.tilesDrawn[t].t.geometry.dispose(),this.tilesDrawn[t].t.material.dispose(),this.tilesDrawn[t].isLODTile?this.p.planetsLOD[this.tilesDrawn[t].LODLevel].remove(this.tilesDrawn[t].t):this.p.planet.remove(this.tilesDrawn[t].t),this.tilesDrawn.splice(t,1)))},t.prototype.removeAllTiles=function(){this.killDrawingTiles();for(var t=0;t<this.tilesDrawn.length;t++)this.removeTile(0)},t.prototype.outdateAllTiles=function(){this.killDrawingTiles(),this.tilesDrawn.forEach((function(t){t.outdated=!0}))},t.prototype.removeAllOutdatedTiles=function(){var t=this,e=[];this.tilesDrawn.forEach((function(t,n){t.outdated&&e.push(n)})),(e=e.sort().reverse()).forEach((function(e){t.removeTile(e)}))},t.prototype.removeTileXYZ=function(t){for(var e in this.tilesDrawn)this.tilesDrawn[e].x==t.x&&this.tilesDrawn[e].y==t.y&&this.tilesDrawn[e].z==t.z&&(this.tilesDrawn[e].t.geometry.dispose(),this.tilesDrawn[e].t.material.dispose(),this.tilesDrawn[e].isLODTile?this.p.planetsLOD[this.tilesDrawn[e].LODLevel].remove(this.tilesDrawn[e].t):this.p.planet.remove(this.tilesDrawn[e].t),this.tilesDrawn.splice(e,1))},t.prototype.killDrawingTiles=function(){for(var t in this.tilesToBeDrawn)this.tilesToBeDrawn[t].make=!1;for(var t in this.tilesBeingDrawn)this.tilesBeingDrawn[t].make=!1},t.prototype.fadeInTiles=function(){for(var t in this.tilesDrawn)if(!this.tilesDrawn[t].fadeOutAndRemove)for(var e in this.tilesDrawn[t].from.rasters)if(this.tilesDrawn[t]&&this.tilesDrawn[t].t&&this.tilesDrawn[t].t.material.hasOwnProperty("uniforms")){var n=this.p.layers.getLayerByName(this.tilesDrawn[t].from.rasters[e].name);if(n){var r=n.opacity,i=this.tilesDrawn[t].t.material.uniforms["tA"+e].value;this.tilesDrawn[t].t.material.uniforms["tA"+e].value=r>i?Math.min(this.tilesDrawn[t].t.material.uniforms["tA"+e].value+.07,r):Math.max(this.tilesDrawn[t].t.material.uniforms["tA"+e].value-.07,r)}}},t.prototype.fadeOutTiles=function(){for(var t=this.tilesDrawn.length-1;t>=0;t--)if(this.tilesDrawn[t].fadeOutAndRemove)for(var e=0;this.tilesDrawn[t]&&e<this.tilesDrawn[t].from.rasters.length;e++)if(this.tilesDrawn[t]&&this.tilesDrawn[t].t&&this.tilesDrawn[t].t.material.hasOwnProperty("uniforms")&&null!=this.tilesDrawn[t].t.material.uniforms["tA"+e]){var n=Math.max(this.tilesDrawn[t].t.material.uniforms["tA"+e].value-.07,0);n<=0?this.removeTile(t):this.tilesDrawn[t].t.material.uniforms["tA"+e].value=n}else this.removeTile(t)},t}(),Rh=n(0);function Oh(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function kh(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Ih(t){return"Feature"===t.type?t.geometry:t}function Dh(t,e,n,r){void 0===r&&(r={});var i=Oh(t),o=Object(Rh.degreesToRadians)(i[0]),s=Object(Rh.degreesToRadians)(i[1]),a=Object(Rh.degreesToRadians)(n),l=Object(Rh.lengthToRadians)(e,r.units),c=Math.asin(Math.sin(s)*Math.cos(l)+Math.cos(s)*Math.sin(l)*Math.cos(a)),u=o+Math.atan2(Math.sin(a)*Math.sin(l)*Math.cos(s),Math.cos(l)-Math.sin(s)*Math.sin(c)),h=Object(Rh.radiansToDegrees)(u),f=Object(Rh.radiansToDegrees)(c);return Object(Rh.point)([h,f],r.properties)}var Nh=function(t,e,n){void 0===n&&(n={});for(var r=n.steps||64,i=n.properties?n.properties:!Array.isArray(t)&&"Feature"===t.type&&t.properties?t.properties:{},o=[],s=0;s<r;s++)o.push(Dh(t,e,-360*s/r,n).geometry.coordinates);return o.push(o[0]),Object(Rh.polygon)([o],i)};function jh(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r=Oh(t),i=Ih(e),o=i.type,s=e.bbox,a=i.coordinates;if(s&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(r,s))return!1;"Polygon"===o&&(a=[a]);for(var l=!1,c=0;c<a.length&&!l;c++)if(Fh(r,a[c][0],n.ignoreBoundary)){for(var u=!1,h=1;h<a[c].length&&!u;)Fh(r,a[c][h],!n.ignoreBoundary)&&(u=!0),h++;u||(l=!0)}return l}function Fh(t,e,n){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var i=0,o=e.length-1;i<e.length;o=i++){var s=e[i][0],a=e[i][1],l=e[o][0],c=e[o][1];if(t[1]*(s-l)+a*(l-t[0])+c*(t[0]-s)==0&&(s-t[0])*(l-t[0])<=0&&(a-t[1])*(c-t[1])<=0)return!n;a>t[1]!=c>t[1]&&t[0]<(l-s)*(t[1]-a)/(c-a)+s&&(r=!r)}return r}var Bh=n(1);var zh=function(t){if(!t)throw new Error("geojson is required");var e=[];return Object(Bh.flattenEach)(t,(function(t){!function(t,e){var n=[],r=t.geometry;if(null!==r){switch(r.type){case"Polygon":n=kh(r);break;case"LineString":n=[kh(r)]}n.forEach((function(n){(function(t,e){var n=[];return t.reduce((function(t,r){var i,o,s,a,l,c,u=Object(Rh.lineString)([t,r],e);return u.bbox=(o=r,s=(i=t)[0],a=i[1],l=o[0],c=o[1],[s<l?s:l,a<c?a:c,s>l?s:l,a>c?a:c]),n.push(u),r})),n})(n,t.properties).forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),Object(Rh.featureCollection)(e)},Uh=n(4),Hh=n.n(Uh);function Gh(t,e){var n=kh(t),r=kh(e);if(2!==n.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==r.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var i=n[0][0],o=n[0][1],s=n[1][0],a=n[1][1],l=r[0][0],c=r[0][1],u=r[1][0],h=r[1][1],f=(h-c)*(s-i)-(u-l)*(a-o),d=(u-l)*(o-c)-(h-c)*(i-l),p=(s-i)*(o-c)-(a-o)*(i-l);if(0===f)return null;var m=d/f,g=p/f;if(m>=0&&m<=1&&g>=0&&g<=1){var v=i+m*(s-i),y=o+m*(a-o);return Object(Rh.point)([v,y])}return null}var Wh=function(t,e){var n={},r=[];if("LineString"===t.type&&(t=Object(Rh.feature)(t)),"LineString"===e.type&&(e=Object(Rh.feature)(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var i=Gh(t,e);return i&&r.push(i),Object(Rh.featureCollection)(r)}var o=Hh()();return o.load(zh(e)),Object(Bh.featureEach)(zh(t),(function(t){Object(Bh.featureEach)(o.search(t),(function(e){var i=Gh(t,e);if(i){var o=kh(i).join(",");n[o]||(n[o]=!0,r.push(i))}}))})),Object(Rh.featureCollection)(r)},Vh=function(t,e){void 0===e&&(e={});var n=Ih(t);switch(e.properties||"Feature"!==t.type||(e.properties=t.properties),n.type){case"Polygon":return function(t,e){void 0===e&&(e={});var n=Ih(t).coordinates,r=e.properties?e.properties:"Feature"===t.type?t.properties:{};return qh(n,r)}(n,e);case"MultiPolygon":return function(t,e){void 0===e&&(e={});var n=Ih(t).coordinates,r=e.properties?e.properties:"Feature"===t.type?t.properties:{},i=[];return n.forEach((function(t){i.push(qh(t,r))})),Object(Rh.featureCollection)(i)}(n,e);default:throw new Error("invalid poly")}};function qh(t,e){return t.length>1?Object(Rh.multiLineString)(t,e):Object(Rh.lineString)(t[0],e)}function Xh(t,e){for(var n=0;n<t.coordinates.length-1;n++)if(Zh(t.coordinates[n],t.coordinates[n+1],e.coordinates))return!0;return!1}function Yh(t,e){for(var n=0,r=e.coordinates;n<r.length;n++){if(jh(r[n],t))return!0}return Wh(e,Vh(t)).features.length>0}function Zh(t,e,n){var r=n[0]-t[0],i=n[1]-t[1],o=e[0]-t[0],s=e[1]-t[1];return 0==r*s-i*o&&(Math.abs(o)>=Math.abs(s)?o>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:s>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1])}var Jh=function(t,e){var n=!0;return Object(Bh.flattenEach)(t,(function(t){Object(Bh.flattenEach)(e,(function(e){if(!1===n)return!1;n=function(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return n=t.coordinates,r=e.coordinates,!(n[0]===r[0]&&n[1]===r[1]);case"LineString":return!Xh(e,t);case"Polygon":return!jh(t,e)}break;case"LineString":switch(e.type){case"Point":return!Xh(t,e);case"LineString":return!function(t,e){if(Wh(t,e).features.length>0)return!0;return!1}(t,e);case"Polygon":return!Yh(e,t)}break;case"Polygon":switch(e.type){case"Point":return!jh(e,t);case"LineString":return!Yh(t,e);case"Polygon":return!function(t,e){for(var n=0,r=t.coordinates[0];n<r.length;n++){if(jh(r[n],e))return!0}for(var i=0,o=e.coordinates[0];i<o.length;i++){if(jh(o[i],t))return!0}if(Wh(Vh(t),Vh(e)).features.length>0)return!0;return!1}(e,t)}}var n,r;return!1}(t.geometry,e.geometry)}))})),n};function Kh(t,e){var n=!1;return Object(Bh.flattenEach)(t,(function(t){Object(Bh.flattenEach)(e,(function(e){if(!0===n)return!0;n=!Jh(t.geometry,e.geometry)}))})),n}var Qh=function(){function t(t){var e=this;this._rotateGlobe=function(t,n){if(n&&(e._.prevMouseXY.x=n.x,e._.prevMouseXY.y=n.y),t){!t.pageX&&t.touches&&(t.pageX=yl.arrayAverage(t.touches,"pageX")),!t.pageY&&t.touches&&(t.pageY=yl.arrayAverage(t.touches,"pageY")),t.hasOwnProperty("x")&&t.hasOwnProperty("y")&&e.p._.cameras.isFirstPerson&&(e._.prevMouseXY.x=0,e._.prevMouseXY.y=0,t.pageX=t.x,t.pageY=t.y);var r=.5*yl.getRadiansPerPixel(e.p.trueZoom)*(e.p._.marsRadius/e.p.projection.radii.major),i=0,o=new _(e.p._.cameras.orbit.camera.position.x,0,e.p._.cameras.orbit.camera.position.z);o.applyAxisAngle(new _(0,1,0),Math.PI/2);var s=new _(e.p._.cameras.orbit.camera.position.x,0,e.p._.cameras.orbit.camera.position.z);if(t.pageY<e._.prevMouseXY.y?(i=Math.abs(t.pageY-e._.prevMouseXY.y),e._rotateAroundArbAxis(o,r*i)):t.pageY>e._.prevMouseXY.y&&(i=Math.abs(t.pageY-e._.prevMouseXY.y),e._rotateAroundArbAxis(o,-r*i)),t.pageX>e._.prevMouseXY.x?(i=Math.abs(t.pageX-e._.prevMouseXY.x),e._rotateAroundArbAxis(s,-r*i)):t.pageX<e._.prevMouseXY.x&&(i=Math.abs(t.pageX-e._.prevMouseXY.x),e._rotateAroundArbAxis(s,r*i)),e._.prevMouseXY.x=t.pageX,e._.prevMouseXY.y=t.pageY,e.p.zoom<=e.p._.zCutOff)e.p._.cameras.orbit.controls.target.x=0,e.p._.cameras.orbit.controls.target.y=-e.p.planetCenter.y,e.p._.cameras.orbit.controls.target.z=0,e.p._.cameras.orbit.controls.update();else{var a=e.p.getCenterElevationRaw();if(null!=a){var l=-(a+e.p.planetCenter.y);0!=l&&-1e4!=l&&(e.p._.cameras.orbit.controls.target.y=l-e.p.options.targetYOffset)}var c=e.p.getCenter();e.p.controls._onMove(c.lng,c.lat,c.height)}}},this._rotateGlobe_MouseDown=function(t){1===t.which||0===t.button?(e._.prevMouseXY.x=t.pageX,e._.prevMouseXY.y=t.pageY,e.p._.sceneContainer.addEventListener("mousemove",e._rotateGlobe,!1),e.p._.sceneContainer.addEventListener("mouseup",e._rotateGlobe_MouseUp,!1),e.p._.sceneContainer.addEventListener("mouseleave",e._rotateGlobe_MouseUp,!1)):t.touches&&t.touches.length>2&&(e._.prevMouseXY.x=yl.arrayAverage(t.touches,"pageX"),e._.prevMouseXY.y=yl.arrayAverage(t.touches,"pageY"),e.p._.sceneContainer.addEventListener("touchmove",e._rotateGlobe,!1),e.p._.sceneContainer.addEventListener("touchend",e._rotateGlobe_MouseUp,!1))},this._rotateGlobe_MouseUp=function(t){e.p._.sceneContainer.removeEventListener("mousemove",e._rotateGlobe),e.p._.sceneContainer.removeEventListener("mouseup",e._rotateGlobe_MouseUp),e.p._.sceneContainer.removeEventListener("mouseleave",e._rotateGlobe_MouseUp),e.p._.sceneContainer.removeEventListener("touchmove",e._rotateGlobe),e.p._.sceneContainer.removeEventListener("touchend",e._rotateGlobe_MouseUp)},this._onZoom=function(t){e._.zoomedSince=0;var n=e.p._.cameras.orbit.camera.position.distanceTo(e.p._.cameras.orbit.controls.target),r=8-(e.p.projection.radiusScale.toString().length-1),i=Math.ceil((r*Math.log(2)-Math.log(n/Math.pow(5,r-1)))/Math.log(2))+1;e._.desiredZoom=i,e._attenuate()},this._onTouchZoom=function(t){t.touches&&1==t.touches.length&&e._onZoom(t)},this._onClick=function(t){if(e.hoveredFeature&&e.hoverInfo){var n=e.p.layers.getLayerByName(e.hoveredFeature.layerName);n&&(e.setActiveFeature({layerName:e.hoveredFeature.layerName,type:e.hoveredFeature.type,obj:e.hoveredFeature.obj,feature:e.hoveredFeature.feature||e.hoveredFeature.obj.feature,lnglat:{lng:e.hoveredFeature.lnglat.lng,lat:e.hoveredFeature.lnglat.lat}}),"function"==typeof n.onClick&&n.onClick(JSON.parse(JSON.stringify(e.hoveredFeature.feature)),JSON.parse(JSON.stringify(e.hoveredFeature.lnglat)),n))}},this._onMouseMove=function(t){e.p._.mouseIsInScene=!0,e.p._.cameras.isFirstPerson?(e._.mouseXY.x=0,e._.mouseXY.y=0):(e._.mouseXY.x=(t.clientX-e.p._.renderer.domElement.getBoundingClientRect().left)/e.p._.renderer.domElement.clientWidth*2-1,e._.mouseXY.y=-(t.clientY-e.p._.renderer.domElement.getBoundingClientRect().top)/e.p._.renderer.domElement.clientHeight*2+1),e._.containerXY={x:t?t.offsetX:null,y:t?t.offsetY:null},e.updateHoverInfoPosition(),e.p._.raycaster.setFromCamera(e._.mouseXY,e.p._.cameras.camera);for(var n=[],r=0;r<e.p._.tiledWorld.tilesDrawn.length;r++)e.p._.tiledWorld.tilesDrawn[r].isLODTile||n.push(e.p._.tiledWorld.tilesDrawn[r].t);for(r=0;r<e.p.layers.vector.length;r++)if(e.p.layers.vector[r].meshes&&e.p.layers.vector[r].meshes.children)for(var i=0;i<e.p.layers.vector[r].meshes.children.length;i++)n.push(e.p.layers.vector[r].meshes.children[i]);var o=e.p._.raycaster.intersectObjects(n);if(o.length>0){var s=o[0].object.type,a=null;switch(s){case"Sprite":case"Line2":a=o[0].object;break;case"Mesh":if(null==(a=e.p._.tiledWorld.findTileDrawnBasedOnUUID(o[0].object.uuid)))return;break;default:return}var l=o[0].point;o[0].point.y+=e.p.planetCenter.y,o[0].point=e.p.projection.rotatePoint3D(o[0].point,{x:-e.p.planet.rotation.x,y:0,z:0}),o[0].point=e.p.projection.rotatePoint3D(o[0].point,{x:0,y:-e.p.planet.rotation.y,z:0}),o[0].point=e.p.projection.rotatePoint3D(o[0].point,{x:0,y:0,z:-e.p.planet.rotation.z});var c=e.p.projection.vector3ToLatLng(o[0].point);c.height=l.length()*e.p.projection.radiusScale-e.p.projection.radii.major,e._updateMouseCoords(c.lng,c.lat,c.height),clearTimeout(e._.highlightTimeout),e._.highlightTimeout=setTimeout((function(){e._highlightFeature(c.lng,c.lat,s,a)}),10),e.p.controls._onMouseMove(c.lng,c.lat,c.height,t)}else e._updateMouseCoords(null,null,null),e._unhighlightHoveredFeature(),e.p.controls._onMouseMove(null,null,null,t)},this.p=t,this.activeFeature=null,this.hoveredFeature=null,this.hoverInfo=null,this._={mouseXY:{x:null,y:null},prevMouseXY:{x:null,y:null},containerXY:{x:null,y:null},lastZoomDelta:1,desiredZoom:null,zoomedSince:0,zoomWait:30,highlightTimeout:null},this._init()}return t.prototype._init=function(){var t=this;this._matchPlanetsLODToPlanet(),this.p._.sceneContainer.addEventListener("mousewheel",this._onZoom,!1),this.p._.sceneContainer.addEventListener("DOMMouseScroll",this._onZoom,!1),this.p._.sceneContainer.addEventListener("wheel",this._onZoom,!1),this.p._.sceneContainer.addEventListener("mouseleave",this.p.controls._onMouseOut,!1),this.p._.sceneContainer.addEventListener("touchend",this._onTouchZoom),this.p._.sceneContainer.addEventListener("mousedown",this._rotateGlobe_MouseDown,!1),this.p._.sceneContainer.addEventListener("mousemove",this._onMouseMove,!1),this.p._.sceneContainer.addEventListener("click",this._onClick,!1),this.p._.sceneContainer.addEventListener("mouseenter",(function(){t.p._.mouseIsInScene=!0}),!1),this.p._.sceneContainer.addEventListener("mouseleave",(function(){t.p._.mouseIsInScene=!1}),!1)},t.prototype._rotateAroundArbAxis=function(t,e,n){var r=new Y;r.makeRotationAxis(t.normalize(),e),!0!==n&&r.multiply(this.p.planet.matrix),this.p.planet.matrix=r,this.p.planet.rotation.setFromRotationMatrix(this.p.planet.matrix),this._matchPlanetsLODToPlanet(),this._refreshFrontGroupRotation()},t.prototype._checkDesiredZoom=function(){this._.zoomedSince++,null!=this._.desiredZoom&&(this.p._.cameras.setNearFarPlane(this._.desiredZoom<14),this._.zoomedSince>this._.zoomWait&&(this._.desiredZoom>=this.p._.minNativeZoom&&this._setZoom(this._.desiredZoom),this._.desiredZoom=null))},t.prototype._setZoom=function(t){var e=this.p.zoom;this.p.zoom=t,this.p.trueZoom=Math.max(0,t),this.p.zoom<0&&(this.p.zoom=0),this.p.zoom<this.p._.minNativeZoom&&(this.p.zoom=this.p._.minNativeZoom),this.p.zoom>this.p._.maxZoom&&(this.p.zoom=this.p._.maxZoom),this._.lastZoomDelta=Math.abs(this.p.zoom-e)},t.prototype._matchPlanetsLODToPlanet=function(){for(var t=0;t<this.p.planetsLOD.length;t++)this.p.planetsLOD[t].matrix=this.p.planet.matrix,this.p.planetsLOD[t].position.set(this.p.planet.position.x,this.p.planet.position.y,this.p.planet.position.z),this.p.planetsLOD[t].rotation.set(this.p.planet.rotation.x,this.p.planet.rotation.y,this.p.planet.rotation.z);this.p.atmosphere&&(this.p.atmosphere.matrix=this.p.planet.matrix,this.p.atmosphere.position.set(this.p.planet.position.x,this.p.planet.position.y,this.p.planet.position.z),this.p.atmosphere.rotation.set(this.p.planet.rotation.x,this.p.planet.rotation.y,this.p.planet.rotation.z))},t.prototype._refreshFrontGroupRotation=function(){this.p.frontGroup.rotation.set(this.p.planet.rotation.x,this.p.planet.rotation.y,this.p.planet.rotation.z)},t.prototype._updateMouseCoords=function(t,e,n){this.p.mouse.lng=t,this.p.mouse.lat=e,this.p.mouse.elev=n},t.prototype.updateHoverInfoPosition=function(){this.hoverInfo&&(this.hoverInfo.style.left=this._.containerXY.x+14+"px",this.hoverInfo.style.top=this._.containerXY.y+14+"px")},t.prototype._highlightFeature=function(t,e,n,r){var i={type:"Point",coordinates:[t,e]},o=!1;switch(n){case"Sprite":case"Line2":if(o=!0,1==r.feature._highlighted)return;this._unhighlightHoveredFeature(),r.feature._highlighted=!0,r.restyle(),this.setHoveredFeature({layerName:r.layerName,type:n,obj:r,feature:r.feature,lnglat:{lng:t,lat:e}});break;case"Mesh":if(r&&r.contains)for(var s=0,a=Object.keys(r.contains).reverse();s<a.length;s++){for(var l=a[s],c=0,u=r.contains[l].reverse();c<u.length;c++){var h=u[c],f=Object.assign({},h);if("point"===f.geometry.type.toLowerCase()&&(f=Nh(f.geometry.coordinates,f._radiusInMeters||1,{steps:12,units:"meters",properties:f.properties})),Kh(f,i)){if(o=!0,1==h._highlighted)return;this._unhighlightHoveredFeature(),h._highlighted=!0,this.setHoveredFeature({layerName:l,type:n,obj:r,feature:h,lnglat:{lng:t,lat:e}}),this.p._.tiledWorld.updateClampedRasterForTile(r,l);break}}if(o)return}}o||this._unhighlightHoveredFeature()},t.prototype._unhighlightHoveredFeature=function(){if(this.hoveredFeature){switch(this.hoveredFeature.feature._highlighted=!1,this.hoveredFeature.type){case"Sprite":case"Line2":this.hoveredFeature.obj.restyle();break;case"Mesh":this.p._.tiledWorld.updateClampedRasterForTile(this.hoveredFeature.obj,this.hoveredFeature.layerName)}this.clearHoveredFeature()}},t.prototype.setHoveredFeature=function(t){this.hoveredFeature=t,this.hoverInfo&&(this.p._.container.removeChild(this.hoverInfo),this.hoverInfo=null),this.hoverInfo=document.createElement("div"),this.hoverInfo.id="_lithosphere_hover_info";var e=this.p.layers.getLayerByName(this.hoveredFeature.layerName);if(e&&e.useKeyAsHoverName){var n=yl.getIn(this.hoveredFeature.feature.properties,e.useKeyAsHoverName.split("."));null!=n&&(this.hoverInfo.innerHTML=yl.capitalizeFirstLetter(e.useKeyAsHoverName+": "+n),this.hoverInfo.style.position="absolute",this.hoverInfo.style.background="black",this.hoverInfo.style.color="white",this.hoverInfo.style.fontSize="16px",this.hoverInfo.style.fontFamily="sans-serif",this.hoverInfo.style.fontWeight="bold",this.hoverInfo.style.padding="4px 8px",this.updateHoverInfoPosition())}this.p._.container.appendChild(this.hoverInfo),this.p._.container.style.cursor="pointer"},t.prototype.clearHoveredFeature=function(){this.hoveredFeature=null,this.hoverInfo&&(this.p._.container.removeChild(this.hoverInfo),this.hoverInfo=null,this.p._.container.style.cursor="default")},t.prototype.setActiveFeature=function(t){switch(this.clearActiveFeature(),this.activeFeature=t,this.activeFeature.feature._active=!0,this.activeFeature.type){case"Sprite":case"Line2":this.activeFeature.obj.restyle();break;case"Mesh":this.p._.tiledWorld.updateClampedRasterForTile(this.activeFeature.obj,this.activeFeature.layerName)}},t.prototype.clearActiveFeature=function(){if(this.activeFeature)switch(this.activeFeature.feature._active=!1,this.activeFeature.type){case"Sprite":case"Line2":this.activeFeature.obj.restyle();break;case"Mesh":this.p._.tiledWorld.updateClampedRasterForTile(this.activeFeature.obj,this.activeFeature.layerName)}this.activeFeature=null},t.prototype._attenuate=function(){var t=this.p._.cameras.camera.position.distanceTo(this.p._.cameras.controls.target)/256;this.p.layers.vector&&this.p.layers.vector.forEach((function(e){e.meshes&&e.meshes.children&&e.meshes.children.forEach((function(e){e instanceof wi&&e.scale.set(t*e.style.radius,t*e.style.radius,t*e.style.radius)}))})),this.p.frontGroup.children&&this.p.frontGroup.children.forEach((function(e){e.children&&e.children.length>0?e.children.forEach((function(e){e instanceof wi&&e.scale.set(t*e.style.radius,t*e.style.radius,t*e.style.radius)})):e instanceof wi&&e.scale.set(t*mesh.style.radius,t*mesh.style.radius,t*mesh.style.radius)}))},t}(),$h=n(2),tf=n.n($h);class ef{constructor(){this.maxSize=800,this.minSize=600,this.unloadPercent=.05,this.itemSet=new Map,this.itemList=[],this.usedSet=new Set,this.callbacks=new Map,this.unloadPriorityCallback=null;const t=this.itemSet;this.defaultPriorityCallback=e=>t.get(e)}isFull(){return this.itemSet.size>=this.maxSize}add(t,e){const n=this.itemSet;if(n.has(t))return!1;if(this.isFull())return!1;const r=this.usedSet,i=this.itemList,o=this.callbacks;return i.push(t),r.add(t),n.set(t,Date.now()),o.set(t,e),!0}remove(t){const e=this.usedSet,n=this.itemSet,r=this.itemList,i=this.callbacks;if(n.has(t)){i.get(t)(t);const o=r.indexOf(t);return r.splice(o,1),e.delete(t),n.delete(t),i.delete(t),!0}return!1}markUsed(t){const e=this.itemSet,n=this.usedSet;e.has(t)&&!n.has(t)&&(e.set(t,Date.now()),n.add(t))}markAllUnused(){this.usedSet.clear()}unloadUnusedContent(){const t=this.unloadPercent,e=this.minSize,n=this.itemList,r=this.itemSet,i=this.usedSet,o=this.callbacks,s=n.length-i.size,a=n.length-e,l=this.unloadPriorityCallback||this.defaultPriorityCallback;if(a>0&&s>0){n.sort((t,e)=>{const n=i.has(t),r=i.has(e);return n&&r?0:n||r?n?1:-1:l(e)-l(t)});const c=Math.min(a,s),u=Math.max(e*t,c*t);let h=Math.min(u,s);h=Math.ceil(h);const f=n.splice(0,h);for(let t=0,e=f.length;t<e;t++){const e=f[t];o.get(e)(e),r.delete(e),o.delete(e)}}}scheduleUnload(t=!0){var e;this.scheduled||(this.scheduled=!0,e=()=>{this.scheduled=!1,this.unloadUnusedContent(),t&&this.markAllUnused()},Promise.resolve().then(e))}}class nf{constructor(){this.maxJobs=6,this.items=[],this.callbacks=new Map,this.currJobs=0,this.scheduled=!1,this.autoUpdate=!0,this.priorityCallback=()=>{throw new Error("PriorityQueue: PriorityCallback function not defined.")}}sort(){const t=this.priorityCallback;this.items.sort((e,n)=>t(e)-t(n))}add(t,e){return new Promise((n,r)=>{const i=this.items,o=this.callbacks;i.push(t),o.set(t,(...t)=>e(...t).then(n).catch(r)),this.autoUpdate&&this.scheduleJobRun()})}remove(t){const e=this.items,n=this.callbacks,r=e.indexOf(t);-1!==r&&(e.splice(r,1),n.delete(t))}tryRunJobs(){this.sort();const t=this.items,e=this.callbacks,n=this.maxJobs;let r=this.currJobs;for(;n>r&&t.length>0;){r++;const n=t.pop(),i=e.get(n);e.delete(n),i(n).then(()=>{this.currJobs--,this.autoUpdate&&this.scheduleJobRun()}).catch(()=>{this.currJobs--,this.autoUpdate&&this.scheduleJobRun()})}this.currJobs=r}scheduleJobRun(){this.scheduled||(requestAnimationFrame(()=>{this.tryRunJobs(),this.scheduled=!1}),this.scheduled=!0)}}function rf(t){return 3===t||4===t}function of(t,e){return t.__lastFrameVisited===e&&t.__used}function sf(t,e){t.__lastFrameVisited!==e&&(t.__lastFrameVisited=e,t.__used=!1,t.__inFrustum=!1,t.__isLeaf=!1,t.__visible=!1,t.__active=!1,t.__error=0,t.__childrenWereVisible=!1,t.__allChildrenLoaded=!1)}function af(t,e,n){if(sf(t,e),t.__used=!0,n.markUsed(t),t.__contentEmpty){const r=t.children;for(let t=0,i=r.length;t<i;t++)af(r[t],e,n)}}function lf(t,e,n){if(t.__contentEmpty&&(!t.__externalTileSet||rf(t.__loadingState))){const r=t.children;for(let t=0,i=r.length;t<i;t++){const i=r[t];i.__depthFromRenderedParent=e,lf(i,e,n)}}else n.requestTileContents(t)}function cf(t,e=null,n=null,r=null,i=0){if(e&&e(t,r,i))return void(n&&n(t,r,i));const o=t.children;for(let r=0,s=o.length;r<s;r++)cf(o[r],e,n,t,i+1);n&&n(t,r,i)}const uf=t=>1/(t.__depthFromRenderedParent+1);function hf(t){let e="";for(let n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);return e}class ff{constructor(t,e,n,r){this.buffer=t,this.binOffset=e+n,this.binLength=r;let i=null;if(0!==n){const r=new Uint8Array(t,e,n);i=JSON.parse(hf(r))}else i={};this.header=i}getKeys(){return Object.keys(this.header)}getData(t,e,n=null,r=null){const i=this.header;if(!(t in i))return null;const o=i[t];if(o instanceof Object){if(Array.isArray(o))return o;{const{buffer:i,binOffset:s,binLength:a}=this,l=o.byteOffset||0,c=o.type||r,u=o.componentType||n;if("type"in o&&r&&o.type!==r)throw new Error("FeatureTable: Specified type does not match expected type.");let h,f;switch(c){case"SCALAR":h=1;break;case"VEC2":h=2;break;case"VEC3":h=3;break;case"VEC4":h=4;break;default:throw new Error(`FeatureTable : Feature type not provided for "${t}".`)}const d=s+l,p=e*h;switch(u){case"BYTE":f=new Int8Array(i,d,p);break;case"UNSIGNED_BYTE":f=new Uint8Array(i,d,p);break;case"SHORT":f=new Int16Array(i,d,p);break;case"UNSIGNED_SHORT":f=new Uint16Array(i,d,p);break;case"INT":f=new Int32Array(i,d,p);break;case"UNSIGNED_INT":f=new Uint32Array(i,d,p);break;case"FLOAT":f=new Float32Array(i,d,p);break;case"DOUBLE":f=new Float64Array(i,d,p);break;default:throw new Error(`FeatureTable : Feature component type not provided for "${t}".`)}if(d+p*f.BYTES_PER_ELEMENT>s+a)throw new Error("FeatureTable: Feature data read outside binary body length.");return f}}return o}}class df extends ff{constructor(t,e,n,r,i){super(t,n,r,i),this.batchSize=e}getData(t,e=null,n=null){return super.getData(t,this.batchSize,n,e)}}var pf=function(){function t(t){_s.call(this,t),this.dracoLoader=null,this.ddsLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(t){return new s(t)})),this.register((function(t){return new l(t)})),this.register((function(t){return new h(t)})),this.register((function(t){return new a(t)})),this.register((function(t){return new i(t)})),this.register((function(t){return new f(t)}))}function e(){var t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}}t.prototype=Object.assign(Object.create(_s.prototype),{constructor:t,load:function(t,e,n,r){var i,o=this;i=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:pa(t),this.manager.itemStart(t);var s=function(e){r?r(e):console.error(e),o.manager.itemError(t),o.manager.itemEnd(t)},a=new ws(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,(function(n){try{o.parse(n,i,(function(n){e(n),o.manager.itemEnd(t)}),s)}catch(t){s(t)}}),n,s)},setDRACOLoader:function(t){return this.dracoLoader=t,this},setDDSLoader:function(t){return this.ddsLoader=t,this},setKTX2Loader:function(t){return this.ktx2Loader=t,this},setMeshoptDecoder:function(t){return this.meshoptDecoder=t,this},register:function(t){return-1===this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.push(t),this},unregister:function(t){return-1!==this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this},parse:function(t,e,i,s){var a,l={},c={};if("string"==typeof t)a=t;else if(da(new Uint8Array(t,0,4))===d){try{l[n.KHR_BINARY_GLTF]=new g(t)}catch(t){return void(s&&s(t))}a=l[n.KHR_BINARY_GLTF].content}else a=da(new Uint8Array(t));var u=JSON.parse(a);if(void 0===u.asset||u.asset.version[0]<2)s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var h=new Z(u,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});h.fileLoader.setRequestHeader(this.requestHeader);for(var f=0;f<this.pluginCallbacks.length;f++){var p=this.pluginCallbacks[f](h);c[p.name]=p,l[p.name]=!0}if(u.extensionsUsed)for(f=0;f<u.extensionsUsed.length;++f){var m=u.extensionsUsed[f],b=u.extensionsRequired||[];switch(m){case n.KHR_MATERIALS_UNLIT:l[m]=new o;break;case n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:l[m]=new x;break;case n.KHR_DRACO_MESH_COMPRESSION:l[m]=new v(u,this.dracoLoader);break;case n.MSFT_TEXTURE_DDS:l[m]=new r(this.ddsLoader);break;case n.KHR_TEXTURE_TRANSFORM:l[m]=new y;break;case n.KHR_MESH_QUANTIZATION:l[m]=new w;break;default:b.indexOf(m)>=0&&void 0===c[m]&&console.warn('THREE.GLTFLoader: Unknown extension "'+m+'".')}}h.setExtensions(l),h.setPlugins(c),h.parse(i,s)}}});var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function r(t){if(!t)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=n.MSFT_TEXTURE_DDS,this.ddsLoader=t}function i(t){this.parser=t,this.name=n.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}function o(){this.name=n.KHR_MATERIALS_UNLIT}function s(t){this.parser=t,this.name=n.KHR_MATERIALS_CLEARCOAT}function a(t){this.parser=t,this.name=n.KHR_MATERIALS_TRANSMISSION}function l(t){this.parser=t,this.name=n.KHR_TEXTURE_BASISU}function h(t){this.parser=t,this.name=n.EXT_TEXTURE_WEBP,this.isSupported=null}function f(t){this.name=n.EXT_MESHOPT_COMPRESSION,this.parser=t}i.prototype._markDefs=function(){for(var t=this.parser,e=this.parser.json.nodes||[],n=0,r=e.length;n<r;n++){var i=e[n];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&t._addNodeRef(this.cache,i.extensions[this.name].light)}},i.prototype._loadLight=function(t){var e=this.parser,n="light:"+t,r=e.cache.get(n);if(r)return r;var i,o=e.json,s=((o.extensions&&o.extensions[this.name]||{}).lights||[])[t],a=new Ut(16777215);void 0!==s.color&&a.fromArray(s.color);var l=void 0!==s.range?s.range:0;switch(s.type){case"directional":(i=new aa(a)).target.position.set(0,0,-1),i.add(i.target);break;case"point":(i=new ia(a)).distance=l;break;case"spot":(i=new na(a)).distance=l,s.spot=s.spot||{},s.spot.innerConeAngle=void 0!==s.spot.innerConeAngle?s.spot.innerConeAngle:0,s.spot.outerConeAngle=void 0!==s.spot.outerConeAngle?s.spot.outerConeAngle:Math.PI/4,i.angle=s.spot.outerConeAngle,i.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,i.target.position.set(0,0,-1),i.add(i.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return i.position.set(0,0,0),i.decay=2,void 0!==s.intensity&&(i.intensity=s.intensity),i.name=e.createUniqueName(s.name||"light_"+t),r=Promise.resolve(i),e.cache.add(n,r),r},i.prototype.createNodeAttachment=function(t){var e=this,n=this.parser,r=n.json.nodes[t],i=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===i?null:this._loadLight(i).then((function(t){return n._getNodeRef(e.cache,i,t)}))},o.prototype.getMaterialType=function(){return Vt},o.prototype.extendParams=function(t,e,n){var r=[];t.color=new Ut(1,1,1),t.opacity=1;var i=e.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var o=i.baseColorFactor;t.color.fromArray(o),t.opacity=o[3]}void 0!==i.baseColorTexture&&r.push(n.assignTexture(t,"map",i.baseColorTexture))}return Promise.all(r)},s.prototype.getMaterialType=function(t){var e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?Yo:null},s.prototype.extendMaterialParams=function(t,e){var n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(e.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&i.push(n.assignTexture(e,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(e.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&i.push(n.assignTexture(e,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(i.push(n.assignTexture(e,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){var s=o.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new u(s,-s)}return Promise.all(i)},a.prototype.getMaterialType=function(t){var e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?Yo:null},a.prototype.extendMaterialParams=function(t,e){var n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(e.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&i.push(n.assignTexture(e,"transmissionMap",o.transmissionTexture)),Promise.all(i)},l.prototype.loadTexture=function(t){var e=this.parser,n=e.json,r=n.textures[t];if(!r.extensions||!r.extensions[this.name])return null;var i=r.extensions[this.name],o=n.images[i.source],s=e.options.ktx2Loader;if(!s){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return e.loadTextureImage(t,o,s)},h.prototype.loadTexture=function(t){var e=this.name,n=this.parser,r=n.json,i=r.textures[t];if(!i.extensions||!i.extensions[e])return null;var o=i.extensions[e],s=r.images[o.source],a=s.uri?n.options.manager.getHandler(s.uri):n.textureLoader;return this.detectSupport().then((function(i){if(i)return n.loadTextureImage(t,s,a);if(r.extensionsRequired&&r.extensionsRequired.indexOf(e)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(t)}))},h.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise((function(t){var e=new Image;e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.onload=e.onerror=function(){t(1===e.height)}}))),this.isSupported},f.prototype.loadBufferView=function(t){var e=this.parser.json,n=e.bufferViews[t];if(n.extensions&&n.extensions[this.name]){var r=n.extensions[this.name],i=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([i,o.ready]).then((function(t){var e=r.byteOffset||0,n=r.byteLength||0,i=r.count,s=r.byteStride,a=new ArrayBuffer(i*s),l=new Uint8Array(t[0],e,n);return o.decodeGltfBuffer(new Uint8Array(a),i,s,l,r.mode,r.filter),a}))}return null};var d="glTF",p=1313821514,m=5130562;function g(t){this.name=n.KHR_BINARY_GLTF,this.content=null,this.body=null;var e=new DataView(t,0,12);if(this.header={magic:da(new Uint8Array(t.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==d)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var r=this.header.length-12,i=new DataView(t,12),o=0;o<r;){var s=i.getUint32(o,!0);o+=4;var a=i.getUint32(o,!0);if(o+=4,a===p){var l=new Uint8Array(t,12+o,s);this.content=da(l)}else if(a===m){var c=12+o;this.body=t.slice(c,c+s)}o+=s}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function v(t,e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=n.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=e,this.dracoLoader.preload()}function y(){this.name=n.KHR_TEXTURE_TRANSFORM}function b(t){Xo.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var e=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),i=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),s={specular:{value:(new Ut).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=s,this.onBeforeCompile=function(t){for(var a in s)t.uniforms[a]=s[a];t.fragmentShader=t.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",e).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",r).replace("#include <metalnessmap_fragment>",i).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return s.specular.value},set:function(t){s.specular.value=t}},specularMap:{get:function(){return s.specularMap.value},set:function(t){s.specularMap.value=t,t?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return s.glossiness.value},set:function(t){s.glossiness.value=t}},glossinessMap:{get:function(){return s.glossinessMap.value},set:function(t){s.glossinessMap.value=t,t?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(t)}function x(){return{name:n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return b},extendParams:function(t,e,n){var r=e.extensions[this.name];t.color=new Ut(1,1,1),t.opacity=1;var i=[];if(Array.isArray(r.diffuseFactor)){var o=r.diffuseFactor;t.color.fromArray(o),t.opacity=o[3]}if(void 0!==r.diffuseTexture&&i.push(n.assignTexture(t,"map",r.diffuseTexture)),t.emissive=new Ut(0,0,0),t.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,t.specular=new Ut(1,1,1),Array.isArray(r.specularFactor)&&t.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){var s=r.specularGlossinessTexture;i.push(n.assignTexture(t,"glossinessMap",s)),i.push(n.assignTexture(t,"specularMap",s))}return Promise.all(i)},createMaterial:function(t){var e=new b(t);return e.fog=!0,e.color=t.color,e.map=void 0===t.map?null:t.map,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=void 0===t.aoMap?null:t.aoMap,e.aoMapIntensity=1,e.emissive=t.emissive,e.emissiveIntensity=1,e.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,e.bumpMap=void 0===t.bumpMap?null:t.bumpMap,e.bumpScale=1,e.normalMap=void 0===t.normalMap?null:t.normalMap,e.normalMapType=0,t.normalScale&&(e.normalScale=t.normalScale),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.specularMap=void 0===t.specularMap?null:t.specularMap,e.specular=t.specular,e.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,e.glossiness=t.glossiness,e.alphaMap=null,e.envMap=void 0===t.envMap?null:t.envMap,e.envMapIntensity=1,e.refractionRatio=.98,e}}}function w(){this.name=n.KHR_MESH_QUANTIZATION}function S(t,e,n,r){rs.call(this,t,e,n,r)}v.prototype.decodePrimitive=function(t,e){var n=this.json,r=this.dracoLoader,i=t.extensions[this.name].bufferView,o=t.extensions[this.name].attributes,s={},a={},l={};for(var c in o){var u=N[c]||c.toLowerCase();s[u]=o[c]}for(c in t.attributes){u=N[c]||c.toLowerCase();if(void 0!==o[c]){var h=n.accessors[t.attributes[c]],f=O[h.componentType];l[u]=f,a[u]=!0===h.normalized}}return e.getDependency("bufferView",i).then((function(t){return new Promise((function(e){r.decodeDracoFile(t,(function(t){for(var n in t.attributes){var r=t.attributes[n],i=a[n];void 0!==i&&(r.normalized=i)}e(t)}),s,l)}))}))},y.prototype.extendTexture=function(t,e){return t=t.clone(),void 0!==e.offset&&t.offset.fromArray(e.offset),void 0!==e.rotation&&(t.rotation=e.rotation),void 0!==e.scale&&t.repeat.fromArray(e.scale),void 0!==e.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.needsUpdate=!0,t},b.prototype=Object.create(Xo.prototype),b.prototype.constructor=b,b.prototype.copy=function(t){return Xo.prototype.copy.call(this,t),this.specularMap=t.specularMap,this.specular.copy(t.specular),this.glossinessMap=t.glossinessMap,this.glossiness=t.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},S.prototype=Object.create(rs.prototype),S.prototype.constructor=S,S.prototype.copySampleValue_=function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r*3+r,o=0;o!==r;o++)e[o]=n[i+o];return e},S.prototype.beforeStart_=S.prototype.copySampleValue_,S.prototype.afterEnd_=S.prototype.copySampleValue_,S.prototype.interpolate_=function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=2*s,l=3*s,c=r-e,u=(n-e)/c,h=u*u,f=h*u,d=t*l,p=d-l,m=-2*f+3*h,g=f-h,v=1-m,y=g-h+u,b=0;b!==s;b++){var _=o[p+b+s],x=o[p+b+a]*c,w=o[d+b+s],M=o[d+b]*c;i[b]=v*_+y*x+m*w+g*M}return i};var E=0,T=1,C=2,A=3,P=4,L=5,R=6,O={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},k={9728:1003,9729:1006,9984:1004,9985:1007,9986:1005,9987:1008},I={33071:1001,33648:1002,10497:1e3},D={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},N={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},j={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},F={CUBICSPLINE:void 0,LINEAR:2301,STEP:2300},z="OPAQUE",U="MASK",H="BLEND";function G(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}function W(t,e,n){for(var r in n.extensions)void 0===t[r]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=n.extensions[r])}function V(t,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function q(t,e){if(t.updateMorphTargets(),void 0!==e.weights)for(var n=0,r=e.weights.length;n<r;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){var i=e.extras.targetNames;if(t.morphTargetInfluences.length===i.length){t.morphTargetDictionary={};for(n=0,r=i.length;n<r;n++)t.morphTargetDictionary[i[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function X(t){for(var e="",n=Object.keys(t).sort(),r=0,i=n.length;r<i;r++)e+=n[r]+":"+t[n[r]]+";";return e}function Z(t,n){this.json=t||{},this.extensions={},this.plugins={},this.options=n||{},this.cache=new e,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new ya(this.options.manager):this.textureLoader=new As(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new ws(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function J(t,e,n){var r=e.attributes,i=[];function o(e,r){return n.getDependency("accessor",e).then((function(e){t.setAttribute(r,e)}))}for(var s in r){var a=N[s]||s.toLowerCase();a in t.attributes||i.push(o(r[s],a))}if(void 0!==e.indices&&!t.index){var l=n.getDependency("accessor",e.indices).then((function(e){t.setIndex(e)}));i.push(l)}return V(t,e),function(t,e,n){var r=e.attributes,i=new M;if(void 0!==r.POSITION){var o=(d=n.json.accessors[r.POSITION]).min,s=d.max;if(void 0!==o&&void 0!==s){i.set(new _(o[0],o[1],o[2]),new _(s[0],s[1],s[2]));var a=e.targets;if(void 0!==a){for(var l=new _,c=new _,u=0,h=a.length;u<h;u++){var f=a[u];if(void 0!==f.POSITION){var d;o=(d=n.json.accessors[f.POSITION]).min,s=d.max;void 0!==o&&void 0!==s?(c.setX(Math.max(Math.abs(o[0]),Math.abs(s[0]))),c.setY(Math.max(Math.abs(o[1]),Math.abs(s[1]))),c.setZ(Math.max(Math.abs(o[2]),Math.abs(s[2]))),l.max(c)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(l)}t.boundingBox=i;var p=new B;i.getCenter(p.center),p.radius=i.min.distanceTo(i.max)/2,t.boundingSphere=p}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(t,e,n),Promise.all(i).then((function(){return void 0!==e.targets?function(t,e,n){for(var r=!1,i=!1,o=0,s=e.length;o<s;o++){if(void 0!==(c=e[o]).POSITION&&(r=!0),void 0!==c.NORMAL&&(i=!0),r&&i)break}if(!r&&!i)return Promise.resolve(t);var a=[],l=[];for(o=0,s=e.length;o<s;o++){var c=e[o];if(r){var u=void 0!==c.POSITION?n.getDependency("accessor",c.POSITION):t.attributes.position;a.push(u)}if(i){u=void 0!==c.NORMAL?n.getDependency("accessor",c.NORMAL):t.attributes.normal;l.push(u)}}return Promise.all([Promise.all(a),Promise.all(l)]).then((function(e){var n=e[0],o=e[1];return r&&(t.morphAttributes.position=n),i&&(t.morphAttributes.normal=o),t.morphTargetsRelative=!0,t}))}(t,e.targets,n):t}))}function K(t,e){var n=t.getIndex();if(null===n){var r=[],i=t.getAttribute("position");if(void 0===i)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(var o=0;o<i.count;o++)r.push(o);t.setIndex(r),n=t.getIndex()}var s=n.count-2,a=[];if(2===e)for(o=1;o<=s;o++)a.push(n.getX(0)),a.push(n.getX(o)),a.push(n.getX(o+1));else for(o=0;o<s;o++)o%2==0?(a.push(n.getX(o)),a.push(n.getX(o+1)),a.push(n.getX(o+2))):(a.push(n.getX(o+2)),a.push(n.getX(o+1)),a.push(n.getX(o)));a.length/3!==s&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var l=t.clone();return l.setIndex(a),l}return Z.prototype.setExtensions=function(t){this.extensions=t},Z.prototype.setPlugins=function(t){this.plugins=t},Z.prototype.parse=function(t,e){var n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this._invokeAll((function(t){return t._markDefs&&t._markDefs()})),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(e){var o={scene:e[0][r.scene||0],scenes:e[0],animations:e[1],cameras:e[2],asset:r.asset,parser:n,userData:{}};W(i,o,r),V(o,r),t(o)})).catch(e)},Z.prototype._markDefs=function(){for(var t=this.json.nodes||[],e=this.json.skins||[],n=this.json.meshes||[],r=0,i=e.length;r<i;r++)for(var o=e[r].joints,s=0,a=o.length;s<a;s++)t[o[s]].isBone=!0;for(var l=0,c=t.length;l<c;l++){var u=t[l];void 0!==u.mesh&&(this._addNodeRef(this.meshCache,u.mesh),void 0!==u.skin&&(n[u.mesh].isSkinnedMesh=!0)),void 0!==u.camera&&this._addNodeRef(this.cameraCache,u.camera)}},Z.prototype._addNodeRef=function(t,e){void 0!==e&&(void 0===t.refs[e]&&(t.refs[e]=t.uses[e]=0),t.refs[e]++)},Z.prototype._getNodeRef=function(t,e,n){if(t.refs[e]<=1)return n;var r=n.clone();return r.name+="_instance_"+t.uses[e]++,r},Z.prototype._invokeOne=function(t){var e=Object.values(this.plugins);e.push(this);for(var n=0;n<e.length;n++){var r=t(e[n]);if(r)return r}},Z.prototype._invokeAll=function(t){var e=Object.values(this.plugins);e.unshift(this);for(var n=[],r=0;r<e.length;r++){var i=t(e[r]);i&&n.push(i)}return n},Z.prototype.getDependency=function(t,e){var n=t+":"+e,r=this.cache.get(n);if(!r){switch(t){case"scene":r=this.loadScene(e);break;case"node":r=this.loadNode(e);break;case"mesh":r=this._invokeOne((function(t){return t.loadMesh&&t.loadMesh(e)}));break;case"accessor":r=this.loadAccessor(e);break;case"bufferView":r=this._invokeOne((function(t){return t.loadBufferView&&t.loadBufferView(e)}));break;case"buffer":r=this.loadBuffer(e);break;case"material":r=this._invokeOne((function(t){return t.loadMaterial&&t.loadMaterial(e)}));break;case"texture":r=this._invokeOne((function(t){return t.loadTexture&&t.loadTexture(e)}));break;case"skin":r=this.loadSkin(e);break;case"animation":r=this.loadAnimation(e);break;case"camera":r=this.loadCamera(e);break;default:throw new Error("Unknown type: "+t)}this.cache.add(n,r)}return r},Z.prototype.getDependencies=function(t){var e=this.cache.get(t);if(!e){var n=this,r=this.json[t+("mesh"===t?"es":"s")]||[];e=Promise.all(r.map((function(e,r){return n.getDependency(t,r)}))),this.cache.add(t,e)}return e},Z.prototype.loadBuffer=function(t){var e=this.json.buffers[t],r=this.fileLoader;if(e.type&&"arraybuffer"!==e.type)throw new Error("THREE.GLTFLoader: "+e.type+" buffer type is not supported.");if(void 0===e.uri&&0===t)return Promise.resolve(this.extensions[n.KHR_BINARY_GLTF].body);var i=this.options;return new Promise((function(t,n){r.load(G(e.uri,i.path),t,void 0,(function(){n(new Error('THREE.GLTFLoader: Failed to load buffer "'+e.uri+'".'))}))}))},Z.prototype.loadBufferView=function(t){var e=this.json.bufferViews[t];return this.getDependency("buffer",e.buffer).then((function(t){var n=e.byteLength||0,r=e.byteOffset||0;return t.slice(r,r+n)}))},Z.prototype.loadAccessor=function(t){var e=this,n=this.json,r=this.json.accessors[t];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);var i=[];return void 0!==r.bufferView?i.push(this.getDependency("bufferView",r.bufferView)):i.push(null),void 0!==r.sparse&&(i.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(i).then((function(t){var i,o=t[0],s=D[r.type],a=O[r.componentType],l=a.BYTES_PER_ELEMENT,c=l*s,u=r.byteOffset||0,h=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,f=!0===r.normalized;if(h&&h!==c){var d=Math.floor(u/h),p="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+d+":"+r.count,m=e.cache.get(p);m||(m=new oi(new a(o,d*h,r.count*h/l),h/l),e.cache.add(p,m)),i=new ai(m,s,u%h/l,f)}else i=new Yt(null===o?new a(r.count*s):new a(o,u,r.count*s),s,f);if(void 0!==r.sparse){var g=D.SCALAR,v=O[r.sparse.indices.componentType],y=r.sparse.indices.byteOffset||0,b=r.sparse.values.byteOffset||0,_=new v(t[1],y,r.sparse.count*g),x=new a(t[2],b,r.sparse.count*s);null!==o&&(i=new Yt(i.array.slice(),i.itemSize,i.normalized));for(var w=0,M=_.length;w<M;w++){var S=_[w];if(i.setX(S,x[w*s]),s>=2&&i.setY(S,x[w*s+1]),s>=3&&i.setZ(S,x[w*s+2]),s>=4&&i.setW(S,x[w*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return i}))},Z.prototype.loadTexture=function(t){var e,r,i=this.json,o=this.options,s=i.textures[t],a=s.extensions||{};return(e=a[n.MSFT_TEXTURE_DDS]?i.images[a[n.MSFT_TEXTURE_DDS].source]:i.images[s.source]).uri&&(r=o.manager.getHandler(e.uri)),r||(r=a[n.MSFT_TEXTURE_DDS]?this.extensions[n.MSFT_TEXTURE_DDS].ddsLoader:this.textureLoader),this.loadTextureImage(t,e,r)},Z.prototype.loadTextureImage=function(t,e,n){var r=this,i=this.json,o=this.options,s=i.textures[t],a=self.URL||self.webkitURL,l=e.uri,c=!1,u=!0;return"image/jpeg"===e.mimeType&&(u=!1),void 0!==e.bufferView&&(l=r.getDependency("bufferView",e.bufferView).then((function(t){if("image/png"===e.mimeType){var n=new DataView(t,25,1).getUint8(0,!1);u=6===n||4===n||3===n}c=!0;var r=new Blob([t],{type:e.mimeType});return l=a.createObjectURL(r)}))),Promise.resolve(l).then((function(t){return new Promise((function(e,r){var i=e;!0===n.isImageBitmapLoader&&(i=function(t){e(new lo(t))}),n.load(G(t,o.path),i,void 0,r)}))})).then((function(e){!0===c&&a.revokeObjectURL(l),e.flipY=!1,s.name&&(e.name=s.name),u||(e.format=1022);var n=(i.samplers||{})[s.sampler]||{};return e.magFilter=k[n.magFilter]||1006,e.minFilter=k[n.minFilter]||1008,e.wrapS=I[n.wrapS]||1e3,e.wrapT=I[n.wrapT]||1e3,r.associations.set(e,{type:"textures",index:t}),e}))},Z.prototype.assignTexture=function(t,e,r){var i=this;return this.getDependency("texture",r.index).then((function(o){if(void 0===r.texCoord||0==r.texCoord||"aoMap"===e&&1==r.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+r.texCoord+" for texture "+e+" not yet supported."),i.extensions[n.KHR_TEXTURE_TRANSFORM]){var s=void 0!==r.extensions?r.extensions[n.KHR_TEXTURE_TRANSFORM]:void 0;if(s){var a=i.associations.get(o);o=i.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(o,s),i.associations.set(o,a)}}t[e]=o}))},Z.prototype.assignFinalMaterial=function(t){var e=t.geometry,n=t.material,r=void 0!==e.attributes.tangent,i=void 0!==e.attributes.color,o=void 0===e.attributes.normal,s=!0===t.isSkinnedMesh,a=Object.keys(e.morphAttributes).length>0,l=a&&void 0!==e.morphAttributes.normal;if(t.isPoints){var c="PointsMaterial:"+n.uuid,u=this.cache.get(c);u||(u=new $i,Wt.prototype.copy.call(u,n),u.color.copy(n.color),u.map=n.map,u.sizeAttenuation=!1,this.cache.add(c,u)),n=u}else if(t.isLine){c="LineBasicMaterial:"+n.uuid;var h=this.cache.get(c);h||(h=new Hi,Wt.prototype.copy.call(h,n),h.color.copy(n.color),this.cache.add(c,h)),n=h}if(r||i||o||s||a){c="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(c+="specular-glossiness:"),s&&(c+="skinning:"),r&&(c+="vertex-tangents:"),i&&(c+="vertex-colors:"),o&&(c+="flat-shading:"),a&&(c+="morph-targets:"),l&&(c+="morph-normals:");var f=this.cache.get(c);f||(f=n.clone(),s&&(f.skinning=!0),i&&(f.vertexColors=!0),o&&(f.flatShading=!0),a&&(f.morphTargets=!0),l&&(f.morphNormals=!0),r&&(f.vertexTangents=!0,f.normalScale&&(f.normalScale.y*=-1),f.clearcoatNormalScale&&(f.clearcoatNormalScale.y*=-1)),this.cache.add(c,f),this.associations.set(f,this.associations.get(n))),n=f}n.aoMap&&void 0===e.attributes.uv2&&void 0!==e.attributes.uv&&e.setAttribute("uv2",e.attributes.uv),t.material=n},Z.prototype.getMaterialType=function(){return Xo},Z.prototype.loadMaterial=function(t){var e,r=this,i=this.json,o=this.extensions,s=i.materials[t],a={},l=s.extensions||{},c=[];if(l[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var h=o[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];e=h.getMaterialType(),c.push(h.extendParams(a,s,r))}else if(l[n.KHR_MATERIALS_UNLIT]){var f=o[n.KHR_MATERIALS_UNLIT];e=f.getMaterialType(),c.push(f.extendParams(a,s,r))}else{var d=s.pbrMetallicRoughness||{};if(a.color=new Ut(1,1,1),a.opacity=1,Array.isArray(d.baseColorFactor)){var p=d.baseColorFactor;a.color.fromArray(p),a.opacity=p[3]}void 0!==d.baseColorTexture&&c.push(r.assignTexture(a,"map",d.baseColorTexture)),a.metalness=void 0!==d.metallicFactor?d.metallicFactor:1,a.roughness=void 0!==d.roughnessFactor?d.roughnessFactor:1,void 0!==d.metallicRoughnessTexture&&(c.push(r.assignTexture(a,"metalnessMap",d.metallicRoughnessTexture)),c.push(r.assignTexture(a,"roughnessMap",d.metallicRoughnessTexture))),e=this._invokeOne((function(e){return e.getMaterialType&&e.getMaterialType(t)})),c.push(Promise.all(this._invokeAll((function(e){return e.extendMaterialParams&&e.extendMaterialParams(t,a)}))))}!0===s.doubleSided&&(a.side=2);var m=s.alphaMode||z;return m===H?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,m===U&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&e!==Vt&&(c.push(r.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new u(1,-1),void 0!==s.normalTexture.scale&&a.normalScale.set(s.normalTexture.scale,-s.normalTexture.scale)),void 0!==s.occlusionTexture&&e!==Vt&&(c.push(r.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&e!==Vt&&(a.emissive=(new Ut).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&e!==Vt&&c.push(r.assignTexture(a,"emissiveMap",s.emissiveTexture)),Promise.all(c).then((function(){var i;return i=e===b?o[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):new e(a),s.name&&(i.name=s.name),i.map&&(i.map.encoding=3001),i.emissiveMap&&(i.emissiveMap.encoding=3001),V(i,s),r.associations.set(i,{type:"materials",index:t}),s.extensions&&W(o,i,s),i}))},Z.prototype.createUniqueName=function(t){for(var e=Ua.sanitizeNodeName(t||""),n=e,r=1;this.nodeNamesUsed[n];++r)n=e+"_"+r;return this.nodeNamesUsed[n]=!0,n},Z.prototype.loadGeometries=function(t){var e=this,r=this.extensions,i=this.primitiveCache;function o(t){return r[n.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,e).then((function(n){return J(n,t,e)}))}for(var s,a,l=[],c=0,u=t.length;c<u;c++){var h,f=t[c],d=(a=void 0,(a=(s=f).extensions&&s.extensions[n.KHR_DRACO_MESH_COMPRESSION])?"draco:"+a.bufferView+":"+a.indices+":"+X(a.attributes):s.indices+":"+X(s.attributes)+":"+s.mode),p=i[d];if(p)l.push(p.promise);else h=f.extensions&&f.extensions[n.KHR_DRACO_MESH_COMPRESSION]?o(f):J(new me,f,e),i[d]={primitive:f,promise:h},l.push(h)}return Promise.all(l)},Z.prototype.loadMesh=function(t){for(var e,n=this,r=this.json,i=this.extensions,o=r.meshes[t],s=o.primitives,a=[],l=0,c=s.length;l<c;l++){var u=void 0===s[l].material?(void 0===(e=this.cache).DefaultMaterial&&(e.DefaultMaterial=new Xo({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),e.DefaultMaterial):this.getDependency("material",s[l].material);a.push(u)}return a.push(n.loadGeometries(s)),Promise.all(a).then((function(e){for(var r=e.slice(0,e.length-1),a=e[e.length-1],l=[],c=0,u=a.length;c<u;c++){var h,f=a[c],d=s[c],p=r[c];if(d.mode===P||d.mode===L||d.mode===R||void 0===d.mode)h=!0===o.isSkinnedMesh?new Oi(f,p):new ke(f,p),!0===p.isMeshStandardMaterial&&2===p.side&&null!==f.getIndex()&&!0===f.hasAttribute("position")&&!0===f.hasAttribute("normal")&&!0===f.hasAttribute("uv")&&!1===f.hasAttribute("tangent")&&(f.computeTangents(),p.vertexTangents=!0),!0!==h.isSkinnedMesh||h.geometry.attributes.skinWeight.normalized||h.normalizeSkinWeights(),d.mode===L?h.geometry=K(h.geometry,1):d.mode===R&&(h.geometry=K(h.geometry,2));else if(d.mode===T)h=new Ki(f,p);else if(d.mode===A)h=new Yi(f,p);else if(d.mode===C)h=new Qi(f,p);else{if(d.mode!==E)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+d.mode);h=new io(f,p)}Object.keys(h.geometry.morphAttributes).length>0&&q(h,o),h.name=n.createUniqueName(o.name||"mesh_"+t),V(h,o),d.extensions&&W(i,h,d),n.assignFinalMaterial(h),l.push(h)}if(1===l.length)return l[0];var m=new Qr;for(c=0,u=l.length;c<u;c++)m.add(l[c]);return m}))},Z.prototype.loadCamera=function(t){var e,n=this.json.cameras[t],r=n[n.type];if(r)return"perspective"===n.type?e=new Ue(c.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(e=new oa(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(e.name=this.createUniqueName(n.name)),V(e,n),Promise.resolve(e);console.warn("THREE.GLTFLoader: Missing camera parameters.")},Z.prototype.loadSkin=function(t){var e=this.json.skins[t],n={joints:e.joints};return void 0===e.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",e.inverseBindMatrices).then((function(t){return n.inverseBindMatrices=t,n}))},Z.prototype.loadAnimation=function(t){for(var e=this.json.animations[t],n=[],r=[],i=[],o=[],s=[],a=0,l=e.channels.length;a<l;a++){var c=e.channels[a],u=e.samplers[c.sampler],h=c.target,f=void 0!==h.node?h.node:h.id,d=void 0!==e.parameters?e.parameters[u.input]:u.input,p=void 0!==e.parameters?e.parameters[u.output]:u.output;n.push(this.getDependency("node",f)),r.push(this.getDependency("accessor",d)),i.push(this.getDependency("accessor",p)),o.push(u),s.push(h)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(i),Promise.all(o),Promise.all(s)]).then((function(n){for(var r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],l=[],c=0,u=r.length;c<u;c++){var h=r[c],f=i[c],d=o[c],p=s[c],m=a[c];if(void 0!==h){var g;switch(h.updateMatrix(),h.matrixAutoUpdate=!0,j[m.path]){case j.weights:g=us;break;case j.rotation:g=fs;break;case j.position:case j.scale:default:g=ps}var v=h.name?h.name:h.uuid,y=void 0!==p.interpolation?F[p.interpolation]:2301,b=[];j[m.path]===j.weights?h.traverse((function(t){!0===t.isMesh&&t.morphTargetInfluences&&b.push(t.name?t.name:t.uuid)})):b.push(v);var _=d.array;if(d.normalized){var x;if(_.constructor===Int8Array)x=1/127;else if(_.constructor===Uint8Array)x=1/255;else if(_.constructor==Int16Array)x=1/32767;else{if(_.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");x=1/65535}for(var w=new Float32Array(_.length),M=0,E=_.length;M<E;M++)w[M]=_[M]*x;_=w}for(M=0,E=b.length;M<E;M++){var T=new g(b[M]+"."+j[m.path],f.array,_,y);"CUBICSPLINE"===p.interpolation&&(T.createInterpolant=function(t){return new S(this.times,this.values,this.getValueSize()/3,t)},T.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(T)}}}return new ms(e.name?e.name:"animation_"+t,void 0,l)}))},Z.prototype.loadNode=function(t){var e,n=this.json,r=this.extensions,i=this,o=n.nodes[t],s=o.name?i.createUniqueName(o.name):"";return(e=[],void 0!==o.mesh&&e.push(i.getDependency("mesh",o.mesh).then((function(t){var e=i._getNodeRef(i.meshCache,o.mesh,t);return void 0!==o.weights&&e.traverse((function(t){if(t.isMesh)for(var e=0,n=o.weights.length;e<n;e++)t.morphTargetInfluences[e]=o.weights[e]})),e}))),void 0!==o.camera&&e.push(i.getDependency("camera",o.camera).then((function(t){return i._getNodeRef(i.cameraCache,o.camera,t)}))),i._invokeAll((function(e){return e.createNodeAttachment&&e.createNodeAttachment(t)})).forEach((function(t){e.push(t)})),Promise.all(e)).then((function(e){var n;if((n=!0===o.isBone?new ki:e.length>1?new Qr:1===e.length?e[0]:new bt)!==e[0])for(var a=0,l=e.length;a<l;a++)n.add(e[a]);if(o.name&&(n.userData.name=o.name,n.name=s),V(n,o),o.extensions&&W(r,n,o),void 0!==o.matrix){var c=new Y;c.fromArray(o.matrix),n.applyMatrix4(c)}else void 0!==o.translation&&n.position.fromArray(o.translation),void 0!==o.rotation&&n.quaternion.fromArray(o.rotation),void 0!==o.scale&&n.scale.fromArray(o.scale);return i.associations.set(n,{type:"nodes",index:t}),n}))},Z.prototype.loadScene=function(){function t(e,n,r,i){var o=r.nodes[e];return i.getDependency("node",e).then((function(t){return void 0===o.skin?t:i.getDependency("skin",o.skin).then((function(t){for(var n=[],r=0,o=(e=t).joints.length;r<o;r++)n.push(i.getDependency("node",e.joints[r]));return Promise.all(n)})).then((function(n){return t.traverse((function(t){if(t.isMesh){for(var r=[],i=[],o=0,s=n.length;o<s;o++){var a=n[o];if(a){r.push(a);var l=new Y;void 0!==e.inverseBindMatrices&&l.fromArray(e.inverseBindMatrices.array,16*o),i.push(l)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',e.joints[o])}t.bind(new Ni(r,i),t.matrixWorld)}})),t}));var e})).then((function(e){n.add(e);var s=[];if(o.children)for(var a=o.children,l=0,c=a.length;l<c;l++){var u=a[l];s.push(t(u,e,r,i))}return Promise.all(s)}))}return function(e){var n=this.json,r=this.extensions,i=this.json.scenes[e],o=new Qr;i.name&&(o.name=this.createUniqueName(i.name)),V(o,i),i.extensions&&W(r,o,i);for(var s=i.nodes||[],a=[],l=0,c=s.length;l<c;l++)a.push(t(s[l],o,n,this));return Promise.all(a).then((function(){return o}))}}(),t}();class mf extends class{constructor(){this.fetchOptions={}}load(t){return fetch(t,this.fetchOptions).then(e=>{if(!e.ok)throw new Error(`Failed to load file "${t}" with status ${e.status} : ${e.statusText}`);return e.arrayBuffer()}).then(t=>this.parse(t))}parse(t){const e=new DataView(t),n=String.fromCharCode(e.getUint8(0))+String.fromCharCode(e.getUint8(1))+String.fromCharCode(e.getUint8(2))+String.fromCharCode(e.getUint8(3));console.assert("b3dm"===n);const r=e.getUint32(4,!0);console.assert(1===r);const i=e.getUint32(8,!0);console.assert(i===t.byteLength);const o=e.getUint32(12,!0),s=e.getUint32(16,!0),a=e.getUint32(20,!0),l=e.getUint32(24,!0),c=t.slice(28,28+o+s),u=new ff(c,0,o,s),h=28+o+s,f=t.slice(h,h+a+l),d=new df(f,u.getData("BATCH_LENGTH"),0,a,l),p=h+a+l;return{version:r,featureTable:u,batchTable:d,glbBytes:new Uint8Array(t,p,i-p)}}}{constructor(t=bs){super(),this.manager=t}parse(t){const e=super.parse(t),n=e.glbBytes.slice().buffer;return new Promise((t,r)=>{const i=this.manager;(i.getHandler("path.gltf")||new pf(i)).parse(n,null,n=>{const{batchTable:r,featureTable:i}=e,{scene:o}=n,s=i.getData("RTC_CENTER");s&&(o.position.x+=s[0],o.position.y+=s[1],o.position.z+=s[2]),n.batchTable=r,n.featureTable=i,o.batchTable=r,o.featureTable=i,t(n)},r)})}}class gf extends class{constructor(){this.fetchOptions={}}load(t){return fetch(t,this.fetchOptions).then(e=>{if(!e.ok)throw new Error(`Failed to load file "${t}" with status ${e.status} : ${e.statusText}`);return e.arrayBuffer()}).then(t=>this.parse(t))}parse(t){const e=new DataView(t),n=String.fromCharCode(e.getUint8(0))+String.fromCharCode(e.getUint8(1))+String.fromCharCode(e.getUint8(2))+String.fromCharCode(e.getUint8(3));console.assert("pnts"===n);const r=e.getUint32(4,!0);console.assert(1===r);const i=e.getUint32(8,!0);console.assert(i===t.byteLength);const o=e.getUint32(12,!0),s=e.getUint32(16,!0),a=e.getUint32(20,!0),l=e.getUint32(24,!0),c=t.slice(28,28+o+s),u=new ff(c,0,o,s),h=28+o+s,f=t.slice(h,h+a+l),d=new df(f,u.getData("BATCH_LENGTH")||u.getData("POINTS_LENGTH"),0,a,l);return{version:r,featureTable:u,batchTable:d}}}{constructor(t=bs){super(),this.manager=t}parse(t){const e=super.parse(t),{featureTable:n}=e,r=n.getData("POINTS_LENGTH"),i=n.getData("POSITION",r,"FLOAT","VEC3"),o=n.getData("RGB",r,"UNSIGNED_BYTE","VEC3");if(null===i)throw new Error("PNTSLoader : POSITION_QUANTIZED feature type is not supported.");const s=new me;s.setAttribute("position",new Yt(i,3,!1));const a=new $i;a.size=2,a.sizeAttenuation=!1,null!==o&&(s.setAttribute("color",new Yt(o,3,!0)),a.vertexColors=!0);const l=new io(s,a);return e.scene=l,e.scene.featureTable=n,e}}const vf=new _,yf=new b,bf=new _,_f=new Y;class xf extends class{constructor(){this.fetchOptions={},this.workingPath=""}resolveExternalURL(t){return this.workingPath+"/"+t}load(t){return fetch(t,this.fetchOptions).then(e=>{if(!e.ok)throw new Error(`Failed to load file "${t}" with status ${e.status} : ${e.statusText}`);return e.arrayBuffer()}).then(e=>{if(""===this.workingPath){const e=t.split(/\\\//g);e.pop(),this.workingPath=e.join("/")}return this.parse(e)})}parse(t){const e=new DataView(t),n=String.fromCharCode(e.getUint8(0))+String.fromCharCode(e.getUint8(1))+String.fromCharCode(e.getUint8(2))+String.fromCharCode(e.getUint8(3));console.assert("i3dm"===n);const r=e.getUint32(4,!0);console.assert(1===r);const i=e.getUint32(8,!0);console.assert(i===t.byteLength);const o=e.getUint32(12,!0),s=e.getUint32(16,!0),a=e.getUint32(20,!0),l=e.getUint32(24,!0),c=e.getUint32(28,!0),u=t.slice(32,32+o+s),h=new ff(u,0,o,s),f=32+o+s,d=t.slice(f,f+a+l),p=new df(d,h.getData("INSTANCES_LENGTH"),0,a,l),m=f+a+l,g=new Uint8Array(t,m,i-m);let v=null,y=null;if(c)v=g,y=Promise.resolve();else{const t=this.resolveExternalURL(hf(g));y=fetch(t,this.fetchOptions).then(e=>{if(!e.ok)throw new Error(`I3DMLoaderBase : Failed to load file "${t}" with status ${e.status} : ${e.statusText}`);return e.arrayBuffer()}).then(t=>{v=new Uint8Array(t)})}return y.then(()=>({version:r,featureTable:h,batchTable:p,glbBytes:v}))}}{constructor(t=bs){super(),this.manager=t}resolveExternalURL(t){return this.manager.resolveURL(super.resolveExternalURL(t))}parse(t){return super.parse(t).then(t=>{const{featureTable:e,batchTable:n}=t,r=t.glbBytes.slice().buffer;return new Promise((t,i)=>{const o=this.manager;(o.getHandler("path.gltf")||new pf(o)).parse(r,null,r=>{const i=e.getData("INSTANCES_LENGTH"),o=e.getData("POSITION",i,"FLOAT","VEC3"),s=new Map,a=[];r.scene.traverse(t=>{if(t.isMesh){const{geometry:e,material:n}=t,r=new Ui(e,n,i);a.push(r),s.set(t,r)}});const l=new _;for(let t=0;t<i;t++)l.x+=o[3*t+0]/i,l.y+=o[3*t+1]/i,l.z+=o[3*t+2]/i;s.forEach((t,e)=>{const n=e.parent;n&&(n.remove(e),n.add(t),t.position.copy(l))});for(let t=0;t<i;t++){vf.set(o[3*t+0]-l.x,o[3*t+1]-l.y,o[3*t+2]-l.z),yf.set(0,0,0,1),bf.set(1,1,1),_f.compose(vf,yf,bf);for(let e=0,n=a.length;e<n;e++){a[e].setMatrixAt(t,_f)}}r.batchTable=n,r.featureTable=e,r.scene.batchTable=n,r.scene.featureTable=e,t(r)},i)})})}}class wf extends class{constructor(){this.fetchOptions={},this.workingPath=""}load(t){return fetch(t,this.fetchOptions).then(e=>{if(!e.ok)throw new Error(`Failed to load file "${t}" with status ${e.status} : ${e.statusText}`);return e.arrayBuffer()}).then(e=>{if(""===this.workingPath){const e=t.split(/\\\//g);e.pop(),this.workingPath=e.join("/")}return this.parse(e)})}parse(t){const e=new DataView(t),n=String.fromCharCode(e.getUint8(0))+String.fromCharCode(e.getUint8(1))+String.fromCharCode(e.getUint8(2))+String.fromCharCode(e.getUint8(3));console.assert("cmpt"===n);const r=e.getUint32(4,!0);console.assert(1===r);const i=e.getUint32(8,!0);console.assert(i===t.byteLength);const o=e.getUint32(12,!0),s=[];let a=16;for(let e=0;e<o;e++){const e=new DataView(t,a,12),n=String.fromCharCode(e.getUint8(0))+String.fromCharCode(e.getUint8(1))+String.fromCharCode(e.getUint8(2))+String.fromCharCode(e.getUint8(3)),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=new Uint8Array(t,a,i);s.push({type:n,buffer:o,version:r}),a+=i}return{version:r,tiles:s}}}{constructor(t=bs){super(),this.manager=t}parse(t){const e=super.parse(t),n=this.manager,r=new Qr,i=[],o=[];for(const t in e.tiles){const{type:s,buffer:a}=e.tiles[t];switch(s){case"b3dm":{const t=a.slice(),e=new mf(n).parse(t.buffer).then(t=>{i.push(t),r.add(t.scene)});o.push(e);break}case"pnts":{const t=a.slice(),e=new gf(n).parse(t.buffer);i.push(e),r.add(e.scene);break}case"i3dm":{const t=a.slice(),e=new xf(n);e.workingPath=this.workingPath,e.fetchOptions=this.fetchOptions;const s=e.parse(t.buffer).then(t=>{i.push(t),r.add(t.scene)});o.push(s);break}}}return Promise.all(o).then(()=>({tiles:i,scene:r}))}}const Mf=new Y;class Sf extends Qr{constructor(t){super(),this.tilesRenderer=t}raycast(t,e){this.tilesRenderer.raycast(t,e)}updateMatrixWorld(t){if(this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldNeedsUpdate||t){null===this.parent?Mf.copy(this.matrix):Mf.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1;const t=Mf.elements,e=this.matrixWorld.elements;let n=!1;for(let r=0;r<16;r++){const i=t[r],o=e[r];if(Math.abs(i-o)>Number.EPSILON){n=!0;break}}if(n){this.matrixWorld.copy(Mf);const t=this.children;for(let e=0,n=t.length;e<n;e++)t[e].updateMatrixWorld()}}}}const Ef=new B,Tf=new Y,Cf=new _,Af=new _,Pf=new X,Lf=[];function Rf(t,e){return t.distance-e.distance}function Of(t,e,n){t.traverse(t=>{Object.getPrototypeOf(t).raycast.call(t,e,n)})}const kf=Symbol("INITIAL_FRUSTUM_CULLED"),If=c.DEG2RAD,Df=new Y,Nf=new Y,jf=new _,Ff=new _,Bf=new _,zf=new _,Uf=new _(1,0,0),Hf=new _(0,1,0);function Gf(){}function Wf(t,e){t.traverse(t=>{t.frustumCulled=t[kf]&&e})}class Vf extends class{get rootTileSet(){const t=this.tileSets[this.rootURL];return!t||t instanceof Promise?null:t}get root(){const t=this.rootTileSet;return t?t.root:null}constructor(t){this.tileSets={},this.rootURL=t,this.fetchOptions={},this.preprocessURL=null;const e=new ef;e.unloadPriorityCallback=uf;const n=new nf;n.maxJobs=4,n.priorityCallback=uf;const r=new nf;r.maxJobs=1,r.priorityCallback=uf,this.lruCache=e,this.downloadQueue=n,this.parseQueue=r,this.stats={parsing:0,downloading:0,failed:0,inFrustum:0,used:0,active:0,visible:0},this.frameCount=0,this.errorTarget=6,this.errorThreshold=1/0,this.loadSiblings=!0,this.displayActiveTiles=!1,this.maxDepth=1/0,this.stopAtEmptyTiles=!0}traverse(t,e){const n=this.tileSets[this.rootURL];n&&n.root&&cf(n.root,t,e)}update(){const t=this.stats,e=this.lruCache,n=this.tileSets,r=n[this.rootURL];if(!(this.rootURL in n))return void this.loadRootTileSet(this.rootURL);if(!r||!r.root)return;const i=r.root;t.inFrustum=0,t.used=0,t.active=0,t.visible=0,this.frameCount++,function t(e,n){const r=n.stats,i=n.frameCount,o=n.errorTarget,s=n.maxDepth,a=n.loadSiblings,l=n.lruCache,c=n.stopAtEmptyTiles;if(sf(e,i),!1===n.tileInView(e))return!1;if(e.__used=!0,l.markUsed(e),e.__inFrustum=!0,r.inFrustum++,(c||!e.__contentEmpty)&&!e.__externalTileSet){const t=n.calculateError(e);if(e.__error=t,t<=o)return!0;if(n.maxDepth>0&&e.__depth+1>=s)return!0}let u=!1;const h=e.children;for(let e=0,r=h.length;e<r;e++){const r=t(h[e],n);u=u||r}if(u&&a)for(let t=0,e=h.length;t<e;t++){af(h[t],i,l)}return!0}(i,this),function t(e,n){const r=n.stats,i=n.frameCount;if(!of(e,i))return;r.used++;const o=e.children;let s=!1;for(let t=0,e=o.length;t<e;t++){const e=o[t];s=s||of(e,i)}if(s){let r=!1,s=!0;for(let e=0,a=o.length;e<a;e++){const a=o[e];if(t(a,n),r=r||a.__wasSetVisible||a.__childrenWereVisible,of(a,i)){const t=a.__allChildrenLoaded||!a.__contentEmpty&&rf(a.__loadingState)||a.__externalTileSet&&4===a.__loadingState;s=s&&t}}e.__childrenWereVisible=r,e.__allChildrenLoaded=s}else e.__isLeaf=!0}(i,this),function t(e,n){const r=n.stats,i=n.frameCount;if(!of(e,i))return;const o=e.parent,s=o?o.__depthFromRenderedParent:-1;e.__depthFromRenderedParent=s;const a=n.lruCache;if(e.__isLeaf)return e.__depthFromRenderedParent++,void(3===e.__loadingState?(e.__inFrustum&&(e.__visible=!0,r.visible++),e.__active=!0,r.active++):a.isFull()||e.__contentEmpty&&!e.__externalTileSet||n.requestTileContents(e));const l=(n.errorTarget+1)*n.errorThreshold,c=e.__error<=l,u=c||"ADD"===e.refine,h=!e.__contentEmpty,f=h||e.__externalTileSet,d=rf(e.__loadingState)&&f,p=e.__childrenWereVisible,m=e.children;let g=e.__allChildrenLoaded;if(u&&h&&e.__depthFromRenderedParent++,u&&!d&&!a.isFull()&&f&&n.requestTileContents(e),(c&&!g&&!p&&d||"ADD"===e.refine&&d)&&(e.__inFrustum&&(e.__visible=!0,r.visible++),e.__active=!0,r.active++),"ADD"!==e.refine&&c&&!g&&d)for(let t=0,r=m.length;t<r;t++){const r=m[t];of(r,i)&&!a.isFull()&&(r.__depthFromRenderedParent=e.__depthFromRenderedParent+1,lf(r,r.__depthFromRenderedParent,n))}else for(let e=0,r=m.length;e<r;e++){const r=m[e];of(r,i)&&t(r,n)}}(i,this),function t(e,n){const r=of(e,n.frameCount);if(r||e.__usedLastFrame){let i=!1,o=!1;r&&(i=e.__active,o=n.displayActiveTiles&&e.__active||e.__visible),e.__contentEmpty||3!==e.__loadingState||(e.__wasSetActive!==i&&n.setTileActive(e,i),e.__wasSetVisible!==o&&n.setTileVisible(e,o)),e.__wasSetActive=i,e.__wasSetVisible=o,e.__usedLastFrame=r;const s=e.children;for(let e=0,r=s.length;e<r;e++){t(s[e],n)}}}(i,this),e.scheduleUnload()}parseTile(t,e,n){return null}disposeTile(t){}preprocessNode(t,e,n){t.content&&(!("uri"in t.content)&&"url"in t.content&&(t.content.uri=t.content.url,delete t.content.url),t.content.uri&&(t.content.uri=function(...t){const e=/^[a-zA-Z]+:\/\//;let n=-1;for(let r=0,i=t.length;r<i;r++)e.test(t[r])&&(n=r);if(-1===n)return tf.a.join(...t).replace(/\\/g,"/");{const r=n<=0?t:t.slice(n),i=r[0].match(e)[0];return r[0]=r[0].substring(i.length),(i+tf.a.join(...r)).replace(/\\/g,"/")}}(n,t.content.uri)),t.content.boundingVolume&&!("box"in t.content.boundingVolume||"sphere"in t.content.boundingVolume||"region"in t.content.boundingVolume)&&delete t.content.boundingVolume),t.parent=e,t.children=t.children||[];if(t.content&&t.content.uri){const e=/\.json$/i.test(t.content.uri);t.__externalTileSet=e,t.__contentEmpty=e}else t.__externalTileSet=!1,t.__contentEmpty=!0;t.__error=0,t.__inFrustum=!1,t.__isLeaf=!1,t.__usedLastFrame=!1,t.__used=!1,t.__wasSetVisible=!1,t.__visible=!1,t.__childrenWereVisible=!1,t.__allChildrenLoaded=!1,t.__wasSetActive=!1,t.__active=!1,t.__loadingState=0,t.__loadIndex=0,t.__loadAbort=null,t.__depthFromRenderedParent=-1,null===e?(t.__depth=0,t.refine=t.refine||"REPLACE"):(t.__depth=e.__depth+1,t.refine=t.refine||e.refine)}setTileActive(t,e){}setTileVisible(t,e){}calculateError(t){return 0}tileInView(t){return!0}fetchTileSet(t,e,n=null){return fetch(t,e).then(e=>{if(e.ok)return e.json();throw new Error(`TilesRenderer: Failed to load tileset "${t}" with status ${e.status} : ${e.statusText}`)}).then(e=>{const r=e.asset.version;console.assert("1.0"===r||"0.0"===r,'asset.version is expected to be a string of "1.0" or "0.0"');const i=tf.a.dirname(t);return cf(e.root,(t,e)=>this.preprocessNode(t,e,i),null,n,n?n.__depth:0),e})}loadRootTileSet(t){const e=this.tileSets;if(t in e)return e[t]instanceof Error?Promise.reject(e[t]):Promise.resolve(e[t]);{const n=this.fetchTileSet(t,this.fetchOptions).then(n=>{e[t]=n});return n.catch(n=>{console.error(n),e[t]=n}),e[t]=n,n}}requestTileContents(t){if(0!==t.__loadingState)return;const e=this.stats,n=this.lruCache,r=this.downloadQueue,i=this.parseQueue,o=t.__externalTileSet;n.add(t,t=>{1===t.__loadingState?(t.__loadAbort.abort(),t.__loadAbort=null):o?t.children.length=0:this.disposeTile(t),1===t.__loadingState?e.downloading--:2===t.__loadingState&&e.parsing--,t.__loadingState=0,t.__loadIndex++,i.remove(t),r.remove(t)}),t.__loadIndex++;const s=t.__loadIndex,a=new AbortController,l=a.signal;e.downloading++,t.__loadAbort=a,t.__loadingState=1;const c=o=>{t.__loadIndex===s&&("AbortError"!==o.name?(i.remove(t),r.remove(t),2===t.__loadingState?e.parsing--:1===t.__loadingState&&e.downloading--,e.failed++,console.error(`TilesRenderer : Failed to load tile at url "${t.content.uri}".`),console.error(o),t.__loadingState=4):n.remove(t))};o?r.add(t,t=>{if(t.__loadIndex!==s)return Promise.resolve();const e=this.preprocessURL?this.preprocessURL(t.content.uri):t.content.uri;return this.fetchTileSet(e,Object.assign({signal:l},this.fetchOptions),t)}).then(n=>{t.__loadIndex===s&&(e.downloading--,t.__loadAbort=null,t.__loadingState=3,t.children.push(n.root))}).catch(c):r.add(t,t=>{if(t.__loadIndex!==s)return Promise.resolve();const e=this.preprocessURL?this.preprocessURL(t.content.uri):t.content.uri;return fetch(e,Object.assign({signal:l},this.fetchOptions))}).then(e=>{if(t.__loadIndex===s){if(e.ok)return e.arrayBuffer();throw new Error("Failed to load model with error code "+e.status)}}).then(n=>{if(t.__loadIndex===s)return e.downloading--,e.parsing++,t.__loadAbort=null,t.__loadingState=2,i.add(t,t=>{if(t.__loadIndex!==s)return Promise.resolve();const e=t.content.uri.split(/\./g).pop();return this.parseTile(n,t,e)})}).then(()=>{t.__loadIndex===s&&(e.parsing--,t.__loadingState=3,t.__wasSetVisible&&this.setTileVisible(t,!0),t.__wasSetActive&&this.setTileActive(t,!0))}).catch(c)}dispose(){const t=this.lruCache;this.traverse(e=>{t.remove(e)})}}{get autoDisableRendererCulling(){return this._autoDisableRendererCulling}set autoDisableRendererCulling(t){this._autoDisableRendererCulling!==t&&(super._autoDisableRendererCulling=t,this.traverse(e=>{e.scene&&Wf(e.scene,t)}))}constructor(...t){super(...t),this.group=new Sf(this),this.cameras=[],this.cameraMap=new Map,this.cameraInfo=[],this.activeTiles=new Set,this.visibleTiles=new Set,this._autoDisableRendererCulling=!0,this.onLoadTileSet=null,this.onLoadModel=null,this.onDisposeModel=null;const e=new ys;e.setURLModifier(t=>this.preprocessURL?this.preprocessURL(t):t),this.manager=e}getBounds(t){if(!this.root)return!1;const e=this.root.cached,n=e.box,r=e.boxTransform;return!!n&&(t.copy(n),t.applyMatrix4(r),!0)}getOrientedBounds(t,e){if(!this.root)return!1;const n=this.root.cached,r=n.box,i=n.boxTransform;return!!t&&(t.copy(r),e.copy(i),!0)}forEachLoadedModel(t){this.traverse(e=>{const n=e.cached.scene;n&&t(n,e)})}raycast(t,e){if(this.root)if(t.firstHitOnly){const n=function t(e,n,r,i){if(r.has(e)){if(Of(e.cached.scene,i,Lf),Lf.length>0){Lf.length>1&&Lf.sort(Rf);const t=Lf[0];return Lf.length=0,t}return null}const o=[],s=e.children;for(let t=0,e=s.length;t<e;t++){const e=s[t],r=e.cached,a=n.matrixWorld;Tf.copy(a);const l=r.sphere;if(l&&(Ef.copy(l),Ef.applyMatrix4(Tf),!i.ray.intersectsSphere(Ef)))continue;const c=r.box,u=r.boxTransform;if(c){if(Tf.multiply(u).invert(),Pf.copy(i.ray),Pf.applyMatrix4(Tf),!Pf.intersectBox(c,Cf))continue;{let t;Af.setFromMatrixScale(Tf),t=Af.x,Math.abs(Math.max(Af.x-Af.y,Af.x-Af.z))>1e-6&&console.warn("ThreeTilesRenderer : Non uniform scale used for tile which may cause issues when raycasting.");let n={distance:1/0,tile:null};o.push(n),n.distance=Cf.distanceToSquared(Pf.origin)*t*t,n.tile=e}}}o.sort(Rf);let a=1/0,l=null;for(let e=0,s=o.length;e<s;e++){const s=o[e];if(s.distance>a)break;{const e=s.tile,o=e.cached.scene;let c=null;if(r.has(e)?(Of(o,i,Lf),Lf.length>0&&(Lf.length>1&&Lf.sort(Rf),c=Lf[0])):c=t(e,n,r,i),c){const t=c.distance*c.distance;t<a&&(a=t,l=c),Lf.length=0}}}return l}(this.root,this.group,this.activeTiles,t);n&&e.push(n)}else!function t(e,n,r,i,o){const s=e.cached,a=n.matrixWorld;Tf.copy(a);const l=s.sphere;if(l&&(Ef.copy(l),Ef.applyMatrix4(Tf),!i.ray.intersectsSphere(Ef)))return;const c=s.box,u=s.boxTransform;if(c&&(Tf.multiply(u).invert(),Pf.copy(i.ray).applyMatrix4(Tf),!Pf.intersectsBox(c)))return;const h=s.scene;if(r.has(e))return void Of(h,i,o);const f=e.children;for(let e=0,s=f.length;e<s;e++)t(f[e],n,r,i,o)}(this.root,this.group,this.activeTiles,t,e)}hasCamera(t){return this.cameraMap.has(t)}setCamera(t){const e=this.cameras,n=this.cameraMap;return!n.has(t)&&(n.set(t,new u),e.push(t),!0)}setResolution(t,e,n){const r=this.cameraMap;return!!r.has(t)&&(e instanceof u?r.get(t).copy(e):r.get(t).set(e,n),!0)}setResolutionFromRenderer(t,e){const n=this.cameraMap;if(!n.has(t))return!1;const r=n.get(t);return e.getSize(r),r.multiplyScalar(e.getPixelRatio()),!0}deleteCamera(t){const e=this.cameras,n=this.cameraMap;if(n.has(t)){const r=e.indexOf(t);return e.splice(r,1),n.delete(t),!0}return!1}fetchTileSet(t,...e){const n=super.fetchTileSet(t,...e);return n.then(e=>{this.onLoadTileSet&&Promise.resolve().then(()=>{this.onLoadTileSet(e,t)})}),n}update(){const t=this.group,e=this.cameras,n=this.cameraMap,r=this.cameraInfo;if(0===e.length)return void console.warn("TilesRenderer: no cameras defined. Cannot update 3d tiles.");for(;r.length>e.length;)r.pop();for(;r.length<e.length;)r.push({frustum:new Ye,sseDenominator:-1,position:new _,invScale:-1,pixelSize:0});let i;Nf.copy(t.matrixWorld).invert(),jf.setFromMatrixScale(Nf),i=jf.x,Math.abs(Math.max(jf.x-jf.y,jf.x-jf.z))>1e-6&&console.warn("ThreeTilesRenderer : Non uniform scale used for tile which may cause issues when calculating screen space error.");for(let o=0,s=r.length;o<s;o++){const s=e[o],a=r[o],l=a.frustum,c=a.position,u=n.get(s);if(0!==u.width&&0!==u.height||console.warn("TilesRenderer: resolution for camera error calculation is not set."),s.isPerspectiveCamera&&(a.sseDenominator=2*Math.tan(.5*s.fov*If)/u.height),s.isOrthographicCamera){const t=s.right-s.left,e=s.top-s.bottom;a.pixelSize=Math.max(e/u.height,t/u.width)}a.invScale=i,Df.copy(t.matrixWorld),Df.premultiply(s.matrixWorldInverse),Df.premultiply(s.projectionMatrix),l.setFromProjectionMatrix(Df),c.set(0,0,0),c.applyMatrix4(s.matrixWorld),c.applyMatrix4(Nf)}super.update()}preprocessNode(t,e,n){super.preprocessNode(t,e,n);const r=new Y;if(t.transform){const e=t.transform;for(let t=0;t<16;t++)r.elements[t]=e[t]}else r.identity();e&&r.premultiply(e.cached.transform);let i=null,o=null,s=null;if("box"in t.boundingVolume){const e=t.boundingVolume.box;i=new M,o=new Y,s=new Y,Ff.set(e[3],e[4],e[5]),Bf.set(e[6],e[7],e[8]),zf.set(e[9],e[10],e[11]);const n=Ff.length(),a=Bf.length(),l=zf.length();Ff.normalize(),Bf.normalize(),zf.normalize(),o.set(Ff.x,Bf.x,zf.x,e[0],Ff.y,Bf.y,zf.y,e[1],Ff.z,Bf.z,zf.z,e[2],0,0,0,1),o.premultiply(r),s.copy(o).invert(),i.min.set(-n,-a,-l),i.max.set(n,a,l)}let a=null;if("sphere"in t.boundingVolume){const e=t.boundingVolume.sphere;a=new B,a.center.set(e[0],e[1],e[2]),a.radius=e[3],a.applyMatrix4(r)}else if("box"in t.boundingVolume){const e=t.boundingVolume.box;a=new B,i.getBoundingSphere(a),a.center.set(e[0],e[1],e[2]),a.applyMatrix4(r)}"region"in t.boundingVolume&&console.warn("ThreeTilesRenderer: region bounding volume not supported."),t.cached={loadIndex:0,transform:r,active:!1,inFrustum:[],box:i,boxTransform:o,boxTransformInverse:s,sphere:a,region:null,scene:null,geometry:null,material:null,distance:1/0}}parseTile(t,e,n){e._loadIndex=e._loadIndex||0,e._loadIndex++;const r=e.content.uri.split(/[\\\/]/g);r.pop();const i=r.join("/"),o=this.fetchOptions,s=this.manager,a=e._loadIndex;let l=null;switch(n){case"b3dm":l=new mf(s).parse(t).then(t=>t.scene);break;case"pnts":l=Promise.resolve(new gf(s).parse(t).scene);break;case"i3dm":{const e=new xf(s);e.workingPath=i,e.fetchOptions=o,l=e.parse(t).then(t=>t.scene);break}case"cmpt":{const e=new wf(s);e.workingPath=i,e.fetchOptions=o,l=e.parse(t).then(t=>t.scene);break}default:console.warn(`TilesRenderer: Content type "${n}" not supported.`),l=Promise.resolve(null)}return l.then(t=>{if(e._loadIndex!==a)return;const n=this.rootTileSet.asset&&this.rootTileSet.asset.gltfUpAxis||"y",r=e.cached,i=r.transform;switch(n.toLowerCase()){case"x":t.matrix.makeRotationAxis(Hf,-Math.PI/2);break;case"y":t.matrix.makeRotationAxis(Uf,Math.PI/2)}t.matrix.premultiply(i),t.matrix.decompose(t.position,t.quaternion,t.scale),t.traverse(t=>{t[kf]=t.frustumCulled}),Wf(t,this.autoDisableRendererCulling),r.scene=t,t.traverse(t=>{t.raycast=Gf});const o=[],s=[],l=[];t.traverse(t=>{if(t.geometry&&s.push(t.geometry),t.material){const e=t.material;o.push(t.material);for(const t in e){const n=e[t];n&&n.isTexture&&l.push(n)}}}),r.materials=o,r.geometry=s,r.textures=l,this.onLoadModel&&this.onLoadModel(t,e)})}disposeTile(t){const e=t.cached;if(e.scene){const n=e.materials,r=e.geometry,i=e.textures;for(let t=0,e=r.length;t<e;t++)r[t].dispose();for(let t=0,e=n.length;t<e;t++)n[t].dispose();for(let t=0,e=i.length;t<e;t++){i[t].dispose()}this.onDisposeModel&&this.onDisposeModel(e.scene,t),e.scene=null,e.materials=null,e.textures=null,e.geometry=null}t._loadIndex++}setTileVisible(t,e){const n=t.cached.scene,r=this.visibleTiles,i=this.group;e?(i.add(n),r.add(t),n.updateMatrixWorld(!0)):(i.remove(n),r.delete(t))}setTileActive(t,e){const n=this.activeTiles;e?n.add(t):n.delete(t)}calculateError(t){if(0===t.geometricError)return 0;const e=t.cached,n=e.inFrustum,r=this.cameras,i=this.cameraInfo,o=t.boundingVolume;if("box"in o){const o=e.box,s=e.boxTransformInverse;let a=-1/0,l=1/0;for(let e=0,c=r.length;e<c;e++){if(!n[e])continue;const c=r[e],u=i[e],h=u.invScale;let f;if(jf.copy(u.position),jf.applyMatrix4(s),c.isOrthographicCamera){const e=u.pixelSize;f=t.geometricError/(e*h)}else{const e=o.distanceToPoint(jf)*h,n=u.sseDenominator;f=t.geometricError/(e*n),l=Math.min(l,e)}a=Math.max(a,f)}return t.cached.distance=l,a}return"sphere"in o?console.warn("ThreeTilesRenderer : Sphere bounds not supported."):"region"in o&&console.warn("ThreeTilesRenderer : Region bounds not supported."),1/0}tileInView(t){const e=t.cached,n=e.sphere,r=e.inFrustum;if(n){const t=this.cameraInfo;let e=!1;for(let i=0,o=t.length;i<o;i++){t[i].frustum.intersectsSphere(n)?(e=!0,r[i]=!0):r[i]=!1}return e}return!0}}new _;Symbol("ORIGINAL_MATERIAL"),Symbol("HAS_RANDOM_COLOR");var qf,Xf,Yf=function(t){var e=this;this.add=function(t){if(e.p.p._.wasInitialized)if(t.hasOwnProperty("name")&&t.hasOwnProperty("on")&&t.hasOwnProperty("path")&&t.hasOwnProperty("opacity")&&t.hasOwnProperty("minZoom")&&t.hasOwnProperty("maxZoom")){for(var n=!1,r=0;r<e.p.tile3d.length;r++)if(e.p.tile3d[r].hasOwnProperty("name")&&e.p.tile3d[r].name==t.name){e.p.tile3d[r]=t,n=!0;break}if(!n){var i=e.generateTile3ds(t),o=i.group,s=new bt;s.material=new Vt({transparent:!0,opacity:.5,color:11184810}),s.add(o),e.p.p.planet.add(s),e.localizeTile3ds(t,i),t.meshes=o,t.renderer=i,t.tile3dLayer=s,e.p.tile3d.push(t),e.p.tile3d.sort((function(t,e){return e.order-t.order}))}}else console.warn("Attempted to add an invalid tile3d layer: "+t.name)},this.toggle=function(t,n){return!!e.p.p._.wasInitialized&&(e.p.vector.forEach((function(r){if(t===r.name)return r.on=null!=n?n:!r.on,r.meshes.visible=r.on,e.p.p._.events._attenuate(),!0})),!1)},this.setOpacity=function(t,n){return!!e.p.p._.wasInitialized&&(n=Math.max(Math.min(n,1),0),e.p.tile3d.forEach((function(e){if(t===e.name)return e.opacity=Math.max(Math.min(n,1),0),e.meshes.children.forEach((function(t){t.material.opacity=e.opacity})),!0})),!1)},this.remove=function(t){if(!e.p.p._.wasInitialized)return!1;for(var n=0;n<e.p.tile3d.length;n++)if(e.p.tile3d[n].name===t)return e.p.p.planet.remove(e.p.tile3d[n].tile3dLayer),e.p.tile3d.splice(n,1),!0;return!1},this.generateTile3ds=function(t){var n=new Vf(t.path);return n.setCamera(e.p.p._.cameras.camera),n.setResolutionFromRenderer(e.p.p._.cameras.camera,e.p.p._.renderer),n},this.localizeTile3ds=function(t,n){var r=e.p.p.projection.lonLatToVector3(t.position.longitude||t.position.lng||0,t.position.latitude||t.position.lat||0,(t.position.elevation||t.position.elev||0)*e.p.p.options.exaggeration);n.group.position.set(r.x,r.y,r.z);var i=t.scale;null==i&&(i=1),n.group.scale.set(i,i,i);var o=t.rotation||{};o.x=o.x||0;var s=o.order||"XYZ";3!=s.length&&(console.warn('Lithosphere: Warning - Tile3d Layer "'+t.name+"\" has an invalid rotation.order. Defaulting back to 'XYZ'"),s="XYZ"),n.group.rotation.order=s;for(var a=0,l=(s=s.toLowerCase()).split("");a<l.length;a++){var c=l[a];switch(c){case"x":yl.rotateAroundArbAxis(n.group,new _(1,0,0),o.x||0);break;case"y":yl.rotateAroundArbAxis(n.group,new _(0,1,0),o.y||0);break;case"z":yl.rotateAroundArbAxis(n.group,new _(0,0,1),o.z||0);break;default:console.warn('Lithosphere: Warning - Tile3d Layer "'+t.name+'" has an unknown rotation.order axis: '+c)}}},this.p=t},Zf=function(t){var e=this;this.add=function(t){if(e.p.p._.wasInitialized){e.p.p._.tiledWorld.killDrawingTiles();var n=!1;if(t.hasOwnProperty("name")&&t.hasOwnProperty("on")&&t.hasOwnProperty("path")&&t.hasOwnProperty("opacity")&&t.hasOwnProperty("minZoom")&&t.hasOwnProperty("maxZoom")){for(var r=0;r<e.p.tile.length;r++)if(e.p.tile[r].hasOwnProperty("name")&&e.p.tile[r].name==t.name){e.p.tile[r]=t,n=!0;break}n||(e.p.tile.push(t),e.p.tile.sort((function(t,e){return t.order-e.order}))),e.p.p.zoom>=t.minZoom&&e.p.p.zoom<=t.maxZoom&&e.p.p._.tiledWorld.removeAllTiles(),e.p.p._.maxZoom=e.p.findHighestMaxZoom(),e.p.p._.minNativeZoom=e.p.findLowestMinZoom()}else console.warn("Attempted to add an invalid tile layer.")}},this.toggle=function(t,n){if(!e.p.p._.wasInitialized)return!1;var r=!1;return e.p.tile.forEach((function(e){t===e.name&&(e.on=null!=n?n:!e.on,r=!0)})),!!r&&(e.p.p._.tiledWorld.outdateAllTiles(),e.p.p._.maxZoom=e.p.findHighestMaxZoom(),e.p.p._.minNativeZoom=e.p.findLowestMinZoom(),!0)},this.setOpacity=function(t,n){if(!e.p.p._.wasInitialized)return!1;for(var r=0;r<e.p.tile.length;r++)if(e.p.tile[r].hasOwnProperty("name")&&e.p.tile[r].name==t)return e.p.tile[r].opacity=n,!0;return!1},this.remove=function(t){if(!e.p.p._.wasInitialized)return!1;for(var n=0;n<e.p.tile.length;n++)if(e.p.tile[n].hasOwnProperty("name")&&e.p.tile[n].name==t){if(e.p.p._.tiledWorld.killDrawingTiles(),e.p.p.zoom>=e.p.tile[n].minZoom&&e.p.p.zoom<=e.p.tile[n].maxZoom)for(var r=e.p.p._.tiledWorld.tilesDrawn.length,i=0;i<r;i++)e.p.p._.tiledWorld.removeTile(0);return e.p.tile.splice(n,1),e.p.p._.maxZoom=e.p.findHighestMaxZoom(),e.p.p._.minNativeZoom=e.p.findLowestMinZoom(),!0}return!1},this.p=t},Jf=null,Kf=function(t){var e=this;this.add=function(t,n){if(e.p.p._.wasInitialized){var r=!1,i=function(){for(var i=0;i<e.p.clamped.length;i++)if(e.p.clamped[i].hasOwnProperty("name")&&e.p.clamped[i].name==t.name){e.p.clamped[i]=t,r=!0;break}r||(e.p.clamped.push(t),e.p.clamped.sort((function(t,e){return t.order-e.order}))),e.p.p.zoom>=t.minZoom&&e.p.p.zoom<=t.maxZoom&&e.p.p._.tiledWorld.updateAllRasters(),"function"==typeof n&&n()};if(e.p.p._.tiledWorld.killDrawingTiles(),t.hasOwnProperty("name")&&t.hasOwnProperty("on")&&(!0===t.preDrawn&&t.hasOwnProperty("data")||(t.hasOwnProperty("geojsonPath")||t.hasOwnProperty("geojson"))&&t.hasOwnProperty("minZoom")&&t.hasOwnProperty("maxZoom")))if(t.hasOwnProperty("geojsonPath")&&!t.hasOwnProperty("geojson")){t.hasOwnProperty("opacity")||(t.opacity=1);var o=new XMLHttpRequest;o.open("GET",t.geojsonPath,!0),o.responseType="json",o.withCredentials=!0===t.withCredentials||!1,o.onload=function(){404!==o.status&&o.response?(t.geojson=o.response,i()):console.warn("Failed to fetch geojson data for clamped layer: "+t.name)},o.send()}else i();else console.warn("Attempted to add an invalid clamped layer: "+t.name)}},this.toggle=function(t,n){if(!e.p.p._.wasInitialized)return!1;var r=!1;return e.p.clamped.forEach((function(e){t===e.name&&(e.on=null!=n?n:!e.on,r=!0)})),!!r&&(e.p.p._.tiledWorld.updateAllRasters(),!0)},this.setOpacity=function(t,n){if(!e.p.p._.wasInitialized)return!1;for(var r=function(r){var i=e.p.clamped[r];if(t===i.name)return clearTimeout(Jf),Jf=setTimeout((function(){i.opacity=Math.max(Math.min(n,1),0),e.p.p.zoom>=i.minZoom&&e.p.p.zoom<=i.maxZoom&&(e.p.p._.tiledWorld.killDrawingTiles(),e.p.p._.tiledWorld.updateAllRasters())}),250),{value:!0}},i=0;i<e.p.clamped.length;i++){var o=r(i);if("object"==typeof o)return o.value}return!1},this.remove=function(t){if(!e.p.p._.wasInitialized)return!1;for(var n=0;n<e.p.clamped.length;n++)if(e.p.clamped[n].hasOwnProperty("name")&&e.p.clamped[n].name==t){var r=e.p.clamped[n].minZoom,i=e.p.clamped[n].maxZoom;return e.p.p.zoom>=r&&e.p.p.zoom<=i&&(e.p.p._.tiledWorld.killDrawingTiles(),e.p.p._.tiledWorld.updateAllRasters()),e.p.clamped.splice(n,1),!0}return!1},this.getClampedTexture=function(t,n){var r=.5,i=e.p.clamped[t],o=document.createElement("canvas");o.id="vectorsastile",o.width=256/r,r*=Math.pow(2,e.p.p.zoom-n.z),o.height=o.width;var s,a,l=o.getContext("2d"),c=[];if(r<128)if(i.preDrawn)l.imageSmoothingEnabled=!1,i.data&&i.data[n.z]&&i.data[n.z][n.x]&&null!=i.data[n.z][n.x][n.y]&&l.drawImage(i.data[n.z][n.x][n.y],0,0,o.width,o.height);else for(var u=0,h=i.geojson.features;u<h.length;u++){var f=h[u],d=e.p.getFeatureStyle(i,f),p=!1;if("rgb"!=d.fillColor.substring(0,3).toLowerCase()){var m=yl.hexToRGB(d.fillColor);m&&(d.fillColor="rgba("+m.r+","+m.g+","+m.b+","+d.fillOpacity+")")}else{var g=d.fillColor.substring(4,d.fillColor.length-1).replace(/ /g,"").split(",");d.fillColor="rgba("+g[0]+","+g[1]+","+g[2]+","+d.fillOpacity+")"}if(l.fillStyle=d.fillColor,l.strokeStyle=d.color,l.lineWidth=d.weight*(1/r*1),l.globalAlpha=i.opacity,l.lineCap="round",d.radius*=1/r*1||10,"Polygon"!=f.geometry.type&&"MultiPolygon"!=f.geometry.type||!f.geometry.coordinates[0]){if("LineString"==f.geometry.type||"MultiLineString"==f.geometry.type){if("number"==typeof f.geometry.coordinates[0][0]){for(_=0;_<f.geometry.coordinates.length;_++)s=e.p.p.projection.lon2tileUnfloored(f.geometry.coordinates[_][0],n.z),a=e.p.p.projection.lat2tileUnfloored(f.geometry.coordinates[_][1],n.z),w=parseInt((s-n.x)*o.width),M=parseInt((a-n.y)*o.height),0==_?(l.beginPath(),l.moveTo(w,M)):l.lineTo(w,M),w>=0&&w<o.width&&M>=0&&M<o.height&&(p=!0);l.stroke()}else if("number"==typeof f.geometry.coordinates[0][0][0])for(_=0;_<f.geometry.coordinates.length;_++){for(var v=0;v<f.geometry.coordinates[_].length;v++)s=e.p.p.projection.lon2tileUnfloored(f.geometry.coordinates[_][v][0],n.z),a=e.p.p.projection.lat2tileUnfloored(f.geometry.coordinates[_][v][1],n.z),w=parseInt((s-n.x)*o.width),M=parseInt((a-n.y)*o.height),0==v?(l.beginPath(),l.moveTo(w,M)):l.lineTo(w,M),w>=0&&w<o.width&&M>=0&&M<o.height&&(p=!0);l.stroke()}}else if("point"===f.geometry.type.toLowerCase()){var y=void 0;"number"==typeof f.geometry.coordinates[0]?(s=e.p.p.projection.lon2tileUnfloored(f.geometry.coordinates[0],n.z),a=e.p.p.projection.lat2tileUnfloored(f.geometry.coordinates[1],n.z),y={lng:f.geometry.coordinates[0],lat:f.geometry.coordinates[1]}):(s=e.p.p.projection.lon2tileUnfloored(f.geometry.coordinates[0][0],n.z),a=e.p.p.projection.lat2tileUnfloored(f.geometry.coordinates[0][1],n.z),y={lng:f.geometry.coordinates[0][0],lat:f.geometry.coordinates[0][1]});var b=e.p.p.projection.tileXYZ2LatLng(s+d.radius/o.width,a,e.p.p.zoom);f._radiusInMeters=e.p.p.projection.lngLatDistBetween(y.lng,y.lat,b.lng,b.lat),w=parseInt((s-n.x)*o.width),M=parseInt((a-n.y)*o.height),l.beginPath(),l.arc(w,M,d.radius,0,2*Math.PI,!1),l.fill(),l.stroke(),w>=0&&w<o.width&&M>=0&&M<o.height&&(p=!0)}}else for(var _=0;_<f.geometry.coordinates.length;_++){if("number"==typeof f.geometry.coordinates[_][0][0])for(var x=0;x<f.geometry.coordinates[_].length;x++){s=e.p.p.projection.lon2tileUnfloored(f.geometry.coordinates[_][x][0],n.z),a=e.p.p.projection.lat2tileUnfloored(f.geometry.coordinates[_][x][1],n.z);var w=parseInt((s-n.x)*o.width),M=parseInt((a-n.y)*o.height);0==x?(l.beginPath(),l.moveTo(w,M)):l.lineTo(w,M),w>=0&&w<o.width&&M>=0&&M<o.height&&(p=!0)}else if("number"==typeof f.geometry.coordinates[_][0][0][0])for(var S=0;S<f.geometry.coordinates[_].length;S++)for(var E=0;E<f.geometry.coordinates[_][S].length;E++){s=e.p.p.projection.lon2tileUnfloored(f.geometry.coordinates[_][S][E][0],n.z),a=e.p.p.projection.lat2tileUnfloored(f.geometry.coordinates[_][S][E][1],n.z);var w=parseInt((s-n.x)*o.width),M=parseInt((a-n.y)*o.height);0==E?(l.beginPath(),l.moveTo(w,M)):l.lineTo(w,M),w>=0&&w<o.width&&M>=0&&M<o.height&&(p=!0)}l.stroke(),l.closePath(),l.fill()}p&&(f._highlighted=f._highlighted||!1,c.push(f))}return{canvas:o,features:c}},this.p=t},Qf=function(){ma.call(this),this.type="LineSegmentsGeometry";this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new re([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new re([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))};Qf.prototype=Object.assign(Object.create(ma.prototype),{constructor:Qf,isLineSegmentsGeometry:!0,applyMatrix4:function(t){var e=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==e&&(e.applyMatrix4(t),n.applyMatrix4(t),e.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},setPositions:function(t){var e;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));var n=new Va(e,6,1);return this.setAttribute("instanceStart",new ai(n,3,0)),this.setAttribute("instanceEnd",new ai(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this},setColors:function(t){var e;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));var n=new Va(e,6,1);return this.setAttribute("instanceColorStart",new ai(n,3,0)),this.setAttribute("instanceColorEnd",new ai(n,3,3)),this},fromWireframeGeometry:function(t){return this.setPositions(t.attributes.position.array),this},fromEdgesGeometry:function(t){return this.setPositions(t.attributes.position.array),this},fromMesh:function(t){return this.fromWireframeGeometry(new Wo(t.geometry)),this},fromLineSegments:function(t){var e=t.geometry;if(!e.isGeometry)return e.isBufferGeometry&&this.setPositions(e.attributes.position.array),this;console.error("THREE.LineSegmentsGeometry no longer supports Geometry. Use THREE.BufferGeometry instead.")},computeBoundingBox:(Xf=new M,function(){null===this.boundingBox&&(this.boundingBox=new M);var t=this.attributes.instanceStart,e=this.attributes.instanceEnd;void 0!==t&&void 0!==e&&(this.boundingBox.setFromBufferAttribute(t),Xf.setFromBufferAttribute(e),this.boundingBox.union(Xf))}),computeBoundingSphere:(qf=new _,function(){null===this.boundingSphere&&(this.boundingSphere=new B),null===this.boundingBox&&this.computeBoundingBox();var t=this.attributes.instanceStart,e=this.attributes.instanceEnd;if(void 0!==t&&void 0!==e){var n=this.boundingSphere.center;this.boundingBox.getCenter(n);for(var r=0,i=0,o=t.count;i<o;i++)qf.fromBufferAttribute(t,i),r=Math.max(r,n.distanceToSquared(qf)),qf.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(qf));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}),toJSON:function(){},applyMatrix:function(t){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(t)}});var $f=function(){Qf.call(this),this.type="LineGeometry"};$f.prototype=Object.assign(Object.create(Qf.prototype),{constructor:$f,isLineGeometry:!0,setPositions:function(t){for(var e=t.length-3,n=new Float32Array(2*e),r=0;r<e;r+=3)n[2*r]=t[r],n[2*r+1]=t[r+1],n[2*r+2]=t[r+2],n[2*r+3]=t[r+3],n[2*r+4]=t[r+4],n[2*r+5]=t[r+5];return Qf.prototype.setPositions.call(this,n),this},setColors:function(t){for(var e=t.length-3,n=new Float32Array(2*e),r=0;r<e;r+=3)n[2*r]=t[r],n[2*r+1]=t[r+1],n[2*r+2]=t[r+2],n[2*r+3]=t[r+3],n[2*r+4]=t[r+4],n[2*r+5]=t[r+5];return Qf.prototype.setColors.call(this,n),this},fromLine:function(t){var e=t.geometry;if(!e.isGeometry)return e.isBufferGeometry&&this.setPositions(e.attributes.position.array),this;console.error("THREE.LineGeometry no longer supports Geometry. Use THREE.BufferGeometry instead.")},copy:function(){return this}}),$e.line={linewidth:{value:1},resolution:{value:new u(1,1)},dashScale:{value:1},dashSize:{value:1},dashOffset:{value:0},gapSize:{value:1},opacity:{value:1}},tn.line={uniforms:Fe.merge([$e.common,$e.fog,$e.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float dashOffset;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t}\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};var td=function(t){Be.call(this,{type:"LineMaterial",uniforms:Fe.clone(tn.line.uniforms),vertexShader:tn.line.vertexShader,fragmentShader:tn.line.fragmentShader,clipping:!0}),this.dashed=!1,Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(t){this.uniforms.linewidth.value=t}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(t){this.uniforms.dashOffset.value=t}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}}}),this.setValues(t)};(td.prototype=Object.create(Be.prototype)).constructor=td,td.prototype.isLineMaterial=!0;var ed,nd,rd=function(t,e){void 0===t&&(t=new Qf),void 0===e&&(e=new td({color:16777215*Math.random()})),ke.call(this,t,e),this.type="LineSegments2"};rd.prototype=Object.assign(Object.create(ke.prototype),{constructor:rd,isLineSegments2:!0,computeLineDistances:(ed=new _,nd=new _,function(){for(var t=this.geometry,e=t.attributes.instanceStart,n=t.attributes.instanceEnd,r=new Float32Array(2*e.data.count),i=0,o=0,s=e.data.count;i<s;i++,o+=2)ed.fromBufferAttribute(e,i),nd.fromBufferAttribute(n,i),r[o]=0===o?0:r[o-1],r[o+1]=r[o]+ed.distanceTo(nd);var a=new Va(r,2,1);return t.setAttribute("instanceDistanceStart",new ai(a,1,0)),t.setAttribute("instanceDistanceEnd",new ai(a,1,1)),this}),raycast:function(){var t=new v,e=new v,n=new v,r=new _,i=new Y,o=new tl,s=new _;return function(a,l){null===a.camera&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2.');var u=void 0!==a.params.Line2&&a.params.Line2.threshold||0,h=a.ray,f=a.camera,d=f.projectionMatrix,p=this.geometry,m=this.material,g=m.resolution,v=m.linewidth+u,y=p.attributes.instanceStart,b=p.attributes.instanceEnd,x=-f.near;h.at(1,n),n.w=1,n.applyMatrix4(f.matrixWorldInverse),n.applyMatrix4(d),n.multiplyScalar(1/n.w),n.x*=g.x/2,n.y*=g.y/2,n.z=0,r.copy(n);var w=this.matrixWorld;i.multiplyMatrices(f.matrixWorldInverse,w);for(var M=0,S=y.count;M<S;M++){if(t.fromBufferAttribute(y,M),e.fromBufferAttribute(b,M),t.w=1,e.w=1,t.applyMatrix4(i),e.applyMatrix4(i),!(t.z>x&&e.z>x)){if(t.z>x){const n=t.z-e.z,r=(t.z-x)/n;t.lerp(e,r)}else if(e.z>x){const n=e.z-t.z,r=(e.z-x)/n;e.lerp(t,r)}t.applyMatrix4(d),e.applyMatrix4(d),t.multiplyScalar(1/t.w),e.multiplyScalar(1/e.w),t.x*=g.x/2,t.y*=g.y/2,e.x*=g.x/2,e.y*=g.y/2,o.start.copy(t),o.start.z=0,o.end.copy(e),o.end.z=0;var E=o.closestPointToPointParameter(r,!0);o.at(E,s);var T=c.lerp(t.z,e.z,E),C=T>=-1&&T<=1,A=r.distanceTo(s)<.5*v;if(C&&A){o.start.fromBufferAttribute(y,M),o.end.fromBufferAttribute(b,M),o.start.applyMatrix4(w),o.end.applyMatrix4(w);var P=new _,L=new _;h.distanceSqToSegment(o.start,o.end,L,P),l.push({point:L,pointOnLine:P,distance:h.origin.distanceTo(L),object:this,face:null,faceIndex:M,uv:null,uv2:null})}}}}}()});var id=function(t,e){void 0===t&&(t=new $f),void 0===e&&(e=new td({color:16777215*Math.random()})),rd.call(this,t,e),this.type="Line2"};id.prototype=Object.assign(Object.create(rd.prototype),{constructor:id,isLine2:!0});var od={spriteMaterials:{},makeMarkerSprite:function(t,e,n){var r=new wi(od.makeMarkerMaterial(t,e,n));return r.style=r.style||{},r.style.radius=t.hasOwnProperty("radius")?t.radius:32,r},makeMarkerMaterial:function(t,e,n){if(e&&this.spriteMaterials.hasOwnProperty(e)&&!0!==n)return this.spriteMaterials[e];void 0===t&&(t={});var r=t.hasOwnProperty("radius")?t.radius:64;r=Math.max(r,64);var i=t.hasOwnProperty("fillColor")?t.fillColor:{r:255,g:255,b:255,a:null!=t.fillOpacity?t.fillOpacity:1},o=t.hasOwnProperty("weight")?t.weight:4,s=t.hasOwnProperty("color")?t.color:{r:0,g:0,b:0,a:1},a=document.createElement("canvas"),l=a.getContext("2d"),c=2*r,u=2*r;a.width=c,a.height=u,l.beginPath(),l.arc(a.width/2,a.height/2,r-o*(r/12),0,2*Math.PI,!1),l.fillStyle="object"==typeof i?"rgba("+i.r+","+i.g+","+i.b+","+i.a+")":i,l.fill(),l.lineWidth=o*(r/8),l.strokeStyle="object"==typeof s?"rgba("+s.r+","+s.g+","+s.b+","+s.a+")":s,l.stroke();var h=new m(a);h.needsUpdate=!0;var f=new li({map:h,transparent:!0,alphaTest:.01});return e&&!0!==n&&(this.spriteMaterials[e]=f),f},makeTextSprite:function(t,e){void 0===e&&(e={});var n=e.hasOwnProperty("fontface")?e.fontface:"Arial",r=e.hasOwnProperty("fontsize")?e.fontsize:18,i=e.hasOwnProperty("strokeWeight")?e.strokeWeight:4,o=e.hasOwnProperty("strokeColor")?e.strokeColor:{r:0,g:0,b:0,a:1},s=e.hasOwnProperty("fontColor")?e.fontColor:{r:255,g:255,b:255,a:1},a=document.createElement("canvas"),l=a.getContext("2d");a.width=1024,a.height=64,l.font="Bold "+r+"px "+n,l.strokeStyle="rgba("+o.r+","+o.g+","+o.b+","+o.a+")",l.lineWidth=i,l.fillStyle="rgba("+s.r+","+s.g+","+s.b+","+s.a+")",l.textAlign="left",l.strokeText(t,512+r,64-r/1.8),l.fillText(t,512+r,64-r/1.8);var c=new m(a);c.needsUpdate=!0;var u=new wi(new li({map:c}));return u.scale.set(64,4,1),u}},sd=od,ad=function(t){var e=this;this.add=function(t,n){if(e.p.p._.wasInitialized){var r=!1,i=function(){for(var i=0;i<e.p.vector.length;i++)if(e.p.vector[i].hasOwnProperty("name")&&e.p.vector[i].name==t.name){e.p.vector[i]=t,r=!0;break}if(!r){var o=e.generateVectors(t);e.p.p.planet.add(o),t.meshes=o,e.p.vector.push(t),e.p.vector.sort((function(t,e){return e.order-t.order}))}e.p.p._.events._attenuate(),"function"==typeof n&&n()};if(t.hasOwnProperty("name")&&t.hasOwnProperty("on")&&(t.hasOwnProperty("geojsonPath")||t.hasOwnProperty("geojson"))&&t.hasOwnProperty("opacity"))if(t.hasOwnProperty("geojsonPath")&&!t.hasOwnProperty("geojson")){var o=new XMLHttpRequest;o.open("GET",t.geojsonPath,!0),o.responseType="json",o.withCredentials=!0===t.withCredentials||!1,o.onload=function(){404!==o.status&&o.response?(t.geojson=o.response,i()):console.warn("Failed to fetch geojson data for vector layer: "+t.name)},o.send()}else i();else console.warn("Attempted to add an invalid vector layer: "+t.name)}},this.toggle=function(t,n){return!!e.p.p._.wasInitialized&&(e.p.vector.forEach((function(r){if(t===r.name)return r.on=null!=n?n:!r.on,r.meshes.visible=r.on,e.p.p._.events._attenuate(),!0})),!1)},this.setOpacity=function(t,n){if(!e.p.p._.wasInitialized)return!1;for(var r=function(r){var i=e.p.vector[r];if(t===i.name)return i.opacity=Math.max(Math.min(n,1),0),i.meshes.children.forEach((function(t){t.material.opacity=i.opacity})),{value:!0}},i=0;i<e.p.vector.length;i++){var o=r(i);if("object"==typeof o)return o.value}return!1},this.remove=function(t){if(!e.p.p._.wasInitialized)return!1;for(var n=0;n<e.p.vector.length;n++)if(e.p.vector[n].name===t)return e.p.p.planet.remove(e.p.vector[n].meshes),e.p.vector.splice(n,1),!0;return!1},this.generateVectors=function(t){var n=new bt;if(null!=t.geojson){var r=t.geojson.features;if(null!=r){for(var i=t.style?t.style.pointType:"",o=t.style?t.style.lineType:"",s=0,a=r;s<a.length;s++){var l=a[s],c=l.geometry.type,u=null;switch(c.toLowerCase()){case"point":switch(i){case"sphere":break;default:u=e.geomTo.sprite(t,l)}break;case"linestring":switch(o){case"thin":u=e.geomTo.line(t,l);break;default:u=e.geomTo.thickLine(t,l)}break;case"polygon":break;default:console.warn("Vector layer: "+t.name+" has an unsupported geojson geometry type: "+c+".")}u.feature=l,n.add(u)}return 0==t.on&&(n.visible=!1),n}console.warn("Vector layer: "+t.name+" has invalid geojson.")}else console.warn("Vector layer: "+t.name+" has no geojson.")},this.geomTo={sprite:function(t,n,r){var i=n.geometry.coordinates,o=e.p.getFeatureStyle(t,n),s=sd.makeMarkerSprite(o,t.name,r),a=0,l=1;t.swapLL&&(a=1,l=0),"number"==typeof i[0]&&(i=[i]);var c=e.p.p.projection.lonLatToVector3(i[0][a],i[0][l],(i[0][2]||0)*e.p.p.options.exaggeration);return s.position.set(c.x,c.y,c.z),s.renderOrder=t.index,0==t.on&&(s.visible=!1),s.layerName=t.name,s.useKeyAsHoverName=t.useKeyAsHoverName,s.name=t.name,s.style=o,s.restyle=function(){var n=e.geomTo.sprite(t,s.feature,s.feature._highlighted||s.feature._active);s.style=n.style,s.material.dispose(),s.material=n.material,s.material.map.needsUpdate=!0,s.material.needsUpdate=!0},s},line:function(t,n){var r=n.geometry.coordinates,i=0,o=1;t.swapLL&&(i=1,o=0);for(var s=[],a=0;a<r.length;a++){isNaN(r[a][i])&&(r=r[0]);var l=e.p.p.projection.lonLatToVector3(r[a][i],r[a][o],(r[a][2]||0)*e.p.p.options.exaggeration);s.push(new _(l.x,l.y,l.z))}var c=e.p.getFeatureStyle(t,n,!0),u=new Yi((new me).setFromPoints(s),new Hi({transparent:!0,color:c.color}));return u.layerName=t.name,u.strokeColor=c.color,u},thickLine:function(t,n){var r,i=n.geometry.coordinates,o=[],s=0,a=1;t.swapLL&&(s=1,a=0);for(var l=0;l<i.length;l++){isNaN(i[l][s])&&(i=i[0]);var c=e.p.p.projection.lonLatToVector3(i[l][s],i[l][a],(i[l][2]||0)*e.p.p.options.exaggeration);0==l&&(r=new _(c.x,c.y,c.z)),o.push(new _(c.x-r.x,c.y-r.y,c.z-r.z)),0==l&&l==i.length-1||o.push(o[o.length-1])}for(var u=e.p.getFeatureStyle(t,n,!0),h=[],f=new js(o),d=(l=0,Math.round(1*o.length));l<d;l++){var p=f.getPoint(l/d);h.push(p.x,p.y,p.z)}var m=new $f;m.setPositions(h);var g=new td({color:u.color,linewidth:5e-4*(u.weight||1)}),v=new id(m,g);return v.computeLineDistances(),v.position.set(r.x,r.y,r.z),v.scale.set(1,1,1),v.layerName=t.name,v.strokeColor=u.color,v.restyle=function(){var n=e.p.getFeatureStyle(t,v.feature,!0);v.material=new td({color:n.color,linewidth:5e-4*(n.weight||1)}),v.strokeColor=n.color},v}},this.p=t,this.baseStyle={fillColor:"rgb(255,255,255)",fillOpacity:.4,color:"rgb(0,0,0)",weight:2,radius:6}},ld=function(){function t(t){var e=this;this.addLayer=function(t,n,r,i){1==n.on?n.on=!0:0==n.on&&(n.on=!1),e._.layerers[t]?e._.layerers[t].add(n,r):console.warn("Cannot add unknown layer type "+t+".")},this.removeLayer=function(t){var n=!1;for(var r in e._.layerers){e._.layerers[r].remove(t)&&(n=!0)}return!!n},this.toggleLayer=function(t,n){var r=!1;for(var i in e._.layerers){e._.layerers[i].toggle(t,n)&&(r=!0)}return!!r},this.setLayerOpacity=function(t,n){var r=!1;for(var i in e._.layerers){e._.layerers[i].setOpacity(t,parseFloat(n))&&(r=!0)}return!!r||(console.warn("Could not find a layer named '"+t+"' to set the opacity of."),!1)},this.findHighestMaxZoom=function(){var t=0;for(var n in e.tile)e.tile[n].on&&e.tile[n].maxZoom>t&&(t=e.tile[n].maxZoom);return t},this.findLowestMinZoom=function(){var t=1/0;for(var n in e.tile)e.tile[n].on&&e.tile[n].minZoom<t&&(t=e.tile[n].minZoom);return t},this.getFeatureStyleProp=function(t,e){if(null!=t&&"string"==typeof t&&t.includes("=")){var n=t.split("=");return yl.getIn(e.properties,n[1].split("."))}return t},this.getLayerByName=function(t){for(var n in e.all)for(var r=0;r<e.all[n].length;r++)if(e.all[n][r].name===t)return e.all[n][r];return null},this.getFeatureStyle=function(t,n,r){var i=JSON.parse(JSON.stringify(e.baseStyle));if(t.style){var o=n.geometry.type.toLowerCase();for(var s in i){if(t.style.default&&null!=t.style.default[s]){var a=e.getFeatureStyleProp(t.style.default[s],n);i[s]=null!=a?a:i[s]}if("point"===o&&t.style.point){var l=e.getFeatureStyleProp(t.style.point[s],n);i[s]=null!=l?l:i[s]}else if("linestring"===o&&t.style.line){var c=e.getFeatureStyleProp(t.style.line[s],n);i[s]=null!=c?c:i[s]}else if("polygon"===o&&t.style.polygon){var u=e.getFeatureStyleProp(t.style.polygon[s],n);i[s]=null!=u?u:i[s]}if(t.style.byProp)for(var h in t.style.byProp){var f=h.split(":")[0].split("=")[1],d=h.split(":")[1];if(yl.getIn(n.properties,f.split("."))===d){var p=e.getFeatureStyleProp(t.style.byProp[h][s],n);i[s]=null!=p?p:i[s]}}if(!0===t.style.letPropertiesStyleOverride){var m=e.getFeatureStyleProp(t.style[s],n);i[s]=null!=m?m:i[s]}}}return"none"===i.fillColor&&(i.fillColor="rgba(0,0,0,0)"),n._active?i.fillColor=e.p.options.activeColor||"red":n._highlighted&&(i.fillColor=e.p.options.highlightColor||"yellow"),!0===r&&(i.color=i.fillColor),i},this.p=t,this.baseStyle={fillColor:"rgb(0,0,0)",fillOpacity:.4,color:"rgb(255,255,255)",weight:2,radius:6},this._={layerers:{tile3d:new Yf(this),tile:new Zf(this),clamped:new Kf(this),vector:new ad(this)}},this._reset()}return t.prototype._reset=function(){this.tile3d=[],this.tile=[],this.clamped=[],this.vector=[],this.all={tile3d:this.tile3d,tile:this.tile,clamped:this.clamped,vector:this.vector}},t}(),cd=function(t,e){var n=this;this.getControl=function(){return["<div class='"+n.name+"' id='_lithosphere_control_compass_root' style='width: 40px; height: 40px; position: relative;'>","<div style='position: absolute; left: 16px; bottom: 40px;font-family: sans-serif; font-size: 10px'>N</div>","<svg width='40' height='40'>","<circle cx='20' cy='20' r='20' stroke-width='0' fill='rgba(0,0,0,1)' />","<path id='_lithosphere_control_compass_arc' fill='#fff' stroke='#fff' stroke-width='0'></path>","<line x1='20' y1='0' x2='20' y2='20' style='stroke:rgb(255,255,255);stroke-width:1;mix-blend-mode:difference;' />","<line x1='40' y1='20' x2='35' y2='20' style='stroke:rgb(255,255,255);stroke-width:1;mix-blend-mode:difference;' />","<line x1='20' y1='40' x2='20' y2='35' style='stroke:rgb(255,255,255);stroke-width:1;mix-blend-mode:difference;' />","<line x1='0' y1='20' x2='5' y2='20' style='stroke:rgb(255,255,255);stroke-width:1;mix-blend-mode:difference;' />","</svg>","<div id='_lithosphere_control_compass_azimuth' style='position: absolute; left: 0px; bottom: 0px; width: 40px; height: 40px; line-height: 40px; opacity: 0; font-size: 11px; transition: opacity 0.1s ease-out; font-weight: bold; text-align: center; background: black; border-radius: 50%;'></div>","</div>"].join("")},this.attachEvents=function(){document.getElementById("_lithosphere_control_compass_azimuth").addEventListener("mouseenter",(function(t){t.target.style.opacity="1"})),document.getElementById("_lithosphere_control_compass_azimuth").addEventListener("mouseleave",(function(t){t.target.style.opacity="0"}))},this.onUpdate=function(){n.setDirection()},this.setDirection=function(){var t,e,r,i=n.p._.cameras.isFirstPerson?n.p._.cameras.firstPerson:n.p._.cameras.orbit;if(null!=i){if(n.p._.cameras.isFirstPerson)e=-(i.controls.getObject().rotation.y%(2*Math.PI)+Math.PI)*(180/Math.PI);else{var o=i.camera.position.x,s=i.camera.position.z;e=Math.atan2(o,s)*(180/Math.PI)}r=i.camera.fov}t=function(t,e,n,r,i){var o=ud(t,e,n,i),s=ud(t,e,n,r),a=i-r<=180?"0":"1";return["M",o.x,o.y,"A",n,n,0,a,0,s.x,s.y,"L",t,e].join(" ")}(20,20,20,e-r/2,e+r/2),document.getElementById("_lithosphere_control_compass_arc").setAttribute("d",t),e<0&&(e+=360),document.getElementById("_lithosphere_control_compass_azimuth").innerHTML=parseInt(e)+" &deg;"},this.p=t,this.name=e,this._={},this.corner="BottomLeft"};function ud(t,e,n,r){var i=(r-90)*Math.PI/180;return{x:t+n*Math.cos(i),y:e+n*Math.sin(i)}}var hd=function(t,e,n){var r=this;this.getControl=function(){var t=(null!=r.params.existingDivId?"display: none; ":"")+"background: black; padding: 5px; font-size: 14px;";return["<div class='"+r.name+"' id='_lithosphere_control_coordinate_root' title='Longitude, Latitude, Elevation' style='"+t+"'>","</div>"].join("")},this.attachEvents=function(){},this.onUpdate=function(){(r.p._.mouseIsInScene||r.p._.cameras.isFirstPerson)&&r.updateMouseCoords()},this.updateMouseCoords=function(){var t="Outer Space";null!=r.p.mouse.lat&&null!=r.p.mouse.lng&&(t=r.p.mouse.lng.toFixed(8)+"&deg;, "+r.p.mouse.lat.toFixed(8)+"&deg;, "+r.p.mouse.elev.toFixed(3)+"m");var e=document.getElementById("_lithosphere_control_coordinate_root");if(e&&e.innerHTML!=t&&(e.innerHTML=t),null!=r.params.existingDivId){var n=document.getElementById(r.params.existingDivId);n&&n.innerHTML!=t&&(n.innerHTML=t)}},this.p=t,this.name=e,this.params=n||{},this._={},this.corner="BottomRight"},fd=function(t,e){var n=this;this.getControl=function(){return["<div class='"+n.name+"' id='_lithosphere_control_home_root' title='Reset View' style='width: 26px; height: 26px; background: black; font-size: 24px; line-height: 26px; text-align: center; cursor: pointer;'>",'<svg style="width:18px; height:18px" viewBox="0 0 24 24">','<path fill="currentColor" d="M9,13H15V19H18V10L12,5.5L6,10V19H9V13M4,21V9L12,3L20,9V21H4Z" />',"</svg>","</div>"].join("")},this.attachEvents=function(){document.getElementById("_lithosphere_control_home_root").addEventListener("click",(function(){n.p.setCenter(n.p.options.initialView,null,!0)}))},this.p=t,this.name=e,this._={},this.corner="TopLeft"},dd=function(t,e){var n=this;this.getControl=function(){return["<div class='"+n.name+"' id='"+n.id+"' style='position: relative;'>",'<div title="Layers" style="cursor: pointer; width: 26px; height: 26px; background: black; font-size: 24px; line-height: 28px; text-align: center;">',n.getInactiveContent(),"</div>","<span id='"+n.id+"_active' style='pointer-events: none; opacity: 0; transition: opacity 0.2s ease-out;'>",n.getActiveContent(),"</span>","</div>"].join("")},this.attachEvents=function(){document.getElementById(n.id).addEventListener("mouseenter",(function(){document.getElementById(n.id+"_active").innerHTML=n.getActiveContent(),n.attachEventsInternal(),document.getElementById(n.id+"_active").style.pointerEvents="all",document.getElementById(n.id+"_active").style.opacity="1"})),document.getElementById(n.id+"_active").addEventListener("mouseleave",(function(){document.getElementById(n.id+"_active").style.pointerEvents="none",document.getElementById(n.id+"_active").style.opacity="0"}))},this.getInactiveContent=function(){return['<svg style="width:18px; height:18px" viewBox="0 0 24 24">','<path fill="currentColor" d="M12,16L19.36,10.27L21,9L12,2L3,9L4.63,10.27M12,18.54L4.62,12.81L3,14.07L12,21.07L21,14.07L19.37,12.8L12,18.54Z" />',"</svg>"].join("")},this.getActiveContent=function(){var t=[];for(var e in n.p.layers.all)if(n.p.layers.all[e].length>0){for(var r=[],i=0,o=n.p.layers.all[e];i<o.length;i++){var s=o[i];r.push(['<li style="display: flex; justify-content: space-between; height: 22px; font-size: 12px; line-height: 22px;">','<div style="display: flex; justify-content: space-between;">','<input class="'+n.id+'_toggle" layer-type="'+e+'" layer-name="'+s.name+'" type="checkbox" '+(s.on?"checked":"")+' style="margin: 4px 4px 3px 4px;"/>','<span style="text-transform: capitalize; margin-right: 20px;">'+s.name+"</span>","</div>",'<div style="display: flex; justify-content: space-between;">','<input class="'+n.id+'_opacity" layer-type="'+e+'" layer-name="'+s.name+'" type="range" min="0" max="1" step="0.01" value="'+s.opacity+'" style="width: 60px;"/>',"</div>","</li>"].join(""))}t.push(['<div style="border-bottom: 1px solid #222;">','<div style="text-transform: capitalize; padding: 6px; font-size: 12px; color: #888;">'+e+"</div>",'<ul style="margin: 0; padding: 0px 6px 6px 6px;">',r.join(""),"</ul>","</div>"].join(""))}return['<div style="position: absolute; top: 0px; right: 0px; background: #111; border: 1px solid #222; border-bottom: 0px solid #222;">',t.join(""),"</div>"].join("")},this.attachEventsInternal=function(){for(var t=function(t){t.addEventListener("click",(function(e){n.p.toggleLayer(t.getAttribute("layer-name"))}))},e=0,r=document.getElementsByClassName(n.id+"_toggle");e<r.length;e++)t(r[e]);for(var i=function(t){"clamped"===t.getAttribute("layer-type")?t.addEventListener("change",(function(e){n.p.setLayerOpacity(t.getAttribute("layer-name"),t.value)})):t.addEventListener("input",(function(e){n.p.setLayerOpacity(t.getAttribute("layer-name"),t.value)}))},o=0,s=document.getElementsByClassName(n.id+"_opacity");o<s.length;o++)i(s[o])},this.id="_lithosphere_control_layers_root",this.p=t,this.name=e,this._={},this.corner="TopRight"},pd=function(t,e){var n=this;this.getControl=function(){return["<div class='"+n.name+"' id='"+n.id+"' style='position: relative;'>",n.getInactiveContent(),"<span id='"+n.id+"_active' style='pointer-events: none; opacity: 0; transition: opacity 0.2s ease-out;'>",n.getActiveContent(),"</span>","</div>"].join("")},this.attachEvents=function(){document.getElementById(n.id).addEventListener("mouseenter",(function(){document.getElementById(n.id+"_active").style.pointerEvents="all",document.getElementById(n.id+"_active").style.opacity="1"})),document.getElementById(n.id+"_active").addEventListener("mouseleave",(function(){document.getElementById(n.id+"_active").style.pointerEvents="none",document.getElementById(n.id+"_active").style.opacity="0"}));for(var t=document.getElementsByClassName(n.id+"_option"),e=function(e){t[e].addEventListener("click",(function(){for(var r=parseFloat(t[e].getAttribute("value")),i=0;i<t.length;i++)t[i].classList.remove("_lithosphere_active"),t[i].style.background="unset",t[i].style.color="unset";t[e].style.background="#FBC02D",t[e].style.color="black",t[e].classList.add("_lithosphere_active"),n.setExaggeration(r)})),parseFloat(t[e].getAttribute("value"))==n.p.options.exaggeration&&(t[e].style.background="#FBC02D",t[e].style.color="black",t[e].classList.add("_lithosphere_active"))},r=0;r<t.length;r++)e(r)},this.getInactiveContent=function(){return['<div title="Exaggerate" style="cursor: pointer; width: 26px; height: 26px; background: black; font-size: 24px; line-height: 28px; text-align: center;">','<svg style="width:18px; height:18px" viewBox="0 0 24 24">','<path fill="currentColor" d="M12,22A2,2 0 0,1 10,20A2,2 0 0,1 12,18A2,2 0 0,1 14,20A2,2 0 0,1 12,22M13,16H11V6L6.5,10.5L5.08,9.08L12,2.16L18.92,9.08L17.5,10.5L13,6V16Z" />',"</svg>","</div>"].join("")},this.getActiveContent=function(){return['<div style="display: flex; position: absolute; top: 0px; left: 0px; height: 26px; line-height: 26px;">',n.getInactiveContent(),'<div style="display: flex; background: #111; font-size: 12px; margin-left: 5px;">','<div class="'+n.id+'_option" value="1" style="padding: 0px 6px; cursor: pointer;">1x</div>','<div class="'+n.id+'_option" value="2" style="padding: 0px 6px; cursor: pointer;">2x</div>','<div class="'+n.id+'_option" value="5" style="padding: 0px 6px; cursor: pointer;">5x</div>',"</div>","</div>"].join("")},this.setExaggeration=function(t){n.p.options.exaggeration=t,n.p._.tiledWorld.removeAllTiles()},this.id="_lithosphere_control_exaggerate_root",this.p=t,this.name=e,this._={},this.corner="TopLeft",this.exaggeration=1},md=function(t,e){var n=this;this.getControl=function(){return["<div class='"+n.name+"' id='"+n.id+"' style='position: relative;'>",n.getInactiveContent(),"<span id='"+n.id+"_active' style='pointer-events: none; opacity: 0; transition: opacity 0.2s ease-out;'>",n.getActiveContent(),"</span>","</div>"].join("")},this.getInactiveContent=function(){return["<div title='Observe' style='width: 26px; height: 26px; background: black; font-size: 24px; line-height: 27px; text-align: center; cursor: pointer;'>",'<svg style="width:18px; height:18px" viewBox="0 0 24 24">','<path fill="currentColor" d="M13.73,15L9.83,21.76C10.53,21.91 11.25,22 12,22C14.4,22 16.6,21.15 18.32,19.75L14.66,13.4M2.46,15C3.38,17.92 5.61,20.26 8.45,21.34L12.12,15M8.54,12L4.64,5.25C3,7 2,9.39 2,12C2,12.68 2.07,13.35 2.2,14H9.69M21.8,10H14.31L14.6,10.5L19.36,18.75C21,16.97 22,14.6 22,12C22,11.31 21.93,10.64 21.8,10M21.54,9C20.62,6.07 18.39,3.74 15.55,2.66L11.88,9M9.4,10.5L14.17,2.24C13.47,2.09 12.75,2 12,2C9.6,2 7.4,2.84 5.68,4.25L9.34,10.6L9.4,10.5Z" />',"</svg>","</div>"].join("")},this.getActiveContent=function(){var t=n.p.getCenter();return['<div style="display: flex; position: absolute; top: 0px; left: 0px; height: 26px; line-height: 26px;">',n.getInactiveContent(),'<div style="display: flex; background: #111; font-size: 12px; margin-left: 5px;">',"<div id='_lithosphere_WalkSettingsPanel' style='padding: 2px 6px 6px 6px; position: absolute; top: 0px; background: #000; width: 185px;'>","<ul style='list-style-type: none; padding: 0; margin: 0; font-size: 12px;'>","<li id='_lithosphere_WalkSettingsFov' style='display: flex; justify-content: space-between; margin-bottom: 3px;'>","<div style='float: left; padding-right: 5px;'>Field of View</div>","<input id='_lithosphere_WalkSettingsFovValue' type='number' value='60' style='width: 100%; background-color: transparent; color: white; border: none; border-bottom: 1px solid #777; width: 80px; margin: 0px 2px 0px auto;'>","<div style='font-size: 20px; padding-right: 4px;'>&deg;</div>","<input id='_lithosphere_WalkSettingsFovValueRaw' type='number' value='60' style='display: none;'>","</li>","<li id='_lithosphere_WalkSettingsVerticalFov' style='display: flex; justify-content: space-between; margin-bottom: 3px;'>","<div style='float: left; padding-right: 5px;'>Vertical FOV</div>","<input id='_lithosphere_WalkSettingsVerticalFovValue' type='number' value='60' style='width: 100%; background-color: transparent; color: white; border: none; border-bottom: 1px solid #777; width: 80px; margin: 0px 2px 0px auto;'>","<div style='font-size: 20px; padding-right: 4px;'>&deg;</div>","</li>","<li id='_lithosphere_WalkSettingsFocalLength' style='display: flex; justify-content: space-between; margin-bottom: 3px;'>","<div style='float: left; padding-right: 5px;'>Focal Length</div>","<input id='_lithosphere_WalkSettingsFocalLengthValue' type='number' value='35' style='width: 100%; background-color: transparent; color: white; border: none; border-bottom: 1px solid #777; width: 80px; margin: 0px 6px 0px auto;'>","<div style='height: 19px; font-size: 10px; line-height: 5px;'><div style='height: 8px;'>m</div><div style='height: 8px;'>m</div></div>","</li>","<li id='_lithosphere_WalkSettingsAzimuth' style='display: flex; justify-content: space-between; margin-bottom: 3px;'>","<div style='float: left; padding-right: 5px;'>Azimuth</div>","<input id='_lithosphere_WalkSettingsAzimuthValue' type='number' style='width: 100%; background-color: transparent; color: white; border: none; border-bottom: 1px solid #777; width: 80px; margin: 0px 2px 0px auto;'>","<div style='font-size: 20px; padding-right: 4px;'>&deg;</div>","</li>","<li id='_lithosphere_WalkSettingsElevation' style='display: flex; justify-content: space-between; margin-bottom: 3px;'>","<div style='float: left; padding-right: 5px;'>Elevation</div>","<input id='_lithosphere_WalkSettingsElevationValue' type='number' style='width: 100%; background-color: transparent; color: white; border: none; border-bottom: 1px solid #777; width: 80px; margin: 0px 2px 0px auto;'>","<div style='font-size: 20px; padding-right: 4px;'>&deg;</div>","</li>","<li id='_lithosphere_WalkSettingsHeight' style='display: flex; justify-content: space-between; margin-bottom: 3px;'>","<div style='float: left; padding-right: 5px;'>Height</div>","<input id='_lithosphere_WalkSettingsHeightValue' type='number' style='width: 100%; background-color: transparent; color: white; border: none; border-bottom: 1px solid #777; width: 80px; margin: 0px 2px 0px auto;'>","<div>m</div>","</li>","<li id='_lithosphere_WalkSettingsLatitude' style='display: flex; justify-content: space-between; margin-bottom: 3px;'>","<div style='float: left; padding-right: 5px;'>Latitude</div>","<input id='_lithosphere_WalkSettingsLatitudeValue' type='number' value='"+t.lat+"' style='width: 100%; background-color: transparent; color: white; border: none; border-bottom: 1px solid #777; width: 80px; margin: 0px 2px 0px auto;'>","<div style='font-size: 20px; padding-right: 4px;'>&deg;</div>","</li>","<li id='_lithosphere_WalkSettingsLongitude' style='display: flex; justify-content: space-between; margin-bottom: 3px;'>","<div style='float: left; padding-right: 5px;'>Longitude</div>","<input id='_lithosphere_WalkSettingsLongitudeValue' type='number' value='"+t.lng+"' style='width: 100%; background-color: transparent; color: white; border: none; border-bottom: 1px solid #777; width: 80px; margin: 0px 2px 0px auto;'>","<div style='font-size: 20px; padding-right: 4px;'>&deg;</div>","</li>","</ul>","<div id='_lithosphere_WalkWalkStandButtons' style='padding-top: 6px; display: flex; justify-content: space-between;'>","<div id='_lithosphere_WalkWalkHere' style='display: none; padding: 0px 6px; cursor: pointer;'>Walk Here</div>","<div id='_lithosphere_WalkStand' style='padding: 0px 6px; cursor: pointer; width: 100%; text-align: center; font-size: 12px; text-transform: uppercase; font-weight: bold; background: #FBC02D; color: black;'>Observe</div>","</div>","</div>","</div>","</div>"].join("")},this.attachEvents=function(){document.getElementById(n.id).addEventListener("mouseenter",(function(){document.getElementById(n.id+"_active").style.pointerEvents="all",document.getElementById(n.id+"_active").style.opacity="1"})),document.getElementById(n.id+"_active").addEventListener("mouseleave",(function(){document.getElementById(n.id+"_active").style.pointerEvents="none",document.getElementById(n.id+"_active").style.opacity="0"})),document.getElementById("_lithosphere_WalkStand").addEventListener("click",(function(){n.setCamera(!0),n.toggleFOVOverlay(!0);var t=n.getObserverValues();n.updateFOVOverlayBounds(t.vfieldofview,t.elevation,t.fieldofview,t.azimuth),document.addEventListener("keydown",n.keydownObserverSettings);try{n.p.controls.controlContainer.removeChild(n.helpDiv)}catch(t){}var e=["<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; border-bottom: 1px solid #222; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>W</div><div>Up</div></div>","<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; border-bottom: 1px solid #222; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>A</div><div>Left</div></div>","<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; border-bottom: 1px solid #222; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>S</div><div>Down</div></div>","<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; border-bottom: 1px solid #222; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>D</div><div>Right</div></div>","<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; border-bottom: 1px solid #222; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>R</div><div>Higher</div></div>","<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; border-bottom: 1px solid #222; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>F</div><div>Lower</div></div>","<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; border-bottom: 1px solid #222; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>T</div><div>FOV +</div></div>","<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; border-bottom: 1px solid #222; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>G</div><div>FOV -</div></div>","<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; border-bottom: 1px solid #222; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>Y</div><div>vFOV +</div></div>","<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; border-bottom: 1px solid #222; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>H</div><div>vFOV -</div></div>","<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; border-bottom: 1px solid #222; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>SHIFT+</div><div>Fast</div></div>","<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>ESC</div><div>Quit</div></div>"].join("\n");n.helpDiv=document.createElement("div"),n.helpDiv.id="_lithosphere_control_walk_help",n.helpDiv.style="position: absolute; bottom: 47px; right: 15px; background: black; font-size: 13px;",n.helpDiv.innerHTML=e,n.p.controls.controlContainer.appendChild(n.helpDiv)}))},this.setCamera=function(t,e){var r=n.getObserverValues();n.p.setCenter({lat:r.latitude,lng:r.longitude,zoom:n.p.zoom},!0),n.p._.cameras.setFirstPersonHeight(r.height),n.p._.cameras.setCameraAzimuthElevation(r.azimuth,r.elevation,!0),n.p._.cameras.setFirstPersonFocalLength(r.focallength),n.p._.cameras.setFirstPersonFOV(Math.max(r.vfieldofview,60)),n.p._.cameras.swap(t,e),"onpointerlockchange"in document?document.addEventListener("pointerlockchange",n.leaveObserver,!1):"onmozpointerlockchange"in document&&document.addEventListener("mozpointerlockchange",n.leaveObserver,!1)},this.leaveObserver=function(){if(document.pointerLockElement===document.body||document.mozPointerLockElement===document.body);else try{n.p.controls.controlContainer.removeChild(n.helpDiv),n.toggleFOVOverlay(!1),document.removeEventListener("keydown",n.keydownObserverSettings)}catch(t){}},this.getObserverValues=function(){return{fieldofview:parseFloat(document.getElementById("_lithosphere_WalkSettingsFovValue").value)||60,fieldofviewRaw:parseFloat(document.getElementById("_lithosphere_WalkSettingsFovValueRaw").value)||60,vfieldofview:parseFloat(document.getElementById("_lithosphere_WalkSettingsVerticalFovValue").value)||60,focallength:parseFloat(document.getElementById("_lithosphere_WalkSettingsFocalLengthValue").value)||35,azimuth:parseFloat(document.getElementById("_lithosphere_WalkSettingsAzimuthValue").value)||0,elevation:parseFloat(document.getElementById("_lithosphere_WalkSettingsElevationValue").value)||0,height:parseFloat(document.getElementById("_lithosphere_WalkSettingsHeightValue").value)||3,latitude:parseFloat(document.getElementById("_lithosphere_WalkSettingsLatitudeValue").value)||n.p.getCenter().lat||0,longitude:parseFloat(document.getElementById("_lithosphere_WalkSettingsLongitudeValue").value)||n.p.getCenter().lon||0}},this.keydownObserverSettings=function(t){var e=n.getObserverValues();84===t.which?document.getElementById("_lithosphere_WalkSettingsFovValue").value=+(e.fieldofview+(t.shiftKey?1:.2)).toFixed(4):71===t.which?document.getElementById("_lithosphere_WalkSettingsFovValue").value=+(e.fieldofview-(t.shiftKey?1:.2)).toFixed(4):89===t.which?document.getElementById("_lithosphere_WalkSettingsVerticalFovValue").value=+(e.vfieldofview+(t.shiftKey?1:.2)).toFixed(4):72===t.which?document.getElementById("_lithosphere_WalkSettingsVerticalFovValue").value=+(e.vfieldofview-(t.shiftKey?1:.2)).toFixed(4):68===t.which?document.getElementById("_lithosphere_WalkSettingsAzimuthValue").value=+(e.azimuth+(t.shiftKey?1:.2)).toFixed(4):65===t.which?document.getElementById("_lithosphere_WalkSettingsAzimuthValue").value=+(e.azimuth-(t.shiftKey?1:.2)).toFixed(4):87===t.which?document.getElementById("_lithosphere_WalkSettingsElevationValue").value=+(e.elevation+(t.shiftKey?1:.2)).toFixed(4):83===t.which?document.getElementById("_lithosphere_WalkSettingsElevationValue").value=+(e.elevation-(t.shiftKey?1:.2)).toFixed(4):82===t.which?document.getElementById("_lithosphere_WalkSettingsHeightValue").value=+(e.height+(t.shiftKey?1:.2)).toFixed(4):70===t.which&&(document.getElementById("_lithosphere_WalkSettingsHeightValue").value=+(e.height-(t.shiftKey?1:.2)).toFixed(4));var r=n.getObserverValues();n.p._.cameras.setFirstPersonHeight(r.height),n.p._.cameras.setCameraAzimuthElevation(r.azimuth,r.elevation,!0),r.vfieldofview!==e.vfieldofview?(n.p._.cameras.setFirstPersonFOV(Math.max(r.vfieldofview,60)),document.getElementById("_lithosphere_WalkSettingsFocalLengthValue").value=+n.p._.cameras.getFirstPersonFocalLength().toFixed(4)):r.focallength!==e.focallength&&(n.p._.cameras.setFirstPersonFocalLength(r.focallength),document.getElementById("_lithosphere_WalkSettingsFovValue").value=+n.p._.cameras.getFirstPersonFOV().toFixed(4)),n.updateFOVOverlayBounds(r.vfieldofview,r.elevation,r.fieldofview,r.azimuth)},this.toggleFOVOverlay=function(t){var e=document.getElementById("_lithosphere_WalkFOVOverlay");if(t){if(null==e){var r=document.createElement("div");r.id="_lithosphere_WalkFOVOverlay",r.style=["position: absolute","left: 0","top: 0","width: 100%","height: 100%","pointer-events: none"].join(";"),r.innerHTML=["<div id='_lithosphere_Walk_NW' style='position: absolute; background: rgba(0,0,0,0.4);'></div>","<div id='_lithosphere_Walk_N' style='position: absolute; background: rgba(0,0,0,0.4); border-bottom: 1px solid #444;'></div>","<div id='_lithosphere_Walk_NE' style='position: absolute; background: rgba(0,0,0,0.4);'></div>","<div id='_lithosphere_Walk_E' style='position: absolute; background: rgba(0,0,0,0.4); border-left: 1px solid #444;'></div>","<div id='_lithosphere_Walk_SE' style='position: absolute; background: rgba(0,0,0,0.4);'></div>","<div id='_lithosphere_Walk_S' style='position: absolute; background: rgba(0,0,0,0.4); border-top: 1px solid #444;'></div>","<div id='_lithosphere_Walk_SW' style='position: absolute; background: rgba(0,0,0,0.4);'></div>","<div id='_lithosphere_Walk_W' style='position: absolute; background: rgba(0,0,0,0.4); border-right: 1px solid #444;'></div>"].join("\n"),n.p.getContainer().appendChild(r)}}else null!=e&&n.p.getContainer().removeChild(e)},this.updateFOVOverlayBounds=function(t,e,r,i){t=document.getElementById("_lithosphere_WalkSettingsVerticalFovValue").value;var o=n.p._.cameras.getFirstPersonFOV(),s=n.p.getContainer().getBoundingClientRect(),a=s.height*(t/o),l=(s.height/2-a/2)/s.height*100,c=(s.height/2+a/2)/s.height*100,u=s.height/o*r,h=(s.width/2-u/2)/s.width*100,f=(s.width/2+u/2)/s.width*100,d=document.getElementById("_lithosphere_Walk_NW");d.style.top="0%",d.style.height=l+"%",d.style.left="0%",d.style.width=h+"%";var p=document.getElementById("_lithosphere_Walk_N");p.style.top="0%",p.style.height=l+"%",p.style.left=h+"%",p.style.width=f-h+"%";var m=document.getElementById("_lithosphere_Walk_NE");m.style.top="0%",m.style.height=l+"%",m.style.left=f+"%",m.style.width=100-f+"%";var g=document.getElementById("_lithosphere_Walk_E");g.style.top=l+"%",g.style.height=c-l+"%",g.style.left=f+"%",g.style.width=100-f+"%";var v=document.getElementById("_lithosphere_Walk_SE");v.style.top=c+"%",v.style.height=100-c+"%",v.style.left=f+"%",v.style.width=100-f+"%";var y=document.getElementById("_lithosphere_Walk_S");y.style.top=c+"%",y.style.height=100-c+"%",y.style.left=h+"%",y.style.width=f-h+"%";var b=document.getElementById("_lithosphere_Walk_SW");b.style.top=c+"%",b.style.height=100-c+"%",b.style.left="0%",b.style.width=h+"%";var _=document.getElementById("_lithosphere_Walk_W");_.style.top=l+"%",_.style.height=c-l+"%",_.style.left="0%",_.style.width=h+"%"},this.p=t,this.name=e,this.id="_lithosphere_control_observe_root",this._={},this.corner="TopLeft"},gd=function(t,e){var n=this;this.getControl=function(){return["<div class='"+n.name+"' id='_lithosphere_control_walk_root' title='Walk' style='width: 26px; height: 26px; background: black; font-size: 24px; line-height: 27px; text-align: center; cursor: pointer;'>",'<svg style="width:18px; height:18px" viewBox="0 0 24 24">','<path fill="currentColor" d="M14.12,10H19V8.2H15.38L13.38,4.87C13.08,4.37 12.54,4.03 11.92,4.03C11.74,4.03 11.58,4.06 11.42,4.11L6,5.8V11H7.8V7.33L9.91,6.67L6,22H7.8L10.67,13.89L13,17V22H14.8V15.59L12.31,11.05L13.04,8.18M14,3.8C15,3.8 15.8,3 15.8,2C15.8,1 15,0.2 14,0.2C13,0.2 12.2,1 12.2,2C12.2,3 13,3.8 14,3.8Z" />',"</svg>","</div>"].join("")},this.attachEvents=function(){document.getElementById("_lithosphere_control_walk_root").addEventListener("click",(function(){n.setCamera(!1);try{n.p.controls.controlContainer.removeChild(n.helpDiv)}catch(t){}var t=["<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; border-bottom: 1px solid #222; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>W</div><div>Forward</div></div>","<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; border-bottom: 1px solid #222; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>A</div><div>Left</div></div>","<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; border-bottom: 1px solid #222; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>S</div><div>Back</div></div>","<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; border-bottom: 1px solid #222; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>D</div><div>Right</div></div>","<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; border-bottom: 1px solid #222; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>SHIFT+</div><div>Fast</div></div>","<div style='display: flex; justify-content: space-between; padding: 2px 6px; white-space: nowrap; text-align: center; color: #fff; line-height: 16px;'><div style='color: #bbb; text-align: center; margin-right: 5px;'>ESC</div><div>Quit</div></div>"].join("\n");n.helpDiv=document.createElement("div"),n.helpDiv.id="_lithosphere_control_walk_help",n.helpDiv.style="position: absolute; bottom: 47px; right: 15px; background: black; font-size: 13px;",n.helpDiv.innerHTML=t,n.p.controls.controlContainer.appendChild(n.helpDiv)}))},this.setCamera=function(t,e){n.p._.cameras.swap(t,e),"onpointerlockchange"in document?document.addEventListener("pointerlockchange",n.leaveWalking,!1):"onmozpointerlockchange"in document&&document.addEventListener("mozpointerlockchange",n.leaveWalking,!1)},this.leaveWalking=function(){if(document.pointerLockElement===document.body||document.mozPointerLockElement===document.body);else try{n.p.controls.controlContainer.removeChild(n.helpDiv)}catch(t){}},this.p=t,this.name=e,this.helpDiv=null,this._={},this.corner="TopLeft"},vd=function(t,e,n){var r=this;this.getControl=function(){return["<div class='"+r.name+"' id='_lithosphere_control_link_root' title='Link' style='width: 26px; height: 26px; color: "+(r.return.isLinked?"black":"white")+"; background: "+(r.return.isLinked?"#FBC02D":"black")+"; font-size: 24px; line-height: 27px; text-align: center; cursor: pointer;'>",'<svg style="width:18px; height:18px" viewBox="0 0 24 24">','<path fill="currentColor" d="M10.59,13.41C11,13.8 11,14.44 10.59,14.83C10.2,15.22 9.56,15.22 9.17,14.83C7.22,12.88 7.22,9.71 9.17,7.76V7.76L12.71,4.22C14.66,2.27 17.83,2.27 19.78,4.22C21.73,6.17 21.73,9.34 19.78,11.29L18.29,12.78C18.3,11.96 18.17,11.14 17.89,10.36L18.36,9.88C19.54,8.71 19.54,6.81 18.36,5.64C17.19,4.46 15.29,4.46 14.12,5.64L10.59,9.17C9.41,10.34 9.41,12.24 10.59,13.41M13.41,9.17C13.8,8.78 14.44,8.78 14.83,9.17C16.78,11.12 16.78,14.29 14.83,16.24V16.24L11.29,19.78C9.34,21.73 6.17,21.73 4.22,19.78C2.27,17.83 2.27,14.66 4.22,12.71L5.71,11.22C5.7,12.04 5.83,12.86 6.11,13.65L5.64,14.12C4.46,15.29 4.46,17.19 5.64,18.36C6.81,19.54 8.71,19.54 9.88,18.36L13.41,14.83C14.59,13.66 14.59,11.76 13.41,10.59C13,10.2 13,9.56 13.41,9.17Z" />',"</svg>","</div>"].join("")},this.attachEvents=function(){document.getElementById("_lithosphere_control_link_root").addEventListener("click",(function(){r.return.isLinked=!r.return.isLinked;var t=document.getElementById("_lithosphere_control_link_root");r.return.isLinked?(t.style.background="#FBC02D",t.style.color="black"):(t.style.background="black",t.style.color="white"),"function"==typeof r.params.onToggle&&r.params.onToggle(r.return.isLinked)}))},this.getReturn=function(){return r.return},this.onMove=function(t,e,n){r.return.isLinked&&"function"==typeof r.params.onMove&&(r._.linkPanned=!0,r.params.onMove(t,e,n),clearTimeout(r._.linkPannedTimeout),r._.linkPannedTimeout=setTimeout((function(){r._.linkPanned=!1}),500))},this.onMouseMove=function(t,e,n){r.return.isLinked&&"function"==typeof r.params.onMouseMove&&r.params.onMouseMove(t,e,n)},this.onMouseOut=function(){r.return.isLinked&&"function"==typeof r.params.onMouseOut&&r.params.onMouseOut()},this.onFirstPersonUpdate=function(){"function"==typeof r.params.onFirstPersonUpdate&&r.params.onFirstPersonUpdate()},this.onOrbitalUpdate=function(){"function"==typeof r.params.onOrbitalUpdate&&r.params.onOrbitalUpdate()},this.setLink=function(t,e,n){if(r.p._.wasInitialized&&(null!=r._.targetPoint&&r.p.frontGroup.remove(r._.targetPoint),null!=t)){var i=new me,o=new Vt({color:65280});r._.targetPoint=new ke(i,o);var s=r.p.getElevationAtLngLat(t.lng,t.lat);if(0!=s){var a=r.p.projection.lonLatToVector3(t.lng,t.lat,(s+.4)*r.p.options.exaggeration);e=e||{radius:8,fillColor:{r:0,g:255,b:0,a:.7},weight:2,color:"rgb(0,255,0)"},null==n&&(n="linkTargetPoint");var l=sd.makeMarkerSprite(e,n);l.style=e,r._.targetPoint.attenuate=!0,r._.targetPoint.position.set(a.x,a.y,a.z),r._.targetPoint.add(l),r.p.frontGroup.add(r._.targetPoint),r.p._.events._attenuate(),r.p._.events._refreshFrontGroupRotation()}}},this.linkMove=function(t,e){r.return.isLinked&&!r._.linkPanned&&r.p.setCenter({lat:e,lng:t,z:0},!0)},this.linkMouseMove=function(t,e){r.return.isLinked&&r.setLink({lat:e,lng:t})},this.linkMouseOut=function(){r.setLink()},this.p=t,this.name=e,this.params=n||{},this._={linkPanned:!1,linkPannedTimeout:null},this.corner="TopLeft",this.return={isLinked:this.params.initiallyLinked||!1,linkMove:this.linkMove,linkMouseMove:this.linkMouseMove,linkMouseOut:this.linkMouseOut}},yd=function(t){var e=this;this.addControl=function(t,n,r,i){if(null==e.activeControls[t]){try{e.activeControls[t]=new n(e.p,t,r)}catch(n){return null!=e.activeControls[t]&&delete e.activeControls[t],void console.warn("Error adding UI Element with name '"+t+"' -",n)}i=i||e.activeControls[t].corner||"TopLeft";var o=document.createElement("div");return o.setAttribute("id","_lithosphere_control_"+t),o.innerHTML=e.activeControls[t].getControl(),o.style.marginRight="5px","TopLeft"!==i&&"TopRight"!==i||(o.style.marginBottom="5px"),e.corners[i].appendChild(o),e.activeControls[t].attachEvents(),e.activeControls[t].getReturn?e.activeControls[t].getReturn():void 0}console.warn("UI Control control with identifying name '"+t+"' already exists. Remove the existing one or pick a different name to add this control.")},this.removeControl=function(t){delete e.activeControls[t],document.getElementById("_lithosphere_control_"+t).remove()},this._onUpdateEvent=function(){Object.values(e.activeControls).forEach((function(t){"function"==typeof t.onUpdate&&t.onUpdate()}))},this._onMove=function(t,n,r){Object.values(e.activeControls).forEach((function(e){"function"==typeof e.onMove&&e.onMove(t,n,r)}))},this._onMouseMove=function(t,n,r){Object.values(e.activeControls).forEach((function(e){"function"==typeof e.onMouseMove&&e.onMouseMove(t,n,r)}))},this._onMouseOut=function(t){Object.values(e.activeControls).forEach((function(e){"function"==typeof e.onMouseOut&&e.onMouseOut(t)}))},this._onFirstPersonUpdate=function(){Object.values(e.activeControls).forEach((function(t){"function"==typeof t.onFirstPersonUpdate&&t.onFirstPersonUpdate()}))},this._onOrbitalUpdate=function(t){Object.values(e.activeControls).forEach((function(e){"function"==typeof e.onOrbitalUpdate&&e.onOrbitalUpdate(t)}))},this.p=t,this.activeControls={},this.controlContainer=document.createElement("div"),this.controlContainer.setAttribute("id","_lithosphere_controls"),this.controlContainer.style.position="absolute",this.controlContainer.style.top="0",this.controlContainer.style.left="0",this.controlContainer.style.width="100%",this.controlContainer.style.height="100%",this.controlContainer.style.pointerEvents="none",this.controlContainer.style.color="white",this.controlContainer.style.fontFamily="sans-serif",this.controlContainer.style.zIndex="1000",this.p._.container.appendChild(this.controlContainer),this.corners={TopLeft:null,TopRight:null,BottomLeft:null,BottomRight:null},this.corners.TopLeft=document.createElement("div"),this.corners.TopLeft.setAttribute("id","_lithosphere_controls_topleft"),this.corners.TopLeft.style.position="absolute",this.corners.TopLeft.style.top="10px",this.corners.TopLeft.style.left="10px",this.corners.TopLeft.style.pointerEvents="all",this.corners.TopLeft.style.display="flex",this.corners.TopLeft.style.flexFlow="column",this.controlContainer.appendChild(this.corners.TopLeft),this.corners.TopRight=document.createElement("div"),this.corners.TopRight.setAttribute("id","_lithosphere_controls_topright"),this.corners.TopRight.style.position="absolute",this.corners.TopRight.style.top="10px",this.corners.TopRight.style.right="10px",this.corners.TopRight.style.pointerEvents="all",this.corners.TopRight.style.display="flex",this.controlContainer.appendChild(this.corners.TopRight),this.corners.BottomLeft=document.createElement("div"),this.corners.BottomLeft.setAttribute("id","_lithosphere_controls_bottomleft"),this.corners.BottomLeft.style.position="absolute",this.corners.BottomLeft.style.bottom="10px",this.corners.BottomLeft.style.left="10px",this.corners.BottomLeft.style.pointerEvents="all",this.corners.BottomLeft.style.display="flex",this.controlContainer.appendChild(this.corners.BottomLeft),this.corners.BottomRight=document.createElement("div"),this.corners.BottomRight.setAttribute("id","_lithosphere_controls_bottomright"),this.corners.BottomRight.style.position="absolute",this.corners.BottomRight.style.bottom="10px",this.corners.BottomRight.style.right="10px",this.corners.BottomRight.style.pointerEvents="all",this.corners.BottomRight.style.display="flex",this.controlContainer.appendChild(this.corners.BottomRight),this.compass=cd,this.coordinates=hd,this.home=fd,this.layers=dd,this.exaggerate=pd,this.observe=md,this.walk=gd,this.link=vd},bd=(n(13),function(t){var e=this;this.end=function(t){!1!==e.p.options.loadingScreen&&e.loadingContainer&&(e.loadingContainer.style.opacity="0",e.p._.sceneContainer.style.filter="blur(0px) brightness(1)",setTimeout((function(){e.loadingContainer.remove(),e.loadingContainer=null,e.p._.sceneContainer.style.filter=null,e.p._.sceneContainer.style.transition=null}),500))},this.p=t,!1!==this.p.options.loadingScreen&&(this.loadingContainer=document.createElement("div"),this.loadingContainer.setAttribute("id","_lithosphere_loadingscreen"),this.loadingContainer.style.position="absolute",this.loadingContainer.style.top="0",this.loadingContainer.style.left="0",this.loadingContainer.style.width="100%",this.loadingContainer.style.height="100%",this.loadingContainer.style.background="black",this.loadingContainer.style.color="white",this.loadingContainer.style.fontFamily="sans-serif",this.loadingContainer.style.zIndex="9001",this.loadingContainer.style.opacity="1",this.loadingContainer.style.transition="opacity 0.5s ease-in",this.loadingContainer.innerHTML=["<div class='_lithosphere_loadingscreen_loading'>","<div></div>","<div></div>","<div></div>","<div></div>","<div></div>","<div></div>","</div>"].join("\n"),this.p._.container.appendChild(this.loadingContainer),this.p._.sceneContainer.style.filter="blur(10px) brightness(0.5)",this.p._.sceneContainer.style.transition="filter 0.5s ease-in-out")}),_d=function(){return(_d=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},xd=function(){function t(t,e){var n=this;this._animate=function(){window.requestAnimationFrame(n._animate),n._render()},this._onFirstLoad=function(){n._.firstLoad=!0,n._.events._rotateGlobe({pageX:0,pageY:0},{x:1e-4,y:1e-4}),setTimeout((function(){n.setCenter(n.options.initialView,!1,!0),n._.events._onZoom(),n._.loadingScreen.end()}),100)},this.setCenter=function(t,e,r){if(!n._.wasInitialized)return!1;var i=(90-(t.lat||0))*(Math.PI/180),o=(t.lng||0)*(Math.PI/180);if(n.planet.rotation.set(i,o,0),n._.events._matchPlanetsLODToPlanet(),null!=t.zoom&&1!=e){n.zoom=t.zoom;var s=n.getCenter(!0);n._.cameras.orbit.camera.position.y=-4e7/n.projection.radiusScale/Math.pow(2,n.zoom),r&&(n._.cameras.orbit.camera.position.y-=s.height),n._.cameras.firstPerson.controls.getObject().position.y=-4e7/n.projection.radiusScale/Math.pow(2,n.zoom),r&&(n._.cameras.firstPerson.controls.getObject().position.y-=s.height)}return n._.events._refreshFrontGroupRotation(),!0},this.getCenterXYZ=function(t){if(t){n._.raycaster.set(new _(0,n.planetCenter.y,0),new _(0,1,0));for(var e=[],r=0;r<n._.tiledWorld.tilesDrawn.length;r++)n._.tiledWorld.tilesDrawn[r].isLODTile||e.push(n._.tiledWorld.tilesDrawn[r].t);var i=n._.raycaster.intersectObjects(e);return i.length>0?(i[0].point.y+=n.planetCenter.y,i[0].point):new _(0,0,0)}var o={x:n.planetCenter.x,y:n.planetCenter.y,z:n.planetCenter.z};return o=n.projection.rotatePoint3D(o,{x:-n.planet.rotation.x,y:0,z:0}),o=n.projection.rotatePoint3D(o,{x:0,y:-n.planet.rotation.y,z:0}),o=n.projection.rotatePoint3D(o,{x:0,y:0,z:-n.planet.rotation.z}),new _(o.x,o.y,o.z)},this.getCenter=function(t){var e=n.getCenterXYZ(t);if(t){var r=JSON.parse(JSON.stringify(e));return r=n.projection.rotatePoint3D(r,{x:-n.planet.rotation.x,y:0,z:0}),r=n.projection.rotatePoint3D(r,{x:0,y:-n.planet.rotation.y,z:0}),r=n.projection.rotatePoint3D(r,{x:0,y:0,z:-n.planet.rotation.z}),(r=n.projection.vector3ToLatLng(r)).height=e.length()*n.projection.radiusScale-n.projection.radii.major,r}return n.projection.vector3ToLatLng(e)},this.getCenterElevation=function(){return n.getCenterXYZ(!0).length()*n.projection.radiusScale-n.projection.radii.major},this.getCenterElevationRaw=function(){var t=n.getCenterXYZ(!0).length();if(!(t<=.1&&t>=-.1))return t},this.getElevationAtLngLat=function(t,e){var r=n.projection.lonLatToVector3(t,e,1e5*n.options.exaggeration),i=new bt;i.position.set(0,-n.planetCenter.y,0),i.rotation.set(n.planet.rotation.x,n.planet.rotation.y,n.planet.rotation.z);var o=new ke(new Go(200,32,32),new Vt({color:16776960}));o.position.set(r.x,r.y,r.z),i.add(o),i.updateMatrixWorld();var s=new _;s.setFromMatrixPosition(o.matrixWorld),n._.raycaster.set(s,new _(0,-n.planetCenter.y,0).normalize());for(var a=[],l=0;l<n._.tiledWorld.tilesDrawn.length;l++)n._.tiledWorld.tilesDrawn[l].isLODTile||a.push(n._.tiledWorld.tilesDrawn[l].t);var c=n._.raycaster.intersectObjects(a);return c.length>0?(c[c.length-1].point.y+=n.planetCenter.y,c[c.length-1].point.length()*n.projection.radiusScale-n.projection.radii.major):0},this.getCenterTile=function(){var t=n.getCenter();return n.projection.latLngZ2TileXYZ(t.lat,t.lng,n.zoom)},this.getCameras=function(){return{camera:n._.cameras.camera,isFirstPerson:n._.cameras.isFirstPerson,firstPerson:n._.cameras.firstPerson,orbit:n._.cameras.orbit}},this.getContainer=function(){return n._.container},this.invalidateSize=function(){n._.wasInitialized&&(n._.renderer.setSize(n._.sceneContainer.offsetWidth,n._.sceneContainer.offsetHeight),n._.cameras.updateSize())};var r=document.getElementById(t).appendChild(document.createElement("div"));r.id="_lithosphere_scene",r.style.width="100%",r.style.height="100%",this._={containerId:t,container:document.getElementById(t),sceneContainer:r,wasInitialized:!1,renderer:null,cameras:null,cameraPositionTarget:null,tiledWorld:null,events:null,maxZoom:0,minNativeZoom:0,loader:new As,raycaster:new Xa,updateEveryNthRender:2,counters:{update:0,frame:0},lastCameraWasFirst:!1,firstUpdate:!0,firstLoad:!1,loadingScreen:null,renderOnlyWhenOpen:!0,zCutOff:3,firstViewOverride:null,mouseIsInScene:!1,marsRadius:3396190},this._.container.style.position="relative",this.scene=new ii,this.scenesLOD=[new ii,new ii,new ii],this.sceneBack=new ii,this.sceneFront=new ii,this.planet=new bt,this.planetsLOD=[new bt,new bt,new bt],this.frontGroup=new bt;e=e||{},this.options=_d(_d({},{loadingScreen:!0,tileMapResource:null,customParsers:{},radiusOfTiles:4,useLOD:!0,LOD:[{radiusOfTiles:4,zoomsUp:3},{radiusOfTiles:2,zoomsUp:7},{radiusOfTiles:2,zoomsUp:11}],tileResolution:32,trueTileResolution:256,showAxes:!1,wireframeMode:!1,exaggeration:1,renderOnlyWhenOpen:!0,targetYOffset:0,highlightColor:"yellow",activeColor:"red"}),e),this._init()}return t.prototype._init=function(){if(this._.renderer=new pl(this._.sceneContainer).renderer,!this._.renderer)return!1;if(this._.wasInitialized=!0,this.projection=new gh(this.options.majorRadius,this.options.minorRadius,this.options.tileMapResource,this.options.trueTileResolution),this._.cameras=new bl(this._.container,this._.sceneContainer,this.scene,this.projection),this.layers=new ld(this),this.addLayer=this.layers.addLayer,this.removeLayer=this.layers.removeLayer,this.toggleLayer=this.layers.toggleLayer,this.setLayerOpacity=this.layers.setLayerOpacity,this._.tiledWorld=new Lh(this),this.zoom=10,this.trueZoom=this.zoom,this.mouse={lat:null,lng:null,elev:null},this.planetCenter=new _(0,-this.projection.radii.major/this.projection.radiusScale,0),this.planet.position.set(this.planetCenter.x,-this.planetCenter.y,this.planetCenter.z),this.scene.add(this.planet),this.scenesLOD[0].add(this.planetsLOD[0]),this.scenesLOD[1].add(this.planetsLOD[1]),this.scenesLOD[2].add(this.planetsLOD[2]),this.frontGroup.position.set(this.planetCenter.x,-this.planetCenter.y,this.planetCenter.z),this.sceneFront.add(this.frontGroup),this.scene.add(new la(16711422)),this.options.starsphere){var t=new Go(1e3*this.planetCenter.y,64,64),e=new Vt({color:this.options.starsphere.color||11184810});this.options.starsphere.url&&(e.map=this._.loader.load(this.options.starsphere.url)),e.opacity=1,this.starsphere=new ke(t,e),this.sceneBack.add(this.starsphere)}if(this.options.atmosphere&&(this.atmosphere=new ke(new Go(1.5*this.planetCenter.y,128,128),vh.atmosphere(this.options.atmosphere.color)),this.sceneBack.add(this.atmosphere)),!0===this.options.showAxes){var n=new Hi({color:16711680}),r=new Yi((new me).setFromPoints([new _(0,0,0),new _(2*this.planetCenter.y,0,0)]),n);this.scene.add(r);var i=new Hi({color:65280}),o=new Yi((new me).setFromPoints([new _(0,0,0),new _(0,2*this.planetCenter.y,0)]),i);this.scene.add(o);var s=new Hi({color:255}),a=new Yi((new me).setFromPoints([new _(0,0,0),new _(0,0,2*this.planetCenter.y)]),s);this.scene.add(a)}return this.controls=new yd(this),this.addControl=this.controls.addControl,this.removeControl=this.controls.removeControl,!1===this.options.renderOnlyWhenOpen&&(this._.renderOnlyWhenOpen=!1),this._.loadingScreen=new bd(this),this._.events=new Qh(this),this.setCenter(this.options.initialView),this._animate(),!0},t.prototype._render=function(){if(this._.renderer.clear(),this._.renderOnlyWhenOpen){var t=this._.container.getBoundingClientRect();if(t.width<=0||t.height<=0)return}this._.counters.update=(this._.counters.update+1)%this._.updateEveryNthRender,0===this._.counters.update?this._update():this._.cameras.isFirstPerson||this._.cameras.orbit.controls.update(),this.layers.tile3d.forEach((function(t){t.renderer.update()})),this._.renderer.render(this.sceneBack,this._.cameras.camera),this._.renderer.clearDepth(),this._.renderer.render(this.scenesLOD[2],this._.cameras.camera),this._.renderer.clearDepth(),this._.renderer.render(this.scenesLOD[1],this._.cameras.camera),this._.renderer.clearDepth(),this._.renderer.render(this.scenesLOD[0],this._.cameras.camera),this._.renderer.clearDepth(),this._.renderer.render(this.scene,this._.cameras.camera),this._.renderer.clearDepth(),this._.renderer.render(this.sceneFront,this._.cameras.camera)},t.prototype._update=function(){if(this._.wasInitialized){if(this._.counters.frame=(this._.counters.frame+1)%4,this.scene.rotation.x=0,this.scene.position.y=0,this._.firstUpdate||this._.tiledWorld.refreshTiles(),this._.events._checkDesiredZoom(),this.controls._onUpdateEvent(),this._.cameras.isFirstPerson){this._.lastCameraWasFirst=!0,this._.cameras.firstPerson.controls.getObject().position.y=this._.cameras.orbit.controls.target.y-this._.cameras.firstPerson.height/this.projection.radiusScale;var t=this._.cameras.update();this._.events._rotateGlobe(t),this._.events._onMouseMove(),this.controls._onFirstPersonUpdate()}else this._.lastCameraWasFirst&&(this._.lastCameraWasFirst=!1,this.controls._onOrbitalUpdate());if(this._.firstUpdate){null!=this._.firstViewOverride?this.setCenter(this._.firstViewOverride):this.setCenter(this.options.initialView,!0);var e=this._.cameras.orbit,n=e.camera,r=e.controls,i=n.position,o=r.target;this._.cameraPositionTarget=[i.x,i.y,i.z,o.x,o.y,o.z],this._.firstUpdate=!1}}},t}();e.default=xd}])}));